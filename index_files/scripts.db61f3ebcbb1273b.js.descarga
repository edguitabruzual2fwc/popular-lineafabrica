(function(Ct,De){"object"==typeof exports&&"undefined"!=typeof module?De(exports):"function"==typeof define&&define.amd?define(["exports"],De):De((Ct=Ct||self).xmsdk={})})(this,function(Ct){"use strict";function De(p){return(De="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(d){return typeof d}:function(d){return d&&"function"==typeof Symbol&&d.constructor===Symbol&&d!==Symbol.prototype?"symbol":typeof d})(p)}function ee(p,d){if(!(p instanceof d))throw new TypeError("Cannot call a class as a function")}function rn(p,d){for(var l=0;l<d.length;l++){var t=d[l];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(p,t.key,t)}}function re(p,d,l){return d&&rn(p.prototype,d),l&&rn(p,l),p}var le=function(){function p(d){ee(this,p),this._host=d}return re(p,[{key:"extractHeaders",value:function(d){return d.trim().split(/[\r\n]+/).map(function(l){var t=l.split(": "),i=t.shift(),u=t.join(": "),c=new com.ts.mobile.sdk.TransportHeader;return c.setName(i),c.setValue(u),c})}},{key:"sendRequest",value:function(d){var l=this;return new Promise(function(t,i){var u=new XMLHttpRequest,c=function(){i(new com.ts.mobile.sdk.impl.AuthenticationErrorImpl(com.ts.mobile.sdk.AuthenticationErrorCode.Communication,u.responseText))};u.open(d.getMethod(),d.getUrl(),!0),u.withCredentials=!0,u.onreadystatechange=function(){if(4===u.readyState)try{if(0===u.status)return l._host.log(com.ts.mobile.sdk.LogLevel.Error,"transport","Destination server is invalid or the server does not support access-control-allow-origin."),i(new com.ts.mobile.sdk.impl.AuthenticationErrorImpl(com.ts.mobile.sdk.AuthenticationErrorCode.Communication,u.responseText));JSON.parse(u.responseText);var s=new com.ts.mobile.sdk.TransportResponse;s.setStatus(u.status),s.setMethod(d.getMethod()),s.setHeaders(l.extractHeaders(u.getAllResponseHeaders())),s.setBodyJson(u.responseText),t(s)}catch(n){c()}},u.onerror=function(){c()},d.getHeaders().forEach(function(s){u.setRequestHeader(s.getName(),s.getValue())}),u.setRequestHeader("Content-Type","application/json"),u.send(d.getBodyJson())})}}]),p}(),oe={ts_gen_back:"BACK",ts_gen_skip:"SKIP",ts_gen_continue:"Continue",ts_gen_cancel:"CANCEL",ts_gen_close:"CLOSE",ts_gen_ok:"OK",ts_gen_default:"Default",ts_gen_restart:"RESTART",ts_gen_expired:"Authenticator expired. Please reregister.",ts_gen_cancel_authentication:"CANCEL",ts_gen_change_authenticator:"CHANGE METHOD",ts_gen_select_authenticator:"CHANGE METHOD",ts_gen_retry_authenticator:"TRY AGAIN",ts_gen_dismiss:"DISMISS",ts_authenticator_device_biometrics:"Device Biometrics",ts_authenticator_password:"Password",ts_authenticator_pin:"PIN",ts_authenticator_pattern:"Pattern",ts_authenticator_otp:"OTP",ts_authenticator_fingerprint:"Fingerprint",ts_authenticator_question:"Security Questions",ts_authenticator_face_id:"Face ID",ts_authenticator_touch_id:"Touch ID",ts_authenticator_totp:"Soft Token",ts_authenticator_pattern_centralized:"Pattern",ts_authenticator_pin_centralized:"PIN",ts_authenticator_voice_server:"Voice",ts_authenticator_fido2:"FIDO2",ts_authenticator_mobile_approve:"Mobile Approve",ts_authenticator_face_server:"Face",ts_authenticator_fido_fidopin:"PIN",ts_authenticator_fido_fidoface:"Face ID",ts_authenticator_fido_fidofp:"Fingerprint",ts_authenticator_device_biometrics_description:"Use the biometric sensors registered on your device",ts_authenticator_password_description:"",ts_authenticator_pin_description:"Numeric PIN code",ts_authenticator_pin_centralized_description:"Numeric PIN code",ts_authenticator_pattern_description:"Visual pattern",ts_authenticator_pattern_centralized_description:"Visual pattern",ts_authenticator_otp_description:"One time password sent to your phone or email",ts_authenticator_voice_description:"Use your voice print",ts_authenticator_voice_server_description:"Use your voice print",ts_authenticator_questions_description:"Knowledge based questions",ts_authenticator_face_description:"Use your smartphone's camera",ts_authenticator_fingerprint_description:"Use your smartphone's biometric sensor",ts_authenticator_face_id_description:"Use Face ID",ts_authenticator_touch_id_description:"Use Touch ID",ts_authenticator_totp_description:"Use soft token",ts_authenticator_mobile_approve_description:"Use mobile approve",ts_authenticator_fido2_description:"Use a security key",ts_authenticator_password_title_auth:"Authenticate with Password",ts_authenticator_password_title_reg:"Register Password",ts_authenticator_password_intro_auth:"",ts_authenticator_password_intro_reg:"",ts_authenticator_password_field_hint:"Password",ts_authenticator_password_reg_field_hint:"Repeat password",ts_authenticator_password_cta_positive:"CONTINUE",ts_authenticator_password_error_too_short:"Password too short!",ts_authenticator_password_error_reg_no_match:"Passwords don't match!",ts_authenticator_password_error_reg_strength_validation_failed:"Password must be at least 6 characters long, and contain a mix of lowercase characters, uppercase characters, and digits.",ts_authenticator_pin_title_auth:"Authenticate with PIN Code",ts_authenticator_pin_title_reg:"Register PIN Code",ts_authenticator_pin_intro_auth:"Enter your PIN Code to proceed",ts_authenticator_pin_intro_reg:"Enter your new PIN Code to proceed",ts_authenticator_pin_intro_repeat:"Re-enter your new PIN Code",ts_authenticator_pin_error_reg_no_match:"Codes don't match!",ts_authenticator_pin_code_length:"Enter your %1$s-digit PIN code",ts_authenticator_otp_title_auth:"Authenticate with OTP",ts_authenticator_otp_qr_title:"Authenticate with QR",ts_authenticator_otp_targets_intro:"Please select how you want us to deliver a One Time Password to you.",ts_authenticator_otp_sms_title:"SMS",ts_authenticator_otp_email_title:"EMAIL",ts_authenticator_otp_voice_title:"VOICE",ts_authenticator_otp_push_title:"PUSH",ts_authenticator_otp_unknown_title:"Unknown",ts_authenticator_otp_sms_sent:"A text message with a code was sent to your phone. Please type it here.",ts_authenticator_otp_email_sent:"A code was sent to your email. Please type it here.",ts_authenticator_otp_push_sent:"A push notification with a code was sent to your phone. Please type it here.",ts_authenticator_otp_voice_sent:"A voice message with a code is being delivered to your phone. Please type it here.",ts_authenticator_otp_qr_sent:"A QR code was sent to your email. Please scan it.",ts_authenticator_otp_external_numeric_sent:"A code is being delivered to you. Please type it here.",ts_authenticator_otp_external_qr_sent:"Please scan the QR code to proceed",ts_authenticator_otp_resend:"RESEND OTP",ts_authenticator_otp_resend_message:"Didn't get the code?",ts_authenticator_otp_resend_intro:"Code resent.",ts_authenticator_otp_error_qr_permission:"Using QR to authenticate requires permission to access your phone's camera",ts_authenticator_otp_error_code_expired:"Your code is no longer valid, please request a new one",ts_authenticator_otp_code_length:"Enter the %1$s-digit code",ts_authenticator_pattern_title_auth:"Authenticate with Pattern",ts_authenticator_pattern_title_reg:"Register Pattern",ts_authenticator_pattern_intro_auth:"Draw your pattern to proceed",ts_authenticator_pattern_intro_reg:"Draw your new pattern to proceed",ts_authenticator_pattern_mismatch:"Patterns don't match. Re-draw your new pattern to proceed.",ts_authenticator_pattern_error_min_points:"Pattern is too short. Try again",ts_authenticator_pattern_intro_repeat:"Re-draw your pattern",ts_authenticator_pattern_cta_reset:"RESTART",ts_authenticator_fingerprint_title_auth:"Authenticate with Fingerprint",ts_authenticator_fingerprint_title_reg:"Confirm fingerprint to continue",ts_authenticator_fingerprint_status_hint:"Touch sensor",ts_authenticator_faceid_title_auth:"Authenticate with Face ID",ts_authenticator_faceid_title_reg:"Confirm Face ID to continue",ts_authenticator_touchid_title_reg:"Authenticate with Touch ID",ts_authenticator_touchid_title_auth:"Confirm Touch ID to continue",ts_authenticator_device_biometrics_title_auth:"Authenticate with device biometrics",ts_authenticator_device_biometrics_title_reg:"Confirm device biometrics to continue",ts_authenticator_device_biometrics_intro_auth:"Authenticate biometric to continue",ts_authenticator_device_biometrics_intro_reg:"Register biometric to continue",ts_authenticator_device_biometrics_prompt:"Follow biometric instructions",ts_authenticator_device_biometrics_cancel_cta:"Cancel biometric",ts_authenticator_questions_title_auth:"Authenticate with Security Questions",ts_authenticator_questions_title_reg:"Register Security Questions",ts_authenticator_questions_intro_auth:"Answer the question below to proceed",ts_authenticator_questions_intro_reg:"Answer at least %1$s questions to proceed.",ts_authenticator_questions_error_answer_range:"Answer must be between %1$s to %2$s characters.",ts_authenticator_questions_left:"%1$s questions answered",ts_authenticator_questions_error_answer_empty:"Please provide an answer",ts_authenticator_questions_remove_this_question_cta:"REMOVE",ts_authenticator_questions_add_question_cta:"ADD QUESTION",ts_authenticator_questions_reg_select_question:"Select Question",ts_authenticator_questions_reg_select_question_cta:"CHOOSE",ts_authenticator_questions_reg_default_answer_placeholder:"*******",ts_authenticator_voice_title_auth:"Authenticate with Voice",ts_authenticator_voice_title_reg:"Register Voice",ts_authenticator_voice_intro_auth:"Follow instructions to authenticate with your voice signature",ts_authenticator_voice_intro_reg:"Follow instructions to register your voice signature",ts_authenticator_voice_passphrase:"Hold to record and repeat the following passphrase %1$s.",ts_authenticator_voice_passphrase_subtitle:"You might be prompted to say it more than once.",ts_authenticator_voice_instructions:"Please record again.",ts_authenticator_voice_record_start:"Hold to record",ts_authenticator_voice_record_stop:"Release to stop",ts_authenticator_voice_request_audio_permission:"Recording voice requires permission to access your phone's microphone",ts_authenticator_voice_error_too_long:"The recording is too long",ts_authenticator_voice_error_too_short:"Recording too short",ts_authenticator_voice_error_too_loud:"Recording too loud",ts_authenticator_voice_error_too_weak:"Recording too weak",ts_authenticator_voice_error_too_noisy:"Recording too noisy",ts_authenticator_voice_error_invalid:"Wrong passphrase!",ts_authenticator_face_title_auth:"Authenticate with Face",ts_authenticator_face_title_reg:"Register Face",ts_authenticator_face_intro_auth:"Capture a selfie in order to proceed",ts_authenticator_face_intro_reg:"Capture a selfie in order to proceed",ts_authenticator_face_error_invalid:"Could not find a match, please try again",ts_authenticator_totp_title:"Authenticate with Soft Token",ts_authenticator_totp_targets_intro:"Please select device",ts_authenticator_totp_input_intro:"Please input code",ts_authenticator_totp_input_with_challenge_intro:"Please use challenge and input code",ts_authenticator_totp_input_with_qr_challenge_intro:"Please scan QR challenge and input code",ts_authenticator_totp_qrcode_challenge_step1_message:"Step 1: Scan this QR code using your mobile app",ts_authenticator_totp_qrcode_challenge_step2_message:"Step 2: Enter the code generated by your mobile app",ts_authenticator_totp_code_challenge_step1_message:"Step 1: Enter this key into your mobile app",ts_authenticator_totp_code_challenge_step2_message:"Step 2: Enter the code generated by your mobile app",ts_authenticator_totp_input_hint:"Insert code",ts_authenticator_totp_targets_recently_used:"Recently used: %1$s",ts_authenticator_totp_targets_current_device:"Current Device",ts_authenticator_mobile_approve_title:"Mobile Approve",ts_authenticator_mobile_approve_fetching_data:"Please wait... Fetching data",ts_authenticator_mobile_approve_send:"SEND",ts_authenticator_mobile_approve_send_to_all:"SEND TO ALL",ts_authenticator_mobile_approve_targets_intro:"Please select device",ts_authenticator_mobile_approve_targets_recently_used:"Recently used: %1$s",ts_authenticator_mobile_approve_targets_current_device:"Current Device",ts_authenticator_mobile_approve_resend_message:"Didn't get the approval request?",ts_authenticator_mobile_approve_resend_cta:"RESEND",ts_session_config_title:"Authenticator configuration",ts_session_config_intro:"Register, remove or change your authenticators.",ts_session_config_item_action_register:"REGISTER",ts_session_config_item_action_unregister:"UNREGISTER",ts_session_config_item_action_reregister:"CHANGE",ts_session_config_item_action_set_as_default:"SET AS DEFAULT",ts_session_config_item_register_result:"%1$s registered successfully",ts_session_config_item_reregister_result:"%1$s changed successfully",ts_session_config_item_unregister_result:"%1$s unregistered successfully",ts_session_config_item_default_result:"%1$s is now the default authenticator",ts_session_config_item_register_failed:"%1$s registration failed. %2$s",ts_session_config_item_reregister_failed:"%1$s change failed. %2$s",ts_session_config_item_unregister_failed:"%1$s unregistration failed. %2$s",ts_session_config_item_default_failed:"Failed to make %1$s the default authenticator. %2$s",ts_session_config_item_unregister_dialog_title:"Are your sure?",ts_session_config_item_unregister_dialog_message:"Do you want to unregister %1$s?",ts_session_config_item_unregister_dialog_cta:"UNREGISTER",ts_session_config_error_dialog_title:"Something went wrong",ts_session_totp_title:"Generate Soft Token",ts_session_totp_content:"Your code is being reset every %1$s seconds.",ts_session_totp_unbound_title:"Unbound TOTP Generation",ts_session_totp_unbound_content:"Your TOTP code has been generated",ts_session_totp_unbound_code:"Your TOTP code is: %1$s",ts_session_totp_nottl_content:"Please use this code.",ts_session_totp_provision_sa_title:"Select Authenticator for Provisioning Soft Token",ts_session_totp_provision_password_title:"Provision Soft Token With Password",ts_session_totp_provision_pattern_title:"Provision Soft Token With Pattern",ts_session_totp_provision_pin_title:"Provision Soft Token With PIN",ts_session_totp_generation_sa_title:"Generate Soft Token with Authenticator",ts_session_totp_generation_password_title:"Generate Soft Token with Password",ts_session_totp_generation_pattern_title:"Generate Soft Token with Pattern",ts_session_totp_generation_pin_title:"Generate Soft Token with PIN",ts_session_totp_generation_fingerprint_title:"Generate Soft Token with Fingerprint",ts_session_totp_generation_device_biometrics_title:"Generate Soft Token with Device Biometrics",ts_session_totp_challenge_title_list:"Soft Token with Challenge",ts_session_totp_challenge_intro_list:"Choose challenge type",ts_session_totp_challenge_title_textual:"Textual",ts_session_totp_challenge_intro_textual:"Enter the challenge to proceed",ts_session_totp_challenge_title_qr:"QR Code",ts_session_totp_challenge_intro_qr:"Scan the QR code to proceed",ts_session_approval_approve:"APPROVE",ts_session_approval_deny:"DENY",ts_session_approval_completed_title:"Success",ts_session_approval_completed_subtitle:"The request has been successfully approved. Please return to the requesting application.",ts_session_approval_completed_denied_subtitle:"The request has been successfully denied. Please return to the requesting application.",ts_session_approval_dialog_title:"Deny approval",ts_session_approval_dialog_message:"Deny approval",ts_session_approval_dialog_cta:"DENY",ts_session_approval_approve_failed:"'%1$s' failed to approve",ts_session_approval_deny_failed:"'%1$s' failed to deny",ts_session_approval_approve_failed_title:"An Error Occurred",ts_session_approval_deny_failed_title:"An Error Occurred",ts_session_approval_approve_failed_cta:"CLOSE",ts_session_approval_deny_failed_cta:"CLOSE",ts_session_approval_username:"Username",ts_session_approval_service:"Service",ts_session_approval_description:"Details",ts_session_approval_requested_device:"Requesting Device",ts_session_approval_expiry:"Expiry",ts_session_approval_requested_location:"Request Location",ts_session_approval_request_expires_time:"Your request expires in %1$s",ts_session_approval_request_has_expired:"Your request has expired",ts_session_dm_title:"Your Devices",ts_session_dm_intro:"These are the devices you've used to log into our applications. Click on a device for more information and options.",ts_session_dm_section_current:"This device",ts_session_dm_section_others:"Other devices",ts_session_dm_last_used_date:"Last used: %1$s",ts_session_dm_last_used_location:"at %1$s",ts_session_dm_details_title:"Your Device Details",ts_session_dm_details_subtitle:"Details about your device",ts_session_dm_details_current_device:"Current device",ts_session_dm_details_rename_action:"RENAME",ts_session_dm_details_remove_subtitle:"You can remove this device if you're not using it anymore.",ts_session_dm_details_remove_action:"REMOVE",ts_session_dm_details_no_other_devices_available:"No other devices available at the moment",ts_session_dm_item_action_dialog_remove_title:"Remove '%1$s'",ts_session_dm_item_action_dialog_remove_message:"Are you sure you want to remove this device?",ts_session_dm_item_action_dialog_remove_cta:"REMOVE",ts_session_dm_item_action_dialog_rename_title:"Rename '%1$s'",ts_session_dm_item_action_dialog_rename_cta:"RENAME",ts_session_dm_details_rename_input_hint:"New Device Name",ts_session_dm_item_action_rename_result_positive:"Device %1$s was renamed successfully to %2$s",ts_session_dm_item_action_rename_result_negative:"Failed to rename %1$s. %2$s",ts_session_dm_item_action_remove_result_positive:"Device %1$s was removed successfully",ts_session_dm_item_action_remove_result_negative:"Failed to remove %1$s. %2$s",ts_session_dm_error_dialog_title:"Something went wrong",ts_session_promotion_title:"Promotion",ts_session_promotion_intro:"Select authentication method to register",ts_session_promotion_skip:"SKIP",ts_session_promotion_abort:"ABORT",ts_promise_sa_title:"Verify It's You",ts_promise_sa_content:"Choose how you want to verify yourself",ts_promise_co_title_auth:"Authentication canceled!",ts_promise_co_title_reg:"Registration canceled!",ts_promise_fallback_title:"%1$s failed.",ts_promise_fallback_content:"Would you like to try a different method?",ts_promise_fallback_action_fallback:"TRY ANOTHER METHOD",ts_promise_fallback_action_menu:"CHANGE METHOD",ts_promise_fallback_action_retry:"TRY AGAIN",ts_promise_fallback_action_cancel:"CANCEL",ts_promise_co_content:"What would you like to do?",ts_promise_co_abort:"ABORT",ts_promise_co_select:"SELECT METHOD",ts_promise_co_change:"CHANGE METHOD",ts_promise_co_retry:"RETRY METHOD",ts_promise_error_default_title_auth:"Authentication failed",ts_promise_error_default_title_reg:"Registration failed",ts_promise_error_default_content_auth:"%1$s",ts_promise_error_default_content_reg:"%1$s",ts_promise_error_lock_title:"Authenticator Locked!",ts_promise_error_lock_content:"Too many failed attempts",ts_promise_invalid_authenticator_title:"%1$s invalidated",ts_promise_invalid_authenticator_content:"This authenticator has became invalid and is no longer available.",ts_promise_invalid_authenticator_cta:"CONTINUE",ts_promise_rejection_policy_title:"Error",ts_promise_rejection_policy_content:"Configuration error, please contact support",ts_promise_rejection_policy_cta:"CONTINUE",ts_promise_rejection_locked_user_title:"User Locked",ts_promise_rejection_locked_user_content:"You have been locked, please contact support",ts_promise_rejection_locked_user_cta:"CONTINUE",ts_promise_rejection_locked_device_title:"Device Locked",ts_promise_rejection_locked_device_content:"Your device has been locked, please contact support",ts_promise_rejection_locked_device_cta:"CONTINUE",ts_promise_rejection_locked_application_title:"Application Locked",ts_promise_rejection_locked_application_content:"Your application has been locked, please contact support",ts_promise_rejection_locked_application_cta:"CONTINUE",ts_promise_rejection_approval_expired_title:"Expired",ts_promise_rejection_approval_expired_content:"Request has expired, please try again",ts_promise_rejection_approval_expired_cta:"CONTINUE",ts_session_authenticator_expired_title:"%1$s Expired",ts_session_authenticator_expired_content:"Click continue to reregister",ts_promise_rejection_feature_not_supported_title:"Upgrade Required",ts_promise_rejection_feature_not_supported_content:"Your application is too old, please upgrade",ts_promise_rejection_feature_not_supported_cta:"CONTINUE",ts_promise_rejection_cannot_consume_ticket_title:"Error",ts_promise_rejection_cannot_consume_ticket_content:"Configuration error, please contact support",ts_promise_rejection_cannot_consume_ticket_cta:"CONTINUE",ts_promise_rejection_username_already_exists_title:"User Already Exists",ts_promise_rejection_username_already_exists_content:"The user %1$s already exists.",ts_promise_rejection_username_already_exists_cta:"CLOSE",ts_promise_rejection_authenticator_fatal_error_title:"An Error Occurred",ts_promise_rejection_authenticator_fatal_error_content:"Something went wrong when trying to add or verify using this method. ",ts_promise_rejection_authenticator_fatal_error_cta:"CLOSE",ts_accessibility_totp_reset:"New code is %1$s. %2$s seconds left before reset.",ts_accessibility_totp_reader:"Code is %1$s. %2$s seconds left.",ts_accessibility_totp_no_ttl:"Your code is %1$s.",ts_accessibility_configuration_cta_register:"Register %1$s",ts_accessibility_configuration_cta_unregister:"Unregister %1$s",ts_accessibility_configuration_cta_reregister:"Change %1$s",ts_accessibility_input_reader:"%1$s cells filled, %2$s cells remaining",ts_accessibility_input_pin_cell:"Cell filled",ts_accessibility_input_reset:"Cells were reset.",ts_accessibility_authenticator_list_locked:"%1$s authenticator is locked. selection disabled.",ts_accessibility_authenticator_list_disabled:"%1$s authenticator is unregistered. selection disabled.",ts_accessibility_authenticator_list_enabled:"%1$s authenticator. double tap to authenticate",ts_accessibility_authenticator_list_default:"%1$s authenticator is the Default authenticator. double tap to authenticate",ts_accessibility_hide_input_field:"Hide Input field",ts_accessibility_show_input_field:"Show Input field",ts_accessibility_back:"Back",ts_accessibility_cancel:"Cancel",ts_accessibility_password_enter_password:"Enter your new password",ts_accessibility_password_enter_password_again:"Enter your new password again",ts_accessibility_password_error_reg_no_match:"Passwords don't match. Try again",ts_plugin_dynamic_form_mandatory:"%1$s *",ts_plugin_dynamic_form_error_mandatory:"'%1$s' is mandatory!",ts_plugin_dynamic_form_error_invalid:"'%1$s' invalid value",ts_plugin_dynamic_form_error_too_long:"'%1$s' is too long",ts_plugin_dynamic_form_error_not_phone:"'%1$s' isn't a valid phone number",ts_plugin_dynamic_form_error_not_email:"'%1$s' isn't a valid Email address",ts_plugin_dynamic_form_error_else:"Something went wrong",ts_plugin_dynamic_form_table_title:"Add row",ts_plugin_dynamic_form_table_title_item:"Add row to %1$s",ts_plugin_dynamic_form_error_general:"Failed to read '%1$s' value",ts_plugin_dynamic_form_item_cta_positive:"OK",ts_plugin_dynamic_form_item_cta_cancel:"Dismiss",ts_plugin_dynamic_form_item_cta_select_all:"Select All",ts_plugin_dynamic_form_item_cta_clear_all:"Clear All",ts_plugin_dynamic_form_item_phone_prefix:"%1$s +%2$s",ts_plugin_dynamic_form_item_phone_prefix_dialog_title:"Select country",ts_session_scan_qr_title:"Scan QR",ts_session_scan_qr_hint:"No QR code detected",ts_gen_recovery:"Forgot my %1$s"},Rn=function(){function p(){ee(this,p)}return re(p,[{key:"formatAsTwoDigits",value:function(d){return d.toLocaleString("EN",{minimumIntegerDigits:2,useGrouping:!1})}},{key:"logDateFormat",value:function(d){var l=d.getFullYear(),t=this.formatAsTwoDigits(d.getMonth()+1),i=this.formatAsTwoDigits(d.getDate()),u=this.formatAsTwoDigits(d.getHours()),c=this.formatAsTwoDigits(d.getMinutes()),s=this.formatAsTwoDigits(d.getSeconds()),n=d.getMilliseconds().toLocaleString("EN",{minimumIntegerDigits:3,useGrouping:!1});return"".concat(l,"-").concat(t,"-").concat(i," ").concat(u,":").concat(c,":").concat(s,".").concat(n)}},{key:"log",value:function(d,l,t){var i=com.ts.mobile.sdk.LogLevel[d].toUpperCase();console.log("".concat(this.logDateFormat(new Date),"\t").concat(i,"\t").concat(l,":\t").concat(t))}}]),p}();function Ee(p,d,l){var t;if("undefined"!=typeof document){if(arguments.length>1){if("number"==typeof(l=function(){for(var f=arguments.length,g=new Array(f),y=0;y<f;y++)g[y]=arguments[y];for(var A=0,T={};A<arguments.length;A++){var C=arguments[A];for(var E in C)T[E]=C[E]}return T}({path:"/"},{},l)).expires){var i=new Date;i.setMilliseconds(i.getMilliseconds()+864e5*l.expires),l.expires=i}l.expires=l.expires?l.expires.toUTCString():"";try{t=JSON.stringify(d),/^[\{\[]/.test(t)&&(d=t)}catch(f){}d=encodeURIComponent(String(d)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),p=(p=(p=encodeURIComponent(String(p))).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent)).replace(/[\(\)]/g,escape);var u="";for(var c in l)l[c]&&(u+="; "+c,!0!==l[c]&&(u+="="+l[c]));return document.cookie=p+"="+d+u}p||(t={});for(var s=document.cookie?document.cookie.split("; "):[],n=/(%[0-9A-Z]{2})+/g,e=0;e<s.length;e++){var o=s[e].split("="),r=o.slice(1).join("=");'"'===r.charAt(0)&&(r=r.slice(1,-1));try{var h=o[0].replace(n,decodeURIComponent);if(r=r.replace(n,decodeURIComponent),p===h){t=r;break}p||(t[h]=r)}catch(f){}}return t}}var ce={set:Ee,get:function(p){return Ee.call(Ee,p)},remove:function(p){Ee(p,"",{expires:-1})}},Pn=function(){function p(d){ee(this,p),this._persistent=d}return re(p,[{key:"setItem",value:function(d,l){var t=btoa(l);this._persistent?ce.set(d,t,{expires:365}):ce.set(d,t)}},{key:"removeItem",value:function(d){ce.remove(d)}},{key:"getItem",value:function(d){var l=ce.get(d);return l&&(l=atob(l)),l}}]),p}(),dt=function(){function p(){ee(this,p),this._memStore={}}return re(p,[{key:"setItem",value:function(d,l){this._memStore[d]=l}},{key:"removeItem",value:function(d){delete this._memStore[d]}},{key:"getItem",value:function(d){return this._memStore[d]}}]),p}(),sn=function(){function p(d){if(ee(this,p),"undefined"!=typeof window)try{this.currentStorage=window[d],this.currentStorage.setItem("ts:test","ok"),this.currentStorage.removeItem("ts:test")}catch(l){console.warn("Failed to use browser storage. Resorting to cookies."),this.currentStorage=new Pn("localStorage"==d)}else this.currentStorage=new dt}return re(p,[{key:"setItem",value:function(d,l){this.currentStorage.setItem(d,l)}},{key:"getItem",value:function(d){return this.currentStorage.getItem(d)}},{key:"removeItem",value:function(d){this.currentStorage.removeItem(d)}}]),p}(),Ne="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function Ut(){throw new Error("Dynamic requires are not currently supported by rollup-plugin-commonjs")}function Pt(p,d){return p(d={exports:{}},d.exports),d.exports}var Kt=Pt(function(p){var l,t;l=Ne,t=function(){var d=function(C,E){var R=[0,0,0,0];return R[3]+=(C=[C[0]>>>16,65535&C[0],C[1]>>>16,65535&C[1]])[3]+(E=[E[0]>>>16,65535&E[0],E[1]>>>16,65535&E[1]])[3],R[2]+=R[3]>>>16,R[3]&=65535,R[2]+=C[2]+E[2],R[1]+=R[2]>>>16,R[2]&=65535,R[1]+=C[1]+E[1],R[0]+=R[1]>>>16,R[1]&=65535,R[0]+=C[0]+E[0],R[0]&=65535,[R[0]<<16|R[1],R[2]<<16|R[3]]},l=function(C,E){var R=[0,0,0,0];return R[3]+=(C=[C[0]>>>16,65535&C[0],C[1]>>>16,65535&C[1]])[3]*(E=[E[0]>>>16,65535&E[0],E[1]>>>16,65535&E[1]])[3],R[2]+=R[3]>>>16,R[3]&=65535,R[2]+=C[2]*E[3],R[1]+=R[2]>>>16,R[2]&=65535,R[2]+=C[3]*E[2],R[1]+=R[2]>>>16,R[2]&=65535,R[1]+=C[1]*E[3],R[0]+=R[1]>>>16,R[1]&=65535,R[1]+=C[2]*E[2],R[0]+=R[1]>>>16,R[1]&=65535,R[1]+=C[3]*E[1],R[0]+=R[1]>>>16,R[1]&=65535,R[0]+=C[0]*E[3]+C[1]*E[2]+C[2]*E[1]+C[3]*E[0],R[0]&=65535,[R[0]<<16|R[1],R[2]<<16|R[3]]},t=function(C,E){return 32==(E%=64)?[C[1],C[0]]:E<32?[C[0]<<E|C[1]>>>32-E,C[1]<<E|C[0]>>>32-E]:[C[1]<<(E-=32)|C[0]>>>32-E,C[0]<<E|C[1]>>>32-E]},i=function(C,E){return 0==(E%=64)?C:E<32?[C[0]<<E|C[1]>>>32-E,C[1]<<E]:[C[1]<<E-32,0]},u=function(C,E){return[C[0]^E[0],C[1]^E[1]]},c=function(C){return C=u(C,[0,C[0]>>>1]),C=l(C,[4283543511,3981806797]),C=u(C,[0,C[0]>>>1]),C=l(C,[3301882366,444984403]),u(C,[0,C[0]>>>1])},s=function(C,E){for(var R=(C=C||"").length%16,O=C.length-R,L=[0,E=E||0],N=[0,E],W=[0,0],j=[0,0],te=[2277735313,289559509],b=[1291169091,658871167],D=0;D<O;D+=16)W=[255&C.charCodeAt(D+4)|(255&C.charCodeAt(D+5))<<8|(255&C.charCodeAt(D+6))<<16|(255&C.charCodeAt(D+7))<<24,255&C.charCodeAt(D)|(255&C.charCodeAt(D+1))<<8|(255&C.charCodeAt(D+2))<<16|(255&C.charCodeAt(D+3))<<24],j=[255&C.charCodeAt(D+12)|(255&C.charCodeAt(D+13))<<8|(255&C.charCodeAt(D+14))<<16|(255&C.charCodeAt(D+15))<<24,255&C.charCodeAt(D+8)|(255&C.charCodeAt(D+9))<<8|(255&C.charCodeAt(D+10))<<16|(255&C.charCodeAt(D+11))<<24],W=l(W,te),W=t(W,31),W=l(W,b),L=u(L,W),L=t(L,27),L=d(L,N),L=d(l(L,[0,5]),[0,1390208809]),j=l(j,b),j=t(j,33),j=l(j,te),N=u(N,j),N=t(N,31),N=d(N,L),N=d(l(N,[0,5]),[0,944331445]);switch(W=[0,0],j=[0,0],R){case 15:j=u(j,i([0,C.charCodeAt(D+14)],48));case 14:j=u(j,i([0,C.charCodeAt(D+13)],40));case 13:j=u(j,i([0,C.charCodeAt(D+12)],32));case 12:j=u(j,i([0,C.charCodeAt(D+11)],24));case 11:j=u(j,i([0,C.charCodeAt(D+10)],16));case 10:j=u(j,i([0,C.charCodeAt(D+9)],8));case 9:j=u(j,[0,C.charCodeAt(D+8)]),j=l(j,b),j=t(j,33),j=l(j,te),N=u(N,j);case 8:W=u(W,i([0,C.charCodeAt(D+7)],56));case 7:W=u(W,i([0,C.charCodeAt(D+6)],48));case 6:W=u(W,i([0,C.charCodeAt(D+5)],40));case 5:W=u(W,i([0,C.charCodeAt(D+4)],32));case 4:W=u(W,i([0,C.charCodeAt(D+3)],24));case 3:W=u(W,i([0,C.charCodeAt(D+2)],16));case 2:W=u(W,i([0,C.charCodeAt(D+1)],8));case 1:W=u(W,[0,C.charCodeAt(D)]),W=l(W,te),W=t(W,31),W=l(W,b),L=u(L,W)}return L=u(L,[0,C.length]),N=u(N,[0,C.length]),L=d(L,N),N=d(N,L),L=c(L),N=c(N),L=d(L,N),N=d(N,L),("00000000"+(L[0]>>>0).toString(16)).slice(-8)+("00000000"+(L[1]>>>0).toString(16)).slice(-8)+("00000000"+(N[0]>>>0).toString(16)).slice(-8)+("00000000"+(N[1]>>>0).toString(16)).slice(-8)},n={preprocessor:null,audio:{timeout:1e3,excludeIOS11:!0},fonts:{swfContainerId:"fingerprintjs2",swfPath:"flash/compiled/FontList.swf",userDefinedFonts:[],extendedJsFonts:!1},screen:{detectScreenOrientation:!0},plugins:{sortPluginsFor:[/palemoon/i],excludeIE:!1},extraComponents:[],excludes:{enumerateDevices:!0,pixelRatio:!0,doNotTrack:!0,fontsFlash:!0},NOT_AVAILABLE:"not available",ERROR:"error",EXCLUDED:"excluded"},e=function(C,E){if(Array.prototype.forEach&&C.forEach===Array.prototype.forEach)C.forEach(E);else if(C.length===+C.length)for(var R=0,O=C.length;R<O;R++)E(C[R],R,C);else for(var L in C)C.hasOwnProperty(L)&&E(C[L],L,C)},o=function(C,E){var R=[];return null==C?R:Array.prototype.map&&C.map===Array.prototype.map?C.map(E):(e(C,function(O,L,N){R.push(E(O,L,N))}),R)},r=function(C){if(null==navigator.plugins)return C.NOT_AVAILABLE;for(var E=[],R=0,O=navigator.plugins.length;R<O;R++)navigator.plugins[R]&&E.push(navigator.plugins[R]);return h(C)&&(E=E.sort(function(L,N){return L.name>N.name?1:L.name<N.name?-1:0})),o(E,function(L){var N=o(L,function(W){return[W.type,W.suffixes]});return[L.name,L.description,N]})},h=function(C){for(var E=!1,R=0,O=C.plugins.sortPluginsFor.length;R<O;R++)if(navigator.userAgent.match(C.plugins.sortPluginsFor[R])){E=!0;break}return E},f=function(){var C=document.createElement("canvas");return!(!C.getContext||!C.getContext("2d"))},g=function(){if(!f())return!1;var C=y();return!!window.WebGLRenderingContext&&!!C},y=function(){var C=document.createElement("canvas"),E=null;try{E=C.getContext("webgl")||C.getContext("experimental-webgl")}catch(R){}return E||(E=null),E},A=[{key:"userAgent",getData:function(C){C(navigator.userAgent)}},{key:"webdriver",getData:function(C,E){C(null==navigator.webdriver?E.NOT_AVAILABLE:navigator.webdriver)}},{key:"language",getData:function(C,E){C(navigator.language||navigator.userLanguage||navigator.browserLanguage||navigator.systemLanguage||E.NOT_AVAILABLE)}},{key:"colorDepth",getData:function(C,E){C(window.screen.colorDepth||E.NOT_AVAILABLE)}},{key:"deviceMemory",getData:function(C,E){C(navigator.deviceMemory||E.NOT_AVAILABLE)}},{key:"pixelRatio",getData:function(C,E){C(window.devicePixelRatio||E.NOT_AVAILABLE)}},{key:"hardwareConcurrency",getData:function(C,E){C(navigator.hardwareConcurrency?navigator.hardwareConcurrency:E.NOT_AVAILABLE)}},{key:"screenResolution",getData:function(C,E){var O;C((O=[window.screen.width,window.screen.height],E.screen.detectScreenOrientation&&O.sort().reverse(),O))}},{key:"availableScreenResolution",getData:function(C,E){C(function(R){if(window.screen.availWidth&&window.screen.availHeight){var O=[window.screen.availHeight,window.screen.availWidth];return R.screen.detectScreenOrientation&&O.sort().reverse(),O}return R.NOT_AVAILABLE}(E))}},{key:"timezoneOffset",getData:function(C){C((new Date).getTimezoneOffset())}},{key:"timezone",getData:function(C,E){window.Intl&&window.Intl.DateTimeFormat?C((new window.Intl.DateTimeFormat).resolvedOptions().timeZone):C(E.NOT_AVAILABLE)}},{key:"sessionStorage",getData:function(C,E){C(function(R){try{return!!window.sessionStorage}catch(O){return R.ERROR}}(E))}},{key:"localStorage",getData:function(C,E){C(function(R){try{return!!window.localStorage}catch(O){return R.ERROR}}(E))}},{key:"indexedDb",getData:function(C,E){C(function(R){try{return!!window.indexedDB}catch(O){return R.ERROR}}(E))}},{key:"addBehavior",getData:function(C){C(!(!document.body||!document.body.addBehavior))}},{key:"openDatabase",getData:function(C){C(!!window.openDatabase)}},{key:"cpuClass",getData:function(C,E){C(navigator.cpuClass||E.NOT_AVAILABLE)}},{key:"platform",getData:function(C,E){C(navigator.platform?navigator.platform:E.NOT_AVAILABLE)}},{key:"doNotTrack",getData:function(C,E){C(navigator.doNotTrack?navigator.doNotTrack:navigator.msDoNotTrack?navigator.msDoNotTrack:window.doNotTrack?window.doNotTrack:E.NOT_AVAILABLE)}},{key:"plugins",getData:function(C,E){var R,O;"Microsoft Internet Explorer"===navigator.appName||"Netscape"===navigator.appName&&/Trident/.test(navigator.userAgent)?C(E.plugins.excludeIE?E.EXCLUDED:(R=E,O=[],Object.getOwnPropertyDescriptor&&Object.getOwnPropertyDescriptor(window,"ActiveXObject")||"ActiveXObject"in window?O=o(["AcroPDF.PDF","Adodb.Stream","AgControl.AgControl","DevalVRXCtrl.DevalVRXCtrl.1","MacromediaFlashPaper.MacromediaFlashPaper","Msxml2.DOMDocument","Msxml2.XMLHTTP","PDF.PdfCtrl","QuickTime.QuickTime","QuickTimeCheckObject.QuickTimeCheck.1","RealPlayer","RealPlayer.RealPlayer(tm) ActiveX Control (32-bit)","RealVideo.RealVideo(tm) ActiveX Control (32-bit)","Scripting.Dictionary","SWCtl.SWCtl","Shell.UIHelper","ShockwaveFlash.ShockwaveFlash","Skype.Detection","TDCCtl.TDCCtl","WMPlayer.OCX","rmocx.RealPlayer G2 Control","rmocx.RealPlayer G2 Control.1"],function(L){try{return new window.ActiveXObject(L),L}catch(N){return R.ERROR}}):O.push(R.NOT_AVAILABLE),navigator.plugins&&(O=O.concat(r(R))),O)):C(r(E))}},{key:"canvas",getData:function(C,E){f()?C(function(R){var O=[],L=document.createElement("canvas");L.width=2e3,L.height=200,L.style.display="inline";var N=L.getContext("2d");return N.rect(0,0,10,10),N.rect(2,2,6,6),O.push("canvas winding:"+(!1===N.isPointInPath(5,5,"evenodd")?"yes":"no")),N.textBaseline="alphabetic",N.fillStyle="#f60",N.fillRect(125,1,62,20),N.fillStyle="#069",N.font=R.dontUseFakeFontInCanvas?"11pt Arial":"11pt no-real-font-123",N.fillText("Cwm fjordbank glyphs vext quiz, ????",2,15),N.fillStyle="rgba(102, 204, 0, 0.2)",N.font="18pt Arial",N.fillText("Cwm fjordbank glyphs vext quiz, ????",4,45),N.globalCompositeOperation="multiply",N.fillStyle="rgb(255,0,255)",N.beginPath(),N.arc(50,50,50,0,2*Math.PI,!0),N.closePath(),N.fill(),N.fillStyle="rgb(0,255,255)",N.beginPath(),N.arc(100,50,50,0,2*Math.PI,!0),N.closePath(),N.fill(),N.fillStyle="rgb(255,255,0)",N.beginPath(),N.arc(75,100,50,0,2*Math.PI,!0),N.closePath(),N.fill(),N.fillStyle="rgb(255,0,255)",N.arc(75,75,75,0,2*Math.PI,!0),N.arc(75,75,25,0,2*Math.PI,!0),N.fill("evenodd"),L.toDataURL&&O.push("canvas fp:"+L.toDataURL()),O}(E)):C(E.NOT_AVAILABLE)}},{key:"webgl",getData:function(C,E){g()?C(function(){var R,O=function(x){return R.clearColor(0,0,0,1),R.enable(R.DEPTH_TEST),R.depthFunc(R.LEQUAL),R.clear(R.COLOR_BUFFER_BIT|R.DEPTH_BUFFER_BIT),"["+x[0]+", "+x[1]+"]"};if(!(R=y()))return null;var L=[],N=R.createBuffer();R.bindBuffer(R.ARRAY_BUFFER,N);var W=new Float32Array([-.2,-.9,0,.4,-.26,0,0,.732134444,0]);R.bufferData(R.ARRAY_BUFFER,W,R.STATIC_DRAW),N.itemSize=3,N.numItems=3;var j=R.createProgram(),te=R.createShader(R.VERTEX_SHADER);R.shaderSource(te,"attribute vec2 attrVertex;varying vec2 varyinTexCoordinate;uniform vec2 uniformOffset;void main(){varyinTexCoordinate=attrVertex+uniformOffset;gl_Position=vec4(attrVertex,0,1);}"),R.compileShader(te);var b=R.createShader(R.FRAGMENT_SHADER);R.shaderSource(b,"precision mediump float;varying vec2 varyinTexCoordinate;void main() {gl_FragColor=vec4(varyinTexCoordinate,0,1);}"),R.compileShader(b),R.attachShader(j,te),R.attachShader(j,b),R.linkProgram(j),R.useProgram(j),j.vertexPosAttrib=R.getAttribLocation(j,"attrVertex"),j.offsetUniform=R.getUniformLocation(j,"uniformOffset"),R.enableVertexAttribArray(j.vertexPosArray),R.vertexAttribPointer(j.vertexPosAttrib,N.itemSize,R.FLOAT,!1,0,0),R.uniform2f(j.offsetUniform,1,1),R.drawArrays(R.TRIANGLE_STRIP,0,N.numItems);try{L.push(R.canvas.toDataURL())}catch(x){}L.push("extensions:"+(R.getSupportedExtensions()||[]).join(";")),L.push("webgl aliased line width range:"+O(R.getParameter(R.ALIASED_LINE_WIDTH_RANGE))),L.push("webgl aliased point size range:"+O(R.getParameter(R.ALIASED_POINT_SIZE_RANGE))),L.push("webgl alpha bits:"+R.getParameter(R.ALPHA_BITS)),L.push("webgl antialiasing:"+(R.getContextAttributes().antialias?"yes":"no")),L.push("webgl blue bits:"+R.getParameter(R.BLUE_BITS)),L.push("webgl depth bits:"+R.getParameter(R.DEPTH_BITS)),L.push("webgl green bits:"+R.getParameter(R.GREEN_BITS)),L.push("webgl max anisotropy:"+function(x){var P=x.getExtension("EXT_texture_filter_anisotropic")||x.getExtension("WEBKIT_EXT_texture_filter_anisotropic")||x.getExtension("MOZ_EXT_texture_filter_anisotropic");if(P){var I=x.getParameter(P.MAX_TEXTURE_MAX_ANISOTROPY_EXT);return 0===I&&(I=2),I}return null}(R)),L.push("webgl max combined texture image units:"+R.getParameter(R.MAX_COMBINED_TEXTURE_IMAGE_UNITS)),L.push("webgl max cube map texture size:"+R.getParameter(R.MAX_CUBE_MAP_TEXTURE_SIZE)),L.push("webgl max fragment uniform vectors:"+R.getParameter(R.MAX_FRAGMENT_UNIFORM_VECTORS)),L.push("webgl max render buffer size:"+R.getParameter(R.MAX_RENDERBUFFER_SIZE)),L.push("webgl max texture image units:"+R.getParameter(R.MAX_TEXTURE_IMAGE_UNITS)),L.push("webgl max texture size:"+R.getParameter(R.MAX_TEXTURE_SIZE)),L.push("webgl max varying vectors:"+R.getParameter(R.MAX_VARYING_VECTORS)),L.push("webgl max vertex attribs:"+R.getParameter(R.MAX_VERTEX_ATTRIBS)),L.push("webgl max vertex texture image units:"+R.getParameter(R.MAX_VERTEX_TEXTURE_IMAGE_UNITS)),L.push("webgl max vertex uniform vectors:"+R.getParameter(R.MAX_VERTEX_UNIFORM_VECTORS)),L.push("webgl max viewport dims:"+O(R.getParameter(R.MAX_VIEWPORT_DIMS))),L.push("webgl red bits:"+R.getParameter(R.RED_BITS)),L.push("webgl renderer:"+R.getParameter(R.RENDERER)),L.push("webgl shading language version:"+R.getParameter(R.SHADING_LANGUAGE_VERSION)),L.push("webgl stencil bits:"+R.getParameter(R.STENCIL_BITS)),L.push("webgl vendor:"+R.getParameter(R.VENDOR)),L.push("webgl version:"+R.getParameter(R.VERSION));try{var D=R.getExtension("WEBGL_debug_renderer_info");D&&(L.push("webgl unmasked vendor:"+R.getParameter(D.UNMASKED_VENDOR_WEBGL)),L.push("webgl unmasked renderer:"+R.getParameter(D.UNMASKED_RENDERER_WEBGL)))}catch(x){}return R.getShaderPrecisionFormat&&e(["FLOAT","INT"],function(x){e(["VERTEX","FRAGMENT"],function(P){e(["HIGH","MEDIUM","LOW"],function(I){e(["precision","rangeMin","rangeMax"],function(F){var G=R.getShaderPrecisionFormat(R[P+"_SHADER"],R[I+"_"+x])[F];"precision"!==F&&(F="precision "+F);var U=["webgl ",P.toLowerCase()," shader ",I.toLowerCase()," ",x.toLowerCase()," ",F,":",G].join("");L.push(U)})})})}),L}()):C(E.NOT_AVAILABLE)}},{key:"webglVendorAndRenderer",getData:function(C){g()?C(function(){try{var E=y(),R=E.getExtension("WEBGL_debug_renderer_info");return E.getParameter(R.UNMASKED_VENDOR_WEBGL)+"~"+E.getParameter(R.UNMASKED_RENDERER_WEBGL)}catch(O){return null}}()):C()}},{key:"adBlock",getData:function(C){C(function(){var E=document.createElement("div");E.innerHTML="&nbsp;";var R=!(E.className="adsbox");try{document.body.appendChild(E),R=0===document.getElementsByClassName("adsbox")[0].offsetHeight,document.body.removeChild(E)}catch(O){R=!1}return R}())}},{key:"hasLiedLanguages",getData:function(C){C(function(){if(void 0!==navigator.languages)try{if(navigator.languages[0].substr(0,2)!==navigator.language.substr(0,2))return!0}catch(E){return!0}return!1}())}},{key:"hasLiedResolution",getData:function(C){C(window.screen.width<window.screen.availWidth||window.screen.height<window.screen.availHeight)}},{key:"hasLiedOs",getData:function(C){var E,R,O,L;C((R=navigator.userAgent.toLowerCase(),O=navigator.oscpu,L=navigator.platform.toLowerCase(),E=0<=R.indexOf("windows phone")?"Windows Phone":0<=R.indexOf("win")?"Windows":0<=R.indexOf("android")?"Android":0<=R.indexOf("linux")||0<=R.indexOf("cros")?"Linux":0<=R.indexOf("iphone")||0<=R.indexOf("ipad")?"iOS":0<=R.indexOf("mac")?"Mac":"Other",("ontouchstart"in window||0<navigator.maxTouchPoints||0<navigator.msMaxTouchPoints)&&"Windows Phone"!==E&&"Android"!==E&&"iOS"!==E&&"Other"!==E||void 0!==O&&(0<=(O=O.toLowerCase()).indexOf("win")&&"Windows"!==E&&"Windows Phone"!==E||0<=O.indexOf("linux")&&"Linux"!==E&&"Android"!==E||0<=O.indexOf("mac")&&"Mac"!==E&&"iOS"!==E||(-1===O.indexOf("win")&&-1===O.indexOf("linux")&&-1===O.indexOf("mac"))!=("Other"===E))||0<=L.indexOf("win")&&"Windows"!==E&&"Windows Phone"!==E||(0<=L.indexOf("linux")||0<=L.indexOf("android")||0<=L.indexOf("pike"))&&"Linux"!==E&&"Android"!==E||(0<=L.indexOf("mac")||0<=L.indexOf("ipad")||0<=L.indexOf("ipod")||0<=L.indexOf("iphone"))&&"Mac"!==E&&"iOS"!==E||(L.indexOf("win")<0&&L.indexOf("linux")<0&&L.indexOf("mac")<0&&L.indexOf("iphone")<0&&L.indexOf("ipad")<0)!=("Other"===E)||void 0===navigator.plugins&&"Windows"!==E&&"Windows Phone"!==E))}},{key:"hasLiedBrowser",getData:function(C){C(function(){var E,R=navigator.userAgent.toLowerCase(),O=navigator.productSub;if(("Chrome"==(E=0<=R.indexOf("firefox")?"Firefox":0<=R.indexOf("opera")||0<=R.indexOf("opr")?"Opera":0<=R.indexOf("chrome")?"Chrome":0<=R.indexOf("safari")?"Safari":0<=R.indexOf("trident")?"Internet Explorer":"Other")||"Safari"===E||"Opera"===E)&&"20030107"!==O)return!0;var L,N=eval.toString().length;if(37===N&&"Safari"!==E&&"Firefox"!==E&&"Other"!==E||39===N&&"Internet Explorer"!==E&&"Other"!==E||33===N&&"Chrome"!==E&&"Opera"!==E&&"Other"!==E)return!0;try{throw"a"}catch(W){try{W.toSource(),L=!0}catch(j){L=!1}}return L&&"Firefox"!==E&&"Other"!==E}())}},{key:"touchSupport",getData:function(C){C(function(){var E,R=0;void 0!==navigator.maxTouchPoints?R=navigator.maxTouchPoints:void 0!==navigator.msMaxTouchPoints&&(R=navigator.msMaxTouchPoints);try{document.createEvent("TouchEvent"),E=!0}catch(O){E=!1}return[R,E,"ontouchstart"in window]}())}},{key:"fonts",getData:function(C,E){var R=["monospace","sans-serif","serif"],O=["Andale Mono","Arial","Arial Black","Arial Hebrew","Arial MT","Arial Narrow","Arial Rounded MT Bold","Arial Unicode MS","Bitstream Vera Sans Mono","Book Antiqua","Bookman Old Style","Calibri","Cambria","Cambria Math","Century","Century Gothic","Century Schoolbook","Comic Sans","Comic Sans MS","Consolas","Courier","Courier New","Geneva","Georgia","Helvetica","Helvetica Neue","Impact","Lucida Bright","Lucida Calligraphy","Lucida Console","Lucida Fax","LUCIDA GRANDE","Lucida Handwriting","Lucida Sans","Lucida Sans Typewriter","Lucida Sans Unicode","Microsoft Sans Serif","Monaco","Monotype Corsiva","MS Gothic","MS Outlook","MS PGothic","MS Reference Sans Serif","MS Sans Serif","MS Serif","MYRIAD","MYRIAD PRO","Palatino","Palatino Linotype","Segoe Print","Segoe Script","Segoe UI","Segoe UI Light","Segoe UI Semibold","Segoe UI Symbol","Tahoma","Times","Times New Roman","Times New Roman PS","Trebuchet MS","Verdana","Wingdings","Wingdings 2","Wingdings 3"];E.fonts.extendedJsFonts&&(O=O.concat(["Abadi MT Condensed Light","Academy Engraved LET","ADOBE CASLON PRO","Adobe Garamond","ADOBE GARAMOND PRO","Agency FB","Aharoni","Albertus Extra Bold","Albertus Medium","Algerian","Amazone BT","American Typewriter","American Typewriter Condensed","AmerType Md BT","Andalus","Angsana New","AngsanaUPC","Antique Olive","Aparajita","Apple Chancery","Apple Color Emoji","Apple SD Gothic Neo","Arabic Typesetting","ARCHER","ARNO PRO","Arrus BT","Aurora Cn BT","AvantGarde Bk BT","AvantGarde Md BT","AVENIR","Ayuthaya","Bandy","Bangla Sangam MN","Bank Gothic","BankGothic Md BT","Baskerville","Baskerville Old Face","Batang","BatangChe","Bauer Bodoni","Bauhaus 93","Bazooka","Bell MT","Bembo","Benguiat Bk BT","Berlin Sans FB","Berlin Sans FB Demi","Bernard MT Condensed","BernhardFashion BT","BernhardMod BT","Big Caslon","BinnerD","Blackadder ITC","BlairMdITC TT","Bodoni 72","Bodoni 72 Oldstyle","Bodoni 72 Smallcaps","Bodoni MT","Bodoni MT Black","Bodoni MT Condensed","Bodoni MT Poster Compressed","Bookshelf Symbol 7","Boulder","Bradley Hand","Bradley Hand ITC","Bremen Bd BT","Britannic Bold","Broadway","Browallia New","BrowalliaUPC","Brush Script MT","Californian FB","Calisto MT","Calligrapher","Candara","CaslonOpnface BT","Castellar","Centaur","Cezanne","CG Omega","CG Times","Chalkboard","Chalkboard SE","Chalkduster","Charlesworth","Charter Bd BT","Charter BT","Chaucer","ChelthmITC Bk BT","Chiller","Clarendon","Clarendon Condensed","CloisterBlack BT","Cochin","Colonna MT","Constantia","Cooper Black","Copperplate","Copperplate Gothic","Copperplate Gothic Bold","Copperplate Gothic Light","CopperplGoth Bd BT","Corbel","Cordia New","CordiaUPC","Cornerstone","Coronet","Cuckoo","Curlz MT","DaunPenh","Dauphin","David","DB LCD Temp","DELICIOUS","Denmark","DFKai-SB","Didot","DilleniaUPC","DIN","DokChampa","Dotum","DotumChe","Ebrima","Edwardian Script ITC","Elephant","English 111 Vivace BT","Engravers MT","EngraversGothic BT","Eras Bold ITC","Eras Demi ITC","Eras Light ITC","Eras Medium ITC","EucrosiaUPC","Euphemia","Euphemia UCAS","EUROSTILE","Exotc350 Bd BT","FangSong","Felix Titling","Fixedsys","FONTIN","Footlight MT Light","Forte","FrankRuehl","Fransiscan","Freefrm721 Blk BT","FreesiaUPC","Freestyle Script","French Script MT","FrnkGothITC Bk BT","Fruitger","FRUTIGER","Futura","Futura Bk BT","Futura Lt BT","Futura Md BT","Futura ZBlk BT","FuturaBlack BT","Gabriola","Galliard BT","Gautami","Geeza Pro","Geometr231 BT","Geometr231 Hv BT","Geometr231 Lt BT","GeoSlab 703 Lt BT","GeoSlab 703 XBd BT","Gigi","Gill Sans","Gill Sans MT","Gill Sans MT Condensed","Gill Sans MT Ext Condensed Bold","Gill Sans Ultra Bold","Gill Sans Ultra Bold Condensed","Gisha","Gloucester MT Extra Condensed","GOTHAM","GOTHAM BOLD","Goudy Old Style","Goudy Stout","GoudyHandtooled BT","GoudyOLSt BT","Gujarati Sangam MN","Gulim","GulimChe","Gungsuh","GungsuhChe","Gurmukhi MN","Haettenschweiler","Harlow Solid Italic","Harrington","Heather","Heiti SC","Heiti TC","HELV","Herald","High Tower Text","Hiragino Kaku Gothic ProN","Hiragino Mincho ProN","Hoefler Text","Humanst 521 Cn BT","Humanst521 BT","Humanst521 Lt BT","Imprint MT Shadow","Incised901 Bd BT","Incised901 BT","Incised901 Lt BT","INCONSOLATA","Informal Roman","Informal011 BT","INTERSTATE","IrisUPC","Iskoola Pota","JasmineUPC","Jazz LET","Jenson","Jester","Jokerman","Juice ITC","Kabel Bk BT","Kabel Ult BT","Kailasa","KaiTi","Kalinga","Kannada Sangam MN","Kartika","Kaufmann Bd BT","Kaufmann BT","Khmer UI","KodchiangUPC","Kokila","Korinna BT","Kristen ITC","Krungthep","Kunstler Script","Lao UI","Latha","Leelawadee","Letter Gothic","Levenim MT","LilyUPC","Lithograph","Lithograph Light","Long Island","Lydian BT","Magneto","Maiandra GD","Malayalam Sangam MN","Malgun Gothic","Mangal","Marigold","Marion","Marker Felt","Market","Marlett","Matisse ITC","Matura MT Script Capitals","Meiryo","Meiryo UI","Microsoft Himalaya","Microsoft JhengHei","Microsoft New Tai Lue","Microsoft PhagsPa","Microsoft Tai Le","Microsoft Uighur","Microsoft YaHei","Microsoft Yi Baiti","MingLiU","MingLiU_HKSCS","MingLiU_HKSCS-ExtB","MingLiU-ExtB","Minion","Minion Pro","Miriam","Miriam Fixed","Mistral","Modern","Modern No. 20","Mona Lisa Solid ITC TT","Mongolian Baiti","MONO","MoolBoran","Mrs Eaves","MS LineDraw","MS Mincho","MS PMincho","MS Reference Specialty","MS UI Gothic","MT Extra","MUSEO","MV Boli","Nadeem","Narkisim","NEVIS","News Gothic","News GothicMT","NewsGoth BT","Niagara Engraved","Niagara Solid","Noteworthy","NSimSun","Nyala","OCR A Extended","Old Century","Old English Text MT","Onyx","Onyx BT","OPTIMA","Oriya Sangam MN","OSAKA","OzHandicraft BT","Palace Script MT","Papyrus","Parchment","Party LET","Pegasus","Perpetua","Perpetua Titling MT","PetitaBold","Pickwick","Plantagenet Cherokee","Playbill","PMingLiU","PMingLiU-ExtB","Poor Richard","Poster","PosterBodoni BT","PRINCETOWN LET","Pristina","PTBarnum BT","Pythagoras","Raavi","Rage Italic","Ravie","Ribbon131 Bd BT","Rockwell","Rockwell Condensed","Rockwell Extra Bold","Rod","Roman","Sakkal Majalla","Santa Fe LET","Savoye LET","Sceptre","Script","Script MT Bold","SCRIPTINA","Serifa","Serifa BT","Serifa Th BT","ShelleyVolante BT","Sherwood","Shonar Bangla","Showcard Gothic","Shruti","Signboard","SILKSCREEN","SimHei","Simplified Arabic","Simplified Arabic Fixed","SimSun","SimSun-ExtB","Sinhala Sangam MN","Sketch Rockwell","Skia","Small Fonts","Snap ITC","Snell Roundhand","Socket","Souvenir Lt BT","Staccato222 BT","Steamer","Stencil","Storybook","Styllo","Subway","Swis721 BlkEx BT","Swiss911 XCm BT","Sylfaen","Synchro LET","System","Tamil Sangam MN","Technical","Teletype","Telugu Sangam MN","Tempus Sans ITC","Terminal","Thonburi","Traditional Arabic","Trajan","TRAJAN PRO","Tristan","Tubular","Tunga","Tw Cen MT","Tw Cen MT Condensed","Tw Cen MT Condensed Extra Bold","TypoUpright BT","Unicorn","Univers","Univers CE 55 Medium","Univers Condensed","Utsaah","Vagabond","Vani","Vijaya","Viner Hand ITC","VisualUI","Vivaldi","Vladimir Script","Vrinda","Westminster","WHITNEY","Wide Latin","ZapfEllipt BT","ZapfHumnst BT","ZapfHumnst Dm BT","Zapfino","Zurich BlkEx BT","Zurich Ex BT","ZWAdobeF"])),O=(O=O.concat(E.fonts.userDefinedFonts)).filter(function(H,Q){return O.indexOf(H)===Q});var L=document.getElementsByTagName("body")[0],N=document.createElement("div"),W=document.createElement("div"),j={},te={},b=function(){var H=document.createElement("span");return H.style.position="absolute",H.style.left="-9999px",H.style.fontSize="72px",H.style.fontStyle="normal",H.style.fontWeight="normal",H.style.letterSpacing="normal",H.style.lineBreak="auto",H.style.lineHeight="normal",H.style.textTransform="none",H.style.textAlign="left",H.style.textDecoration="none",H.style.textShadow="none",H.style.whiteSpace="normal",H.style.wordBreak="normal",H.style.wordSpacing="normal",H.innerHTML="mmmmmmmmmmlli",H},D=function(H){for(var Q=!1,$=0;$<R.length;$++)if(Q=H[$].offsetWidth!==j[R[$]]||H[$].offsetHeight!==te[R[$]])return Q;return Q},x=function(){for(var H=[],Q=0,$=R.length;Q<$;Q++){var ue=b();ue.style.fontFamily=R[Q],N.appendChild(ue),H.push(ue)}return H}();L.appendChild(N);for(var P=0,I=R.length;P<I;P++)j[R[P]]=x[P].offsetWidth,te[R[P]]=x[P].offsetHeight;var F=function(){for(var H,Q,$,ue={},ae=0,me=O.length;ae<me;ae++){for(var be=[],Xe=0,Se=R.length;Xe<Se;Xe++){var Ce=(H=O[ae],Q=R[Xe],$=void 0,($=b()).style.fontFamily="'"+H+"',"+Q,$);W.appendChild(Ce),be.push(Ce)}ue[O[ae]]=be}return ue}();L.appendChild(W);for(var G=[],U=0,K=O.length;U<K;U++)D(F[O[U]])&&G.push(O[U]);L.removeChild(W),L.removeChild(N),C(G)},pauseBefore:!0},{key:"fontsFlash",getData:function(C,E){return void 0!==window.swfobject?window.swfobject.hasFlashPlayerVersion("9.0.0")?E.fonts.swfPath?void function(R,O){var L="___fp_swf_loaded";window[L]=function(te){!function(R){C(R)}(te)};var N,W=O.fonts.swfContainerId;(N=document.createElement("div")).setAttribute("id",(void 0).fonts.swfContainerId),document.body.appendChild(N),window.swfobject.embedSWF(O.fonts.swfPath,W,"1","1","9.0.0",!1,{onReady:L},{allowScriptAccess:"always",menu:"false"},{})}(0,E):C("missing options.fonts.swfPath"):C("flash not installed"):C("swf object not loaded")},pauseBefore:!0},{key:"audio",getData:function(C,E){var R=E.audio;if(R.excludeIOS11&&navigator.userAgent.match(/OS 11.+Version\/11.+Safari/))return C(E.EXCLUDED);var O=window.OfflineAudioContext||window.webkitOfflineAudioContext;if(null==O)return C(E.NOT_AVAILABLE);var L=new O(1,44100,44100),N=L.createOscillator();N.type="triangle",N.frequency.setValueAtTime(1e4,L.currentTime);var W=L.createDynamicsCompressor();e([["threshold",-50],["knee",40],["ratio",12],["reduction",-20],["attack",0],["release",.25]],function(te){void 0!==W[te[0]]&&"function"==typeof W[te[0]].setValueAtTime&&W[te[0]].setValueAtTime(te[1],L.currentTime)}),N.connect(W),W.connect(L.destination),N.start(0),L.startRendering();var j=setTimeout(function(){return console.warn('Audio fingerprint timed out. Please report bug at https://github.com/Valve/fingerprintjs2 with your user agent: "'+navigator.userAgent+'".'),L.oncomplete=function(){},L=null,C("audioTimeout")},R.timeout);L.oncomplete=function(te){var b;try{clearTimeout(j),b=te.renderedBuffer.getChannelData(0).slice(4500,5e3).reduce(function(D,x){return D+Math.abs(x)},0).toString(),N.disconnect(),W.disconnect()}catch(D){return void C(D)}C(b)}}},{key:"enumerateDevices",getData:function(C,E){if(!navigator.mediaDevices||!navigator.mediaDevices.enumerateDevices)return C(E.NOT_AVAILABLE);navigator.mediaDevices.enumerateDevices().then(function(R){C(R.map(function(O){return"id="+O.deviceId+";gid="+O.groupId+";"+O.kind+";"+O.label}))}).catch(function(R){C(R)})}}],T=function(C){throw new Error("'new Fingerprint()' is deprecated, see https://github.com/Valve/fingerprintjs2#upgrade-guide-from-182-to-200")};return T.get=function(C,E){E?C||(C={}):(E=C,C={}),function(L,N){var W,j;if(null!=N)for(j in N)null==(W=N[j])||Object.prototype.hasOwnProperty.call(L,j)||(L[j]=W)}(C,n),C.components=C.extraComponents.concat(A);var R={data:[],addPreprocessedComponent:function(L,N){"function"==typeof C.preprocessor&&(N=C.preprocessor(L,N)),R.data.push({key:L,value:N})}},O=-1;!function L(N){if((O+=1)>=C.components.length)E(R.data);else{var W=C.components[O];if(C.excludes[W.key])L(!1);else{if(!N&&W.pauseBefore)return O-=1,void setTimeout(function(){L(!0)},1);try{W.getData(function(j){R.addPreprocessedComponent(W.key,j),L(!1)},C)}catch(j){R.addPreprocessedComponent(W.key,String(j)),L(!1)}}}}(!1)},T.getPromise=function(C){return new Promise(function(E,R){T.get(C,E)})},T.getV18=function(C,E){return null==E&&(E=C,C={}),T.get(C,function(R){for(var O=[],L=0;L<R.length;L++){var N=R[L];if(N.value===(C.NOT_AVAILABLE||"not available"))O.push({key:N.key,value:"unknown"});else if("plugins"===N.key)O.push({key:"plugins",value:o(N.value,function(j){var te=o(j[2],function(b){return b.join?b.join("~"):b}).join(",");return[j[0],j[1],te].join("::")})});else if(-1!==["canvas","webgl"].indexOf(N.key))O.push({key:N.key,value:N.value.join("~")});else if(-1!==["sessionStorage","localStorage","indexedDb","addBehavior","openDatabase"].indexOf(N.key)){if(!N.value)continue;O.push({key:N.key,value:1})}else O.push(N.value?N.value.join?{key:N.key,value:N.value.join(";")}:N:{key:N.key,value:N.value})}var W=s(o(O,function(j){return j.value}).join("~~~"),31);E(W,O)})},T.x64hash128=s,T.VERSION="2.1.0",T},p.exports?p.exports=t():l.exports?l.exports=t():l.Fingerprint2=t()}),gt=Pt(function(p,d){!function(l,t){var i="model",u="name",c="type",s="vendor",n="version",e="mobile",o="tablet",r="smarttv",h={extend:function(E,R){var O={};for(var L in E)O[L]=R[L]&&R[L].length%2==0?R[L].concat(E[L]):E[L];return O},has:function(E,R){return"string"===De(E)&&-1!==R.toLowerCase().indexOf(E.toLowerCase())},lowerize:function(E){return E.toLowerCase()},major:function(E){return"string"===De(E)?E.replace(/[^\d\.]/g,"").split(".")[0]:void 0},trim:function(E,R){return E=E.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""),"undefined"===De(R)?E:E.substring(0,255)}},f={rgx:function(E,R){for(var O,L,N,W,j,te,b=0;b<R.length&&!j;){var D=R[b],x=R[b+1];for(O=L=0;O<D.length&&!j;)if(j=D[O++].exec(E))for(N=0;N<x.length;N++)te=j[++L],"object"===De(W=x[N])&&W.length>0?2==W.length?this[W[0]]="function"==De(W[1])?W[1].call(this,te):W[1]:3==W.length?this[W[0]]="function"!==De(W[1])||W[1].exec&&W[1].test?te?te.replace(W[1],W[2]):void 0:te?W[1].call(this,te,W[2]):void 0:4==W.length&&(this[W[0]]=te?W[3].call(this,te.replace(W[1],W[2])):void 0):this[W]=te||void 0;b+=2}},str:function(E,R){for(var O in R)if("object"===De(R[O])&&R[O].length>0){for(var L=0;L<R[O].length;L++)if(h.has(R[O][L],E))return"?"===O?void 0:O}else if(h.has(R[O],E))return"?"===O?void 0:O;return E}},g={browser:{oldSafari:{version:{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}},oldEdge:{version:{.1:"12.",21:"13.",31:"14.",39:"15.",41:"16.",42:"17.",44:"18."}}},os:{windows:{version:{ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"}}}},y={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[n,[u,"Chrome"]],[/(?:edge|edgios|edga|edg)\/([\w\.]+)/i],[n,[u,"Edge"]],[/(opera\smini)\/([\w\.-]+)/i,/(opera\s[mobiletab]{3,6})\b.+version\/([\w\.-]+)/i,/(opera)(?:.+version\/|[\/\s]+)([\w\.]+)/i],[u,n],[/opios[\/\s]+([\w\.]+)/i],[n,[u,"Opera Mini"]],[/\sopr\/([\w\.]+)/i],[n,[u,"Opera"]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/\s]?([\w\.]*)/i,/(avant\s|iemobile|slim)(?:browser)?[\/\s]?([\w\.]*)/i,/(ba?idubrowser)[\/\s]?([\w\.]+)/i,/(?:ms|\()(ie)\s([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon)\/([\w\.-]+)/i,/(rekonq|puffin|brave|whale|qqbrowserlite|qq)\/([\w\.]+)/i,/(weibo)__([\d\.]+)/i],[u,n],[/(?:[\s\/]uc?\s?browser|(?:juc.+)ucweb)[\/\s]?([\w\.]+)/i],[n,[u,"UCBrowser"]],[/(?:windowswechat)?\sqbcore\/([\w\.]+)\b.*(?:windowswechat)?/i],[n,[u,"WeChat(Win) Desktop"]],[/micromessenger\/([\w\.]+)/i],[n,[u,"WeChat"]],[/konqueror\/([\w\.]+)/i],[n,[u,"Konqueror"]],[/trident.+rv[:\s]([\w\.]{1,9})\b.+like\sgecko/i],[n,[u,"IE"]],[/yabrowser\/([\w\.]+)/i],[n,[u,"Yandex"]],[/(avast|avg)\/([\w\.]+)/i],[[u,/(.+)/,"$1 Secure Browser"],n],[/focus\/([\w\.]+)/i],[n,[u,"Firefox Focus"]],[/opt\/([\w\.]+)/i],[n,[u,"Opera Touch"]],[/coc_coc_browser\/([\w\.]+)/i],[n,[u,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[n,[u,"Dolphin"]],[/coast\/([\w\.]+)/i],[n,[u,"Opera Coast"]],[/xiaomi\/miuibrowser\/([\w\.]+)/i],[n,[u,"MIUI Browser"]],[/fxios\/([\w\.-]+)/i],[n,[u,"Firefox"]],[/(qihu|qhbrowser|qihoobrowser|360browser)/i],[[u,"360 Browser"]],[/(oculus|samsung|sailfish)browser\/([\w\.]+)/i],[[u,/(.+)/,"$1 Browser"],n],[/(comodo_dragon)\/([\w\.]+)/i],[[u,/_/g," "],n],[/\s(electron)\/([\w\.]+)\ssafari/i,/(tesla)(?:\sqtcarbrowser|\/(20[12]\d\.[\w\.-]+))/i,/m?(qqbrowser|baiduboxapp|2345Explorer)[\/\s]?([\w\.]+)/i],[u,n],[/(MetaSr)[\/\s]?([\w\.]+)/i,/(LBBROWSER)/i],[u],[/;fbav\/([\w\.]+);/i],[n,[u,"Facebook"]],[/FBAN\/FBIOS|FB_IAB\/FB4A/i],[[u,"Facebook"]],[/safari\s(line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(chromium|instagram)[\/\s]([\w\.-]+)/i],[u,n],[/\bgsa\/([\w\.]+)\s.*safari\//i],[n,[u,"GSA"]],[/headlesschrome(?:\/([\w\.]+)|\s)/i],[n,[u,"Chrome Headless"]],[/\swv\).+(chrome)\/([\w\.]+)/i],[[u,"Chrome WebView"],n],[/droid.+\sversion\/([\w\.]+)\b.+(?:mobile\ssafari|safari)/i],[n,[u,"Android Browser"]],[/(chrome|omniweb|arora|[tizenoka]{5}\s?browser)\/v?([\w\.]+)/i],[u,n],[/version\/([\w\.]+)\s.*mobile\/\w+\s(safari)/i],[n,[u,"Mobile Safari"]],[/version\/([\w\.]+)\s.*(mobile\s?safari|safari)/i],[n,u],[/webkit.+?(mobile\s?safari|safari)(\/[\w\.]+)/i],[u,[n,f.str,g.browser.oldSafari.version]],[/(webkit|khtml)\/([\w\.]+)/i],[u,n],[/(navigator|netscape)\/([\w\.-]+)/i],[[u,"Netscape"],n],[/ile\svr;\srv:([\w\.]+)\).+firefox/i],[n,[u,"Firefox Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo\sbrowser|minimo|conkeror)[\/\s]?([\w\.\+]+)/i,/(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([\w\.-]+)$/i,/(firefox)\/([\w\.]+)\s[\w\s\-]+\/[\w\.]+$/i,/(mozilla)\/([\w\.]+)\s.+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir)[\/\s]?([\w\.]+)/i,/(links)\s\(([\w\.]+)/i,/(gobrowser)\/?([\w\.]*)/i,/(ice\s?browser)\/v?([\w\._]+)/i,/(mosaic)[\/\s]([\w\.]+)/i],[u,n]],cpu:[[/(?:(amd|x(?:(?:86|64)[_-])?|wow|win)64)[;\)]/i],[["architecture","amd64"]],[/(ia32(?=;))/i],[["architecture",h.lowerize]],[/((?:i[346]|x)86)[;\)]/i],[["architecture","ia32"]],[/\b(aarch64|armv?8e?l?)\b/i],[["architecture","arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[["architecture","armhf"]],[/windows\s(ce|mobile);\sppc;/i],[["architecture","arm"]],[/((?:ppc|powerpc)(?:64)?)(?:\smac|;|\))/i],[["architecture",/ower/,"",h.lowerize]],[/(sun4\w)[;\)]/i],[["architecture","sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?:64|(?=v(?:[1-7]|[5-7]1)l?|;|eabi))|(?=atmel\s)avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[["architecture",h.lowerize]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[pt]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus\s10)/i],[i,[s,"Samsung"],[c,o]],[/\b((?:s[cgp]h|gt|sm)-\w+|galaxy\snexus)/i,/\ssamsung[\s-]([\w-]+)/i,/sec-(sgh\w+)/i],[i,[s,"Samsung"],[c,e]],[/\((ip(?:hone|od)[\s\w]*);/i],[i,[s,"Apple"],[c,e]],[/\((ipad);[\w\s\),;-]+apple/i,/applecoremedia\/[\w\.]+\s\((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[i,[s,"Apple"],[c,o]],[/\b((?:agr|ags[23]|bah2?|sht?)-a?[lw]\d{2})/i],[i,[s,"Huawei"],[c,o]],[/d\/huawei([\w\s-]+)[;\)]/i,/\b(nexus\s6p|vog-[at]?l\d\d|ane-[at]?l[x\d]\d|eml-a?l\d\da?|lya-[at]?l\d[\dc]|clt-a?l\d\di?|ele-l\d\d)/i,/\b(\w{2,4}-[atu][ln][01259][019])[;\)\s]/i],[i,[s,"Huawei"],[c,e]],[/\b(poco[\s\w]+)(?:\sbuild|\))/i,/\b;\s(\w+)\sbuild\/hm\1/i,/\b(hm[\s\-_]?note?[\s_]?(?:\d\w)?)\sbuild/i,/\b(redmi[\s\-_]?(?:note|k)?[\w\s_]+)(?:\sbuild|\))/i,/\b(mi[\s\-_]?(?:a\d|one|one[\s_]plus|note lte)?[\s_]?(?:\d?\w?)[\s_]?(?:plus)?)\sbuild/i],[[i,/_/g," "],[s,"Xiaomi"],[c,e]],[/\b(mi[\s\-_]?(?:pad)(?:[\w\s_]+))(?:\sbuild|\))/i],[[i,/_/g," "],[s,"Xiaomi"],[c,o]],[/;\s(\w+)\sbuild.+\soppo/i,/\s(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007)\b/i],[i,[s,"OPPO"],[c,e]],[/\svivo\s(\w+)(?:\sbuild|\))/i,/\s(v[12]\d{3}\w?[at])(?:\sbuild|;)/i],[i,[s,"Vivo"],[c,e]],[/\s(rmx[12]\d{3})(?:\sbuild|;)/i],[i,[s,"Realme"],[c,e]],[/\s(milestone|droid(?:[2-4x]|\s(?:bionic|x2|pro|razr))?:?(\s4g)?)\b[\w\s]+build\//i,/\smot(?:orola)?[\s-](\w*)/i,/((?:moto[\s\w\(\)]+|xt\d{3,4}|nexus\s6)(?=\sbuild|\)))/i],[i,[s,"Motorola"],[c,e]],[/\s(mz60\d|xoom[\s2]{0,2})\sbuild\//i],[i,[s,"Motorola"],[c,o]],[/((?=lg)?[vl]k\-?\d{3})\sbuild|\s3\.[\s\w;-]{10}lg?-([06cv9]{3,4})/i],[i,[s,"LG"],[c,o]],[/(lm-?f100[nv]?|nexus\s[45])/i,/lg[e;\s\/-]+((?!browser|netcast)\w+)/i,/\blg(\-?[\d\w]+)\sbuild/i],[i,[s,"LG"],[c,e]],[/(ideatab[\w\-\s]+)/i,/lenovo\s?(s(?:5000|6000)(?:[\w-]+)|tab(?:[\s\w]+)|yt[\d\w-]{6}|tb[\d\w-]{6})/i],[i,[s,"Lenovo"],[c,o]],[/(?:maemo|nokia).*(n900|lumia\s\d+)/i,/nokia[\s_-]?([\w\.-]*)/i],[[i,/_/g," "],[s,"Nokia"],[c,e]],[/droid.+;\s(pixel\sc)[\s)]/i],[i,[s,"Google"],[c,o]],[/droid.+;\s(pixel[\s\daxl]{0,6})(?:\sbuild|\))/i],[i,[s,"Google"],[c,e]],[/droid.+\s([c-g]\d{4}|so[-l]\w+|xq-a\w[4-7][12])(?=\sbuild\/|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[i,[s,"Sony"],[c,e]],[/sony\stablet\s[ps]\sbuild\//i,/(?:sony)?sgp\w+(?:\sbuild\/|\))/i],[[i,"Xperia Tablet"],[s,"Sony"],[c,o]],[/\s(kb2005|in20[12]5|be20[12][59])\b/i,/\ba000(1)\sbuild/i,/\boneplus\s(a\d{4})[\s)]/i],[i,[s,"OnePlus"],[c,e]],[/(alexa)webm/i,/(kf[a-z]{2}wi)(\sbuild\/|\))/i,/(kf[a-z]+)(\sbuild\/|\)).+silk\//i],[i,[s,"Amazon"],[c,o]],[/(sd|kf)[0349hijorstuw]+(\sbuild\/|\)).+silk\//i],[[i,"Fire Phone"],[s,"Amazon"],[c,e]],[/\((playbook);[\w\s\),;-]+(rim)/i],[i,s,[c,o]],[/((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10;\s(\w+)/i],[i,[s,"BlackBerry"],[c,e]],[/(?:\b|asus_)(transfo[prime\s]{4,10}\s\w+|eeepc|slider\s\w+|nexus\s7|padfone|p00[cj])/i],[i,[s,"ASUS"],[c,o]],[/\s(z[es]6[027][01][km][ls]|zenfone\s\d\w?)\b/i],[i,[s,"ASUS"],[c,e]],[/(nexus\s9)/i],[i,[s,"HTC"],[c,o]],[/(htc)[;_\s-]{1,2}([\w\s]+(?=\)|\sbuild)|\w+)/i,/(zte)-(\w*)/i,/(alcatel|geeksphone|nexian|panasonic|(?=;\s)sony)[_\s-]?([\w-]*)/i],[s,[i,/_/g," "],[c,e]],[/droid[x\d\.\s;]+\s([ab][1-7]\-?[0178a]\d\d?)/i],[i,[s,"Acer"],[c,o]],[/droid.+;\s(m[1-5]\snote)\sbuild/i,/\bmz-([\w-]{2,})/i],[i,[s,"Meizu"],[c,e]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[\s_-]?([\w-]*)/i,/(hp)\s([\w\s]+\w)/i,/(asus)-?(\w+)/i,/(microsoft);\s(lumia[\s\w]+)/i,/(lenovo)[_\s-]?([\w-]+)/i,/linux;.+(jolla);/i,/droid.+;\s(oppo)\s?([\w\s]+)\sbuild/i],[s,i,[c,e]],[/(archos)\s(gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/\s(nook)[\w\s]+build\/(\w+)/i,/(dell)\s(strea[kpr\s\d]*[\dko])/i,/[;\/]\s?(le[\s\-]+pan)[\s\-]+(\w{1,9})\sbuild/i,/[;\/]\s?(trinity)[\-\s]*(t\d{3})\sbuild/i,/\b(gigaset)[\s\-]+(q\w{1,9})\sbuild/i,/\b(vodafone)\s([\w\s]+)(?:\)|\sbuild)/i],[s,i,[c,o]],[/\s(surface\sduo)\s/i],[i,[s,"Microsoft"],[c,o]],[/droid\s[\d\.]+;\s(fp\du?)\sbuild/i],[i,[s,"Fairphone"],[c,e]],[/\s(u304aa)\sbuild/i],[i,[s,"AT&T"],[c,e]],[/sie-(\w*)/i],[i,[s,"Siemens"],[c,e]],[/[;\/]\s?(rct\w+)\sbuild/i],[i,[s,"RCA"],[c,o]],[/[;\/\s](venue[\d\s]{2,7})\sbuild/i],[i,[s,"Dell"],[c,o]],[/[;\/]\s?(q(?:mv|ta)\w+)\sbuild/i],[i,[s,"Verizon"],[c,o]],[/[;\/]\s(?:barnes[&\s]+noble\s|bn[rt])([\w\s\+]*)\sbuild/i],[i,[s,"Barnes & Noble"],[c,o]],[/[;\/]\s(tm\d{3}\w+)\sbuild/i],[i,[s,"NuVision"],[c,o]],[/;\s(k88)\sbuild/i],[i,[s,"ZTE"],[c,o]],[/;\s(nx\d{3}j)\sbuild/i],[i,[s,"ZTE"],[c,e]],[/[;\/]\s?(gen\d{3})\sbuild.*49h/i],[i,[s,"Swiss"],[c,e]],[/[;\/]\s?(zur\d{3})\sbuild/i],[i,[s,"Swiss"],[c,o]],[/[;\/]\s?((zeki)?tb.*\b)\sbuild/i],[i,[s,"Zeki"],[c,o]],[/[;\/]\s([yr]\d{2})\sbuild/i,/[;\/]\s(dragon[\-\s]+touch\s|dt)(\w{5})\sbuild/i],[[s,"Dragon Touch"],i,[c,o]],[/[;\/]\s?(ns-?\w{0,9})\sbuild/i],[i,[s,"Insignia"],[c,o]],[/[;\/]\s?((nxa|Next)-?\w{0,9})\sbuild/i],[i,[s,"NextBook"],[c,o]],[/[;\/]\s?(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05]))\sbuild/i],[[s,"Voice"],i,[c,e]],[/[;\/]\s?(lvtel\-)?(v1[12])\sbuild/i],[[s,"LvTel"],i,[c,e]],[/;\s(ph-1)\s/i],[i,[s,"Essential"],[c,e]],[/[;\/]\s?(v(100md|700na|7011|917g).*\b)\sbuild/i],[i,[s,"Envizen"],[c,o]],[/[;\/]\s?(trio[\s\w\-\.]+)\sbuild/i],[i,[s,"MachSpeed"],[c,o]],[/[;\/]\s?tu_(1491)\sbuild/i],[i,[s,"Rotor"],[c,o]],[/(shield[\w\s]+)\sbuild/i],[i,[s,"Nvidia"],[c,o]],[/(sprint)\s(\w+)/i],[s,i,[c,e]],[/(kin\.[onetw]{3})/i],[[i,/\./g," "],[s,"Microsoft"],[c,e]],[/droid\s[\d\.]+;\s(cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[i,[s,"Zebra"],[c,o]],[/droid\s[\d\.]+;\s(ec30|ps20|tc[2-8]\d[kx])\)/i],[i,[s,"Zebra"],[c,e]],[/\s(ouya)\s/i,/(nintendo)\s([wids3utch]+)/i],[s,i,[c,"console"]],[/droid.+;\s(shield)\sbuild/i],[i,[s,"Nvidia"],[c,"console"]],[/(playstation\s[345portablevi]+)/i],[i,[s,"Sony"],[c,"console"]],[/[\s\(;](xbox(?:\sone)?(?!;\sxbox))[\s\);]/i],[i,[s,"Microsoft"],[c,"console"]],[/smart-tv.+(samsung)/i],[s,[c,r]],[/hbbtv.+maple;(\d+)/i],[[i,/^/,"SmartTV"],[s,"Samsung"],[c,r]],[/(?:linux;\snetcast.+smarttv|lg\snetcast\.tv-201\d)/i],[[s,"LG"],[c,r]],[/(apple)\s?tv/i],[s,[i,"Apple TV"],[c,r]],[/crkey/i],[[i,"Chromecast"],[s,"Google"],[c,r]],[/droid.+aft([\w])(\sbuild\/|\))/i],[i,[s,"Amazon"],[c,r]],[/\(dtv[\);].+(aquos)/i],[i,[s,"Sharp"],[c,r]],[/hbbtv\/\d+\.\d+\.\d+\s+\([\w\s]*;\s*(\w[^;]*);([^;]*)/i],[[s,h.trim],[i,h.trim],[c,r]],[/[\s\/\(](android\s|smart[-\s]?|opera\s)tv[;\)\s]/i],[[c,r]],[/((pebble))app\/[\d\.]+\s/i],[s,i,[c,"wearable"]],[/droid.+;\s(glass)\s\d/i],[i,[s,"Google"],[c,"wearable"]],[/droid\s[\d\.]+;\s(wt63?0{2,3})\)/i],[i,[s,"Zebra"],[c,"wearable"]],[/(tesla)(?:\sqtcarbrowser|\/20[12]\d\.[\w\.-]+)/i],[s,[c,"embedded"]],[/droid .+?; ([^;]+?)(?: build|\) applewebkit).+? mobile safari/i],[i,[c,e]],[/droid .+?;\s([^;]+?)(?: build|\) applewebkit).+?(?! mobile) safari/i],[i,[c,o]],[/\s(tablet|tab)[;\/]/i,/\s(mobile)(?:[;\/]|\ssafari)/i],[[c,h.lowerize]],[/(android[\w\.\s\-]{0,9});.+build/i],[i,[s,"Generic"]],[/(phone)/i],[[c,e]]],engine:[[/windows.+\sedge\/([\w\.]+)/i],[n,[u,"EdgeHTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[n,[u,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/\s]\(?([\w\.]+)/i,/(icab)[\/\s]([23]\.[\d\.]+)/i],[u,n],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[n,u]],os:[[/microsoft\s(windows)\s(vista|xp)/i],[u,n],[/(windows)\snt\s6\.2;\s(arm)/i,/(windows\sphone(?:\sos)*)[\s\/]?([\d\.\s\w]*)/i,/(windows\smobile|windows)[\s\/]?([ntce\d\.\s]+\w)(?!.+xbox)/i],[u,[n,f.str,g.os.windows.version]],[/(win(?=3|9|n)|win\s9x\s)([nt\d\.]+)/i],[[u,"Windows"],[n,f.str,g.os.windows.version]],[/ip[honead]{2,4}\b(?:.*os\s([\w]+)\slike\smac|;\sopera)/i,/cfnetwork\/.+darwin/i],[[n,/_/g,"."],[u,"iOS"]],[/(mac\sos\sx)\s?([\w\s\.]*)/i,/(macintosh|mac(?=_powerpc)\s)(?!.+haiku)/i],[[u,"Mac OS"],[n,/_/g,"."]],[/(android|webos|palm\sos|qnx|bada|rim\stablet\sos|meego|sailfish|contiki)[\/\s-]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/\s]([\w\.]+)/i,/\((series40);/i],[u,n],[/\(bb(10);/i],[n,[u,"BlackBerry"]],[/(?:symbian\s?os|symbos|s60(?=;)|series60)[\/\s-]?([\w\.]*)/i],[n,[u,"Symbian"]],[/mozilla.+\(mobile;.+gecko.+firefox/i],[[u,"Firefox OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[n,[u,"webOS"]],[/crkey\/([\d\.]+)/i],[n,[u,"Chromecast"]],[/(cros)\s[\w]+\s([\w\.]+\w)/i],[[u,"Chromium OS"],n],[/(nintendo|playstation)\s([wids345portablevuch]+)/i,/(xbox);\s+xbox\s([^\);]+)/i,/(mint)[\/\s\(\)]?(\w*)/i,/(mageia|vectorlinux)[;\s]/i,/(joli|[kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?=\slinux)|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk|linpus|raspbian)(?:\sgnu\/linux)?(?:\slinux)?[\/\s-]?(?!chrom|package)([\w\.-]*)/i,/(hurd|linux)\s?([\w\.]*)/i,/(gnu)\s?([\w\.]*)/i,/\s([frentopc-]{0,4}bsd|dragonfly)\s?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku)\s(\w+)/i],[u,n],[/(sunos)\s?([\w\.\d]*)/i],[[u,"Solaris"],n],[/((?:open)?solaris)[\/\s-]?([\w\.]*)/i,/(aix)\s((\d)(?=\.|\)|\s)[\w\.])*/i,/(plan\s9|minix|beos|os\/2|amigaos|morphos|risc\sos|openvms|fuchsia)/i,/(unix)\s?([\w\.]*)/i],[u,n]]},A=function E(R,O){if("object"===De(R)&&(O=R,R=void 0),!(this instanceof E))return new E(R,O).getResult();var L=R||(void 0!==l&&l.navigator&&l.navigator.userAgent?l.navigator.userAgent:""),N=O?h.extend(y,O):y;return this.getBrowser=function(){var W={name:void 0,version:void 0};return f.rgx.call(W,L,N.browser),W.major=h.major(W.version),W},this.getCPU=function(){var W={architecture:void 0};return f.rgx.call(W,L,N.cpu),W},this.getDevice=function(){var W={vendor:void 0,model:void 0,type:void 0};return f.rgx.call(W,L,N.device),W},this.getEngine=function(){var W={name:void 0,version:void 0};return f.rgx.call(W,L,N.engine),W},this.getOS=function(){var W={name:void 0,version:void 0};return f.rgx.call(W,L,N.os),W},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return L},this.setUA=function(W){return L="string"===De(W)&&W.length>255?h.trim(W,255):W,this},this.setUA(L),this};A.VERSION="0.7.28",A.BROWSER={NAME:u,MAJOR:"major",VERSION:n},A.CPU={ARCHITECTURE:"architecture"},A.DEVICE={MODEL:i,VENDOR:s,TYPE:c,CONSOLE:"console",MOBILE:e,SMARTTV:r,TABLET:o,WEARABLE:"wearable",EMBEDDED:"embedded"},A.ENGINE={NAME:u,VERSION:n},A.OS={NAME:u,VERSION:n},p.exports&&(d=p.exports=A),d.UAParser=A;var T=void 0!==l&&(l.jQuery||l.Zepto);if(T&&!T.ua){var C=new A;T.ua=C.getResult(),T.ua.get=function(){return C.getUA()},T.ua.set=function(E){C.setUA(E);var R=C.getResult();for(var O in R)T.ua[O]=R[O]}}}("object"===("undefined"==typeof window?"undefined":De(window))?window:Ne)}),Dn=gt.UAParser,Jt=Object.freeze({__proto__:null,default:gt,__moduleExports:gt,UAParser:Dn}),Lt=void 0,Ht=void 0;function Tn(p){var l=void 0,t=function(){l=void 0},c=function(y){var A=arguments.length>1&&void 0!==arguments[1]&&arguments[1];y=y||[];for(var T={},C=0;C<y.length;C++){var E=y[C],R=E.key;A&&(R=s(R)),T[R]=E.value}return T},s=function(y){return y.replace(/[\w]([A-Z])/g,function(A){return A[0]+"_"+A[1]}).toLowerCase()},o=function(y){return null==y};function h(y,A,T,C){l={enabled:y||!1,lat:A,lng:T,error:C}}var f=function(y,A){if(!(o(Ht)||o(Lt)||o(l))){var T={metadata:{timestamp:Date.now()},content:{device_details:g(Lt,A),location:l},fp2:Ht};t(),y(T)}},g=function(y,A){var R,T={device_id:y.id},C=y.details,E=(new A.UAParser).setUA(navigator.userAgent).getResult();return T.os_type=E.os.name,T.os_version=E.os.version,T.device_model=E.browser.name+" "+E.browser.version,T.device_platform=C.navigator_platform,T.tampered=(R=C)&&(R.has_lied_browser||R.has_lied_language||R.has_lied_os||R.has_lied_resolution),T.timezone_offset=C.timezone_offset,T};return(p=p||{}).location=function(y,A){var T={};for(var C in A=A||{},y=y||{})T[C]=y[C];for(var C in A)T[C]=A[C];return T}({allow:!1,timeout:4e3,maximumAge:18e4},p.location),t(),{get:function(y){(function(y,A,T){if(Lt)f(y,T);else{var C={excludes:{userAgent:!0,screenResolution:!0,fonts:!0,fontsFlash:!0,plugins:!0,colorDepth:!0,webdriver:!0,audio:!0,deviceMemory:!0,enumerateDevices:!0,timezone:!0,webglVendorAndRenderer:!0}};p.largeData||(C.excludes.canvas=!0,C.excludes.webgl=!0),A.getV18(C,function(E,R){var O=c(R);Lt={id:E,details:O},f(y,T)})}})(y,Kt,Jt),function(y,A,T){if(Ht)f(y,T);else{var C={excludes:{}};p.largeData||(C.excludes.canvas=!0,C.excludes.webgl=!0),p.deviceFingerprint||(C.excludes.screenResolution=!0,C.excludes.fonts=!0,C.excludes.fontsFlash=!0,C.excludes.plugins=!0,C.excludes.colorDepth=!0,C.excludes.webdriver=!0,C.excludes.audio=!0,C.excludes.deviceMemory=!0,C.excludes.enumerateDevices=!0,C.excludes.timezone=!0,C.excludes.webglVendorAndRenderer=!0),A.get(C,function(E){Ht=c(E,!0),f(y,T)})}}(y,Kt,Jt),function(y,A){l=void 0;var T=p.location;if(!T.allow||o(navigator.geolocation)||"function"!=typeof navigator.geolocation.getCurrentPosition)return h(!1),void f(y,A);var C=setTimeout(function(){E({code:3})},T.timeout),E=function(R){clearTimeout(C),h(!0,void 0,void 0,function(y){return 1===y?"permission_denied":2===y?"position_unavailable":3===y?"timeout":"unknown"}(R.code)),f(y,A)};navigator.geolocation.getCurrentPosition(function(R){clearTimeout(C),h(!0,R.coords.latitude,R.coords.longitude),f(y,A)},E,T)}(y,Jt)}}}function kt(p,d){var l=(65535&p)+(65535&d);return(p>>16)+(d>>16)+(l>>16)<<16|65535&l}function ft(p,d,l,t,i,u){return kt((c=kt(kt(d,p),kt(t,u)))<<(s=i)|c>>>32-s,l);var c,s}function fe(p,d,l,t,i,u,c){return ft(d&l|~d&t,p,d,i,u,c)}function tt(p,d,l,t,i,u,c){return ft(d&t|l&~t,p,d,i,u,c)}function ve(p,d,l,t,i,u,c){return ft(d^l^t,p,d,i,u,c)}function lt(p,d,l,t,i,u,c){return ft(l^(d|~t),p,d,i,u,c)}function se(p,d){var l,t,i,u,c;p[d>>5]|=128<<d%32,p[14+(d+64>>>9<<4)]=d;var s=1732584193,n=-271733879,e=-1732584194,o=271733878;for(l=0;l<p.length;l+=16)t=s,i=n,u=e,c=o,s=fe(s,n,e,o,p[l],7,-680876936),o=fe(o,s,n,e,p[l+1],12,-389564586),e=fe(e,o,s,n,p[l+2],17,606105819),n=fe(n,e,o,s,p[l+3],22,-1044525330),s=fe(s,n,e,o,p[l+4],7,-176418897),o=fe(o,s,n,e,p[l+5],12,1200080426),e=fe(e,o,s,n,p[l+6],17,-1473231341),n=fe(n,e,o,s,p[l+7],22,-45705983),s=fe(s,n,e,o,p[l+8],7,1770035416),o=fe(o,s,n,e,p[l+9],12,-1958414417),e=fe(e,o,s,n,p[l+10],17,-42063),n=fe(n,e,o,s,p[l+11],22,-1990404162),s=fe(s,n,e,o,p[l+12],7,1804603682),o=fe(o,s,n,e,p[l+13],12,-40341101),e=fe(e,o,s,n,p[l+14],17,-1502002290),s=tt(s,n=fe(n,e,o,s,p[l+15],22,1236535329),e,o,p[l+1],5,-165796510),o=tt(o,s,n,e,p[l+6],9,-1069501632),e=tt(e,o,s,n,p[l+11],14,643717713),n=tt(n,e,o,s,p[l],20,-373897302),s=tt(s,n,e,o,p[l+5],5,-701558691),o=tt(o,s,n,e,p[l+10],9,38016083),e=tt(e,o,s,n,p[l+15],14,-660478335),n=tt(n,e,o,s,p[l+4],20,-405537848),s=tt(s,n,e,o,p[l+9],5,568446438),o=tt(o,s,n,e,p[l+14],9,-1019803690),e=tt(e,o,s,n,p[l+3],14,-187363961),n=tt(n,e,o,s,p[l+8],20,1163531501),s=tt(s,n,e,o,p[l+13],5,-1444681467),o=tt(o,s,n,e,p[l+2],9,-51403784),e=tt(e,o,s,n,p[l+7],14,1735328473),s=ve(s,n=tt(n,e,o,s,p[l+12],20,-1926607734),e,o,p[l+5],4,-378558),o=ve(o,s,n,e,p[l+8],11,-2022574463),e=ve(e,o,s,n,p[l+11],16,1839030562),n=ve(n,e,o,s,p[l+14],23,-35309556),s=ve(s,n,e,o,p[l+1],4,-1530992060),o=ve(o,s,n,e,p[l+4],11,1272893353),e=ve(e,o,s,n,p[l+7],16,-155497632),n=ve(n,e,o,s,p[l+10],23,-1094730640),s=ve(s,n,e,o,p[l+13],4,681279174),o=ve(o,s,n,e,p[l],11,-358537222),e=ve(e,o,s,n,p[l+3],16,-722521979),n=ve(n,e,o,s,p[l+6],23,76029189),s=ve(s,n,e,o,p[l+9],4,-640364487),o=ve(o,s,n,e,p[l+12],11,-421815835),e=ve(e,o,s,n,p[l+15],16,530742520),s=lt(s,n=ve(n,e,o,s,p[l+2],23,-995338651),e,o,p[l],6,-198630844),o=lt(o,s,n,e,p[l+7],10,1126891415),e=lt(e,o,s,n,p[l+14],15,-1416354905),n=lt(n,e,o,s,p[l+5],21,-57434055),s=lt(s,n,e,o,p[l+12],6,1700485571),o=lt(o,s,n,e,p[l+3],10,-1894986606),e=lt(e,o,s,n,p[l+10],15,-1051523),n=lt(n,e,o,s,p[l+1],21,-2054922799),s=lt(s,n,e,o,p[l+8],6,1873313359),o=lt(o,s,n,e,p[l+15],10,-30611744),e=lt(e,o,s,n,p[l+6],15,-1560198380),n=lt(n,e,o,s,p[l+13],21,1309151649),s=lt(s,n,e,o,p[l+4],6,-145523070),o=lt(o,s,n,e,p[l+11],10,-1120210379),e=lt(e,o,s,n,p[l+2],15,718787259),n=lt(n,e,o,s,p[l+9],21,-343485551),s=kt(s,t),n=kt(n,i),e=kt(e,u),o=kt(o,c);return[s,n,e,o]}function jt(p){var d,l="",t=32*p.length;for(d=0;d<t;d+=8)l+=String.fromCharCode(p[d>>5]>>>d%32&255);return l}function an(p){var d,l=[];for(l[(p.length>>2)-1]=void 0,d=0;d<l.length;d+=1)l[d]=0;var t=8*p.length;for(d=0;d<t;d+=8)l[d>>5]|=(255&p.charCodeAt(d/8))<<d%32;return l}function xn(p){var d,l,t="";for(l=0;l<p.length;l+=1)d=p.charCodeAt(l),t+="0123456789abcdef".charAt(d>>>4&15)+"0123456789abcdef".charAt(15&d);return t}function cn(p){return unescape(encodeURIComponent(p))}function qt(p){return jt(se(an(d=cn(p)),8*d.length));var d}function un(p,d){return function(l,t){var i,u,c=an(l),s=[],n=[];for(s[15]=n[15]=void 0,c.length>16&&(c=se(c,8*l.length)),i=0;i<16;i+=1)s[i]=909522486^c[i],n[i]=1549556828^c[i];return u=se(s.concat(an(t)),512+8*t.length),jt(se(n.concat(u),640))}(cn(p),cn(d))}var p,d,l,t,i,u,c,Fn=function(){function p(){ee(this,p),this.locales={}}return re(p,[{key:"getString",value:function(d,l){var i=this.locales[l||"en-US"];return i&&i.hasOwnProperty(d)?i[d]:d}},{key:"addDictionary",value:function(d){var l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"en-US",t=this.locales[l]||{},i=Object.assign(t,d);this.locales[l]=i}}]),p}(),Mn=function(){function p(d,l){ee(this,p),this.navi=navigator,this.opType=d,this.options=l}return re(p,[{key:"b64Encode",value:function(d){for(var l="",t=new Uint8Array(d),i=t.byteLength,u=0;u<i;u++)l+=String.fromCharCode(t[u]);return window.btoa(l).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}},{key:"b64Decode",value:function(d){for(var l=d.replace(/-/g,"+").replace(/_/g,"/").replace(/\s/g,""),t=window.atob(l),i=t.length,u=new Uint8Array(i),c=0;c<i;c++)u[c]=t.charCodeAt(c);return u.buffer}},{key:"publicKeyCredentialToJSON",value:function(d){var l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:25;if(d instanceof ArrayBuffer)return this.b64Encode(d);if(l<=0)return d;if(d instanceof Array){var t=[],i=!0,u=!1,c=void 0;try{for(var s,n=d[Symbol.iterator]();!(i=(s=n.next()).done);i=!0){var e=s.value;t.push(this.publicKeyCredentialToJSON(e),l-1)}}catch(h){u=!0,c=h}finally{try{i||null==n.return||n.return()}finally{if(u)throw c}}return t}if(d instanceof Object){var o={};for(var r in d)"function"!=typeof d[r]&&(o[r]=this.publicKeyCredentialToJSON(d[r],l-1));return o}return d}},{key:"execute",value:function(){var d,l=this,t=JSON.parse(JSON.stringify(this.options));switch(this.opType){case com.ts.mobile.sdkhost.Fido2CredentialsOpType.Create:t.publicKey.challenge=this.b64Decode(t.publicKey.challenge),t.publicKey.user.id=this.b64Decode(t.publicKey.user.id),t.publicKey.excludeCredentials.map(function(o){return o.id=l.b64Decode(o.id),o}),d=this.navi.credentials.create(t).then(function(o){o.clientExtensionResults=o.getClientExtensionResults();var r=o.response&&o.response.getTransports&&o.response.getTransports(),h=l.publicKeyCredentialToJSON(o);return r&&r.length>0&&(h.response.transports=r),h});break;case com.ts.mobile.sdkhost.Fido2CredentialsOpType.Get:t.publicKey.challenge=this.b64Decode(t.publicKey.challenge);var i=!0,u=!1,c=void 0;try{for(var s,n=t.publicKey.allowCredentials[Symbol.iterator]();!(i=(s=n.next()).done);i=!0){var e=s.value;e.id=this.b64Decode(e.id)}}catch(o){u=!0,c=o}finally{try{i||null==n.return||n.return()}finally{if(u)throw c}}d=this.navi.credentials.get(t).then(function(o){return o.clientExtensionResults=o.getClientExtensionResults(),l.publicKeyCredentialToJSON(o)})}return d.catch(function(o){throw Kn.indexOf(o.name)>-1?new com.ts.mobile.sdk.impl.AuthenticationErrorImpl(com.ts.mobile.sdk.AuthenticationErrorCode.UserCanceled,"Received FIDO2 cancellation request from platform; Error: ".concat(o)):o})}}]),p}(),Kn=["NotAllowedError","AbortError"],ln=function(){function p(d,l,t,i,u){ee(this,p),this._tag=d,this._keyClass=l,this._protection=t,this._keyData=i,this._keyStore=u}return re(p,[{key:"getKeyClass",value:function(){return this._keyClass}},{key:"getTag",value:function(){return this._tag}},{key:"getBioProtected",value:function(){return this._protection}},{key:"setBiometricPromptInfo",value:function(d,l,t){}},{key:"signHex",value:function(d){return this._keyStore.signWithKeyPair(this._tag,this._keyClass,d)}},{key:"encrypt",value:function(d){throw new Error("Method not implemented.")}},{key:"decrypt",value:function(d){throw new Error("Method not implemented.")}},{key:"unwrapAsymmetricKeyPairFromPrivateKeyHex",value:function(d,l){throw new Error("Method not implemented.")}},{key:"unwrapSymmetricKeyHex",value:function(d,l){throw new Error("Method not implemented.")}},{key:"wrapSymmetricKey",value:function(d){throw new Error("Method not implemented.")}},{key:"publicKeyToJson",value:function(){return this._keyData}},{key:"closeKeyPair",value:function(){throw new Error("Method not implemented.")}}]),p}(),Ot=function(){function p(d){ee(this,p),this._host=d}return re(p,[{key:"generateKeyPair",value:function(d,l,t,i){var u=this,c=this.keyGenParamsForKeyClass(l);return this.generateKeyPairInternal(d,c,l,t,i).catch(function(s){if(u._host.log(com.ts.mobile.sdk.LogLevel.Error,"TransmitSDK/Tarsus","Failed to generate key pair: ".concat(s)),s instanceof DOMException&&"DataCloneError"===s.name){var n=u.fallbackKeyGenParamsForKeyClass(l);return u.generateKeyPairInternal(d,n,l,t,i)}throw u._host.log(com.ts.mobile.sdk.LogLevel.Error,"TransmitSDK/Tarsus","Failed to generate key pair: ".concat(s)),com.ts.mobile.sdk.impl.AuthenticationErrorImpl.ensureAuthenticationError(s)})}},{key:"generateKeyPairInternal",value:function(d,l,t,i,u){var c=this;return new Promise(function(s,n){l||s(null),c.promiseLikeToPromise(crypto.subtle.generateKey(l.params,!1,c.keyUsagesForKeyClass(t))).then(function(e){return c._host.log(com.ts.mobile.sdk.LogLevel.Debug,"TransmitSDK/Tarsus","key pair generated, now will validate private key is not exportable."),new Promise(function(o,r){c.promiseLikeToPromise(crypto.subtle.exportKey("pkcs8",e.privateKey)).then(function(h){var f="generated exportable private key";c._host.log(com.ts.mobile.sdk.LogLevel.Error,"TransmitSDK/Tarsus",f);var g=new com.ts.mobile.sdk.impl.AuthenticationErrorImpl(com.ts.mobile.sdk.AuthenticationErrorCode.Internal,f),y={};throw y[com.ts.mobile.sdkhost.ErrorDataInternalError]=com.ts.mobile.sdkhost.InternalErrorCouldNotGenerateSecureKey,com.ts.mobile.sdk.impl.AuthenticationErrorImpl.augmentErrorData(g,y)}).catch(function(h){if(h instanceof com.ts.mobile.sdk.impl.AuthenticationErrorImpl&&r(h),!(h instanceof DOMException)||h instanceof DOMException&&"InvalidAccessError"!==h.name){var f="failed to verify private key is not exportable";c._host.log(com.ts.mobile.sdk.LogLevel.Error,"TransmitSDK/Tarsus",f);var g=new com.ts.mobile.sdk.impl.AuthenticationErrorImpl(com.ts.mobile.sdk.AuthenticationErrorCode.Internal,f),y={};y[com.ts.mobile.sdkhost.ErrorDataInternalError]=com.ts.mobile.sdkhost.InternalErrorCouldNotGenerateSecureKey,r(com.ts.mobile.sdk.impl.AuthenticationErrorImpl.augmentErrorData(g,y))}o(!0)})}).then(function(o){return c._host.log(com.ts.mobile.sdk.LogLevel.Debug,"TransmitSDK/Tarsus","generate key pair success"),c.promiseLikeToPromise(crypto.subtle.exportKey("spki",e.publicKey)).then(function(r){c._host.log(com.ts.mobile.sdk.LogLevel.Debug,"TransmitSDK/Tarsus","export key pair success");var h=c._db.transaction("keystore","readwrite");h.oncomplete=function(y){c._host.log(com.ts.mobile.sdk.LogLevel.Debug,"TransmitSDK/Tarsus","object store transaction complete")},h.onerror=function(y){var A="object store transaction failed: ".concat(h.error.message);c._host.log(com.ts.mobile.sdk.LogLevel.Debug,"TransmitSDK/Tarsus",A),n(new com.ts.mobile.sdk.impl.AuthenticationErrorImpl(com.ts.mobile.sdk.AuthenticationErrorCode.Internal,A))};var f=h.objectStore("keystore");try{var g=f.add({tag:d,key:e.privateKey});return c.promiseRequestResult(g).then(function(y){c._host.log(com.ts.mobile.sdk.LogLevel.Debug,"TransmitSDK/Tarsus","add key pair success");var A=btoa(String.fromCharCode.apply(String,function ge(p){return function(d){if(Array.isArray(d)){for(var l=0,t=new Array(d.length);l<d.length;l++)t[l]=d[l];return t}}(p)||function(d){if(Symbol.iterator in Object(d)||"[object Arguments]"===Object.prototype.toString.call(d))return Array.from(d)}(p)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}(new Uint8Array(r))));return c.savePublicKeyData(d,A,l.keyType),new ln(d,t,i,{type:l.keyType,key:A},c)})}catch(y){throw c._host.log(com.ts.mobile.sdk.LogLevel.Error,"TransmitSDK/Tarsus","failed to add record to db: ".concat(y)),y}})}).catch(function(o){throw c._host.log(com.ts.mobile.sdk.LogLevel.Error,"TransmitSDK/Tarsus","failed to generate key pair: ".concat(o)),o}).then(s,n)})})}},{key:"getKeyPair",value:function(d,l,t){var i=this.getPublicKeyData(d);return i?new ln(d,l,t,{type:i.keyType,key:i.keyData},this):null}},{key:"deleteKeyPair",value:function(d){delete this._publicKeyDataCache[d],this._host.writeStorageKey("xmkeystore",this._publicKeyDataCache)}},{key:"signWithKeyPair",value:function(d,l,t){var i=this;return new Promise(function(u,c){var s=i._db.transaction("keystore");s.oncomplete=function(e){i._host.log(com.ts.mobile.sdk.LogLevel.Debug,"TransmitSDK/Tarsus","object store transaction complete")},s.onerror=function(e){var o="object store transaction failed: ".concat(s.error.message);i._host.log(com.ts.mobile.sdk.LogLevel.Debug,"TransmitSDK/Tarsus",o),c(new com.ts.mobile.sdk.impl.AuthenticationErrorImpl(com.ts.mobile.sdk.AuthenticationErrorCode.Internal,o))};var n=s.objectStore("keystore").get(d);i.promiseRequestResult(n).then(function(e){i._host.log(com.ts.mobile.sdk.LogLevel.Debug,"TransmitSDK/Tarsus","get key pair success");var o=new Uint8Array(com.ts.mobile.sdk.util.hexToBytes(t)),r=e.key.algorithm.name;i.promiseLikeToPromise(crypto.subtle.sign({name:r,hash:"SHA-256"},e.key,o)).then(function(h){if("ECDSA"===r){var f=i.convertSignatureToDERHex(new Uint8Array(h));u(f)}else if("RSASSA-PKCS1-v1_5"===r)u(i.toHexString(h));else{var g="invalid signing key algorithm";i._host.log(com.ts.mobile.sdk.LogLevel.Debug,"TransmitSDK/Tarsus",g),c(new com.ts.mobile.sdk.impl.AuthenticationErrorImpl(com.ts.mobile.sdk.AuthenticationErrorCode.Internal,g))}})})}).catch(function(u){throw i._host.log(com.ts.mobile.sdk.LogLevel.Error,"TransmitSDK/Tarsus","failed to sign with key pair: ".concat(u)),com.ts.mobile.sdk.impl.AuthenticationErrorImpl.ensureAuthenticationError(u)})}},{key:"initialize",value:function(){var d=this;return new Promise(function(l,t){var i=function(){try{d._publicKeyDataCache=d._host.readStorageKey("xmkeystore"),l(!0)}catch(s){var c="failed to fetch public key data cache: ".concat(s);d._host.log(com.ts.mobile.sdk.LogLevel.Error,"TransmitSDK/Tarsus",c),t(new com.ts.mobile.sdk.impl.AuthenticationErrorImpl(com.ts.mobile.sdk.AuthenticationErrorCode.Internal,c))}},u=indexedDB.open("com.ts.mobile.sdk.key-store",1);u.onupgradeneeded=function(c){d._host.log(com.ts.mobile.sdk.LogLevel.Debug,"TransmitSDK/Tarsus","indexedDB upgrade or create required"),d._db=u.result,d._db.createObjectStore("keystore",{keyPath:"tag"}),i()},u.onsuccess=function(c){d._host.log(com.ts.mobile.sdk.LogLevel.Debug,"TransmitSDK/Tarsus","indexedDB opened successfully"),d._db=u.result,i()},u.onerror=function(c){var s="failed to open indexedDB: ".concat(u.error.message);d._host.log(com.ts.mobile.sdk.LogLevel.Error,"TransmitSDK/Tarsus",s),t(new com.ts.mobile.sdk.impl.AuthenticationErrorImpl(com.ts.mobile.sdk.AuthenticationErrorCode.Internal,s))}})}},{key:"promiseRequestResult",value:function(d){return new Promise(function(l,t){d.onsuccess=function(i){l(d.result)},d.onerror=function(i){t(d.error)}})}},{key:"promiseLikeToPromise",value:function(d){return new Promise(function(l,t){d.then(l,t)})}},{key:"keyUsagesForKeyClass",value:function(d){switch(d){case com.ts.mobile.sdkhost.KeyClass.StdEncryptionKey:case com.ts.mobile.sdkhost.KeyClass.HardwareProtectedSignAndEncryptKey:return["decrypt","encrypt"];default:return["sign"]}}},{key:"keyGenParamsForKeyClass",value:function(d){switch(d){case com.ts.mobile.sdkhost.KeyClass.StdEncryptionKey:case com.ts.mobile.sdkhost.KeyClass.HardwareProtectedSignAndEncryptKey:return null;default:return{keyType:"ec",params:{name:"ECDSA",namedCurve:"P-384"}}}}},{key:"fallbackKeyGenParamsForKeyClass",value:function(d){switch(d){case com.ts.mobile.sdkhost.KeyClass.StdEncryptionKey:case com.ts.mobile.sdkhost.KeyClass.HardwareProtectedSignAndEncryptKey:return null;default:return{keyType:"rsapkcs",params:{name:"RSASSA-PKCS1-v1_5",modulusLength:2048,publicExponent:new Uint8Array([1,0,1]),hash:"SHA-256"}}}}},{key:"getPublicKeyData",value:function(d){return this._publicKeyDataCache[d]}},{key:"savePublicKeyData",value:function(d,l,t){this._publicKeyDataCache[d]={keyType:t,keyData:l},this._host.writeStorageKey("xmkeystore",this._publicKeyDataCache)}},{key:"convertSignatureToDERHex",value:function(d){for(var l=Array.prototype.map.call(d,function(e){return("00"+e.toString(16)).slice(-2)}).join(""),t=l.substring(0,96),i=l.substring(96),u=!0,c=!0;0===t.indexOf("00");)t=t.substring(2),u=!1;for(u&&parseInt(t.substring(0,2),16)>127&&(t="00"+t);0===i.indexOf("00");)i=i.substring(2),c=!1;c&&parseInt(i.substring(0,2),16)>127&&(i="00"+i);var s=function(e){return("00"+(e.length/2).toString(16)).slice(-2).toString()},n="02"+s(t)+t+"02"+s(i)+i;return"30"+s(n)+n}},{key:"toHexString",value:function(d){return Array.prototype.map.call(new Uint8Array(d),function(l){return("00"+l.toString(16)).slice(-2)}).join("")}}],[{key:"isIndexedDBSupported",value:function(){return!!(window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB)}}]),p}(),X=function(){function p(){ee(this,p)}return re(p,null,[{key:"isWebCryptoSupported",value:function(){if(!window.crypto||!window.crypto.subtle)return!1;var d=(new Dn).setUA(navigator.userAgent).getBrowser(),l=d.name,t=d.major;return"Chrome"===l&&t>=45||"Safari"===l&&t>=11||"Mobile Safari"===l&&(t>=12||11==t&&(d.minor||0)>=3)||"Edge"===l&&t>=79||"Firefox"===l&&t>=34}},{key:"isIndexedDBAvailable",value:function(){return new Promise(function(d){try{var l=window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB;if(l){var t=l.open("capability-test"),i=setTimeout(function(){t.onsuccess=t.onerror=null,d(!1)},4e3);t.onerror=function(){clearTimeout(i),d(!1)},t.onsuccess=function(){clearTimeout(i),l.deleteDatabase("capability-test"),d(!0)}}else d(!1)}catch(u){d(!1)}})}},{key:"collect",value:function(){return new Promise(function(d){p.isIndexedDBAvailable().then(function(l){d({indexedDB:l,webCrypto:p.isWebCryptoSupported()})})})}}]),p}().collect(),bt=function(){function p(){ee(this,p),this.logLevel=com.ts.mobile.sdk.LogLevel.Error,this.collectionResultsPromise=null,this.internalLogger=new Rn,this.externalLogger=null,this.cachedFidoMfuvaSupported=null,this.localizer=new Fn,this.browserCapabilities=null,window.__XMSDK_PLUGINS={},this.localizer.addDictionary(oe)}return re(p,[{key:"initialize",value:function(d){var l=this;return this.log(com.ts.mobile.sdk.LogLevel.Debug,"TransmitSDK/Tarsus","initialize with collectors [".concat(d,"]")),this._localStorage=new sn("localStorage"),this._sessionStorage=new sn("sessionStorage"),X.then(function(t){return l.browserCapabilities=t,l._enabledCollectors=d,"true"!==l.queryHostInfo(com.ts.mobile.sdkhost.HostInformationKey.PersistentKeysSupported)||(l.keyStore=new Ot(l),l.keyStore.initialize())})}},{key:"setLogLevel",value:function(d){this.logLevel=d}},{key:"log",value:function(d,l,t){d<=this.logLevel&&this.internalLogger.log(d,l,t),this.externalLogger&&this.externalLogger.log(d,l,t)}},{key:"readStorageKey",value:function(d){return JSON.parse(this._localStorage.getItem(d)||"{}")}},{key:"writeStorageKey",value:function(d,l){this._localStorage.setItem(d,JSON.stringify(l))}},{key:"deleteStorageKey",value:function(d){this._localStorage.removeItem(d)}},{key:"readSessionStorageKey",value:function(d){return JSON.parse(this._sessionStorage.getItem(d)||"{}")}},{key:"writeSessionStorageKey",value:function(d,l){this._sessionStorage.setItem(d,JSON.stringify(l))}},{key:"deleteSessionStorageKey",value:function(d){this._sessionStorage.removeItem(d)}},{key:"promiseCollectionResult",value:function(){var d,l=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;null!=t?(this.log(com.ts.mobile.sdk.LogLevel.Debug,"TransmitSDK/Tarsus","promiseCollectionResult() override collectors"),d=t):d=this._enabledCollectors;var i={location:{allow:d.indexOf(com.ts.mobile.sdk.CollectorType.Location)>=0,timeout:4e3,maximumAge:18e4},deviceFingerprint:d.indexOf(com.ts.mobile.sdk.CollectorType.DeviceFingerprint)>=0,largeData:d.indexOf(com.ts.mobile.sdk.CollectorType.LargeData)>=0},u=new Promise(function(c,s){l.log(com.ts.mobile.sdk.LogLevel.Debug,"TransmitSDK/Tarsus","promiseCollectionResult() invoked with collectors: [".concat(d,"]")),Tn(i).get(function(n){l.log(com.ts.mobile.sdk.LogLevel.Debug,"TransmitSDK/Tarsus","promiseCollectionResult() completed"),c(n)})});return Promise.all([u]).then(function(c){var s=Object.assign(c[0]);return s.toJson=function(){return s},s})}},{key:"calcHexStringEncodedMd5Hash",value:function(d){return function Xt(p,d,l){return d?l?un(d,p):xn(un(d,p)):l?qt(p):xn(qt(p))}(com.ts.mobile.sdk.util.hexToAscii(d))}},{key:"generateRandomHexString",value:function(d){var l=new Uint8Array(d);(window.crypto||window.msCrypto).getRandomValues(l);for(var t="",i=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F"],u=0;u<l.length;u++)t+=i[15&l[u]];return t}},{key:"queryHostInfo",value:function(d){switch(d){case com.ts.mobile.sdkhost.HostInformationKey.Version:return"6.3.0";case com.ts.mobile.sdkhost.HostInformationKey.Platform:return"web";case com.ts.mobile.sdkhost.HostInformationKey.FingerprintSupported:return"false";case com.ts.mobile.sdkhost.HostInformationKey.HostProvidedFeatures:return"";case com.ts.mobile.sdkhost.HostInformationKey.FaceIdKeyBioProtectionSupported:case com.ts.mobile.sdkhost.HostInformationKey.ImageAcquitisionSupported:return"false";case com.ts.mobile.sdkhost.HostInformationKey.AudioAcquitisionSupported:return"true";case com.ts.mobile.sdkhost.HostInformationKey.PersistentKeysSupported:return this.browserCapabilities&&this.browserCapabilities.indexedDB&&this.browserCapabilities.webCrypto?"true":"false";case com.ts.mobile.sdkhost.HostInformationKey.FidoClientPresent:case com.ts.mobile.sdkhost.HostInformationKey.DyadicPresent:return"false";case com.ts.mobile.sdkhost.HostInformationKey.Fido2ClientPresent:return navigator.credentials&&window.PublicKeyCredential?"true":"false";case com.ts.mobile.sdkhost.HostInformationKey.DeviceBiometricsSupported:case com.ts.mobile.sdkhost.HostInformationKey.DeviceBiometricsFPContinuation:case com.ts.mobile.sdkhost.HostInformationKey.DeviceBiometricsUsesSign:return"false";case com.ts.mobile.sdkhost.HostInformationKey.DevicePersistenceMode:return"persistent";default:throw new Error("Info key is unsupported: ".concat(d))}}},{key:"queryAsyncHostInfo",value:function(d){var l=this;return new Promise(function(t,i){if(d===com.ts.mobile.sdkhost.AsyncHostInformationKey.Fido2UserVerifyingPlatformAuthenticatorAvailable)if(l.log(com.ts.mobile.sdk.LogLevel.Debug,"TransmitSDK/Tarsus","queryAsyncHostInfo() for Fido2UserVerifyingPlatformAuthenticatorAvailable invoked"),null!=l.cachedFidoMfuvaSupported)l.log(com.ts.mobile.sdk.LogLevel.Debug,"TransmitSDK/Tarsus","queryAsyncHostInfo() for Fido2UserVerifyingPlatformAuthenticatorAvailable returning cached result"),t(l.cachedFidoMfuvaSupported?"true":"false");else{l.log(com.ts.mobile.sdk.LogLevel.Debug,"TransmitSDK/Tarsus","queryAsyncHostInfo() for Fido2UserVerifyingPlatformAuthenticatorAvailable evaluating");var u=window.PublicKeyCredential;(u?u.isUserVerifyingPlatformAuthenticatorAvailable().catch(function(c){return!1}):Promise.resolve(!1)).then(function(c){l.cachedFidoMfuvaSupported=c,t(c?"true":"false")})}else l.log(com.ts.mobile.sdk.LogLevel.Debug,"not-implemented","queryAsyncHostInfo not implemented for key \n                            [".concat(com.ts.mobile.sdkhost.AsyncHostInformationKey[d],"] in tarsus-web")),i("Info key is unsupported: ".concat(d))})}},{key:"setExternalLogger",value:function(d){this.externalLogger=d}},{key:"getCurrentTime",value:function(){return Date.now()}},{key:"createDelayedPromise",value:function(d){return new Promise(function(l){setTimeout(function(){return l(d)},d)})}},{key:"calcHexStringEncodedHmacSha1HashWithHexEncodedKey",value:function(d,l){return this.log(com.ts.mobile.sdk.LogLevel.Error,"not-implemented","calcHexStringEncodedHmacSha1HashWithHexEncodedKey not implemented for tarsus-web"),null}},{key:"generatePbkdf2HmacSha1HexString",value:function(d,l,t,i){return Promise.reject("generatePbkdf2HmacSha1HexString not implemented for tarsus-web")}},{key:"fidoClientXact",value:function(d,l,t,i){return Promise.reject("fidoClientXact not implemented for tarsus-web")}},{key:"fido2CredentialsOp",value:function(d,l,t,i,u){return new Mn(i,u).execute()}},{key:"generateKeyPair",value:function(d,l,t,i){return this.keyStore.generateKeyPair(d,l,t,i)}},{key:"getKeyPair",value:function(d,l,t){return this.keyStore.getKeyPair(d,l,t)}},{key:"deleteKeyPair",value:function(d){this.keyStore.deleteKeyPair(d)}},{key:"importSymmetricKey",value:function(d,l,t,i){return this.log(com.ts.mobile.sdk.LogLevel.Error,"not-implemented","importSymmetricKey not implemented for tarsus-web"),null}},{key:"calcHexStringEncodedSha256Hash",value:function(d){var l=com.ts.mobile.sdk.util.hexToAscii(d);return sha256(com.ts.mobile.sdk.util.toUTF8Array(l))}},{key:"calcHexStringEncodedSha512Hash",value:function(d){throw this.log(com.ts.mobile.sdk.LogLevel.Error,"not-implemented","calcHexStringEncodedSha512Hash not implemented for tarsus-web"),new Error("Method not implemented.")}},{key:"generateHexSeededKeyPairExternalRepresentation",value:function(d,l){return Promise.reject("Method not implemented.")}},{key:"generateKeyPairExternalRepresentation",value:function(d){return Promise.reject("Method not implemented.")}},{key:"importVolatileKeyPair",value:function(d,l){throw new Error("Method not implemented.")}},{key:"importVolatileSymmetricKey",value:function(d,l){throw new Error("Method not implemented.")}},{key:"loadPlugin",value:function(d){var l=window.__XMSDK_PLUGINS[d];return l?(this.log(com.ts.mobile.sdk.LogLevel.Debug,"plugins","Found defined plugin "+d),Promise.resolve(l)):(this.log(com.ts.mobile.sdk.LogLevel.Error,"plugins","Could not find defined plugin "+d),Promise.reject(new com.ts.mobile.sdk.impl.AuthenticationErrorImpl(com.ts.mobile.sdk.AuthenticationErrorCode.AppImplementation,"Could not find defined plugin "+d)))}},{key:"dyadicRefreshToken",value:function(d){throw new Error("Method not implemented.")}},{key:"dyadicEnroll",value:function(d,l){return Promise.reject("Method not implemented.")}},{key:"dyadicSign",value:function(d){return Promise.reject("Method not implemented.")}},{key:"dyadicDelete",value:function(){return Promise.reject("Method not implemented.")}},{key:"setDebugIndicatorVisible",value:function(d){d?this.debugIndicator||(this.debugIndicator=document.createElement("div"),Object.assign(this.debugIndicator.style,{position:"absolute",top:"5px",left:"5px",background:"black",opacity:"0.7",color:"white",borderRadius:"10px",padding:"12px",fontFamily:"sans-serif"}),this.debugIndicator.innerText="Transmit SDK: Journey is being debugged.",document.body.appendChild(this.debugIndicator)):this.debugIndicator&&(this.debugIndicator.remove(),this.debugIndicator=null)}},{key:"importVolatileKeyPairFromPublicKeyHex",value:function(d,l){throw new Error("Method not implemented.")}},{key:"getString",value:function(d,l){return this.localizer.getString(d,l)}},{key:"getPreferredLocale",value:function(){var d=window.navigator;return(window.navigator.languages?window.navigator.languages[0]:null)||d.language||d.browserLanguage||d.userLanguage}},{key:"transformApiPath",value:function(d){return d}},{key:"getUIStyles",value:function(){return"{}"}}]),p}();i=(t=(l=(d=(p=S||(S={})).ts||(p.ts={})).mobile||(d.mobile={})).sdk||(l.sdk={})).core||(t.core={}),u={},c=function(){function s(n){n?(this._reading=!0,this._root=n):(this._reading=!1,this._root={}),this._currentContainer=this._root,this._otherContainerStack=[]}return Object.defineProperty(s.prototype,"serializedContent",{get:function(){return this._root},enumerable:!1,configurable:!0}),s.prototype.enterContainer=function(n){var e=this._currentContainer[n];if(this._reading||e||(this._currentContainer[n]=e={}),"object"!=De(e))throw new Error("Attempt to enter non-container "+n);this._otherContainerStack.push(this._currentContainer),this._currentContainer=e},s.prototype.leaveContainer=function(){this._currentContainer=this._otherContainerStack.pop()},s.prototype.writePrimitive=function(n,e){this._currentContainer[n]=e},s.prototype.readPrimitive=function(n){return this._currentContainer[n]},s.prototype.writeObject=function(n,e){if(null!==e){var o=e.constructor.___serializationTag;if(!o)throw new Error("Invalid typetag for object passed to writeObject. Did you forget to decorate object with @Serializable?");this.enterContainer(n),this.writePrimitive("type",o),this.enterContainer("content"),e.serializeTo(this),this.leaveContainer(),this.leaveContainer()}else this.writePrimitive(n,null)},s.prototype.readObject=function(n,e){return this.internalReadObject(n,e)},s.prototype.readNonNullObject=function(n,e){var o=this.internalReadObject(n,e);if(!o)throw new Error("Invalid null object encountered");return o},s.prototype.internalReadObject=function(n,e){var o,r;if("string"==typeof n?(r=n,o=null):(o=n,r=e),null===this.readPrimitive(r))return null;this.enterContainer(r);var h=this.readPrimitive("type"),f=u[h];if(!f)throw new Error("Invalid class tag encountered in archive "+h);this.enterContainer("content");var g=new f(this);if(this.leaveContainer(),o&&!(g instanceof o))throw new Error("Expected subclass of "+o+"; found "+f);return this.leaveContainer(),g},s}(),i.SerializationContext=c,i.Serializable=function(s){return function(n){u[s]=n,n.___serializationTag=s}},function(p){!function(d){!function(l){!function(t){!function(i){i[i.Hide=0]="Hide",i[i.Action=1]="Action",i[i.Cancel=2]="Cancel",i[i.Custom=3]="Custom"}(t.ActionEscapeOptionPresentation||(t.ActionEscapeOptionPresentation={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){var i=function(){function u(){}return u.__tarsusInterfaceName="InputResponseType",u}();t.InputResponseType=i}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){var i=function(){function u(){}return u.__tarsusInterfaceName="AuthenticationActionParameter",u}();t.AuthenticationActionParameter=i}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={}));var wt,V=Ne&&Ne.__extends||(wt=function(p,d){return(wt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(l,t){l.__proto__=t}||function(l,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(l[i]=t[i])})(p,d)},function(p,d){function l(){this.constructor=p}wt(p,d),p.prototype=null===d?Object.create(d):(l.prototype=d.prototype,new l)});(function(p){!function(d){!function(l){!function(t){var i=function(u){function c(){return null!==u&&u.apply(this,arguments)||this}return V(c,u),c.prototype.getAuthenticatorInput=function(){return this._authenticatorInput},c.prototype.setAuthenticatorInput=function(s){this._authenticatorInput=s},c.prototype.getSelectedTargets=function(){return this._selectedTargets},c.prototype.setSelectedTargets=function(s){this._selectedTargets=s},c.createAuthenticatorInput=function(s){return p.ts.mobile.sdk.impl.TargetBasedAuthenticatorInputImpl.createAuthenticatorInput(s)},c.createTargetSelectionRequest=function(s){return p.ts.mobile.sdk.impl.TargetBasedAuthenticatorInputImpl.createTargetSelectionRequest(s)},c.createTargetsSelectionRequest=function(s){return p.ts.mobile.sdk.impl.TargetBasedAuthenticatorInputImpl.createTargetsSelectionRequest(s)},c.__tarsusInterfaceName="TargetBasedAuthenticatorInput",c}(t.InputResponseType);t.TargetBasedAuthenticatorInput=i}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))})(S||(S={})),function(p){!function(d){!function(l){!function(t){var i=function(u){function c(){return null!==u&&u.apply(this,arguments)||this}return V(c,u),c.__tarsusInterfaceName="OtpInput",c}(t.InputResponseType);t.OtpInput=i}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){var i=function(u){function c(){return null!==u&&u.apply(this,arguments)||this}return V(c,u),c.createSuccessResponse=function(s){return p.ts.mobile.sdk.impl.PlaceholderInputResponseImpl.createSuccessResponse(s)},c.createdFailedResponse=function(s,n){return p.ts.mobile.sdk.impl.PlaceholderInputResponseImpl.createdFailedResponse(s,n)},c.createFailedResponseWithServerProvidedStatus=function(s){return p.ts.mobile.sdk.impl.PlaceholderInputResponseImpl.createFailedResponseWithServerProvidedStatus(s)},c.__tarsusInterfaceName="PlaceholderInputResponse",c}(t.InputResponseType);t.PlaceholderInputResponse=i}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){var i=function(){function u(){}return u.__tarsusInterfaceName="PushRequestPayload",u}();t.PushRequestPayload=i}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){var i=function(u){function c(){return null!==u&&u.apply(this,arguments)||this}return V(c,u),c.createSuccessResponse=function(s){return p.ts.mobile.sdk.impl.FidoInputResponseImpl.createSuccessResponse(s)},c.createdFailedResponse=function(s,n){return p.ts.mobile.sdk.impl.FidoInputResponseImpl.createdFailedResponse(s,n)},c.__tarsusInterfaceName="FidoInputResponse",c}(t.InputResponseType);t.FidoInputResponse=i}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){var i=function(u){function c(){return null!==u&&u.apply(this,arguments)||this}return V(c,u),c.createWithUserId=function(s){return p.ts.mobile.sdk.impl.MobileApprovePushRequestPayloadImpl.createWithUserId(s)},c.createWithUserTicket=function(s){return p.ts.mobile.sdk.impl.MobileApprovePushRequestPayloadImpl.createWithUserTicket(s)},c.createWithJsonPayload=function(s){return p.ts.mobile.sdk.impl.MobileApprovePushRequestPayloadImpl.createWithJsonPayload(s)},c.__tarsusInterfaceName="MobileApprovePushRequestPayload",c}(t.PushRequestPayload);t.MobileApprovePushRequestPayload=i}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){var i=function(u){function c(){return null!==u&&u.apply(this,arguments)||this}return V(c,u),c.createSecurityQuestionAnswersInputResponse=function(s){return p.ts.mobile.sdk.impl.SecurityQuestionInputResponseImpl.createSecurityQuestionAnswersInputResponse(s)},c.__tarsusInterfaceName="SecurityQuestionInputResponse",c}(t.InputResponseType);t.SecurityQuestionInputResponse=i}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){var i=function(){function u(){}return u.prototype.getAnswerText=function(){return this._answerText},u.createWithText=function(c){return p.ts.mobile.sdk.impl.SecurityQuestionAnswerImpl.createWithText(c)},u.__tarsusInterfaceName="SecurityQuestionAnswer",u}();t.SecurityQuestionAnswer=i}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){var i=function(){function u(){}return u.prototype.getQuestion=function(){return this._question},u.prototype.getAnswer=function(){return this._answer},u.prototype.getIsRemoved=function(){return this._isRemoved},u.createAnswerToQuestion=function(c,s){return p.ts.mobile.sdk.impl.SecurityQuestionAndAnswerImpl.createAnswerToQuestion(c,s)},u.createAnswerRemovalRequest=function(c){return p.ts.mobile.sdk.impl.SecurityQuestionAndAnswerImpl.createAnswerRemovalRequest(c)},u.__tarsusInterfaceName="SecurityQuestionAndAnswer",u}();t.SecurityQuestionAndAnswer=i}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){var i=function(){function u(){}return u.prototype.getFlowId=function(){return this._flowId},u.prototype.setFlowId=function(c){this._flowId=c},u.__tarsusInterfaceName="JourneyInvocationOptions",u}();t.JourneyInvocationOptions=i}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){var i=function(){function u(){}return u.createEscapeRequest=function(c){return p.ts.mobile.tarsusplugin.impl.TotpProvisionResultImpl.createEscapeRequest(c)},u.__tarsusInterfaceName="TotpProvisionResult",u}();t.TotpProvisionResult=i}(l.tarsusplugin||(l.tarsusplugin={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){var i=function(u){function c(){return null!==u&&u.apply(this,arguments)||this}return V(c,u),c.prototype.getAssertionData=function(){return this._assertionData},c.prototype.setAssertionData=function(s){this._assertionData=s},c.prototype.getStoredData=function(){return this._storedData},c.prototype.setStoredData=function(s){this._storedData=s},c.__tarsusInterfaceName="TotpProvisionOutput",c}(t.TotpProvisionResult);t.TotpProvisionOutput=i}(l.tarsusplugin||(l.tarsusplugin={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){var u=function(){function c(s,n){this._stepTag=s,this._passphraseText=n}return c.prototype.getStepTag=function(){return this._stepTag},c.prototype.getAcquisitionChallenges=function(){return[]},c.prototype.getPassphraseText=function(){return this._passphraseText},c.__tarsusInterfaceName="AudioAcquisitionStepDescription",c}();i.AudioAcquisitionStepDescriptionImpl=u}(t.impl||(t.impl={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){var i=function(u){function c(){return null!==u&&u.apply(this,arguments)||this}return V(c,u),c.prototype.getTarget=function(){return this._target},c.create=function(s){return p.ts.mobile.sdk.impl.AuthenticationActionParameterTargetSelectionImpl.create(s)},c.__tarsusInterfaceName="AuthenticationActionParameterTargetSelection",c}(t.AuthenticationActionParameter);t.AuthenticationActionParameterTargetSelection=i}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){var u=function(c){function s(n){var e=c.call(this)||this;return e._target=n,e}return V(s,c),s.create=function(n){return new s(n)},s.__tarsusInterfaceName="AuthenticationActionParameterTargetSelection",s}(t.AuthenticationActionParameterTargetSelection);i.AuthenticationActionParameterTargetSelectionImpl=u}(t.impl||(t.impl={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){var i=function(){function u(){}return u.prototype.getErrorCode=function(){return this._errorCode},u.prototype.getMessage=function(){return this._message},u.prototype.getData=function(){return this._data},u.createApplicationGeneratedGeneralError=function(c,s){return p.ts.mobile.sdk.impl.AuthenticationErrorImpl.createApplicationGeneratedGeneralError(c,s)},u.createApplicationGeneratedCommunicationError=function(c,s){return p.ts.mobile.sdk.impl.AuthenticationErrorImpl.createApplicationGeneratedCommunicationError(c,s)},u.__tarsusInterfaceName="AuthenticationError",u}();t.AuthenticationError=i}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={}));var At=Ne&&Ne.__assign||function(){return(At=Object.assign||function(p){for(var d,l=1,t=arguments.length;l<t;l++)for(var i in d=arguments[l])Object.prototype.hasOwnProperty.call(d,i)&&(p[i]=d[i]);return p}).apply(this,arguments)};(function(p){!function(d){!function(l){!function(t){!function(i){var u=function(c){function s(n,e,o){var r=c.call(this)||this;return r._errorCode=n,r._message=e,r._data=o||{},r._data.public_properties||(r._data=At(At({},r._data),{public_properties:{}})),r}return V(s,c),s.errorForServerResponse=function(n){var e={server_error_code:n.error_code,server_error_message:n.error_message,server_error_data:n.data},o=n.error_message||"Internal error",r=t.AuthenticationErrorCode.Internal;switch(n.error_code){case 2009:r=t.AuthenticationErrorCode.DeviceNotFound;break;case 28:var h=new s(t.AuthenticationErrorCode.InvalidIdToken,o);return h.setPublicProperty(t.AuthenticationErrorProperty.InvalidIdTokenErrorReason,t.AuthenticationErrorPropertySymbol.InvalidIdTokenErrorReasonBadToken),h;case t.core.Protocol.ServerResponseErrorCode.UserIdTokenExpired:return(h=new s(t.AuthenticationErrorCode.InvalidIdToken,o)).setPublicProperty(t.AuthenticationErrorProperty.InvalidIdTokenErrorReason,t.AuthenticationErrorPropertySymbol.InvalidIdTokenErrorReasonExpiredToken),h;case 3001:case 3002:r=t.AuthenticationErrorCode.InvalidDeviceBinding;break;case 4e3:case 4002:r=t.AuthenticationErrorCode.ControlFlowExpired;break;case 4005:case 4006:r=t.AuthenticationErrorCode.SessionRequired;break;case 6001:case 6002:r=t.AuthenticationErrorCode.ApprovalWrongState}return new s(r,o,e)},s.createApplicationGeneratedGeneralError=function(n,e){return new s(t.AuthenticationErrorCode.Internal,n,e)},s.createApplicationGeneratedCommunicationError=function(n,e){return new s(t.AuthenticationErrorCode.Communication,n,e)},s.errorForSessionRejectionFailureData=function(n){var e=t.AuthenticationErrorCode.PolicyRejection,o="Session rejected by server.",r={failure_data:n};return n&&n.source&&(n.reason&&n.reason.type)===t.core.Protocol.FailureReasonType.ApprovalExpired&&(e=t.AuthenticationErrorCode.ApprovalWrongState,o="Approval expired.",r.approval_state="expired"),new s(e,o,r)},s.errorForHostInternalBiometricErrorData=function(n,e){var o;switch(n[l.sdkhost.ErrorDataInternalError]){case l.sdkhost.InternalErrorBiometricInvalidated:o=new i.AuthenticationErrorImpl(t.AuthenticationErrorCode.AuthenticatorInvalidated,e+" registration invalidated.");break;case l.sdkhost.InternalErrorWrongBiometric:o=new i.AuthenticationErrorImpl(t.AuthenticationErrorCode.InvalidInput,"Invalid "+e+" was input.");break;case l.sdkhost.InternalErrorBiometricNotConfigured:(o=new i.AuthenticationErrorImpl(t.AuthenticationErrorCode.AuthenticatorExternalConfigError,e+" not configured on this device.")).setPublicProperty(t.AuthenticationErrorProperty.AuthenticatorExternalConfigErrorReason,t.AuthenticationErrorPropertySymbol.AuthenticatorExternalConfigErrorReasonBiometricsNotEnrolled);break;case l.sdkhost.InternalErrorBiometricOsLockTemporary:(o=new i.AuthenticationErrorImpl(t.AuthenticationErrorCode.AuthenticatorExternalConfigError,e+" authentication is temporarily locked by the OS.")).setPublicProperty(t.AuthenticationErrorProperty.AuthenticatorExternalConfigErrorReason,t.AuthenticationErrorPropertySymbol.AuthenticatorExternalConfigErrorReasonBiometricsOsLockTemporary);break;case l.sdkhost.InternalErrorBiometricOsLockPermanent:(o=new i.AuthenticationErrorImpl(t.AuthenticationErrorCode.AuthenticatorExternalConfigError,e+" authentication is permanently locked by the OS.")).setPublicProperty(t.AuthenticationErrorProperty.AuthenticatorExternalConfigErrorReason,t.AuthenticationErrorPropertySymbol.AuthenticatorExternalConfigErrorReasonBiometricsOsLockPermanent);break;default:o=null}return o},s.errorForHostInternalErrorData=function(n){var e;return n[l.sdkhost.ErrorDataInternalError]===l.sdkhost.InternalErrorCouldNotGenerateSecureKey?(e=new i.AuthenticationErrorImpl(t.AuthenticationErrorCode.AuthenticatorExternalConfigError,"Failed to generate secure key.")).setPublicProperty(t.AuthenticationErrorProperty.AuthenticatorExternalConfigErrorReason,t.AuthenticationErrorPropertySymbol.AuthenticatorExternalConfigErrorReasonGeneratedKeyIsNotSecure):e=null,e},s.prototype.setPublicProperty=function(n,e){this._data.public_properties[t.AuthenticationErrorProperty[n]]=e},s.prototype.getPublicProperty=function(n){return this._data.public_properties[t.AuthenticationErrorProperty[n]]},s.prototype.getPublicBooleanProperty=function(n){var e=this.getPublicProperty(n);if(e&&"boolean"!=typeof e)throw new s(t.AuthenticationErrorCode.AppImplementation,"type of property "+t.AuthenticationErrorProperty[n]+" is not 'boolean'");return e},s.prototype.getPublicNumberProperty=function(n){var e=this.getPublicProperty(n);if(e&&"number"!=typeof e)throw new s(t.AuthenticationErrorCode.AppImplementation,"type of property "+t.AuthenticationErrorProperty[n]+" is not 'number'");return e},s.prototype.getPublicStringProperty=function(n){var e=this.getPublicProperty(n);if(e&&"string"!=typeof e)throw new s(t.AuthenticationErrorCode.AppImplementation,"type of property "+t.AuthenticationErrorProperty[n]+" is not 'string'");return e},s.prototype.getPublicSymbolicProperty=function(n){var e=this.getPublicProperty(n);if(e&&!t.AuthenticationErrorProperty[n])throw new s(t.AuthenticationErrorCode.AppImplementation,"type of property "+t.AuthenticationErrorProperty[n]+" is not 'AuthenticationErrorPropertySymbol'");return e},s.prototype.toString=function(){return"AuthenticationError<"+t.AuthenticationErrorCode[this._errorCode]+", "+this._message+", "+JSON.stringify(this._data)+">"},s.errorForAssertionResponse=function(n){var e;switch(n.assertion_error_code){case t.core.Protocol.AssertionErrorCode.FailedAssertion:e=t.AuthenticationErrorCode.InvalidInput;break;case t.core.Protocol.AssertionErrorCode.MethodLocked:e=t.AuthenticationErrorCode.AuthenticatorLocked;break;case t.core.Protocol.AssertionErrorCode.HistoryRepeat:e=t.AuthenticationErrorCode.RegisteredSecretAlreadyInHistory;break;default:e=t.AuthenticationErrorCode.Internal}return new s(e,n.assertion_error_message||"Assertion error code "+n.assertion_error_code,{assertion_error_code:n.assertion_error_code,additional_data:n.data})},s.appImplementationError=function(n){return new s(t.AuthenticationErrorCode.AppImplementation,n)},s.errorForTransportResponse=function(n){return new s(t.AuthenticationErrorCode.Communication,"HTTP response error",{status:n.getStatus(),body:n.getBodyJson()})},s.ensureAuthenticationError=function(n){if(s.dynamicCast(n))return n;var e={js_error_message:n.toString()};return n.stack&&(e.js_error_stack=n.stack),new s(t.AuthenticationErrorCode.Internal,"Internal error occurred ("+n.toString()+")",e)},s.augmentErrorData=function(n,e){var o,r={},h=n.getData();if(h)for(o in h)r[o]=h[o];for(o in e)r[o]=e[o];return new s(n.getErrorCode(),n.getMessage(),r)},s.dynamicCast=function(n){return void 0!==n.getErrorCode&&void 0!==n.getMessage&&void 0!==n.getData},s}(t.AuthenticationError);i.AuthenticationErrorImpl=u}(t.impl||(t.impl={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))})(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){var u=function(){function c(s,n){this._authenticator=s,this._suggestedParams=n}return c.prototype.getAuthenticator=function(){return this._authenticator},c.prototype.getSuggestedParameters=function(){return this._suggestedParams},c}();i.AuthenticationOptionImpl=u}(t.impl||(t.impl={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){var u=function(){function c(s,n,e,o){this._appData=e||null,this._token=s||null,this._internalData=o||null,this._deviceId=n||null}return c.prototype.getToken=function(){return this._token||""},c.prototype.getDeviceId=function(){return this._deviceId||""},c.prototype.getData=function(){return this._appData||{}},c.prototype.getInternalData=function(){return this._internalData},c.fromCflowServerResponse=function(s,n){return new c(s.token,n,s.application_data,s.data)},c}();i.AuthenticationResultImpl=u}(t.impl||(t.impl={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){var i=function(){function u(){}return u.prototype.getResultType=function(){return this._resultType},u.prototype.setResultType=function(c){this._resultType=c},u.prototype.getSelectedAuthenticator=function(){return this._selectedAuthenticator},u.prototype.setSelectedAuthenticator=function(c){this._selectedAuthenticator=c},u.prototype.getSelectedAuthenticationParameters=function(){return this._selectedAuthenticationParameters},u.prototype.setSelectedAuthenticationParameters=function(c){this._selectedAuthenticationParameters=c},u.prototype.getActionEscapeRequest=function(){return this._actionEscapeRequest},u.prototype.setActionEscapeRequest=function(c){this._actionEscapeRequest=c},u.createAbortRequest=function(){return p.ts.mobile.sdk.impl.AuthenticatorSelectionResultImpl.createAbortRequest()},u.createEscapeRequest=function(c,s){return p.ts.mobile.sdk.impl.AuthenticatorSelectionResultImpl.createEscapeRequest(c,s)},u.createSelectionRequest=function(c){return p.ts.mobile.sdk.impl.AuthenticatorSelectionResultImpl.createSelectionRequest(c)},u.createParameterizedSelectionRequest=function(c,s){return p.ts.mobile.sdk.impl.AuthenticatorSelectionResultImpl.createParameterizedSelectionRequest(c,s)},u.__tarsusInterfaceName="AuthenticatorSelectionResult",u}();t.AuthenticatorSelectionResult=i}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){var u=function(c){function s(){return null!==c&&c.apply(this,arguments)||this}return V(s,c),s.createAbortRequest=function(){var n=new s;return n.setResultType(t.AuthenticatorSelectionResultType.Abort),n},s.createSelectionRequest=function(n){var e=new s;return e.setResultType(t.AuthenticatorSelectionResultType.SelectAuthenticator),e.setSelectedAuthenticator(n),e},s.createEscapeRequest=function(n,e){var o=new s;return o._resultType=t.AuthenticatorSelectionResultType.Escape,o._actionEscapeRequest=new t.ActionEscapeRequest,o._actionEscapeRequest._escapeOption=n,o._actionEscapeRequest._escapeParameters=e,o},s}(t.AuthenticatorSelectionResult);i.AuthenticatorSelectionResultImpl=u}(t.impl||(t.impl={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){var u=function(){function c(s){this._acquisitionChallenges=s}return c.prototype.getStepTag=function(){return"imageAcquisition"},c.prototype.getAcquisitionChallenges=function(){return this._acquisitionChallenges},c.__tarsusInterfaceName="CameraAcquisitionStepDescription",c}();i.CameraAcquisitionStepDescriptionImpl=u}(t.impl||(t.impl={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){var i=function(){function u(){}return u.prototype.getLocalEnrollmentKeySizeInBytes=function(){return this._localEnrollmentKeySizeInBytes},u.prototype.getLocalEnrollmentKeyIterationCount=function(){return this._localEnrollmentKeyIterationCount},u.prototype.setLocalEnrollmentKeyIterationCount=function(c){this._localEnrollmentKeyIterationCount=c},u.create=function(c){return p.ts.mobile.sdk.impl.ClientCryptoSettingsImpl.create(c)},u.__tarsusInterfaceName="ClientCryptoSettings",u}();t.ClientCryptoSettings=i}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){var u=function(c){function s(){return null!==c&&c.apply(this,arguments)||this}return V(s,c),s.create=function(n){var e=new s;return e.setLocalEnrollmentKeyIterationCount(n),e._localEnrollmentKeySizeInBytes=32,e},s}(t.ClientCryptoSettings);i.ClientCryptoSettingsImpl=u}(t.impl||(t.impl={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){var u=function(){function c(s,n){this._description=s,this._menuItemOptions=n||{}}return c.prototype.getDescription=function(){return this._description},c.prototype.getAvailableActions=function(){var s=this,n=[];switch(this._description.getRegistrationStatus()){case t.AuthenticatorRegistrationStatus.Registered:n=[t.AuthenticatorConfigurationAction.Reregister,t.AuthenticatorConfigurationAction.Unregister];break;case t.AuthenticatorRegistrationStatus.Unregistered:case t.AuthenticatorRegistrationStatus.LocallyInvalid:n=[t.AuthenticatorConfigurationAction.Register]}return n.filter(function(e){return e==t.AuthenticatorConfigurationAction.Reregister&&!s._menuItemOptions.hide_reregister||e==t.AuthenticatorConfigurationAction.Register&&!s._menuItemOptions.hide_register||e==t.AuthenticatorConfigurationAction.Unregister&&!s._menuItemOptions.hide_unregister})},c}();i.ConfigurableAuthenticatorImpl=u}(t.impl||(t.impl={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){var i=function(){function u(){}return u.prototype.getUserChoice=function(){return this._userChoice},u.prototype.setUserChoice=function(c){this._userChoice=c},u.prototype.getActionEscapeRequest=function(){return this._actionEscapeRequest},u.prototype.setActionEscapeRequest=function(c){this._actionEscapeRequest=c},u.create=function(c){return p.ts.mobile.sdk.impl.ConfirmationInputImpl.create(c)},u.createEscapeRequest=function(c,s){return p.ts.mobile.sdk.impl.ConfirmationInputImpl.createEscapeRequest(c,s)},u.__tarsusInterfaceName="ConfirmationInput",u}();t.ConfirmationInput=i}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){var u=function(c){function s(){return null!==c&&c.apply(this,arguments)||this}return V(s,c),s.create=function(n){var e=new s;return e.setUserChoice(n),e},s.createEscapeRequest=function(n,e){var o=new s,r=new t.ActionEscapeRequest;return r.setEscapeOption(n),r.setEscapeParameters(e),o.setActionEscapeRequest(r),o},s}(t.ConfirmationInput);i.ConfirmationInputImpl=u}(t.impl||(t.impl={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){var i=function(){function u(){}return u.prototype.getRequestType=function(){return this._requestType},u.prototype.setRequestType=function(c){this._requestType=c},u.create=function(c){return p.ts.mobile.sdk.impl.ControlRequestImpl.create(c)},u.__tarsusInterfaceName="ControlRequest",u}();t.ControlRequest=i}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){var u=function(c){function s(){return null!==c&&c.apply(this,arguments)||this}return V(s,c),s.create=function(n){var e=new s;return e.setRequestType(n),e},s}(t.ControlRequest);i.ControlRequestImpl=u}(t.impl||(t.impl={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){var i=function(u){function c(){return null!==u&&u.apply(this,arguments)||this}return V(c,u),c.prototype.getPrompt=function(){return this._prompt},c.prototype.setPrompt=function(s){this._prompt=s},c.prototype.getTitle=function(){return this._title},c.prototype.setTitle=function(s){this._title=s},c.prototype.getSubtitle=function(){return this._subtitle},c.prototype.setSubtitle=function(s){this._subtitle=s},c.prototype.getCancelButtonTitle=function(){return this._cancelButtonTitle},c.prototype.setCancelButtonTitle=function(s){this._cancelButtonTitle=s},c.create=function(s){return p.ts.mobile.sdk.impl.DeviceBiometricsInputImpl.create(s)},c.createFull=function(s,n,e,o){return p.ts.mobile.sdk.impl.DeviceBiometricsInputImpl.createFull(s,n,e,o)},c.__tarsusInterfaceName="DeviceBiometricsInput",c}(t.InputResponseType);t.DeviceBiometricsInput=i}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){var u=function(c){function s(){return null!==c&&c.apply(this,arguments)||this}return V(s,c),s.create=function(n){var e=new s;return n&&e.setPrompt(n),e},s}(t.DeviceBiometricsInput);i.DeviceBiometricsInputImpl=u}(t.impl||(t.impl={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){var u=function(){function c(s,n){this._id=s,this._name=n}return c.prototype.getId=function(){return this._id},c.prototype.getName=function(){return this._name},c}();i.DeviceGroupImpl=u}(t.impl||(t.impl={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){var u=function(){function c(s){this.updateFromServer(s)}return c.prototype.getDeviceHwId=function(){return this._id},c.prototype.getName=function(){return this._name?this._name:this._model+" "+this._osType+" "+this._osVersion},c.prototype.getStatus=function(){return this._status},c.prototype.getLastAccess=function(){return this._lastAccess},c.prototype.getLastAccessLocation=function(){return this._lastAccessLocation},c.prototype.getLastAccessLocationAttributes=function(){return this._lastAccessLocationAttributes},c.prototype.getRegistered=function(){return this._registered},c.prototype.getModel=function(){return this._model},c.prototype.getOsType=function(){return this._osType},c.prototype.getOsVersion=function(){return this._osVersion},c.prototype.getUseCount=function(){return this._useCount},c.prototype.getIsCurrent=function(){return this._isCurrent},c.prototype.getDeviecId=function(){return this._id},c.prototype.setStatus=function(s){this._status=s},c.prototype.setName=function(s){this._name=s},c.prototype.forceCurrent=function(){this._isCurrent=!0},c.prototype.updateFromServer=function(s){switch(this._model=t.core.DeviceModelConverter.getDeviceModel(s.device_model,s.os_type),this._name=s.name,this._lastAccess=Date.parse(s.last_access),this._registered=Date.parse(s.registered),this._osType=t.core.DeviceModelConverter.getOsName(s.os_type),this._osVersion=s.os_version,this._useCount=s.use_count,this._isCurrent=s.cur_device,this._id=s.device_id,s.status){case t.core.Protocol.DeviceStatusServerFormat.Disabled:this._status=t.DeviceStatus.Disabled;break;case t.core.Protocol.DeviceStatusServerFormat.LongInactivity:this._status=t.DeviceStatus.LongInactivity;break;case t.core.Protocol.DeviceStatusServerFormat.NoRecentActivity:this._status=t.DeviceStatus.NoRecentActivity;break;case t.core.Protocol.DeviceStatusServerFormat.RecentlyUsed:this._status=t.DeviceStatus.RecentlyUsed;break;case t.core.Protocol.DeviceStatusServerFormat.Removed:this._status=t.DeviceStatus.Removed;break;default:throw new i.AuthenticationErrorImpl(t.AuthenticationErrorCode.Internal,"Unknown device status "+s.status)}if(s.last_access_location){var n=new t.GeoLocation;n.longitude=s.last_access_location.lng,n.latitude=s.last_access_location.lat,this._lastAccessLocation=n,this._lastAccessLocationAttributes=new i.LocationAttributesImpl(s.last_access_location)}},c}();i.DeviceInfoImpl=u}(t.impl||(t.impl={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){var u=function(){function c(){}return c.getOsName=function(s){var n=s;switch(s){case"iPhone":case"iPad":n="iOS"}return n},c.getDeviceModel=function(s,n){var e=s;if("iPhone"==n)switch(s){case"i386":case"x86_64":e="Simulator";break;case"iPod1,1":case"iPod2,1":case"iPod3,1":case"iPod4,1":case"iPod7,1":e="iPod Touch";break;case"iPhone1,1":case"iPhone1,2":case"iPhone2,1":e="iPhone";break;case"iPad1,1":case"iPad3,1":case"iPad3,4":case"iPad7,5":case"iPad7,6":case"iPad11,6":case"iPad11,7":e="iPad";break;case"iPad2,1":e="iPad 2";break;case"iPhone3,1":case"iPhone3,3":e="iPhone 4";break;case"iPhone4,1":e="iPhone 4S";break;case"iPhone5,1":case"iPhone5,2":e="iPhone 5";break;case"iPad2,5":case"iPad4,4":case"iPad4,5":case"iPad4,7":e="iPad Mini";break;case"iPhone5,3":case"iPhone5,4":e="iPhone 5c";break;case"iPhone6,1":case"iPhone6,2":e="iPhone 5s";break;case"iPhone7,1":e="iPhone 6 Plus";break;case"iPhone7,2":e="iPhone 6";break;case"iPhone8,1":e="iPhone 6S";break;case"iPhone8,2":e="iPhone 6S Plus";break;case"iPhone8,4":e="iPhone SE";break;case"iPhone9,1":case"iPhone9,3":e="iPhone 7";break;case"iPhone9,2":case"iPhone9,4":e="iPhone 7 Plus";break;case"iPhone10,1":case"iPhone10,4":e="iPhone 8";break;case"iPhone10,2":case"iPhone10,5":e="iPhone 8 Plus";break;case"iPhone10,3":case"iPhone10,6":e="iPhone X";break;case"iPad4,1":case"iPad4,2":case"iPad11,3":case"iPad11,4":case"iPad13,1":case"iPad13,2":e="iPad Air";break;case"iPad6,7":case"iPad6,8":case"iPad6,7":case"iPad6,8":case"iPad8,5":case"iPad8,6":case"iPad8,7":case"iPad8,8":case"iPad8,11":case"iPad8,12":case"iPad13,8":case"iPad13,9":case"iPad13,10":case"iPad13,11":e='iPad Pro (12.9")';break;case"iPad6,3":case"iPad6,4":e='iPad Pro (9.7")';break;case"iPhone11,2":e="iPhone XS";break;case"iPhone11,6":case"iPhone11,4":e="iPhone XS Max";break;case"iPhone11,8":e="iPhone XR";break;case"iPad6,11":case"iPad6,12":e="iPad (2017)";break;case"iPad7,1":case"iPad7,2":e="iPad Pro 2nd Gen";break;case"iPad7,3":case"iPad7,4":e='iPad Pro (10.5")';break;case"iPad8,1":case"iPad8,2":case"iPad8,3":case"iPad8,4":case"iPad8,9":case"iPad8,10":case"iPad13,4":case"iPad13,5":case"iPad13,6":case"iPad13,7":e='iPad Pro (11")';break;case"iPad11,1":case"iPad11,2":e="iPad mini";break;case"iPhone12,1":e="iPhone 11";break;case"iPhone12,3":e="iPhone 11 Pro";break;case"iPhone12,5":e="iPhone 11 Pro Max";break;case"iPhone12,8":e="iPhone SE 2nd Gen";break;case"iPhone13,1":e="iPhone 12 Mini";break;case"iPhone13,2":e="iPhone 12";break;case"iPhone13,3":e="iPhone 12 Pro";break;case"iPhone13,4":e="iPhone 12 Pro Max"}return e},c}();i.DeviceModelConverter=u}(t.core||(t.core={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){i[i.Password=0]="Password",i[i.Fingerprint=1]="Fingerprint",i[i.Pincode=2]="Pincode",i[i.Pattern=3]="Pattern",i[i.Otp=4]="Otp",i[i.Face=5]="Face",i[i.Voice=6]="Voice",i[i.Eye=7]="Eye",i[i.Emoji=8]="Emoji",i[i.Questions=9]="Questions",i[i.FaceID=10]="FaceID",i[i.Generic=11]="Generic",i[i.MobileApprove=12]="MobileApprove",i[i.Totp=13]="Totp",i[i.DeviceBiometrics=14]="DeviceBiometrics",i[i.Fido2=15]="Fido2"}(t.AuthenticatorType||(t.AuthenticatorType={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){i[i.RedirectTypeBind=0]="RedirectTypeBind",i[i.RedirectTypeAuthenticate=1]="RedirectTypeAuthenticate",i[i.RedirectTypeBindOrAuthenticate=2]="RedirectTypeBindOrAuthenticate",i[i.RedirectTypeInvokePolicy=3]="RedirectTypeInvokePolicy"}(t.RedirectType||(t.RedirectType={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){!function(u){var c,s,n;u.AuthTypeData={password:{authTypeEnum:t.AuthenticatorType.Password,authTypeName:"Password"},fingerprint:{authTypeEnum:t.AuthenticatorType.Fingerprint,authTypeName:"Fingerprint"},pin:{authTypeEnum:t.AuthenticatorType.Pincode,authTypeName:"PIN"},pin_centralized:{authTypeEnum:t.AuthenticatorType.Pincode,authTypeName:"PIN"},pattern:{authTypeEnum:t.AuthenticatorType.Pattern,authTypeName:"Pattern"},pattern_centralized:{authTypeEnum:t.AuthenticatorType.Pattern,authTypeName:"Pattern"},otp:{authTypeEnum:t.AuthenticatorType.Otp,authTypeName:"OTP"},face:{authTypeEnum:t.AuthenticatorType.Face,authTypeName:"Face"},face_server:{authTypeEnum:t.AuthenticatorType.Face,authTypeName:"Face"},voice_server:{authTypeEnum:t.AuthenticatorType.Voice,authTypeName:"Voice"},eye:{authTypeEnum:t.AuthenticatorType.Eye,authTypeName:"Eye"},emoji:{authTypeEnum:t.AuthenticatorType.Emoji,authTypeName:"Emoji"},question:{authTypeEnum:t.AuthenticatorType.Questions,authTypeName:"Questions"},face_id:{authTypeEnum:t.AuthenticatorType.FaceID,authTypeName:"FaceID"},mobile_approve:{authTypeEnum:t.AuthenticatorType.MobileApprove,authTypeName:"MobileApprove"},totp:{authTypeEnum:t.AuthenticatorType.Totp,authTypeName:"Totp"},device_biometrics:{authTypeEnum:t.AuthenticatorType.DeviceBiometrics,authTypeName:"DeviceBiometrics"},fido2:{authTypeEnum:t.AuthenticatorType.Generic,authTypeName:"FIDO2Authenticator"}},(u.SessionStateChangeState||(u.SessionStateChangeState={})).Closed="closed",u.flowIdHeaderName="flow_id",(n=u.AuthSessionState||(u.AuthSessionState={})).Pending="pending",n.Completed="completed",n.Rejected="rejected",function(n){n.LOGINS="frequency_logins",n.DAYS="frequency_days"}(u.PromotionStrategyFrequency||(u.PromotionStrategyFrequency={})),function(n){n.Numeric="numeric",n.Alphanumeric="alphanumeric",n.Binary="binary"}(u.QrCodeFormatType||(u.QrCodeFormatType={})),function(n){n.Alphanumeric="alphanumeric",n.QrCode="qrcode"}(u.TicketIdFormatType||(u.TicketIdFormatType={})),function(n){n.ApprovalApprove="approval_approve"}(u.FailureSourceTransactionType||(u.FailureSourceTransactionType={})),function(n){n.AutoExecute="auto_execute",n.AssertionRejected="assertion_rejected",n.Policy="policy",n.Locked="locked",n.ApprovalExpired="approval_expired"}(u.FailureReasonType||(u.FailureReasonType={})),function(n){n.DefaultAuthenticator="default",n.AuthenticatorMenu="menu",n.FirstAuthenticator="first"}(u.AuthMenuPresentationMode||(u.AuthMenuPresentationMode={})),function(n){n.Registered="registered",n.Registering="registering",n.Unregistered="unregistered"}(u.AuthenticationMethodStatus||(u.AuthenticationMethodStatus={})),function(n){n.Validate="validate",n.Generate="generate"}(u.AuthenticationMethodOtpState||(u.AuthenticationMethodOtpState={})),function(n){n.None="none",n.Sms="sms",n.Email="email",n.Voice="voice",n.Push="push_notification"}(u.AuthenticationMethodOtpChannelType||(u.AuthenticationMethodOtpChannelType={})),function(n){n.Numeric="numeric",n.QrCode="qrcode",n.External="external",n.Unknown=""}(u.OtpFormatType||(u.OtpFormatType={})),function(n){n.WaitForApproval="wait_for_approval",n.WaitForAuthenticate="wait_for_authenticate"}(u.AuthenticationMethodMobileApproveState||(u.AuthenticationMethodMobileApproveState={})),function(n){n.AlphaNumeric="alpha_numeric",n.Numeric="numeric",n.QrCode="qrcode"}(u.TotpChallengeFormatType||(u.TotpChallengeFormatType={})),function(n){n.SelectTargets="select_targets",n.Validate="validate",n.Generate="generate"}(u.AuthenticationMethodTotpState||(u.AuthenticationMethodTotpState={})),function(n){n.RedirectTypeNameBind="bind",n.RedirectTypeNameAuthenticate="auth",n.RedirectTypeNameBindOrAuthenticate="bind_or_auth",n.RedirectTypeNameInvokePolicy="invoke"}(s=u.RedirectTypeName||(u.RedirectTypeName={})),u.RedirectTypeMap=((c={})[s.RedirectTypeNameBind]=t.RedirectType.RedirectTypeBind,c[s.RedirectTypeNameAuthenticate]=t.RedirectType.RedirectTypeAuthenticate,c[s.RedirectTypeNameBindOrAuthenticate]=t.RedirectType.RedirectTypeBindOrAuthenticate,c[s.RedirectTypeNameInvokePolicy]=t.RedirectType.RedirectTypeInvokePolicy,c),function(n){n[n.EncryptionStateError=23]="EncryptionStateError",n[n.UserIdTokenExpired=29]="UserIdTokenExpired",n[n.DeviceKeyExpired=2017]="DeviceKeyExpired"}(u.ServerResponseErrorCode||(u.ServerResponseErrorCode={})),function(n){n[n.NotRegistered=1]="NotRegistered",n[n.InvalidAction=2]="InvalidAction",n[n.BadConfig=3]="BadConfig",n[n.BadFch=4]="BadFch",n[n.FailedAssertion=5]="FailedAssertion",n[n.MethodLocked=6]="MethodLocked",n[n.DataMissing=7]="DataMissing",n[n.Internal=9]="Internal",n[n.HistoryRepeat=11]="HistoryRepeat",n[n.ExternalProcessPending=13]="ExternalProcessPending",n[n.MustRegister=14]="MustRegister",n[n.NotFinished=16]="NotFinished",n[n.MissingQuestions=17]="MissingQuestions",n[n.RepeatCurrentStep=18]="RepeatCurrentStep",n[n.FailOver=19]="FailOver",n[n.AssertionContainerNotComplete=20]="AssertionContainerNotComplete",n[n.AckRequired=22]="AckRequired"}(u.AssertionErrorCode||(u.AssertionErrorCode={})),function(n){n.Pending="pending",n.Approved="approved",n.Denied="declined",n.Expired="expired"}(u.ServerResponseDataApprovalsApprovalStatus||(u.ServerResponseDataApprovalsApprovalStatus={})),function(n){n.RecentlyUsed="recently_used",n.NoRecentActivity="no_recent_activity",n.LongInactivity="long_inactivity",n.Disabled="disabled",n.Removed="removed"}(u.DeviceStatusServerFormat||(u.DeviceStatusServerFormat={})),function(n){n.ErrorReasonAttestationReverificationFailed="attestation_verification_failed",n.ErrorReasonCredentialFiltered="credential_filtered"}(u.ServerResponseDataErrorReasonReasons||(u.ServerResponseDataErrorReasonReasons={})),function(n){n.Active="active",n.Disabled="disabled"}(u.CollectorState||(u.CollectorState={}))}(i.Protocol||(i.Protocol={}))}(t.core||(t.core={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){var u=function(){function c(){for(var s=[],n=0;n<arguments.length;n++)s[n]=arguments[n];this._styleSheet=c.merge.apply(c,s),this.replaceRefValues()}return c.prototype.getMatchingStyle=function(s){var n=this;if(null!=this._styleSheet.styles){var e={};return this._styleSheet.styles.forEach(function(o){var r=n.matchStyle(s,o);e=At(At({},e),r)}),new t.impl.UIStyleImpl(e)}return t.impl.UIStyleImpl.emptyStyle()},c.merge=function(){for(var s=[],n=0;n<arguments.length;n++)s[n]=arguments[n];var e={styles:[],values:{}};return s.forEach(function(o){var r;(r=e.styles).push.apply(r,o.styles),e.values=At(At({},e.values),o.values)}),e},c.prototype.matchStyle=function(s,n){return n.rule.tags.every(function(e){return s.indexOf(e)>-1})?n.properties:{}},c.prototype.replaceRefValues=function(){var s=this;null!=this._styleSheet.values&&this._styleSheet.styles&&this._styleSheet.styles.forEach(function(n){n.properties=s.replaceStyleProperties(n.properties)})},c.prototype.replaceRef=function(s){return i.Protocol.isRefType(s)?this._styleSheet.values[s.ref]:s},c.prototype.replaceStyleProperties=function(s){var n=s;for(var e in s)n[e]=this.replaceRef(s[e]);return n},c}();i.UIStyleSheets=u}(t.core||(t.core={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){var u={hide:t.ActionEscapeOptionPresentation.Hide,action:t.ActionEscapeOptionPresentation.Action,cancel:t.ActionEscapeOptionPresentation.Cancel,custom:t.ActionEscapeOptionPresentation.Custom},c=function(){function s(n){this._id=n.id,this._displayName=n.display_name,this._presentation=u[n.presentation]}return s.prototype.getId=function(){return this._id},s.prototype.getDisplayName=function(){return this._displayName},s.prototype.getPresentation=function(){return this._presentation},s}();i.EscapeOptionImpl=c}(t.impl||(t.impl={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){var i=function(u){function c(){return null!==u&&u.apply(this,arguments)||this}return V(c,u),c.prototype.getDisplayName=function(){return this._displayName},c.prototype.setDisplayName=function(s){this._displayName=s},c.create=function(s){return p.ts.mobile.sdk.impl.Fido2InputResponseImpl.create(s)},c.__tarsusInterfaceName="Fido2InputResponse",c}(t.InputResponseType);t.Fido2InputResponse=i}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){var u=function(c){function s(){return null!==c&&c.apply(this,arguments)||this}return V(s,c),s.create=function(n){var e=new s;return e.setDisplayName(n),e},s}(t.Fido2InputResponse);i.Fido2InputResponseImpl=u}(t.impl||(t.impl={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){var u=function(c){function s(){return null!==c&&c.apply(this,arguments)||this}return V(s,c),s.createSuccessResponse=function(n){var e=new t.FidoAuthSuccessResponse;return e.setFidoResponse(n),e},s.createdFailedResponse=function(n,e){var o=new t.FidoAuthFailureResponse;return o.setFailureError(e),o.setExpired(n.getExpired()),o.setLocked(n.getLocked()),o.setRegistered(n.getRegistered()),o.setRegistrationStatus(n.getRegistrationStatus()),o},s}(t.PlaceholderInputResponse);i.FidoInputResponseImpl=u}(t.impl||(t.impl={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){var i=function(u){function c(){return null!==u&&u.apply(this,arguments)||this}return V(c,u),c.prototype.getPrompt=function(){return this._prompt},c.prototype.setPrompt=function(s){this._prompt=s},c.prototype.getCancelButtonTitle=function(){return this._cancelButtonTitle},c.prototype.setCancelButtonTitle=function(s){this._cancelButtonTitle=s},c.prototype.getFallbackButtonTitle=function(){return this._fallbackButtonTitle},c.prototype.setFallbackButtonTitle=function(s){this._fallbackButtonTitle=s},c.prototype.getFallbackControlRequestType=function(){return this._fallbackControlRequestType},c.prototype.setFallbackControlRequestType=function(s){this._fallbackControlRequestType=s},c.create=function(s){return p.ts.mobile.sdk.impl.FingerprintInputImpl.create(s)},c.createFallbackEnabledPrompt=function(s,n,e){return p.ts.mobile.sdk.impl.FingerprintInputImpl.createFallbackEnabledPrompt(s,n,e)},c.__tarsusInterfaceName="FingerprintInput",c}(t.InputResponseType);t.FingerprintInput=i}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){var u=function(c){function s(){return null!==c&&c.apply(this,arguments)||this}return V(s,c),s.create=function(n){var e=new s;return n&&e.setPrompt(n),e},s.createFallbackEnabledPrompt=function(n,e,o){var r=new s;return n&&r.setPrompt(n),e&&r.setFallbackButtonTitle(e),r.setFallbackControlRequestType(o||t.ControlRequestType.SelectMethod),r},s}(t.FingerprintInput);i.FingerprintInputImpl=u}(t.impl||(t.impl={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){var i=function(){function u(){}return u.prototype.getJsonData=function(){return this._jsonData},u.prototype.setJsonData=function(c){this._jsonData=c},u.prototype.getControlRequest=function(){return this._controlRequest},u.prototype.setControlRequest=function(c){this._controlRequest=c},u.prototype.getActionEscapeRequest=function(){return this._actionEscapeRequest},u.prototype.setActionEscapeRequest=function(c){this._actionEscapeRequest=c},u.createFormInputSubmissionRequest=function(c){return p.ts.mobile.sdk.impl.FormInputImpl.createFormInputSubmissionRequest(c)},u.createFormCancellationRequest=function(){return p.ts.mobile.sdk.impl.FormInputImpl.createFormCancellationRequest()},u.createEscapeRequest=function(c,s){return p.ts.mobile.sdk.impl.FormInputImpl.createEscapeRequest(c,s)},u.__tarsusInterfaceName="FormInput",u}();t.FormInput=i}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){var u=function(c){function s(){return null!==c&&c.apply(this,arguments)||this}return V(s,c),s.createFormInputSubmissionRequest=function(n){var e=new s;return e.setJsonData(n),e.setControlRequest(t.FormControlRequest.Submit),e},s.createFormCancellationRequest=function(){var n=new s;return n.setControlRequest(t.FormControlRequest.Abort),n},s.createEscapeRequest=function(n,e){var o=new s,r=new t.ActionEscapeRequest;return r.setEscapeOption(n),r.setEscapeParameters(e),o.setActionEscapeRequest(r),o.setControlRequest(t.FormControlRequest.Escape),o},s}(t.FormInput);i.FormInputImpl=u}(t.impl||(t.impl={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){t.GeoLocation=function(){}}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){var i=function(){function u(){}return u.prototype.getResponse=function(){return this._response},u.prototype.setResponse=function(c){this._response=c},u.prototype.getControlRequest=function(){return this._controlRequest},u.prototype.setControlRequest=function(c){this._controlRequest=c},u.prototype.getActionEscapeRequest=function(){return this._actionEscapeRequest},u.prototype.setActionEscapeRequest=function(c){this._actionEscapeRequest=c},u.createControlResponse=function(c){return p.ts.mobile.sdk.impl.InputOrControlResponseImpl.createControlResponse(c)},u.createEscapeResponse=function(c,s){return p.ts.mobile.sdk.impl.InputOrControlResponseImpl.createEscapeResponse(c,s)},u.createInputResponse=function(c){return p.ts.mobile.sdk.impl.InputOrControlResponseImpl.createInputResponse(c)},u.__tarsusInterfaceName="InputOrControlResponse",u}();t.InputOrControlResponse=i}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){var u=function(c){function s(){return null!==c&&c.apply(this,arguments)||this}return V(s,c),s.createControlResponse=function(n){var e=new s;return e.setControlRequest(n),e},s.createInputResponse=function(n){var e=new s;return e.setResponse(n),e},s.createEscapeResponse=function(n,e){var o=new s;return o._actionEscapeRequest=new t.ActionEscapeRequest,o._actionEscapeRequest._escapeOption=n,o._actionEscapeRequest._escapeParameters=e,o},s.prototype.isControlRequest=function(){return!!this._controlRequest},s}(t.InputOrControlResponse);i.InputOrControlResponseImpl=u}(t.impl||(t.impl={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){var i=function(){function u(){}return u.prototype.getContinueProcessing=function(){return this._continueProcessing},u.prototype.setContinueProcessing=function(c){this._continueProcessing=c},u.create=function(c){return p.ts.mobile.sdk.impl.JsonDataProcessingResultImpl.create(c)},u.__tarsusInterfaceName="JsonDataProcessingResult",u}();t.JsonDataProcessingResult=i}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){var u=function(c){function s(){return null!==c&&c.apply(this,arguments)||this}return V(s,c),s.create=function(n){var e=new s;return e.setContinueProcessing(n),e},s}(t.JsonDataProcessingResult);i.JsonDataProcessingResultImpl=u}(t.impl||(t.impl={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){var u=function(){function c(s){this.city=s.city,this.state=s.state,this.country=s.country}return c.prototype.getCity=function(){return this.city},c.prototype.getCountry=function(){return this.country},c.prototype.getState=function(){return this.state},c}();i.LocationAttributesImpl=u}(t.impl||(t.impl={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){var u=function(){function c(s){this._deviceInfo=new i.DeviceInfoImpl(s)}return c.prototype.getInfo=function(){return this._deviceInfo},c.prototype.getAvailableActions=function(){if(this._deviceInfo.getStatus()==t.DeviceStatus.Removed)return[];var s=[t.DeviceManagementAction.Rename];return this._deviceInfo.getIsCurrent()||s.push(t.DeviceManagementAction.Remove),s},c}();i.ManagedDeviceImpl=u}(t.impl||(t.impl={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){var u=function(){function c(s){this._approval=new i.MobileApprovalImpl(s),this._availableActions=this._approval.getStatus()===t.MobileApprovalStatus.Pending?[t.MobileApprovalAction.Approve,t.MobileApprovalAction.Deny]:[]}return c.prototype.getApproval=function(){return this._approval},c.prototype.getAvailableActions=function(){return this._availableActions},c}();i.ManagedMobileApprovalImpl=u}(t.impl||(t.impl={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){var u=function(){function c(s){if(this._originDevice=null,this._approvalId=s.approval_id,this._source=s.source,this._title=s.title,this._details=s.details,this._creationTime=s.create,this._finishTime=s.finish,this._expiresAt=s.create+1e3*s.expiry_in,this._originAppId=s.origin_app_id,this._customParams=s.custom_params,s.origin_device&&(this._originDevice=t.TargetDeviceDetailsImpl.fromServerFormat(s.origin_device)),s.location){var n=new t.GeoLocation;n.longitude=s.location.lng,n.latitude=s.location.lat,this._location=n}switch(s.status){case t.core.Protocol.ServerResponseDataApprovalsApprovalStatus.Approved:this._status=t.MobileApprovalStatus.Approved;break;case t.core.Protocol.ServerResponseDataApprovalsApprovalStatus.Denied:this._status=t.MobileApprovalStatus.Denied;break;case t.core.Protocol.ServerResponseDataApprovalsApprovalStatus.Expired:this._status=t.MobileApprovalStatus.Expired;break;case t.core.Protocol.ServerResponseDataApprovalsApprovalStatus.Pending:this._status=t.MobileApprovalStatus.Pending;break;default:throw new i.AuthenticationErrorImpl(t.AuthenticationErrorCode.Internal,"Unknown approval status "+s.status)}}return c.prototype.getApprovalId=function(){return this._approvalId},c.prototype.getSource=function(){return this._source},c.prototype.getTitle=function(){return this._title},c.prototype.getDetails=function(){return this._details},c.prototype.getCreationTime=function(){return this._creationTime},c.prototype.getFinishTime=function(){return this._finishTime},c.prototype.getExpiresAt=function(){return this._expiresAt},c.prototype.getOriginAppId=function(){return this._originAppId},c.prototype.getOriginDevice=function(){return this._originDevice},c.prototype.getLocation=function(){return this._location},c.prototype.getCustomParams=function(){return this._customParams},c.prototype.getStatus=function(){return this._status},c.prototype.isExpired=function(){return this._status==t.MobileApprovalStatus.Expired},c.prototype.updateStatus=function(s){this._status=s},c}();i.MobileApprovalImpl=u}(t.impl||(t.impl={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){var i=function(u){function c(){return null!==u&&u.apply(this,arguments)||this}return V(c,u),c.__tarsusInterfaceName="MobileApproveInput",c}(t.InputResponseType);t.MobileApproveInput=i}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){var i=function(u){function c(){return null!==u&&u.apply(this,arguments)||this}return V(c,u),c.prototype.getPollingTimeout=function(){return this._pollingTimeout},c.prototype.setPollingTimeout=function(s){this._pollingTimeout=s},c.createRequestPollingInput=function(){return p.ts.mobile.sdk.impl.MobileApproveInputRequestPollingImpl.createRequestPollingInput()},c.createRequestLongPollingInput=function(s){return p.ts.mobile.sdk.impl.MobileApproveInputRequestPollingImpl.createRequestLongPollingInput(s)},c.__tarsusInterfaceName="MobileApproveInputRequestPolling",c}(t.MobileApproveInput);t.MobileApproveInputRequestPolling=i}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){var u=function(c){function s(){return null!==c&&c.apply(this,arguments)||this}return V(s,c),s.createRequestPollingInput=function(){var n=new s;return n.setPollingTimeout(0),n},s.createRequestLongPollingInput=function(n){var e=new s;return e.setPollingTimeout(n),e},s}(t.MobileApproveInputRequestPolling);i.MobileApproveInputRequestPollingImpl=u}(t.impl||(t.impl={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){var u=function(){function c(s,n,e){this.value=s,this.format=n,this.alt=e}return c.prototype.getValue=function(){return this.value},c.prototype.getFormat=function(){return this.format},c.prototype.getQrAlternativeRepresentation=function(){return this.alt},c.createFromServerFormat=function(s){var n=t.OtpFormatImpl.fromAssertionFormat(s.format),e=null;return(s.alt||[]).forEach(function(o){"qr_text"===o.type&&(e=o.value)}),new c(s.value,n,e)},c}();i.MobileApproveOtpImpl=u}(t.impl||(t.impl={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){var i,u;i=t.impl||(t.impl={}),u=function(c){function s(){return null!==c&&c.apply(this,arguments)||this}return V(s,c),s.prototype.userId=function(){return this._userId},s.prototype.title=function(){return this._title},s.prototype.body=function(){return this._body},s.prototype.source=function(){return this._source},s.prototype.ticket=function(){return this._ticket},s.createWithUserId=function(n){var e=new s;return e._userId=n,e},s.createWithUserTicket=function(n){var e=new s;return e._userId=n,e},s.createWithJsonPayload=function(n){var e=n,o=new s;return o._userId=e.user_id,o._title=e.body,o._body=e.details,o._source=e.source,o},s}(t.MobileApprovePushRequestPayload),i.MobileApprovePushRequestPayloadImpl=u}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){var i=function(u){function c(){return null!==u&&u.apply(this,arguments)||this}return V(c,u),c.prototype.getPrompt=function(){return this._prompt},c.prototype.setPrompt=function(s){this._prompt=s},c.prototype.getCancelButtonTitle=function(){return this._cancelButtonTitle},c.prototype.setCancelButtonTitle=function(s){this._cancelButtonTitle=s},c.prototype.getFallbackButtonTitle=function(){return this._fallbackButtonTitle},c.prototype.setFallbackButtonTitle=function(s){this._fallbackButtonTitle=s},c.prototype.getFallbackControlRequestType=function(){return this._fallbackControlRequestType},c.prototype.setFallbackControlRequestType=function(s){this._fallbackControlRequestType=s},c.create=function(s){return p.ts.mobile.sdk.impl.NativeFaceInputImpl.create(s)},c.createFallbackEnabledPrompt=function(s,n,e){return p.ts.mobile.sdk.impl.NativeFaceInputImpl.createFallbackEnabledPrompt(s,n,e)},c.__tarsusInterfaceName="NativeFaceInput",c}(t.InputResponseType);t.NativeFaceInput=i}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){var u=function(c){function s(){return null!==c&&c.apply(this,arguments)||this}return V(s,c),s.create=function(n){var e=new s;return n&&e.setPrompt(n),e},s.createFallbackEnabledPrompt=function(n,e,o){var r=new s;return n&&r.setPrompt(n),e&&r.setFallbackButtonTitle(e),r.setFallbackControlRequestType(o||t.ControlRequestType.SelectMethod),r},s}(t.NativeFaceInput);i.NativeFaceInputImpl=u}(t.impl||(t.impl={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){var i=function(){function e(){}return e.fromAssertionFormat=function(o){switch(o.type){case t.core.Protocol.OtpFormatType.Numeric:return new u(o.length);case t.core.Protocol.OtpFormatType.QrCode:return new c;case t.core.Protocol.OtpFormatType.External:return new n(o.data);default:throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Internal,"Invalid format type encountered: "+o.type)}},e}();t.OtpFormatImpl=i;var u=function(){function e(o){this._length=o}return e.prototype.getOtpLength=function(){return this._length},e.prototype.getType=function(){return s.Numeric},e.__tarsusInterfaceName="OtpFormatNumeric",e}();t.OtpFormatNumericImpl=u;var c=function(){function e(){}return e.prototype.getType=function(){return s.QrCode},e.__tarsusInterfaceName="OtpFormatQr",e}();t.OtpFormatQrImpl=c;var s,e,n=function(){function e(o){this._data=o}return e.prototype.getData=function(){return this._data},e.prototype.getType=function(){return s.External},e.__tarsusInterfaceName="OtpFormatExternal",e}();t.OtpFormatExternalImpl=n,(e=s=t.OtpFormatType||(t.OtpFormatType={}))[e.Numeric=0]="Numeric",e[e.QrCode=1]="QrCode",e[e.External=2]="External"}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){var i=function(u){function c(){return null!==u&&u.apply(this,arguments)||this}return V(c,u),c.prototype.getOtp=function(){return this._otp},c.prototype.setOtp=function(s){this._otp=s},c.createOtpSubmission=function(s){return p.ts.mobile.sdk.impl.OtpInputOtpSubmissionImpl.createOtpSubmission(s)},c.__tarsusInterfaceName="OtpInputOtpSubmission",c}(t.OtpInput);t.OtpInputOtpSubmission=i}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){var u=function(c){function s(){return null!==c&&c.apply(this,arguments)||this}return V(s,c),s.createOtpSubmission=function(n){var e=new s;return e.setOtp(n),e},s}(t.OtpInputOtpSubmission);i.OtpInputOtpSubmissionImpl=u}(t.impl||(t.impl={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){var i=function(u){function c(){return null!==u&&u.apply(this,arguments)||this}return V(c,u),c.createOtpResendRequest=function(){return p.ts.mobile.sdk.impl.OtpInputRequestResendImpl.createOtpResendRequest()},c.__tarsusInterfaceName="OtpInputRequestResend",c}(t.OtpInput);t.OtpInputRequestResend=i}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){var u=function(c){function s(){return null!==c&&c.apply(this,arguments)||this}return V(s,c),s.createOtpResendRequest=function(){return new s},s}(t.OtpInputRequestResend);i.OtpInputRequestResendImpl=u}(t.impl||(t.impl={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){var i=function(u){function c(){return null!==u&&u.apply(this,arguments)||this}return V(c,u),c.__tarsusInterfaceName="OtpPushRequestPayload",c}(t.PushRequestPayload);t.OtpPushRequestPayload=i}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){var i,u;i=t.impl||(t.impl={}),u=function(c){function s(){return null!==c&&c.apply(this,arguments)||this}return V(s,c),s.prototype.userId=function(){return this._userId},s.prototype.title=function(){return this._title},s.prototype.body=function(){return this._body},s.createWithJsonPayload=function(n){var e=n,o=new s;return o._userId=e.user_id,o._title=e.title,o._body=e.body,o},s}(t.OtpPushRequestPayload),i.OtpPushRequestPayloadImpl=u}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){var i=function(u){function c(){return null!==u&&u.apply(this,arguments)||this}return V(c,u),c.prototype.getPassword=function(){return this._password},c.prototype.setPassword=function(s){this._password=s},c.create=function(s){return p.ts.mobile.sdk.impl.PasswordInputImpl.create(s)},c.__tarsusInterfaceName="PasswordInput",c}(t.InputResponseType);t.PasswordInput=i}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){var u=function(c){function s(){return null!==c&&c.apply(this,arguments)||this}return V(s,c),s.create=function(n){var e=new s;return e.setPassword(n),e},s}(t.PasswordInput);i.PasswordInputImpl=u}(t.impl||(t.impl={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){var i=function(u){function c(){return null!==u&&u.apply(this,arguments)||this}return V(c,u),c.prototype.getPatternDescription=function(){return this._patternDescription},c.prototype.setPatternDescription=function(s){this._patternDescription=s},c.create=function(s){return p.ts.mobile.sdk.impl.PatternInputImpl.create(s)},c.__tarsusInterfaceName="PatternInput",c}(t.InputResponseType);t.PatternInput=i}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){var u=function(c){function s(){return null!==c&&c.apply(this,arguments)||this}return V(s,c),s.create=function(n){var e=new s;return e.setPatternDescription(n),e},s.validateFormat=function(n){return null!=n.getPatternDescription().match(/^(r:[0-9]+,c:[0-9]+)+$/)},s.getPatternLength=function(n){if(s.validateFormat(n))return n.getPatternDescription().match(/r/g).length;throw new i.AuthenticationErrorImpl(t.AuthenticationErrorCode.AppImplementation,"Invalid pattern input.")},s}(t.PatternInput);i.PatternInputImpl=u}(t.impl||(t.impl={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){var i=function(u){function c(){return null!==u&&u.apply(this,arguments)||this}return V(c,u),c.prototype.getPin=function(){return this._pin},c.prototype.setPin=function(s){this._pin=s},c.create=function(s){return p.ts.mobile.sdk.impl.PinInputImpl.create(s)},c.__tarsusInterfaceName="PinInput",c}(t.InputResponseType);t.PinInput=i}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){var u=function(c){function s(){return null!==c&&c.apply(this,arguments)||this}return V(s,c),s.create=function(n){var e=new s;return e.setPin(n),e},s}(t.PinInput);i.PinInputImpl=u}(t.impl||(t.impl={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){var u=function(c){function s(){return null!==c&&c.apply(this,arguments)||this}return V(s,c),s.createSuccessResponse=function(n){var e=new t.PlaceholderAuthSuccessResponse;return e.setPlaceholderToken(n),e},s.createdFailedResponse=function(n,e){var o=new t.PlaceholderAuthFailureResponse;return o.setFailureError(e),o.setExpired(n.getExpired()),o.setLocked(n.getLocked()),o.setRegistered(n.getRegistered()),o.setRegistrationStatus(n.getRegistrationStatus()),o},s.createFailedResponseWithServerProvidedStatus=function(n){var e=new t.PlaceholderAuthFailureWithServerProvidedStatusResponse;return e.setFailureError(n),e},s}(t.PlaceholderInputResponse);i.PlaceholderInputResponseImpl=u}(t.impl||(t.impl={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){var u=function(){};function c(r){return!!r.createContinuation}i.Continuation=u,i.IsResumableProcess=c;var s=function(){function r(h,f){this._ctxt=h}return Object.defineProperty(r.prototype,"rtContext",{get:function(){return this._ctxt},enumerable:!1,configurable:!0}),r.prototype.resume=function(h,f){return h instanceof o?(this._currentStep=h.currentStepContinuation.createResumableProcess(this),this.pumpSteps(this._currentStep.resume(h.currentStepContinuation,f))):Promise.reject("Attempt to resume a MultiStageResumableProcess with a bad continuation class.")},r.prototype.startWithStage=function(h){return this._currentStep=h,this.pumpSteps(h.run())},r.prototype.pumpSteps=function(h){var f=this;return h.then(function(g){return e(g)?(f._currentStep=g,f.pumpSteps(g.run())):g})},r}();i.MultiStageResumableProcess=s;var n=function(r){function h(){return null!==r&&r.apply(this,arguments)||this}return V(h,r),h}(u);function e(r){return c(r)&&r.run}i.ResumableProcessStageContinuation=n,i.IsResumableProcessStage=e;var o=function(r){function h(f){var g=r.call(this)||this;return f instanceof i.SerializationContext?g.serializeFrom(f):g._currentStepContinuation=f._currentStep.createContinuation(),g}return V(h,r),h.prototype.serializeTo=function(f){f.writeObject("currentStepContinuation",this._currentStepContinuation)},h.prototype.serializeFrom=function(f){this._currentStepContinuation=f.readNonNullObject("currentStepContinuation")},Object.defineProperty(h.prototype,"currentStepContinuation",{get:function(){return this._currentStepContinuation},enumerable:!1,configurable:!0}),h}(u);i.MultiStageResumableProcessContinuation=o}(t.core||(t.core={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){!function(u){var c=function(){function s(n,e){this._controlFlowProcessor=n,this._action=e,this._sdk=this._controlFlowProcessor._sdk,this._uiHandler=this._controlFlowProcessor._uiHandler,this._clientContext=this._controlFlowProcessor._clientContext}return s.prototype.cancelRun=function(){},s.prototype.policyAction=function(){return this._policyAction||(this._policyAction=t.impl.PolicyActionImpl.fromServerAction(this._controlFlowProcessor,this._action)),this._policyAction},s.prototype.processEscapeRequest=function(n){var e=this;return new Promise(function(o,r){var h=n.getEscapeOption().getId();e._sdk.log(t.LogLevel.Debug,function(){return"Processing escape reques "+h});for(var f=e._policyAction.getEscapeOptions(),g=!1,y=0;y<f.length;y++)if(f[y].getId()===h){g=!0;break}g?e.sendAssertionEscapeRequest(n).then(o,r):r(new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.AppImplementation,"Attempt to invoke an invalid escape option "+h))})},s.prototype.sendPollingRequest=function(n,e){var o=this._controlFlowProcessor.createPollingRequest(n,e);return t.util.wrapPromiseWithActivityIndicator(this._uiHandler,this.policyAction(),this._clientContext,this._controlFlowProcessor._session.performSessionExchange(o).then(function(r){return r.data}))},s.prototype.sendAssertionRequest=function(n,e,o){var r=this._controlFlowProcessor.createAssertionRequest(this._action,n,e,o);return t.util.wrapPromiseWithActivityIndicator(this._uiHandler,this.policyAction(),this._clientContext,this._controlFlowProcessor._session.performSessionExchange(r).then(function(h){if(!h.data)throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Communication,"Invalid response to assertion.",{responseBody:JSON.stringify(h)});return h.data}))},s.prototype.sendErrorReportAssertionRequest=function(n){return this.sendAssertionRequest("report_error",{client_error:n})},s.prototype.sendAssertionEscapeRequest=function(n){var e=this._controlFlowProcessor.createAssertionRequest(this._action,"escape",{escape_id:n.getEscapeOption().getId(),escape_params:n.getEscapeParameters()});return t.util.wrapPromiseWithActivityIndicator(this._uiHandler,this.policyAction(),this._clientContext,this._controlFlowProcessor._session.performSessionExchange(e).then(function(o){if(!o.data)throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Communication,"Invalid response to assertion.",{responseBody:JSON.stringify(o)});return o.data}))},s}();u.ActionDriver=c}(i.actiondrivers||(i.actiondrivers={}))}(t.core||(t.core={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){!function(u){var c=function(){};u.ResumableProcessActionDriverRuntimeContext=c;var s=function(e){function o(r){var h=e.call(this)||this;return r instanceof i.SerializationContext?h.serializeFrom(r):h._actionData=r,h}return V(o,e),o.prototype.serializeTo=function(r){r.writePrimitive("actionData",this._actionData)},o.prototype.serializeFrom=function(r){this._actionData=r.readPrimitive("actionData")},Object.defineProperty(o.prototype,"actionData",{get:function(){return this._actionData},enumerable:!1,configurable:!0}),o}(i.Continuation);u.ResumableProcessActionContinuation=s;var n=function(e){function o(r,h){return r instanceof c&&(r=r.controlFlowProcessor),h instanceof s&&(h=h.actionData),e.call(this,r,h)||this}return V(o,e),o}(u.ActionDriver);u.ResumableProcessActionDriver=n}(i.actiondrivers||(i.actiondrivers={}))}(t.core||(t.core={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={}));var z=Ne&&Ne.__decorate||function(p,d,l,t){var i,u=arguments.length,c=u<3?d:null===t?t=Object.getOwnPropertyDescriptor(d,l):t;if("object"===("undefined"==typeof Reflect?"undefined":De(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(p,d,l,t);else for(var s=p.length-1;s>=0;s--)(i=p[s])&&(c=(u<3?i(c):u>3?i(d,l,c):i(d,l))||c);return u>3&&c&&Object.defineProperty(d,l,c),c},$t=Ne&&Ne.__metadata||function(p,d){if("object"===("undefined"==typeof Reflect?"undefined":De(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(p,d)};(function(p){!function(d){!function(l){var t;!function(i){var u=function(){};i.ControlFlowProcessorRuntimeContext=u;var c=function(){function n(e,o,r,h,f){if(e instanceof i.SerializationContext)this.serializeFrom(e);else{if(!(o&&r&&void 0!==h&&f))throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Internal,"Invalid arguments passed to ControlFlowProcessorContinuation ctor");this._initiatingRequest=e,this._initialCflowResponse=o,this._controlFlow=r,this._currentControlFlowStep=h,this._actionContinuation=f.createContinuation()}}return Object.defineProperty(n.prototype,"initiatingRequest",{get:function(){return this._initiatingRequest},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"initialCflowResponse",{get:function(){return this._initialCflowResponse},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"controlFlow",{get:function(){return this._controlFlow},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"currentControlFlowStep",{get:function(){return this._currentControlFlowStep},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"actionContinuation",{get:function(){return this._actionContinuation},enumerable:!1,configurable:!0}),n.prototype.createResumableProcess=function(e){return new s(e)},n.prototype.serializeTo=function(e){e.writeObject("intiatingRequest",this._initiatingRequest),e.writePrimitive("initialCflowResponse",this._initialCflowResponse),e.writePrimitive("controlFlow",this._controlFlow),e.writePrimitive("currentControlFlowStep",this._currentControlFlowStep),e.writeObject("actionContinuation",this._actionContinuation)},n.prototype.serializeFrom=function(e){this._initiatingRequest=e.readObject(i.SessionExchangeRequest,"intiatingRequest"),this._initialCflowResponse=e.readPrimitive("initialCflowResponse"),this._controlFlow=e.readPrimitive("controlFlow"),this._currentControlFlowStep=e.readPrimitive("currentControlFlowStep"),this._actionContinuation=e.readNonNullObject("actionContinuation")},z([i.Serializable("ControlFlowProcessorContinuation"),$t("design:paramtypes",[Object,Object,Array,Number,i.actiondrivers.ResumableProcessActionDriver])],n)}(),s=function(){function n(e,o,r,h){if(this._cancelled=!1,!(e instanceof u)){var f=e;(e=new u).sdk=f,e.cflowRequestContext=h||null,e.clientContext=r,e.session=o,e.uiHandler=f.currentUiHandler}this._sdk=e.sdk,this._session=e.session,this._uiHandler=e.uiHandler,this._clientContext=e.clientContext,this._requestContext=e.cflowRequestContext}return n.findByClientContext=function(e){var o=n._allRunningControlFlows.filter(function(r){return r._clientContext==e});return o.length?o[0]:null},n.prototype.createContinuation=function(){if(this._cancelled)throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Internal,"Cannot create continuation for cancelled control flow");if(!this._currentActionDriver)throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Internal,"Cannot create continuation for control flow without current action");if(this._currentActionDriver instanceof i.actiondrivers.ResumableProcessActionDriver)return new c(this._initiatingRequest,this._initialCflowResponse,this._controlFlow,this._currentControlFlowStep,this._currentActionDriver);throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Internal,"Cannot create continuation for control flow running current action "+this._currentActionDriver._action.type)},Object.defineProperty(n.prototype,"sdk",{get:function(){return this._sdk},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"initiatingRequest",{get:function(){return this._initiatingRequest},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"requestContext",{get:function(){return this._requestContext},enumerable:!1,configurable:!0}),n.prototype.cancelFlow=function(){this._cancelled=!0,this._currentActionDriver&&this._currentActionDriver.cancelRun(),this._uiHandler.controlFlowCancelled(this._clientContext)},n.prototype.startControlFlow=function(e){var o,r=this;if(this._cancelled)return this.createExternalCancellationRejectionPromise();var h=null;return e instanceof i.SessionExchangeRequest?(h=e,o=t.util.wrapPromiseWithActivityIndicator(this._uiHandler,null,this._clientContext,this._session.performSessionExchange(e))):o=this._session.processInlineResponse(e),o.then(function(f){return r._initialCflowResponse=f.data,r._initiatingRequest=h,r.executeControlFlow(r._initialCflowResponse)})},n.prototype.resume=function(e,o){var r=this;return new Promise(function(h,f){if(!(e instanceof c))throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Internal,"Invalid continuation type provided to resume()");r._initiatingRequest=e.initiatingRequest,r._initialCflowResponse=e.initialCflowResponse,r._controlFlow=e.controlFlow,r._currentControlFlowStep=e.currentControlFlowStep;var g=new i.actiondrivers.ResumableProcessActionDriverRuntimeContext;g.controlFlowProcessor=r;var y=e.actionContinuation.createResumableProcess(g);r._currentActionDriver=y,y.resume(e.actionContinuation,o).then(function(A){return r.executeControlFlow(A)}).then(h,f)})},Object.defineProperty(n.prototype,"challenge",{get:function(){return this._initialCflowResponse&&this._initialCflowResponse.challenge||null},enumerable:!1,configurable:!0}),n.prototype.executeControlFlow=function(e){var o=this;return new Promise(function(r,h){n._allRunningControlFlows.push(o),o._uiHandler.controlFlowStarting(o._clientContext),o.processSingleStepExchange(e).then(function(f){return o._uiHandler.controlFlowEnded(null,o._clientContext),f},function(f){throw o._uiHandler.controlFlowEnded(f,o._clientContext),f}).finally(function(){var f=n._allRunningControlFlows.indexOf(o);n._allRunningControlFlows.splice(f,1)}).then(r,h)})},n.prototype.processSingleStepExchange=function(e){var o,r=this;return e.control_flow&&(this._controlFlow=e.control_flow,this._currentControlFlowStep=0,this._sdk.log(t.LogLevel.Debug,function(){return"Got ControlFlow with "+r._controlFlow.length+" steps."})),e.data&&e.data.json_data?(this._sdk.log(t.LogLevel.Debug,function(){return"Got a JSON data attachment on control flow response. Processing."}),o=i.actiondrivers.ActionDriverJsonData.handleJsonDataByUiHandler(this._uiHandler,e,e.data.json_data,null,this._clientContext)):o=Promise.resolve(e),o.then(function(h){switch(e.state){case i.Protocol.AuthSessionState.Pending:return r._sdk.log(t.LogLevel.Debug,function(){return"Execute step "+r._currentControlFlowStep+"."}),(f=r._controlFlow[r._currentControlFlowStep])?r._cancelled?r.createExternalCancellationRejectionPromise():r.promiseCancellableSingleActionProcessing(f).then(function(g){return r._currentControlFlowStep++,r.processSingleStepExchange(g)}):(r._sdk.log(t.LogLevel.Error,function(){return"Step "+r._currentControlFlowStep+" nonexisting."}),Promise.reject(new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Internal,"Session state is pending but no control flow.")));case i.Protocol.AuthSessionState.Rejected:r._sdk.log(t.LogLevel.Debug,function(){return"Handle control flow rejection."});var f=r._controlFlow&&r._controlFlow[r._currentControlFlowStep]||null;return r._uiHandler.handlePolicyRejection(e.rejection_data&&e.rejection_data.title||null,e.rejection_data&&e.rejection_data.text||null,e.rejection_data&&e.rejection_data.button_text||null,e.failure_data,f?t.impl.PolicyActionImpl.fromServerAction(r,f):t.impl.PolicyActionImpl.createPseudoAction(r._sdk,"rejection"),r._clientContext).then(function(g){throw-1!=g.getUserChoice()?new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.AppImplementation,"ConfirmationInput.getUserChoice must be set to -1."):t.impl.AuthenticationErrorImpl.errorForSessionRejectionFailureData(e.failure_data)});case i.Protocol.AuthSessionState.Completed:return r._sdk.log(t.LogLevel.Debug,function(){return"Handle control flow completion."}),Promise.resolve(t.impl.AuthenticationResultImpl.fromCflowServerResponse(e,r._session.deviceId()))}})},n.prototype.promiseCancellableSingleActionProcessing=function(e){var o=this,r=i.actiondrivers.ActionDrivers[e.type];if(!r)return Promise.reject(new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Internal,"Don't know how to handle action.",{actionType:e.type}));var h=new r(this,e);return this._currentActionDriver=h,this._uiHandler.controlFlowActionStarting(h.policyAction(),this._clientContext),h.run().then(function(f){return o._uiHandler.controlFlowActionEnded(null,h.policyAction(),o._clientContext),f},function(f){var g=t.impl.AuthenticationErrorImpl.augmentErrorData(f,{});throw g.setPublicProperty(t.AuthenticationErrorProperty.AuthenticationErrorFailingActionType,e.type),o._uiHandler.controlFlowActionEnded(g,h.policyAction(),o._clientContext),g}).finally(function(){o._currentActionDriver=null})},n.prototype.createAssertionRequest=function(e,o,r,h){var f;if(!this.challenge)throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Internal,"Attempt to create an assertion request without an initial control flow request.");var g={action:e.type,assert:o||"action",assertion_id:e.assertion_id,fch:this.challenge};if(r&&(g.data=r),h){var y=g;for(var A in h)y[A]=h[A]}return new i.SessionExchangeRequest("POST","auth/assert",g,[],null===(f=this.requestContext)||void 0===f?void 0:f.getFlowId())},n.prototype.createPollingRequest=function(e,o){var r,h={};return Object.keys(e).forEach(function(f){h[f]=e[f]}),h.polling_timeout=o,new i.SessionExchangeRequest("POST","auth/poll",h,[],null===(r=this.requestContext)||void 0===r?void 0:r.getFlowId())},n.prototype.createExternalCancellationRejectionPromise=function(){return Promise.reject(this.createExternalCancellationError())},n.prototype.createExternalCancellationError=function(){return new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.UserCanceled,"Operation cancelled by user.",{control_flow_external_cancellation:!0})},n.prototype.generateDebugPin=function(){var e=this;return new Promise(function(o,r){var h=new i.SessionExchangeRequest("POST","auth/create_debug_token",{},[]);e._session.performSessionExchange(h).then(function(f){return f.data.debug_pin}).then(o,r)})},n._allRunningControlFlows=[],n}();i.ControlFlowProcessor=s}((t=l.sdk||(l.sdk={})).core||(t.core={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))})(S||(S={})),function(p){!function(d){!function(l){var t,i,u;u=l.sdk||(l.sdk={}),t=u.impl||(u.impl={}),i=function(){function c(s,n,e,o,r,h){void 0===o&&(o=!1),void 0===r&&(r=null),void 0===h&&(h=null),this._isPseudoAction=!1,this._escapeOptions=[],this._actionType=n,this._isPseudoAction=o,this._actionLocalStrings=r,this._actionLocalStyles=h,this._uiContextImpl=new t.UIContextImpl(s,this._actionLocalStrings||void 0,this._actionLocalStyles),this._controlFlow=e}return c.prototype.getIsPseudoAction=function(){return this._isPseudoAction},c.prototype.getActionType=function(){return this._actionType},c.prototype.getAltLabel=function(){return""},c.prototype.getUiContext=function(){return this._uiContextImpl},c.prototype.getEscapeOptions=function(){return this._escapeOptions},c.prototype.escapeOptionById=function(s){var n=null;if(this._escapeOptions.forEach(function(e){e.getId()===s&&(n=e)}),!n)throw new t.AuthenticationErrorImpl(u.AuthenticationErrorCode.AppImplementation,"Invalid escape ID "+s+" for this action.");return n},Object.defineProperty(c.prototype,"controlFlow",{get:function(){return this._controlFlow},enumerable:!1,configurable:!0}),c.fromServerAction=function(s,n){var e=new c(s.sdk,n.type,s,!1,n.strings,n.styles);return n.escapes&&(e._escapeOptions=n.escapes.map(function(o){return new t.EscapeOptionImpl(o)})),e},c.createPseudoAction=function(s,n){return new c(s,n,null,!0)},c}(),t.PolicyActionImpl=i}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){var i=function(){function u(){}return u.prototype.getControlRequest=function(){return this._controlRequest},u.prototype.setControlRequest=function(c){this._controlRequest=c},u.prototype.getSelectedAuthenticator=function(){return this._selectedAuthenticator},u.prototype.setSelectedAuthenticator=function(c){this._selectedAuthenticator=c},u.prototype.getActionEscapeRequest=function(){return this._actionEscapeRequest},u.prototype.setActionEscapeRequest=function(c){this._actionEscapeRequest=c},u.createControlResponse=function(c){return p.ts.mobile.sdk.impl.PromotionInputImpl.createControlResponse(c)},u.createEscapeRequest=function(c,s){return p.ts.mobile.sdk.impl.PromotionInputImpl.createEscapeRequest(c,s)},u.createAuthenticatorDescription=function(c){return p.ts.mobile.sdk.impl.PromotionInputImpl.createAuthenticatorDescription(c)},u.__tarsusInterfaceName="PromotionInput",u}();t.PromotionInput=i}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){var u=function(c){function s(){return null!==c&&c.apply(this,arguments)||this}return V(s,c),s.prototype.isControlRequest=function(){return!(null==this._controlRequest)},s.createControlResponse=function(n){var e=new s;return e.setControlRequest(n),e},s.createAuthenticatorDescription=function(n){var e=new s;return e.setSelectedAuthenticator(n),e},s.createEscapeRequest=function(n,e){var o=new s;return o._actionEscapeRequest=new t.ActionEscapeRequest,o._actionEscapeRequest._escapeOption=n,o._actionEscapeRequest._escapeParameters=e,o},s}(t.PromotionInput);i.PromotionInputImpl=u}(t.impl||(t.impl={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){var i=function(){function u(){}return u.fromAssertionFormat=function(c){switch(c){case t.core.Protocol.QrCodeFormatType.Numeric:return t.QrCodeFormat.Numeric;case t.core.Protocol.QrCodeFormatType.Alphanumeric:return t.QrCodeFormat.Alphanumeric;case t.core.Protocol.QrCodeFormatType.Binary:return t.QrCodeFormat.Binary;default:throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Internal,"Invalid qr code format type encountered: "+c.type)}},u}();t.QrCodeFormatImpl=i}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){var i=function(){function u(){}return u.prototype.getQrCode=function(){return this._qrCode},u.prototype.getQrCodeFormat=function(){return this._qrCodeFormat},u.createQrCodeResult=function(c,s){return p.ts.mobile.sdk.impl.QrCodeResultImpl.createQrCodeResult(c,s)},u.__tarsusInterfaceName="QrCodeResult",u}();t.QrCodeResult=i}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){var u=function(c){function s(){return null!==c&&c.apply(this,arguments)||this}return V(s,c),s.createQrCodeResult=function(n,e){var o=new s;return o._qrCode=n,o._qrCodeFormat=e,o},s}(t.QrCodeResult);i.QrCodeResultImpl=u}(t.impl||(t.impl={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){var i=function(){function u(){}return u.prototype.getRedirectResponse=function(){return this._redirectResponse},u.prototype.setRedirectResponse=function(c){this._redirectResponse=c},u.prototype.getAdditionalParametersOverride=function(){return this._additionalParametersOverride},u.prototype.setAdditionalParametersOverride=function(c){this._additionalParametersOverride=c},u.create=function(c){return p.ts.mobile.sdk.impl.RedirectInputImpl.create(c)},u.__tarsusInterfaceName="RedirectInput",u}();t.RedirectInput=i}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){var u=function(c){function s(){return null!==c&&c.apply(this,arguments)||this}return V(s,c),s.create=function(n){var e=new s;return e.setRedirectResponse(n),e},s}(t.RedirectInput);i.RedirectInputImpl=u}(t.impl||(t.impl={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){var i=function(){function u(){}return u.prototype.getServerAddress=function(){return this._serverAddress},u.prototype.setServerAddress=function(c){this._serverAddress=c},u.prototype.getRealm=function(){return this._realm},u.prototype.setRealm=function(c){this._realm=c},u.prototype.getAppId=function(){return this._appId},u.prototype.setAppId=function(c){this._appId=c},u.prototype.getTokenName=function(){return this._tokenName},u.prototype.setTokenName=function(c){this._tokenName=c},u.prototype.getToken=function(){return this._token},u.prototype.setToken=function(c){this._token=c},u.prototype.getCryptoMode=function(){return this._cryptoMode},u.prototype.setCryptoMode=function(c){this._cryptoMode=c},u.create=function(c,s,n,e){return p.ts.mobile.sdk.impl.SDKConnectionSettingsImpl.create(c,s,n,e)},u.createWithCryptoMode=function(c,s,n,e,o){return p.ts.mobile.sdk.impl.SDKConnectionSettingsImpl.createWithCryptoMode(c,s,n,e,o)},u.__tarsusInterfaceName="SDKConnectionSettings",u}();t.SDKConnectionSettings=i}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){var u=function(c){function s(){return null!==c&&c.apply(this,arguments)||this}return V(s,c),s.create=function(n,e,o,r){return this.createWithCryptoMode(n,e,o,r,t.ConnectionCryptoMode.None)},s.createWithCryptoMode=function(n,e,o,r,h){var f=new s;return f.setServerAddress(n),f.setAppId(e),f.setTokenName(o),f.setToken(r),f.setCryptoMode(h),f},s.prototype.setSendFlowIdAsHttpHeader=function(n){this.sendFlowIdAsHttpHeader=n},s.prototype.shouldSendFlowIdAsHttpHeader=function(){return this.sendFlowIdAsHttpHeader},s}(t.SDKConnectionSettings);i.SDKConnectionSettingsImpl=u}(t.impl||(t.impl={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){var i=function(u){function c(){return null!==u&&u.apply(this,arguments)||this}return V(c,u),c.prototype.getQrCodeResult=function(){return this._qrCodeResult},c.prototype.setQrCodeResult=function(s){this._qrCodeResult=s},c.createScanQrCodeInput=function(s){return p.ts.mobile.sdk.impl.ScanQrCodeInputImpl.createScanQrCodeInput(s)},c.__tarsusInterfaceName="ScanQrCodeInput",c}(t.InputResponseType);t.ScanQrCodeInput=i}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){var u=function(c){function s(){return null!==c&&c.apply(this,arguments)||this}return V(s,c),s.createScanQrCodeInput=function(n){var e=new s;return e.setQrCodeResult(n),e},s}(t.ScanQrCodeInput);i.ScanQrCodeInputImpl=u}(t.impl||(t.impl={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){var u=function(c){function s(){return null!==c&&c.apply(this,arguments)||this}return V(s,c),s.createAnswerToQuestion=function(n,e){var o=new s;return o._question=n,o._answer=e,o._isRemoved=!1,o},s.createAnswerRemovalRequest=function(n){var e=new s;return e._question=n,e._isRemoved=!0,e},s}(t.SecurityQuestionAndAnswer);i.SecurityQuestionAndAnswerImpl=u}(t.impl||(t.impl={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){var u=function(c){function s(){return null!==c&&c.apply(this,arguments)||this}return V(s,c),s.createWithText=function(n){var e=new s;return e._answerText=n,e},s}(t.SecurityQuestionAnswer);i.SecurityQuestionAnswerImpl=u}(t.impl||(t.impl={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){var u=function(){function c(s,n,e){this._id=s,this._text=n,this._registered=e}return c.prototype.getSecurityQuestionId=function(){return this._id},c.prototype.getSecurityQuestionText=function(){return this._text},c.prototype.getAnswered=function(){return this._registered},c.__tarsusInterfaceName="SecurityQuestion",c}();i.SecurityQuestionImpl=u}(t.impl||(t.impl={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){var u=function(c){function s(){return null!==c&&c.apply(this,arguments)||this}return V(s,c),s.createSecurityQuestionAnswersInputResponse=function(n){var e=new t.SecurityQuestionAnswersInputResponse;return e._answers=n,e},s}(t.SecurityQuestionInputResponse);i.SecurityQuestionInputResponseImpl=u}(t.impl||(t.impl={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){var u=function(){function c(){}return c.prototype.getStepTag=function(){return"question"},c.prototype.getSecurityQuestions=function(){return this._securityQuestions},c.prototype.getMinAnswersNeeded=function(){return this._minAnswers},c.prototype.getMaxAnswerLength=function(){return this._maxAnswerLength},c.prototype.getMinAnswerLength=function(){return this._minAnswerLength},c.createForAuthQuestion=function(s){var n=new c;return n._minAnswers=1,n._securityQuestions=[s],n._maxAnswerLength=-1,n._minAnswerLength=-1,n},c.createForRegistrationQuestions=function(s,n,e,o){var r=new c;return r._minAnswers=n,r._securityQuestions=s,r._maxAnswerLength=e,r._minAnswerLength=o,r},c.__tarsusInterfaceName="SecurityQuestionStepDescription",c}();i.SecurityQuestionStepDescriptionImpl=u}(t.impl||(t.impl={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){var d="undefined"!=typeof window?window:d;d.com=p}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){var u=function(){function c(s){this._hex=s.hex||"",s.alpha&&(this._hex=this._hex.slice(0,1)+this.convertAlpha(s.alpha)+this._hex.slice(1))}return c.prototype.getHexValue=function(){return this._hex},c.prototype.convertAlpha=function(s){return Math.ceil(255*s).toString(16)},c}();i.TSColorImpl=u}(t.impl||(t.impl={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){var u=function(c){function s(n,e){var o=c.call(this)||this;return e&&(o._selectedTargets=e),n&&(o._authenticatorInput=n),o}return V(s,c),s.createAuthenticatorInput=function(n){return new s(n,null)},s.createTargetSelectionRequest=function(n){return new s(null,[n])},s.createTargetsSelectionRequest=function(n){return new s(null,n)},s}(t.TargetBasedAuthenticatorInput);i.TargetBasedAuthenticatorInputImpl=u}(t.impl||(t.impl={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){var i=function(){function u(c,s,n,e,o,r,h){this._deviceId=c,this._model=t.core.DeviceModelConverter.getDeviceModel(s,o),this._isCurrentDevice=e,this._osType=t.core.DeviceModelConverter.getOsName(o),this._osVersion=r,this._lastAccessed=n,this._alias=h}return u.prototype.getDeviceId=function(){return this._deviceId},u.prototype.getModel=function(){return this._model},u.prototype.getLastAccessed=function(){return this._lastAccessed},u.prototype.getIsCurrent=function(){return this._isCurrentDevice},u.prototype.getOsType=function(){return this._osType},u.prototype.getOsVersion=function(){return this._osVersion},u.prototype.getAlias=function(){return this._alias},u.prototype.describe=function(){var c=new Date(this._lastAccessed).toLocaleDateString();return(this._alias?this._alias+" : ":"")+this._model+" last accessed on "+c},u.fromServerFormat=function(c){return new u(c.device_id,c.model,c.last_access,c.current_device,c.os_type,c.os_version,c.alias||null)},u}();t.TargetDeviceDetailsImpl=i}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){var i=function(u){function c(){return null!==u&&u.apply(this,arguments)||this}return V(c,u),c.createPollRequest=function(){return p.ts.mobile.sdk.impl.TicketWaitInputImpl.createPollRequest()},c.createLongPollRequest=function(s){return p.ts.mobile.sdk.impl.TicketWaitInputImpl.createLongPollRequest(s)},c.__tarsusInterfaceName="TicketWaitInput",c}(t.InputResponseType);t.TicketWaitInput=i}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){var i=function(u){function c(){return null!==u&&u.apply(this,arguments)||this}return V(c,u),c.prototype.getPollingTimeout=function(){return this._pollingTimeout},c.prototype.setPollingTimeout=function(s){this._pollingTimeout=s},c.__tarsusInterfaceName="TicketWaitInputPollRequest",c}(t.TicketWaitInput);t.TicketWaitInputPollRequest=i}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){var u=function(s){function n(){return null!==s&&s.apply(this,arguments)||this}return V(n,s),n.createPollRequest=function(){var e=new c;return e.setPollingTimeout(0),e},n.createLongPollRequest=function(e){var o=new c;return o.setPollingTimeout(e),o},n}(t.TicketWaitInput);i.TicketWaitInputImpl=u;var c=function(s){function n(){return null!==s&&s.apply(this,arguments)||this}return V(n,s),n.__tarsusInterfaceName="TicketWaitInputPollRequest",n}(t.TicketWaitInputPollRequest);i.TicketWaitInputPollRequestImpl=c}(t.impl||(t.impl={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){i[i.Qr=0]="Qr",i[i.Alphanumeric=1]="Alphanumeric"}(t.TicketIdFormat||(t.TicketIdFormat={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){var u=function(){function s(n){this._ticketId=n}return s.prototype.getFormat=function(){return this._ticketId.format===t.core.Protocol.TicketIdFormatType.Alphanumeric?t.TicketIdFormat.Alphanumeric:t.TicketIdFormat.Qr},s.prototype.getValue=function(){return this._ticketId.value},s.prototype.getValueAltRepresentation=function(){return this._ticketId.alt},s}();i.TicketIdImpl=u;var c=function(){function s(n){this._title=n.title,this._text=n.text,this._ticketId=n.ticket_id?new u(n.ticket_id):null}return s.prototype.getTitle=function(){return this._title},s.prototype.getText=function(){return this._text},s.prototype.getTicketId=function(){return this._ticketId},s}();i.TicketWaitingInformationImpl=c}(t.impl||(t.impl={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){var i=function(){function e(){}return e.fromAssertionFormat=function(o){switch(o.type){case t.core.Protocol.TotpChallengeFormatType.Numeric:return new c;case t.core.Protocol.TotpChallengeFormatType.QrCode:return new n;case t.core.Protocol.TotpChallengeFormatType.AlphaNumeric:return new u;default:throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Internal,"Invalid format type encountered: "+o.type)}},e}();t.TotpChallengeFormatImpl=i;var u=function(){function e(){}return e.prototype.getType=function(){return s.AlphaNumeric},e.__tarsusInterfaceName="TotpChallengeFormatAlphaNumeric",e}();t.TotpChallengeFormatAlphaNumericImpl=u;var c=function(){function e(){}return e.prototype.getType=function(){return s.Numeric},e.__tarsusInterfaceName="TotpChallengeFormatNumeric",e}();t.TotpChallengeFormatNumericImpl=c;var s,e,n=function(){function e(){}return e.prototype.getType=function(){return s.QrCode},e.__tarsusInterfaceName="TotpChallengeFormatQr",e}();t.TotpChallengeFormatQrImpl=n,(e=s=t.TotpChallengeFormatType||(t.TotpChallengeFormatType={}))[e.AlphaNumeric=0]="AlphaNumeric",e[e.Numeric=1]="Numeric",e[e.QrCode=2]="QrCode"}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){var i=function(u){function c(){return null!==u&&u.apply(this,arguments)||this}return V(c,u),c.prototype.getChallenge=function(){return this._challenge},c.prototype.setChallenge=function(s){this._challenge=s},c.create=function(s){return p.ts.mobile.sdk.impl.TotpChallengeInputImpl.create(s)},c.__tarsusInterfaceName="TotpChallengeInput",c}(t.InputResponseType);t.TotpChallengeInput=i}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){var u=function(c){function s(){return null!==c&&c.apply(this,arguments)||this}return V(s,c),s.create=function(n){var e=new s;return e.setChallenge(n),e},s}(t.TotpChallengeInput);i.TotpChallengeInputImpl=u}(t.impl||(t.impl={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){var u=function(){function c(){}return c.createTotpGenerationRequest=function(s,n,e){var o=new c;return o.setUserId(s.userHandle),o.setChallenge(n),o.setGeneratorName(e),o},c.prototype.getChallenge=function(){return this._challenge},c.prototype.getGeneratorName=function(){return this._generatorName},c.prototype.setGeneratorName=function(s){this._generatorName=s},c.prototype.setChallenge=function(s){this._challenge=s},c.prototype.setUserId=function(s){this._userId=s},c.prototype.getUserId=function(){return this._userId},c.prototype.setUserHandleType=function(s){this._userHandleType=s},c.prototype.getUserHandleType=function(){return this._userHandleType},c}();i.TotpGenerationRequestImpl=u}(t.impl||(t.impl={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){var i=function(u){function c(){return null!==u&&u.apply(this,arguments)||this}return V(c,u),c.__tarsusInterfaceName="TotpInput",c}(t.InputResponseType);t.TotpInput=i}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){var i=function(u){function c(){return null!==u&&u.apply(this,arguments)||this}return V(c,u),c.prototype.getCode=function(){return this._code},c.prototype.setCode=function(s){this._code=s},c.createTotpCodeSubmission=function(s){return p.ts.mobile.sdk.impl.TotpInputCodeSubmissionImpl.createTotpCodeSubmission(s)},c.__tarsusInterfaceName="TotpInputCodeSubmission",c}(t.TotpInput);t.TotpInputCodeSubmission=i}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){var u=function(c){function s(){return null!==c&&c.apply(this,arguments)||this}return V(s,c),s.createTotpCodeSubmission=function(n){var e=new s;return e.setCode(n),e},s}(t.TotpInputCodeSubmission);i.TotpInputCodeSubmissionImpl=u}(t.impl||(t.impl={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){var u=function(){function c(){}return c.createEscapeRequest=function(s){var n=new t.TotpProvisionEscapeRequest;return n.setEscapeRequest(s),n},c}();i.TotpProvisionResultImpl=u}(t.impl||(t.impl={}))}(l.tarsusplugin||(l.tarsusplugin={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={}));var Wt=Ne&&Ne.__spreadArrays||function(){for(var p=0,d=0,l=arguments.length;d<l;d++)p+=arguments[d].length;var t=Array(p),i=0;for(d=0;d<l;d++)for(var u=arguments[d],c=0,s=u.length;c<s;c++,i++)t[i]=u[c];return t};(function(p){!function(d){!function(l){!function(t){!function(i){var u=function(){function s(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];this._components=n}return s.prototype.toString=function(){return this._components.map(function(n){return n.replace(/([\\.])/g,function(e){return"\\"+("."==e?"p":e)})}).join(".")},s.fromString=function(n){return new(s.bind.apply(s,Wt([void 0],n.split("."))))},s.prototype.concat=function(n){return new(s.bind.apply(s,Wt([void 0],this._components.concat(n._components))))},s.prototype.component=function(n){return this._components[n]},s}();i.TarsusKeyPath=u;var c=function(){function s(n){this._host=n}return s.prototype.readStorageKey=function(n){return this._host.readStorageKey(n.toString())},s.prototype.writeStorageKey=function(n,e){this._host.writeStorageKey(n.toString(),e)},s.prototype.deleteStorageKey=function(n){this._host.deleteStorageKey(n.toString())},s.prototype.readSessionStorageKey=function(n){return this._host.readSessionStorageKey(n.toString())},s.prototype.writeSessionStorageKey=function(n,e){this._host.writeSessionStorageKey(n.toString(),e)},s.prototype.deleteSessionStorageKey=function(n){this._host.deleteSessionStorageKey(n.toString())},s.prototype.generateKeyPair=function(n,e,o,r){return this._host.generateKeyPair(n.toString(),e,o,r)},s.prototype.generateKeyPairExternalRepresentation=function(n){return this._host.generateKeyPairExternalRepresentation(n)},s.prototype.generateHexSeededKeyPairExternalRepresentation=function(n,e,o,r){return this._host.generateHexSeededKeyPairExternalRepresentation(n,e,o,r)},s.prototype.getKeyPair=function(n,e,o){return this._host.getKeyPair(n.toString(),e,o)},s.prototype.deleteKeyPair=function(n){this._host.deleteKeyPair(n.toString())},s.prototype.importVolatileSymmetricKey=function(n,e){return this._host.importVolatileSymmetricKey(n,e)},s.prototype.importVolatileKeyPair=function(n,e){return this._host.importVolatileKeyPair(n,e)},s.prototype.importVolatileKeyPairFromPublicKeyHex=function(n,e){return this._host.importVolatileKeyPairFromPublicKeyHex(n,e)},s.prototype.generatePbkdf2HmacSha1HexString=function(n,e,o,r){return this._host.generatePbkdf2HmacSha1HexString(n,e,o,r)},s.prototype.calcHexStringEncodedSha256Hash=function(n){return this._host.calcHexStringEncodedSha256Hash(n)},s.prototype.calcHexStringEncodedSha512Hash=function(n){return this._host.calcHexStringEncodedSha512Hash(n)},s.prototype.generateRandomHexString=function(n){return this._host.generateRandomHexString(n)},s.prototype.queryHostInfo=function(n){return this._host.queryHostInfo(n)},s.prototype.queryAsyncHostInfo=function(n){return this._host.queryAsyncHostInfo(n)},s.prototype.calcHexStringEncodedHmacSha1HashWithHexEncodedKey=function(n,e){return this._host.calcHexStringEncodedHmacSha1HashWithHexEncodedKey(n,e)},s.prototype.getCurrentTime=function(){return this._host.getCurrentTime()},s.prototype.createDelayedPromise=function(n){return this._host.createDelayedPromise(n)},s.prototype.fidoClientXact=function(n,e,o,r){return this._host.fidoClientXact(n,e,o,r)},s.prototype.fido2CredentialsOp=function(n,e,o,r,h){return this._host.fido2CredentialsOp(n,e,o,r,h)},s.prototype.dyadicEnroll=function(n,e){return this._host.dyadicEnroll(n,e)},s.prototype.dyadicSign=function(n,e){return this._host.dyadicSign(n,e)},s.prototype.dyadicDelete=function(n){return this._host.dyadicDelete(n)},s.prototype.dyadicRefreshToken=function(n){return this._host.dyadicRefreshToken(n)},s.prototype.log=function(n,e,o){return this._host.log(n,e,o)},s.prototype.setDebugIndicatorVisible=function(n){this._host.setDebugIndicatorVisible(n)},s.prototype.getUIStyles=function(){return this._host.getUIStyles()},s.prototype.getString=function(n,e){return this._host.getString(n,e)},s.prototype.loadPlugin=function(n){return this._host.loadPlugin(n)},s}();i.TarsusHostServices=c}(t.core||(t.core={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))})(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){var u=function(){function c(s){this._strings=s}return Object.defineProperty(c.prototype,"strings",{get:function(){return this._strings},enumerable:!1,configurable:!0}),c.prototype.getString=function(s){return this._strings?this._strings[s]:null},c}();i.ClientStrings=u}(t.core||(t.core={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){var t,i,u;t=(u=l.sdk||(l.sdk={})).impl||(u.impl={}),i=function(){function c(s,n,e){this._sdk=s,this._contextLocalStrings=n||null,this._contextStylesheetJson=e||null}return c.prototype.getString=function(s){return this.internalFormatString(s,null)},c.prototype.formatString=function(s,n){return this.internalFormatString(s,n)},c.prototype.internalFormatString=function(s,n){var e;return null==(e=this.resolveStringKey(s))?s:n&&n.length>0?this.format(e,n):e},c.prototype.resolveStringKey=function(s){var n;if(null!=(n=this._contextLocalStrings&&this._contextLocalStrings[s]))return n;var e=this._sdk.uiAssetsData;return e?e.getString(s):(this._sdk.log(u.LogLevel.Warning,function(){return"Attempt to get string value without initialized asset data."}),null)},c.prototype.format=function(s,n){var e=this,o=s;return o&&(o=o.replace(/%(\d+)\$s/g,function(r,h){return e.stringForIndex(+h-1,n,r)})),o},c.prototype.stringForIndex=function(s,n,e){return s>=0&&s<n.length?n[s]:e},c.prototype.getStyle=function(s){return this._contextStylesheet||(this._contextStylesheet=this._contextStylesheetJson?this._sdk.uiAssetsData.getUiStylesheetsWithOverrides(this._contextStylesheetJson):this._sdk.uiAssetsData.uiStylesheets),this._contextStylesheet.getMatchingStyle(s)},c}(),t.UIContextImpl=i}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){var i=new t.core.TarsusKeyPath("currentSession"),u=new t.core.TarsusKeyPath("continuations","default_cflow"),c=(new t.core.TarsusKeyPath("flow_id"),function(){function n(){this.mandatoryCollectors=[t.CollectorType.DeviceDetails,t.CollectorType.ExternalSDKDetails,t.CollectorType.HWAuthenticators,t.CollectorType.LocalEnrollments,t.CollectorType.Capabilities,t.CollectorType.DeviceFingerprint],this.mandatoryCollectorsForAnonymous=[t.CollectorType.DeviceDetails],this.uiAssetsDownloadMode=t.UIAssetsDownloadMode.DownloadOnInit,this._wasLocaleSet=!1}return n.prototype.pushRequestPayloadFromJSON=function(e){var o=e.push_type;switch(o){case"otp_notification":return t.impl.OtpPushRequestPayloadImpl.createWithJsonPayload(e);case"approval":return t.impl.MobileApprovePushRequestPayloadImpl.createWithJsonPayload(e)}throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.AppImplementation,"Payload with type "+o+" isn't recognized")},Object.defineProperty(n.prototype,"apiLevel",{get:function(){if(null==this._apiLevel)throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Internal,"Attempt to access uninitialized API level");return this._apiLevel},enumerable:!1,configurable:!0}),n.prototype.setTarsusHost=function(e){this._nativeHost=e,this.host=new t.core.TarsusHostServices(e),this.setLogLevel(t.LogLevel.Debug),this.pluginManager=new t.core.TarsusPluginManager(this),this.enabledCollectors=[t.CollectorType.Accounts,t.CollectorType.DeviceDetails,t.CollectorType.Contacts,t.CollectorType.Owner,t.CollectorType.Software,t.CollectorType.Location,t.CollectorType.Bluetooth,t.CollectorType.ExternalSDKDetails,t.CollectorType.HWAuthenticators,t.CollectorType.FidoAuthenticators,t.CollectorType.Capabilities,t.CollectorType.LargeData,t.CollectorType.LocalEnrollments,t.CollectorType.DeviceFingerprint,t.CollectorType.AppPermissions],this._enabledCollectorsAnonymous=null,this.currentPersistUserData=!0},Object.defineProperty(n.prototype,"fidoClient",{get:function(){return this._fidoClient||(this._fidoClient=new t.core.fidoclient.TarsusFidoClient(this)),this._fidoClient},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"enabledCollectorsAnonymous",{get:function(){return null==this._enabledCollectorsAnonymous?this.apiLevel<11?(this.log(t.LogLevel.Debug,function(){return"enabledCollectorsAnonymous() returning regular collectors"}),this.enabledCollectors):(this.log(t.LogLevel.Debug,function(){return"enabledCollectorsAnonymous() returning mandatory collectors for anonymous only"}),this.mandatoryCollectorsForAnonymous):(this.log(t.LogLevel.Debug,function(){return"enabledCollectorsAnonymous() returning collectors set by the customer"}),this._enabledCollectorsAnonymous)},enumerable:!1,configurable:!0}),n.prototype.setUiAssetsDownloadMode=function(e){this.uiAssetsDownloadMode=e},n.prototype.setLocale=function(e){var o=this;return this.log(t.LogLevel.Debug,function(){return"Start setLocale with locale "+e}),e&&""!=e&&(this._wasLocaleSet=!0,(this.uiAssetsData&&this.uiAssetsData.locale)!=e||this.uiAssetsData.isServerClientStringsEmpty())?(this.log(t.LogLevel.Debug,function(){return"Updating locale to "+e}),this.uiAssetsDownloadMode!==t.UIAssetsDownloadMode.Disable?this.loadUiAssetsFromServer(e).then(function(r){return Promise.resolve(r)}).catch(function(r){return o.log(t.LogLevel.Warning,function(){return"Error loading locale from server; using empty locale "+e}),o.uiAssetsData=new t.core.UIAssetsData(o,e),Promise.reject(t.impl.AuthenticationErrorImpl.ensureAuthenticationError(r))}):(this.uiAssetsData=new t.core.UIAssetsData(this,e),Promise.resolve(!0))):Promise.resolve(!1)},n.prototype.setConnectionSettings=function(e){this.connectionSettings=e},n.prototype.setClientCryptoSettings=function(e){this.cryptoSettings=e},n.prototype.setEnabledCollectors=function(e){this.enabledCollectors=e,this.addMandatoryCollectorsIfNeeded()},n.prototype.setEnabledCollectorsForAnonymousJourneys=function(e){this.log(t.LogLevel.Debug,function(){return"Overriding collectors for anonymous"}),this._enabledCollectorsAnonymous=e,this.addMandatoryCollectorsForAnonymousIfNeeded()},n.prototype.setLogLevel=function(e){this._logLevel=e,this._nativeHost.setLogLevel(this._logLevel)},n.prototype.setExternalLogger=function(e){this._nativeHost.setExternalLogger(e)},n.prototype.setTransportProvider=function(e){this.transportProvider=e},n.prototype.setUiHandler=function(e){this.currentUiHandler=e},n.prototype.setPushToken=function(e){this._lastReceivedPushToken=e},n.prototype.setPersistUserData=function(e){this.currentPersistUserData=e},n.prototype.setInvalidUserRecordRecoveryMode=function(e){if(null!=this.invalidUserRecoveryMode&&this.invalidUserRecoveryMode!=e)throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.AppImplementation,"Duplicate invocation of setInvalidUserRecordRecoveryMode.");this.invalidUserRecoveryMode=e},n.prototype.setClientApiLevel=function(e){if(null!=this._apiLevel&&this._apiLevel!=e)throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.AppImplementation,"Duplicate invocation of setClientApiLevel.");if(e>p.ts.mobile.sdk.core.API_LEVEL)throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.AppImplementation,"This SDK does not support API level "+this.apiLevel+".");this._apiLevel=e},Object.defineProperty(n.prototype,"currentSession",{get:function(){return this._currentSession},enumerable:!1,configurable:!0}),n.prototype.installPlugin=function(e,o){this.pluginManager.installPlugin(e,o)},n.prototype.initialize=function(){var e=this;return new Promise(function(o,r){if(!e.host)throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.AppImplementation,"Attempt to initialize SDK without host.");if(!e.connectionSettings)throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.AppImplementation,"Attempt to initialize SDK without connection settings.");if(!e.transportProvider)throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.AppImplementation,"Attempt to initialize SDK without transport provider.");e.cryptoSettings||(e.cryptoSettings=t.ClientCryptoSettings.create(1e4)),e.applyConfigurationDefaultsAndLogConfiguration(),e._nativeHost.initialize(e.allCollectorsSet()).then(function(h){var f=null;if(!e._wasLocaleSet){var g=e._nativeHost.getPreferredLocale(),y=e.getFullLocale(g);e.uiAssetsDownloadMode===t.UIAssetsDownloadMode.DownloadOnInit?f=e.setLocale(y).catch(function(){return!1}):e.uiAssetsData=new t.core.UIAssetsData(e,y)}return f=f||Promise.resolve(!0),Promise.all([e.pluginManager.initializePlugins(),f]).then(function(){var A=e.host.readSessionStorageKey(i);if(A){e.log(t.LogLevel.Info,function(){return"Loading existing session from session store"});try{e._currentSession=t.core.Session.fromJson(e,A),e.log(t.LogLevel.Debug,function(){return"Loaded existing session for user "+(e._currentSession.user&&e._currentSession.user.displayName)})}catch(T){e.log(t.LogLevel.Warning,function(){return"Failed to load existing session from session store. Discarding existing session "+T+"."})}}return!0})}).then(o,r)}).catch(function(o){return Promise.reject(t.impl.AuthenticationErrorImpl.ensureAuthenticationError(o))})},n.prototype.getUsersInfo=function(){var e=[];return t.core.User.iterateUsers(this,function(o){e.push(t.impl.UserInfoImpl.createWithUser(o))}),e},n.prototype.getUserInfo=function(e){var o=t.core.User.findUser(this,e);if(!o)throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.UserNotFound,"Attempt to call getUserInfo with a non existing user.");return t.impl.UserInfoImpl.createWithUser(o)},n.prototype.isBoundForUser=function(e){var o=t.core.User.findUser(this,e);return!(!o||!o.deviceBound)},n.prototype.getBoundUserIds=function(){var e=[];return t.core.User.iterateUsers(this,function(o){o.userId&&o.deviceBound&&e.push(o.userId)}),e},n.prototype.getKnownUserIds=function(){var e=[];return t.core.User.iterateUsers(this,function(o){o.userId&&(o.hasLoggedIn||o.deviceBound)&&e.push(o.userId)}),e},n.prototype.logout=function(){var e=this;return new Promise(function(o,r){if(e._currentSession)if(e._currentSession.canTerminate()){var h,f=e._currentSession.createLogoutRequest(),g=e._currentSession;e._currentSession=null,e.saveCurrentSession(),g.invalidated?(e.log(t.LogLevel.Info,function(){return"Logging out with an invalidated session; not issuing server request."}),h=Promise.resolve(!0)):h=g.performSessionExchange(f).then(function(y){return Promise.resolve(!0)}),h.then(function(y){return t.core.Session.notifySessionObserversOnMainSessionLogout(g),y}).then(o,r)}else r(new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.AppImplementation,"Attempt to logout with a locked session."));else r(new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.AppImplementation,"No logged in user."))}).catch(function(o){return Promise.reject(t.impl.AuthenticationErrorImpl.ensureAuthenticationError(o))})},n.prototype.isTotpProvisionedForUser=function(e,o){var r=t.core.User.findUser(this,e);if(!r)return this.log(t.LogLevel.Error,function(){return"Can not find user record for <"+e+">"}),!1;var h=new t.core.LocalSession(this,r);return t.core.totp.TotpPropertiesProcessor.createWithUserWithoutUIInteraction(r,this,h).isTotpProvisionedForGenerator(o||t.core.totp.TotpPropertiesProcessor.BACKWARD_COMPATIBILITY_DEFAULT_GENERATOR)},n.prototype.getVersionInfo=function(){return this._versionInfo||(this._versionInfo=new t.impl.VersionInfoImpl(this.host.queryHostInfo(l.sdkhost.HostInformationKey.Platform),this.host.queryHostInfo(l.sdkhost.HostInformationKey.Version))),this._versionInfo},n.prototype.resolveUserForBind=function(e){var o=t.core.User.findUser(this,e);return o||(this.log(t.LogLevel.Debug,function(){return"bind: Creating new user "+e}),o=t.core.User.createUserWithUserId(this,e)),o},n.prototype.resumableControlFlowRequestRuntimeContext=function(e){var o=this;return{clientContext:e,sdk:this,sdkSessionManagementServices:new(function(){function r(){}return r.prototype.setCurrentSession=function(h){o._currentSession=h},Object.defineProperty(r.prototype,"lastReceivedPushToken",{get:function(){return o._lastReceivedPushToken},enumerable:!1,configurable:!0}),r.prototype.saveCurrentSession=function(){o.saveCurrentSession()},r}()),uiHandler:this.currentUiHandler}},n.prototype.internalBind=function(e,o,r,h){return this.log(t.LogLevel.Debug,function(){return"Bind for user "+(e.userId||e.idToken)}),new t.core.BindControlFlowRequest(this.resumableControlFlowRequestRuntimeContext(r),this.getOrGenerateFlowId(h)).run(e,o)},n.prototype.bind=function(e,o,r){return this.bindWithOptions(e,o,r,null)},n.prototype.bindWithOptions=function(e,o,r,h){var f=this;return new Promise(function(g,y){var A=f.resolveUserForBind(e);return f.internalBind(A,o,r,h).then(g,y)}).catch(function(g){return Promise.reject(t.impl.AuthenticationErrorImpl.ensureAuthenticationError(g))})},n.prototype.deviceSupportsCryptoBinding=function(){return"true"==this.host.queryHostInfo(l.sdkhost.HostInformationKey.PersistentKeysSupported)},n.prototype.resolveUserForAuthenticate=function(e,o){var r=t.core.User.findUserWithType(this,e,o);if(!r){if(o!==t.UserHandleType.UserId)throw o===t.UserHandleType.IdToken?new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.AppImplementation,"Attempt to authenticate with ID Token that is not provisioned on this device.",{uid_token:e}):new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Internal,"Unsupported user handle type",{user_handle_type:o});this.log(t.LogLevel.Debug,function(){return"authenticate: Creating new user "+e}),r=t.core.User.createUserWithUserId(this,e)}return r},n.prototype.internalAuthenticate=function(e,o,r,h,f){var g=this;return this.log(t.LogLevel.Debug,function(){return"Authenticate for user "+(e.userId||e.idToken)+" with policy "+o}),new t.core.AuthenticateControlFlowRequest(this.resumableControlFlowRequestRuntimeContext(h),this.getOrGenerateFlowId(f)).run(e,o,r).catch(function(y){return g.applyInvalidUserRecordRecovery(e.userHandle,t.impl.AuthenticationErrorImpl.ensureAuthenticationError(y))})},n.prototype.authenticate=function(e,o,r,h){return this.authenticateWithOptions(e,o,r,h,null)},n.prototype.authenticateWithOptions=function(e,o,r,h,f){try{var g=this.resolveUserForAuthenticate(e,t.UserHandleType.UserId);return this.internalAuthenticate(g,o,r,h,f)}catch(y){return Promise.reject(t.impl.AuthenticationErrorImpl.ensureAuthenticationError(y))}},n.prototype.authenticateWithIdToken=function(e,o,r,h){return this.authenticateWithIdTokenWithOptions(e,o,r,h,null)},n.prototype.authenticateWithIdTokenWithOptions=function(e,o,r,h,f){try{var g=this.resolveUserForAuthenticate(e,t.UserHandleType.IdToken);return this.internalAuthenticate(g,o,r,h,f)}catch(y){return Promise.reject(t.impl.AuthenticationErrorImpl.ensureAuthenticationError(y))}},n.prototype.invokePolicy=function(e,o,r){return this.invokePolicyWithOptions(e,o,r,null)},n.prototype.invokePolicyWithOptions=function(e,o,r,h){return this.log(t.LogLevel.Debug,function(){return"Invoke policy "+e+" for current session."}),new t.core.InvokePolicyControlFlowRequest(this.resumableControlFlowRequestRuntimeContext(r),this.getOrGenerateFlowId(h)).run(e,o)},n.prototype.startTotpSessionForUser=function(e,o,r,h){var f=this;return r=r||t.core.totp.TotpPropertiesProcessor.BACKWARD_COMPATIBILITY_DEFAULT_GENERATOR,this.log(t.LogLevel.Debug,function(){return"Start TOTP session for user "+e+", generator "+r}),new Promise(function(g,y){f.ensureConfigured(),f.log(t.LogLevel.Debug,function(){return"Get TOTP data for <"+e+", "+r+">"});var A=t.core.User.findUser(f,e);if(!A)throw f.log(t.LogLevel.Error,function(){return"Can not find user record for <"+e+">"}),new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Internal,"Can not find user <"+e+">");var T=new t.core.LocalSession(f,A);t.core.totp.TotpPropertiesProcessor.createWithUserHandle(e,f,T,h).runCodeGenerationSession(r,o,h,f.currentUiHandler).then(g,y)}).catch(function(g){return Promise.reject(t.impl.AuthenticationErrorImpl.ensureAuthenticationError(g))})},n.prototype.totpGenerationRequestForUserFromCanonicalString=function(e,o){this.ensureConfigured(),this.log(t.LogLevel.Debug,function(){return"Get TOTP request for <"+e+">"});var r=t.core.User.findUser(this,e);if(!r)throw this.log(t.LogLevel.Error,function(){return"Can not find user record for <"+e+">"}),new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Internal,"Can not find user <"+e+">");var h=new t.core.LocalSession(this,r);return t.core.totp.TotpPropertiesProcessor.createWithUserWithoutUIInteraction(r,this,h).totpRequestFromCanonicalString(o)},n.prototype.startTotpSessionWithRequest=function(e,o){var r=this;return new Promise(function(h,f){r.ensureConfigured(),r.log(t.LogLevel.Debug,function(){return"Start TOTP session for user "+e.getUserId()+", generator "+e.getGeneratorName()});var g=t.core.User.findUser(r,e.getUserId());if(!g)throw r.log(t.LogLevel.Error,function(){return"Can not find user record for <"+e.getUserId()+">"}),new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Internal,"Can not find user <"+e.getUserId()+">");var y=new t.core.LocalSession(r,g);t.core.totp.TotpPropertiesProcessor.createWithUserHandle(e.getUserId(),r,y,o).runCodeGenerationSessionWithRequest(e,o,r.currentUiHandler).then(h,f)}).catch(function(h){return Promise.reject(t.impl.AuthenticationErrorImpl.ensureAuthenticationError(h))})},n.prototype.startDeviceManagementSession=function(e){var o=this;return new Promise(function(r,h){o.ensureConfigured(),o.runWithCurrentSession(function(f){return o.log(t.LogLevel.Debug,function(){return"User in current session: "+f.user.displayName}),new t.core.DeviceManagementSessionProcessor(o,f,e).run()}).then(function(f){switch(f){case t.core.DeviceManagementSessionProcessorReturnReason.CurrentDeviceDeleted:var g=o._currentSession&&o._currentSession.user;return o.log(t.LogLevel.Debug,function(){return"Invalidating current session after deletion of current device."}),o._currentSession=null,o.saveCurrentSession(),g?(o.log(t.LogLevel.Debug,function(){return"Clearing data for current user ("+g.displayName+") after deletion of current device."}),o.clearDataForUser(g.userHandle)):o.log(t.LogLevel.Warning,function(){return"No current user after deletion of current device; not clearing sesison."}),!0;case t.core.DeviceManagementSessionProcessorReturnReason.FinishSession:return!0}}).then(r,h)}).catch(function(r){return Promise.reject(t.impl.AuthenticationErrorImpl.ensureAuthenticationError(r))})},n.prototype.startAuthenticationConfiguration=function(e){var o=this;return this.log(t.LogLevel.Debug,function(){return"Start authentication configuration for current session"}),new Promise(function(r,h){o.ensureConfigured(),o.runWithCurrentSession(function(f){return o.log(t.LogLevel.Debug,function(){return"User in current session: "+f.user.displayName}),new t.core.AuthenticationConfigurationSessionProcessor(o,f,e).run()}).then(r,h)}).catch(function(r){return Promise.reject(t.impl.AuthenticationErrorImpl.ensureAuthenticationError(r))})},n.prototype.startAuthenticationConfigurationWithToken=function(e,o){var r=this;return this.log(t.LogLevel.Debug,function(){return"Start approval for provided session token"}),new Promise(function(h,f){r.ensureConfigured(),r.runWithCurrentSession(function(g){return r.log(t.LogLevel.Debug,function(){return"User in current session: "+g.user.displayName}),new t.core.AuthenticationConfigurationSessionProcessor(r,g,o,e).run()}).then(h,f)}).catch(function(h){return Promise.reject(t.impl.AuthenticationErrorImpl.ensureAuthenticationError(h))})},n.prototype.startApprovalsSessionForCurrentSession=function(e){var o=this;return this.log(t.LogLevel.Debug,function(){return"Start approval for current session"}),new Promise(function(r,h){o.ensureConfigured(),o.runWithCurrentSession(function(f){return o.log(t.LogLevel.Debug,function(){return"User in current session: "+f.user.displayName}),new t.core.ApprovalSessionProcessor(o,f,e).run()}).then(r,h)}).catch(function(r){return Promise.reject(t.impl.AuthenticationErrorImpl.ensureAuthenticationError(r))})},n.prototype.startApprovalsSessionForPushedRequest=function(e,o){return this.startApprovalsSessionForPushedRequestWithOptions(e,o,null)},n.prototype.startApprovalsSessionForPushedRequestWithOptions=function(e,o,r){var h=this;return this.log(t.LogLevel.Debug,function(){return"Start approval for push request"}),new Promise(function(f,g){if(h.ensureConfigured(),!e.userId())return e.ticket()?void g(new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Internal,"Mobile approval push by ticket not yet implemented.")):void g(new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Internal,"Unknown mobile approval push request."));h.log(t.LogLevel.Debug,function(){return"startApprovalsSessionForPushedRequest with userid "+e.userId()});var y=h.lookupBoundUser(e.userId()),A=new t.core.Session(h,y);new t.core.ApprovalSessionProcessor(h,A,o).run().then(f,g)}).catch(function(f){return Promise.reject(t.impl.AuthenticationErrorImpl.ensureAuthenticationError(f))})},n.prototype.invokeAnonymousPolicy=function(e,o,r){return this.invokeAnonymousPolicyWithOptions(e,o,r,null)},n.prototype.invokeAnonymousPolicyWithOptions=function(e,o,r,h){return this.log(t.LogLevel.Debug,function(){return"Start anonymous policy "+e}),new t.core.InvokeAnonymousPolicyControlFlowRequest(this.resumableControlFlowRequestRuntimeContext(r),this.getOrGenerateFlowId(h)).run(e,o)},n.prototype.invokeAnonymousPolicyWithInlineInvokeResponse=function(e,o){return this.log(t.LogLevel.Debug,function(){return"Start anonymous policy with inline server response"}),new t.core.InvokeAnonymousPolicyControlFlowRequest(this.resumableControlFlowRequestRuntimeContext(o),e.flow_id).run(e.inline_invoke_response)},n.prototype.cancelCurrentRunningControlFlow=function(){this.log(t.LogLevel.Debug,function(){return"Cancel current running control flow requested."}),this._currentSession?this._currentSession.cancelCurrentControlFlow():this.log(t.LogLevel.Error,function(){return"No current session"})},n.prototype.ensureConfigured=function(){if(!this.currentUiHandler)throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.AppImplementation,"Attempt to start authentication without a registered UIHandler.")},n.prototype.getAppGlobalUIContext=function(){return this._appGlobalUiContext||(this._appGlobalUiContext=new t.impl.UIContextImpl(this)),this._appGlobalUiContext},n.prototype.userVaultExists=function(e,o){return t.UserVault.exists(this,e,o)},n.prototype.readUserVault=function(e,o,r){var h=this;return new Promise(function(f,g){t.UserVault.open(h,e,o).readData(r).then(f,g)})},n.prototype.writeUserVault=function(e,o,r,h){var f=this;return new Promise(function(g,y){t.UserVault.open(f,e,o).writeData(r,h).then(function(){return g(!0)},y)})},n.prototype.saveCurrentSession=function(){this._currentSession?this.host.writeSessionStorageKey(i,this._currentSession.toJson()):this.host.deleteSessionStorageKey(i)},n.prototype.runWithCurrentSession=function(e){var o=this;if(!this._currentSession)return Promise.reject(new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.SessionRequired,"Operation requires an active session."));var r=this._currentSession;return r.lock(),e(r).finally(function(){r.unlock(),o.saveCurrentSession()})},n.prototype.log=function(e,o){e<=this._logLevel&&this._nativeHost.log(e,"TransmitSDK/Tarsus",o())},n.prototype.getOrGenerateFlowId=function(e){return(null==e?void 0:e.getFlowId())||this.generateFlowId()},n.prototype.generateFlowId=function(){return this.host.generateRandomHexString(64)},n.prototype.promiseCollectionResult=function(e){var o=this;return void 0===e&&(e=null),this._nativeHost.promiseCollectionResult(e).then(function(r){return o.addTarsusCollectedData(r,null!=e?e:o.enabledCollectors)})},n.prototype.getClientFeatureSet=function(){var e,o=this.host.queryHostInfo(l.sdkhost.HostInformationKey.HostProvidedFeatures);return e=o&&o.length?o.split(",").map(function(r){return parseInt(r)}):[],"true"==this.host.queryHostInfo(l.sdkhost.HostInformationKey.DeviceBiometricsFPContinuation)&&e.push(l.sdkhost.FeatureDeviceBiometricsFPContinuation),t.core.STATIC_FEATURE_SET.concat(e)},n.prototype.clearDataForUser=function(e){try{if(this.log(t.LogLevel.Debug,function(){return"Delete data for user "+e+"."}),this._currentSession)throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.AppImplementation,"Attempt to call clearDataForUser with an active primary ongoing session.");var o=t.core.User.findUser(this,e);if(!o)throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.AppImplementation,"Attempt to call clearDataForUser with a non existing user.");try{this.host.deleteKeyPair(o.deviceSigningKeyTag)}catch(h){this.log(t.LogLevel.Warning,function(){return"Can't delete device signing key."})}try{this.host.deleteKeyPair(o.deviceEncryptionKeyTag)}catch(h){this.log(t.LogLevel.Warning,function(){return"Can't delete device encryption key."})}try{t.core.LocalEnrollment.deleteEnrollmentsForUser(o,this)}catch(h){this.log(t.LogLevel.Warning,function(){return"Can't delete enrollments for user."})}var r=new t.core.LocalSession(this,o);try{t.core.totp&&t.core.totp.TotpPropertiesProcessor.createWithUserWithoutUIInteraction(o,this,r).deleteAllProvisions()}catch(h){this.log(t.LogLevel.Warning,function(){return"Can't delete enrollments for user."})}t.core.User.deleteUser(o,this)}catch(h){throw this.log(t.LogLevel.Warning,function(){return"Can't delete data for user "+e+": "+h}),h}},n.prototype.clearAllData=function(){var e=this;if(this._currentSession)throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.AppImplementation,"Attempt to call clearAllData with an active primary ongoing session.");this.log(t.LogLevel.Debug,function(){return"Delete all data: collecting users"});var o=[];t.core.User.iterateUsers(this,function(r){o.push(r.userHandle)}),this.log(t.LogLevel.Debug,function(){return"Delete all data: deleting users"}),o.forEach(function(r){try{e.clearDataForUser(r)}catch(h){e.log(t.LogLevel.Warning,function(){return"Error when deleting user "+r+": "+h})}})},n.prototype.generateDebugPinForControlFlow=function(e){var o=this;return this.log(t.LogLevel.Debug,function(){return"generateDebugPinForMainSession: Starting"}),new Promise(function(r,h){o.ensureConfigured();var f=t.core.ControlFlowProcessor.findByClientContext(e);if(!f)throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.AppImplementation,"Attempt to start debugging for an unknown control flow.");f.generateDebugPin().then(r,h)})},n.prototype.lookupBoundUser=function(e,o){var r=t.core.User.findUserWithType(this,e,o);if(!r)throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.AppImplementation,"Attempt to authenticate with an unknown user on this device.",{user:e});if(!r.deviceBound)throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.AppImplementation,"Attempt to authenticate with an unbound user on this device.",{user:e});return r},n.prototype.addTarsusCollectedData=function(e,o){var r=this;return new Promise(function(h,f){var g=new Array,y=new Array;Object.keys(t.core.collectors.TarsusCollectors).forEach(function(A){var T=new t.core.collectors.TarsusCollectors[A].createCollector(o);T.isEnabled()&&(y.push(A),g.push(T.provide(r)))}),Promise.all(g.map(function(A){return A.catch(function(T){return new Error(T)})})).then(function(A){for(var T=e.toJson(),C=function(R){A[R]instanceof Error?r.log(t.LogLevel.Error,function(){return"caught collection error "+A[R]}):(r.log(t.LogLevel.Debug,function(){return"Tarsus collected from: "+y[R]+" "+JSON.stringify(A[R])}),T.content[y[R]]=r.mergeCollectedData(A[R],T.content[y[R]]))},E=0;E<A.length;E++)C(E);h(new s(T))}).catch(function(A){f(A)})})},n.prototype.mergeCollectedData=function(e,o){var r={};for(var h in e)r[h]=e[h];for(var h in o)r[h]=o[h];return r},n.prototype.addMandatoryCollectorsIfNeeded=function(){var e=this;this.mandatoryCollectors.forEach(function(o){e.enabledCollectors.indexOf(o)<0&&(e.enabledCollectors.push(o),e.log(t.LogLevel.Warning,function(){return t.CollectorType[o]+" collector is mandatory, and will remain enabled."}))})},n.prototype.addMandatoryCollectorsForAnonymousIfNeeded=function(){var e=this;this.mandatoryCollectorsForAnonymous.forEach(function(o){null!==e._enabledCollectorsAnonymous&&e._enabledCollectorsAnonymous.indexOf(o)<0&&(e._enabledCollectorsAnonymous.push(o),e.log(t.LogLevel.Warning,function(){return t.CollectorType[o]+" collector is mandatory for anonymous, and will remain enabled."}))})},n.prototype.allCollectorsSet=function(){var e=[];return this.enabledCollectors.forEach(function(o){-1==e.indexOf(o)&&e.push(o)}),this.enabledCollectorsAnonymous.forEach(function(o){-1==e.indexOf(o)&&e.push(o)}),e},n.prototype.loadUiAssetsFromServer=function(e){var o=this;try{this.log(t.LogLevel.Debug,function(){return"Start ClientStrings request with locale: "+e});var r=new t.core.PublicNetworkRequest(this),h=r.createClientStringsRequest(e);return r.performRequest(h).then(function(f){if(o.uiAssetsData=new t.core.UIAssetsData(o,e),f){var g=f&&f.data;if(g&&g.values)return o.uiAssetsData.setServerClientStrings(new t.core.ClientStrings(g.values)),!0;throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Internal,f.error_message)}return!1})}catch(f){return this.log(t.LogLevel.Error,function(){return"ClientStrings general error: "+f.getMessage()}),Promise.reject(f)}},n.prototype.getFullLocale=function(e){return e&&e.indexOf("-")>=0&&(t.util.LANGUAGES[e]=e),t.util.LANGUAGES[e]||e},n.prototype.applyConfigurationDefaultsAndLogConfiguration=function(){var e=this;null==this._apiLevel&&(this._apiLevel=p.ts.mobile.sdk.core.API_LEVEL),null==this.invalidUserRecoveryMode&&(this.invalidUserRecoveryMode=this.apiLevel>=9?t.InvalidUserRecordRecoveryMode.RecoverDeviceAndBindingOnAuthenticate:t.InvalidUserRecordRecoveryMode.Disable),this.log(t.LogLevel.Debug,function(){return"Using Client API Level "+e.apiLevel}),this.log(t.LogLevel.Debug,function(){return"Using invalid user recovery mode "+t.InvalidUserRecordRecoveryMode[e.invalidUserRecoveryMode]})},n.prototype.applyInvalidUserRecordRecovery=function(e,o){switch(this.invalidUserRecoveryMode){case t.InvalidUserRecordRecoveryMode.Disable:break;case t.InvalidUserRecordRecoveryMode.RecoverDeviceAndBindingOnAuthenticate:o.getErrorCode()!=t.AuthenticationErrorCode.DeviceNotFound&&o.getErrorCode()!=t.AuthenticationErrorCode.InvalidDeviceBinding||(this.log(t.LogLevel.Error,function(){return"Resetting user record due to error "+o}),this.clearDataForUser(e),o instanceof t.impl.AuthenticationErrorImpl||(o=new t.impl.AuthenticationErrorImpl(o.getErrorCode(),o.getMessage(),o.getData())),o.setPublicProperty(t.AuthenticationErrorProperty.UserRecordDeleted,!0))}return Promise.reject(o)},n.prototype.suspendControlFlowToDefaultSuspensionContext=function(e){if(!(e instanceof t.impl.PolicyActionImpl))throw this.log(t.LogLevel.Error,function(){return"Attempt to request continuation for an unknown PolicyAction implementation"}),new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Internal,"Cannot prepare SDK for continuation in this context.");if(!(e.controlFlow&&e.controlFlow.requestContext&&e.controlFlow.requestContext instanceof t.core.ResumableControlFlowRequest))throw this.log(t.LogLevel.Error,function(){return"Attempt to request continuation for a PolicyAction implementation without a control flow request context"}),new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Internal,"Cannot prepare SDK for continuation in this context.");this.log(t.LogLevel.Debug,function(){return"Preparing for continuation of "+e.controlFlow});var o=e.controlFlow.requestContext.topmost.createContinuation(),r=new t.core.SerializationContext;r.writeObject("continuation",o),this.log(t.LogLevel.Debug,function(){return"Storing continuation"}),this.host.writeStorageKey(u,r.serializedContent)},n.prototype.resumeSuspendedControlFlow=function(e,o,r){var h=this;return new Promise(function(f,g){h.log(t.LogLevel.Debug,function(){return"resumeSuspendedControlFlow Fetching continuation and deleting it..."});var y=h.host.readStorageKey(u);h.host.deleteStorageKey(u),h.log(t.LogLevel.Debug,function(){return"Deserializing continuation"});var A=new t.core.SerializationContext(y).readNonNullObject("continuation");h.log(t.LogLevel.Debug,function(){return"Resuming process based on continuation"}),A.createResumableProcess(h.resumableControlFlowRequestRuntimeContext(r)).resume(A,o).then(f,g)}).catch(function(f){throw t.impl.AuthenticationErrorImpl.ensureAuthenticationError(f)})},n.prototype.resetCurrentSession=function(){var e=this;return new Promise(function(o,r){if(e.log(t.LogLevel.Debug,function(){return"resetCurrentSession Invoked"}),e.log(t.LogLevel.Debug,function(){return"resetCurrentSession will discard session"}),e._currentSession&&!e._currentSession.canTerminate())throw e.log(t.LogLevel.Error,function(){return"resetCurrentSession Attempt to reset current session with a locked session"}),new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.AppImplementation,"Attempt to resetCurrentSession with a locked session.");e._currentSession=null,e.saveCurrentSession(),e.log(t.LogLevel.Debug,function(){return"resetCurrentSession will discard continuation"}),e.host.deleteStorageKey(u),o(!0)})},n.__tarsusInterfaceName="TransmitSDKXm",n}());t.TransmitSDKXmImpl=c;var s=function(){function n(e){this.theResult=e}return n.prototype.toJson=function(){return this.theResult},n}();t.CollectionResultImpl=s,t.createSdk=function(){return new c}}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){var u=function(){function c(s){this._backgroundColor=s.backgroundColor&&new i.TSColorImpl(t.core.Protocol.unwrap(s.backgroundColor)),this._tintColor=s.tintColor&&new i.TSColorImpl(t.core.Protocol.unwrap(s.tintColor)),this._lineColor=s.lineColor&&new i.TSColorImpl(t.core.Protocol.unwrap(s.lineColor)),this._iconColor=s.iconColor&&new i.TSColorImpl(t.core.Protocol.unwrap(s.iconColor)),this._imageUrl=s.imageUrl&&t.core.Protocol.unwrap(s.imageUrl),this._fontName=s.fontName&&t.core.Protocol.unwrap(s.fontName),this._fontSize=s.fontSize&&t.core.Protocol.unwrap(s.fontSize),this._fontBold=s.fontBold&&t.core.Protocol.unwrap(s.fontBold),this._maskInput=s.maskInput&&t.core.Protocol.unwrap(s.maskInput),this._rawJson=JSON.stringify({backgroundColor:this._backgroundColor&&this._backgroundColor.getHexValue(),tintColor:this._tintColor&&this._tintColor.getHexValue(),lineColor:this._lineColor&&this._lineColor.getHexValue(),iconColor:this._iconColor&&this._iconColor.getHexValue(),imageUrl:this._imageUrl,fontName:this._fontName,fontSize:this._fontSize,fontBold:this._fontBold,maskInput:this._maskInput})}return c.prototype.getBackgroundColor=function(){return this._backgroundColor||null},c.prototype.getTintColor=function(){return this._tintColor||null},c.prototype.getLineColor=function(){return this._lineColor||null},c.prototype.getIconColor=function(){return this._iconColor||null},c.prototype.getImageUrl=function(){return this._imageUrl||null},c.prototype.getFontName=function(){return this._fontName||null},c.prototype.getFontSize=function(){return this._fontSize||0},c.prototype.getFontBold=function(){return this._fontBold||!1},c.prototype.getMaskInput=function(){return this._maskInput||!1},c.prototype.getRawJson=function(){return this._rawJson},c.emptyStyle=function(){return this._emptyStyle||(this._emptyStyle=new c({})),this._emptyStyle},c}();i.UIStyleImpl=u}(t.impl||(t.impl={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){var i=function(){function u(){}return u.prototype.getUserChoice=function(){return this._userChoice},u.prototype.setUserChoice=function(c){this._userChoice=c},u.create=function(c){return p.ts.mobile.sdk.impl.UnregistrationInputImpl.create(c)},u.__tarsusInterfaceName="UnregistrationInput",u}();t.UnregistrationInput=i}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){var u=function(c){function s(){return null!==c&&c.apply(this,arguments)||this}return V(s,c),s.create=function(n){var e=new s;return e.setUserChoice(n),e},s}(t.UnregistrationInput);i.UnregistrationInputImpl=u}(t.impl||(t.impl={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){var u=function(){function c(){}return c.prototype.getUserHandle=function(){return this._user.userHandle},c.prototype.getUserHandleType=function(){return this._user.userHandleType},c.prototype.getDisplayName=function(){return this._user.displayName},c.prototype.getDeviceBound=function(){return this._user.deviceBound},c.prototype.getHasLoggedIn=function(){return this._user.hasLoggedIn},c.createWithUser=function(s){var n=new c;return n._user=s,n},c}();i.UserInfoImpl=u}(t.impl||(t.impl={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){var t,i,u;t=l.sdk||(l.sdk={}),i=function(){function c(){}return c.prototype.getValidCancelOptions=function(){return null},c.prototype.getValidErrorRecoveryOptions=function(s){return[t.AuthenticationErrorRecovery.ChangeAuthenticator,t.AuthenticationErrorRecovery.SelectAuthenticator,t.AuthenticationErrorRecovery.Fail,t.AuthenticationErrorRecovery.RetryAuthenticator]},c}(),u=function(){function c(s,n){this._sdk=s,this._vault=n}return c.keyPathForUserVaultNamed=function(s){return new t.core.TarsusKeyPath("user_vaults",s)},c.isValidKeyPathForUserVault=function(s){return"user_vaults"==s.component(0)},c.open=function(s,n,e){var o=t.core.User.findUser(s,n);if(!o)throw s.log(t.LogLevel.Error,function(){return"Can not find user record for <"+n+">"}),new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.InvalidInput,"Can not find user <"+n+">");return new c(s,t.core.vault.Vault.getVaultForUserWithId(o,this.keyPathForUserVaultNamed(e),new i,s,s.currentUiHandler))},c.exists=function(s,n,e){var o=t.core.User.findUser(s,n);return o?t.core.vault.Vault.vaultExists(o,this.keyPathForUserVaultNamed(e),s):(s.log(t.LogLevel.Error,function(){return"Can not find user record for <"+n+">"}),!1)},c.prototype.readData=function(s){var n=this,e=t.impl.PolicyActionImpl.createPseudoAction(this._sdk,"user_vault_read");return this._vault.unlock(e,s,!0).then(function(o){if(o instanceof t.core.vault.VaultUnlockResultSuccessOrFailed&&o.successful){var r=n._vault.readVaultKey(t.core.vault.Vault.noIntegrityElementKey),h=t.util.hexToBase64(r);return n._vault.lock(),h}throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Internal,"Invalid response from vault unlock operation",{result:JSON.stringify(o)})})},c.prototype.writeData=function(s,n){var e=this,o=t.impl.PolicyActionImpl.createPseudoAction(this._sdk,"user_vault_write");return this._vault.unlock(o,n,!0).then(function(r){if(r instanceof t.core.vault.VaultUnlockResultSuccessOrFailed&&r.successful){var h=t.util.base64ToHex(s);return e._vault.writeVaultKey(t.core.vault.Vault.noIntegrityElementKey,h).then(function(){return e._vault.lock()})}throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Internal,"Invalid response from vault unlock operation")})},c}(),t.UserVault=u}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){var u=function(){function c(s,n){this._sdkVersion=n,this._platformName=s}return c.prototype.getSdkVersion=function(){return this._sdkVersion},c.prototype.getTarsusVersion=function(){return t.core.TARSUS_VERSION},c.prototype.getPlatformName=function(){return this._platformName},c.prototype.getApiLevel=function(){return t.core.API_LEVEL},c}();i.VersionInfoImpl=u}(t.impl||(t.impl={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){function d(U){return parseInt(U)===U}function l(U){if(!d(U.length))return!1;for(var K=0;K<U.length;K++)if(!d(U[K])||U[K]<0||U[K]>255)return!1;return!0}function t(U,K){if(U.buffer&&ArrayBuffer.isView(U)&&"Uint8Array"===U.name)return K&&(U=U.slice?U.slice():Array.prototype.slice.call(U)),U;if(Array.isArray(U)){if(!l(U))throw new Error("Array contains invalid value: "+U);return new Uint8Array(U)}if(d(U.length)&&l(U))return new Uint8Array(U);throw new Error("unsupported array-like object")}function i(U){return new Uint8Array(U)}function u(U,K,H,Q,$){null==Q&&null==$||(U=U.slice?U.slice(Q,$):Array.prototype.slice.call(U,Q,$)),K.set(U,H)}var c,s={toBytes:function(U){var K=[],H=0;for(U=encodeURI(U);H<U.length;){var Q=U.charCodeAt(H++);37===Q?(K.push(parseInt(U.substr(H,2),16)),H+=2):K.push(Q)}return t(K)},fromBytes:function(U){for(var K=0,H="";K<U.length;){var Q=U[K++];if(Q>127)if(Q>191&&Q<224){if(K>=U.length)throw new Error("UTF-8 decode: incomplete 2-byte sequence");Q=(31&Q)<<6|63&U[K++]}else if(Q>223&&Q<240){if(K+1>=U.length)throw new Error("UTF-8 decode: incomplete 3-byte sequence");Q=(15&Q)<<12|(63&U[K++])<<6|63&U[K++]}else{if(!(Q>239&&Q<248))throw new Error("UTF-8 decode: unknown multibyte start 0x"+Q.toString(16)+" at index "+(K-1));if(K+2>=U.length)throw new Error("UTF-8 decode: incomplete 4-byte sequence");Q=(7&Q)<<18|(63&U[K++])<<12|(63&U[K++])<<6|63&U[K++]}if(Q<=65535)H+=String.fromCharCode(Q);else{if(!(Q<=1114111))throw new Error("UTF-8 decode: code point 0x"+Q.toString(16)+" exceeds UTF-16 reach");Q-=65536,H+=String.fromCharCode(Q>>10|55296),H+=String.fromCharCode(1023&Q|56320)}}return H}},n=(c="0123456789abcdef",{toBytes:function(U){for(var K=[],H=0;H<U.length;H+=2)K.push(parseInt(U.substr(H,2),16));return K},fromBytes:function(U){for(var K=[],H=0;H<U.length;H++){var Q=U[H];K.push(c[(240&Q)>>4]+c[15&Q])}return K.join("")}}),e={16:10,24:12,32:14},o=[1,2,4,8,16,32,64,128,27,54,108,216,171,77,154,47,94,188,99,198,151,53,106,212,179,125,250,239,197,145],r=[99,124,119,123,242,107,111,197,48,1,103,43,254,215,171,118,202,130,201,125,250,89,71,240,173,212,162,175,156,164,114,192,183,253,147,38,54,63,247,204,52,165,229,241,113,216,49,21,4,199,35,195,24,150,5,154,7,18,128,226,235,39,178,117,9,131,44,26,27,110,90,160,82,59,214,179,41,227,47,132,83,209,0,237,32,252,177,91,106,203,190,57,74,76,88,207,208,239,170,251,67,77,51,133,69,249,2,127,80,60,159,168,81,163,64,143,146,157,56,245,188,182,218,33,16,255,243,210,205,12,19,236,95,151,68,23,196,167,126,61,100,93,25,115,96,129,79,220,34,42,144,136,70,238,184,20,222,94,11,219,224,50,58,10,73,6,36,92,194,211,172,98,145,149,228,121,231,200,55,109,141,213,78,169,108,86,244,234,101,122,174,8,186,120,37,46,28,166,180,198,232,221,116,31,75,189,139,138,112,62,181,102,72,3,246,14,97,53,87,185,134,193,29,158,225,248,152,17,105,217,142,148,155,30,135,233,206,85,40,223,140,161,137,13,191,230,66,104,65,153,45,15,176,84,187,22],h=[82,9,106,213,48,54,165,56,191,64,163,158,129,243,215,251,124,227,57,130,155,47,255,135,52,142,67,68,196,222,233,203,84,123,148,50,166,194,35,61,238,76,149,11,66,250,195,78,8,46,161,102,40,217,36,178,118,91,162,73,109,139,209,37,114,248,246,100,134,104,152,22,212,164,92,204,93,101,182,146,108,112,72,80,253,237,185,218,94,21,70,87,167,141,157,132,144,216,171,0,140,188,211,10,247,228,88,5,184,179,69,6,208,44,30,143,202,63,15,2,193,175,189,3,1,19,138,107,58,145,17,65,79,103,220,234,151,242,207,206,240,180,230,115,150,172,116,34,231,173,53,133,226,249,55,232,28,117,223,110,71,241,26,113,29,41,197,137,111,183,98,14,170,24,190,27,252,86,62,75,198,210,121,32,154,219,192,254,120,205,90,244,31,221,168,51,136,7,199,49,177,18,16,89,39,128,236,95,96,81,127,169,25,181,74,13,45,229,122,159,147,201,156,239,160,224,59,77,174,42,245,176,200,235,187,60,131,83,153,97,23,43,4,126,186,119,214,38,225,105,20,99,85,33,12,125],f=[3328402341,4168907908,4000806809,4135287693,4294111757,3597364157,3731845041,2445657428,1613770832,33620227,3462883241,1445669757,3892248089,3050821474,1303096294,3967186586,2412431941,528646813,2311702848,4202528135,4026202645,2992200171,2387036105,4226871307,1101901292,3017069671,1604494077,1169141738,597466303,1403299063,3832705686,2613100635,1974974402,3791519004,1033081774,1277568618,1815492186,2118074177,4126668546,2211236943,1748251740,1369810420,3521504564,4193382664,3799085459,2883115123,1647391059,706024767,134480908,2512897874,1176707941,2646852446,806885416,932615841,168101135,798661301,235341577,605164086,461406363,3756188221,3454790438,1311188841,2142417613,3933566367,302582043,495158174,1479289972,874125870,907746093,3698224818,3025820398,1537253627,2756858614,1983593293,3084310113,2108928974,1378429307,3722699582,1580150641,327451799,2790478837,3117535592,0,3253595436,1075847264,3825007647,2041688520,3059440621,3563743934,2378943302,1740553945,1916352843,2487896798,2555137236,2958579944,2244988746,3151024235,3320835882,1336584933,3992714006,2252555205,2588757463,1714631509,293963156,2319795663,3925473552,67240454,4269768577,2689618160,2017213508,631218106,1269344483,2723238387,1571005438,2151694528,93294474,1066570413,563977660,1882732616,4059428100,1673313503,2008463041,2950355573,1109467491,537923632,3858759450,4260623118,3218264685,2177748300,403442708,638784309,3287084079,3193921505,899127202,2286175436,773265209,2479146071,1437050866,4236148354,2050833735,3362022572,3126681063,840505643,3866325909,3227541664,427917720,2655997905,2749160575,1143087718,1412049534,999329963,193497219,2353415882,3354324521,1807268051,672404540,2816401017,3160301282,369822493,2916866934,3688947771,1681011286,1949973070,336202270,2454276571,201721354,1210328172,3093060836,2680341085,3184776046,1135389935,3294782118,965841320,831886756,3554993207,4068047243,3588745010,2345191491,1849112409,3664604599,26054028,2983581028,2622377682,1235855840,3630984372,2891339514,4092916743,3488279077,3395642799,4101667470,1202630377,268961816,1874508501,4034427016,1243948399,1546530418,941366308,1470539505,1941222599,2546386513,3421038627,2715671932,3899946140,1042226977,2521517021,1639824860,227249030,260737669,3765465232,2084453954,1907733956,3429263018,2420656344,100860677,4160157185,470683154,3261161891,1781871967,2924959737,1773779408,394692241,2579611992,974986535,664706745,3655459128,3958962195,731420851,571543859,3530123707,2849626480,126783113,865375399,765172662,1008606754,361203602,3387549984,2278477385,2857719295,1344809080,2782912378,59542671,1503764984,160008576,437062935,1707065306,3622233649,2218934982,3496503480,2185314755,697932208,1512910199,504303377,2075177163,2824099068,1841019862,739644986],g=[2781242211,2230877308,2582542199,2381740923,234877682,3184946027,2984144751,1418839493,1348481072,50462977,2848876391,2102799147,434634494,1656084439,3863849899,2599188086,1167051466,2636087938,1082771913,2281340285,368048890,3954334041,3381544775,201060592,3963727277,1739838676,4250903202,3930435503,3206782108,4149453988,2531553906,1536934080,3262494647,484572669,2923271059,1783375398,1517041206,1098792767,49674231,1334037708,1550332980,4098991525,886171109,150598129,2481090929,1940641898,1398944049,1059722517,201851908,1385547719,1699095331,1587397571,674240536,2704774806,252314885,3039795866,151914247,908333586,2602270848,1038082786,651029483,1766729511,3447698098,2682942837,454166793,2652734339,1951935532,775166490,758520603,3000790638,4004797018,4217086112,4137964114,1299594043,1639438038,3464344499,2068982057,1054729187,1901997871,2534638724,4121318227,1757008337,0,750906861,1614815264,535035132,3363418545,3988151131,3201591914,1183697867,3647454910,1265776953,3734260298,3566750796,3903871064,1250283471,1807470800,717615087,3847203498,384695291,3313910595,3617213773,1432761139,2484176261,3481945413,283769337,100925954,2180939647,4037038160,1148730428,3123027871,3813386408,4087501137,4267549603,3229630528,2315620239,2906624658,3156319645,1215313976,82966005,3747855548,3245848246,1974459098,1665278241,807407632,451280895,251524083,1841287890,1283575245,337120268,891687699,801369324,3787349855,2721421207,3431482436,959321879,1469301956,4065699751,2197585534,1199193405,2898814052,3887750493,724703513,2514908019,2696962144,2551808385,3516813135,2141445340,1715741218,2119445034,2872807568,2198571144,3398190662,700968686,3547052216,1009259540,2041044702,3803995742,487983883,1991105499,1004265696,1449407026,1316239930,504629770,3683797321,168560134,1816667172,3837287516,1570751170,1857934291,4014189740,2797888098,2822345105,2754712981,936633572,2347923833,852879335,1133234376,1500395319,3084545389,2348912013,1689376213,3533459022,3762923945,3034082412,4205598294,133428468,634383082,2949277029,2398386810,3913789102,403703816,3580869306,2297460856,1867130149,1918643758,607656988,4049053350,3346248884,1368901318,600565992,2090982877,2632479860,557719327,3717614411,3697393085,2249034635,2232388234,2430627952,1115438654,3295786421,2865522278,3633334344,84280067,33027830,303828494,2747425121,1600795957,4188952407,3496589753,2434238086,1486471617,658119965,3106381470,953803233,334231800,3005978776,857870609,3151128937,1890179545,2298973838,2805175444,3056442267,574365214,2450884487,550103529,1233637070,4289353045,2018519080,2057691103,2399374476,4166623649,2148108681,387583245,3664101311,836232934,3330556482,3100665960,3280093505,2955516313,2002398509,287182607,3413881008,4238890068,3597515707,975967766],y=[1671808611,2089089148,2006576759,2072901243,4061003762,1807603307,1873927791,3310653893,810573872,16974337,1739181671,729634347,4263110654,3613570519,2883997099,1989864566,3393556426,2191335298,3376449993,2106063485,4195741690,1508618841,1204391495,4027317232,2917941677,3563566036,2734514082,2951366063,2629772188,2767672228,1922491506,3227229120,3082974647,4246528509,2477669779,644500518,911895606,1061256767,4144166391,3427763148,878471220,2784252325,3845444069,4043897329,1905517169,3631459288,827548209,356461077,67897348,3344078279,593839651,3277757891,405286936,2527147926,84871685,2595565466,118033927,305538066,2157648768,3795705826,3945188843,661212711,2999812018,1973414517,152769033,2208177539,745822252,439235610,455947803,1857215598,1525593178,2700827552,1391895634,994932283,3596728278,3016654259,695947817,3812548067,795958831,2224493444,1408607827,3513301457,0,3979133421,543178784,4229948412,2982705585,1542305371,1790891114,3410398667,3201918910,961245753,1256100938,1289001036,1491644504,3477767631,3496721360,4012557807,2867154858,4212583931,1137018435,1305975373,861234739,2241073541,1171229253,4178635257,33948674,2139225727,1357946960,1011120188,2679776671,2833468328,1374921297,2751356323,1086357568,2408187279,2460827538,2646352285,944271416,4110741895,3168756668,3066132406,3665145818,560153121,271589392,4279952895,4077846003,3530407890,3444343245,202643468,322250259,3962553324,1608629855,2543990167,1154254916,389623319,3294073796,2817676711,2122513534,1028094525,1689045092,1575467613,422261273,1939203699,1621147744,2174228865,1339137615,3699352540,577127458,712922154,2427141008,2290289544,1187679302,3995715566,3100863416,339486740,3732514782,1591917662,186455563,3681988059,3762019296,844522546,978220090,169743370,1239126601,101321734,611076132,1558493276,3260915650,3547250131,2901361580,1655096418,2443721105,2510565781,3828863972,2039214713,3878868455,3359869896,928607799,1840765549,2374762893,3580146133,1322425422,2850048425,1823791212,1459268694,4094161908,3928346602,1706019429,2056189050,2934523822,135794696,3134549946,2022240376,628050469,779246638,472135708,2800834470,3032970164,3327236038,3894660072,3715932637,1956440180,522272287,1272813131,3185336765,2340818315,2323976074,1888542832,1044544574,3049550261,1722469478,1222152264,50660867,4127324150,236067854,1638122081,895445557,1475980887,3117443513,2257655686,3243809217,489110045,2662934430,3778599393,4162055160,2561878936,288563729,1773916777,3648039385,2391345038,2493985684,2612407707,505560094,2274497927,3911240169,3460925390,1442818645,678973480,3749357023,2358182796,2717407649,2306869641,219617805,3218761151,3862026214,1120306242,1756942440,1103331905,2578459033,762796589,252780047,2966125488,1425844308,3151392187,372911126],A=[1667474886,2088535288,2004326894,2071694838,4075949567,1802223062,1869591006,3318043793,808472672,16843522,1734846926,724270422,4278065639,3621216949,2880169549,1987484396,3402253711,2189597983,3385409673,2105378810,4210693615,1499065266,1195886990,4042263547,2913856577,3570689971,2728590687,2947541573,2627518243,2762274643,1920112356,3233831835,3082273397,4261223649,2475929149,640051788,909531756,1061110142,4160160501,3435941763,875846760,2779116625,3857003729,4059105529,1903268834,3638064043,825316194,353713962,67374088,3351728789,589522246,3284360861,404236336,2526454071,84217610,2593830191,117901582,303183396,2155911963,3806477791,3958056653,656894286,2998062463,1970642922,151591698,2206440989,741110872,437923380,454765878,1852748508,1515908788,2694904667,1381168804,993742198,3604373943,3014905469,690584402,3823320797,791638366,2223281939,1398011302,3520161977,0,3991743681,538992704,4244381667,2981218425,1532751286,1785380564,3419096717,3200178535,960056178,1246420628,1280103576,1482221744,3486468741,3503319995,4025428677,2863326543,4227536621,1128514950,1296947098,859002214,2240123921,1162203018,4193849577,33687044,2139062782,1347481760,1010582648,2678045221,2829640523,1364325282,2745433693,1077985408,2408548869,2459086143,2644360225,943212656,4126475505,3166494563,3065430391,3671750063,555836226,269496352,4294908645,4092792573,3537006015,3452783745,202118168,320025894,3974901699,1600119230,2543297077,1145359496,387397934,3301201811,2812801621,2122220284,1027426170,1684319432,1566435258,421079858,1936954854,1616945344,2172753945,1330631070,3705438115,572679748,707427924,2425400123,2290647819,1179044492,4008585671,3099120491,336870440,3739122087,1583276732,185277718,3688593069,3772791771,842159716,976899700,168435220,1229577106,101059084,606366792,1549591736,3267517855,3553849021,2897014595,1650632388,2442242105,2509612081,3840161747,2038008818,3890688725,3368567691,926374254,1835907034,2374863873,3587531953,1313788572,2846482505,1819063512,1448540844,4109633523,3941213647,1701162954,2054852340,2930698567,134748176,3132806511,2021165296,623210314,774795868,471606328,2795958615,3031746419,3334885783,3907527627,3722280097,1953799400,522133822,1263263126,3183336545,2341176845,2324333839,1886425312,1044267644,3048588401,1718004428,1212733584,50529542,4143317495,235803164,1633788866,892690282,1465383342,3115962473,2256965911,3250673817,488449850,2661202215,3789633753,4177007595,2560144171,286339874,1768537042,3654906025,2391705863,2492770099,2610673197,505291324,2273808917,3924369609,3469625735,1431699370,673740880,3755965093,2358021891,2711746649,2307489801,218961690,3217021541,3873845719,1111672452,1751693520,1094828930,2576986153,757954394,252645662,2964376443,1414855848,3149649517,370555436],T=[1374988112,2118214995,437757123,975658646,1001089995,530400753,2902087851,1273168787,540080725,2910219766,2295101073,4110568485,1340463100,3307916247,641025152,3043140495,3736164937,632953703,1172967064,1576976609,3274667266,2169303058,2370213795,1809054150,59727847,361929877,3211623147,2505202138,3569255213,1484005843,1239443753,2395588676,1975683434,4102977912,2572697195,666464733,3202437046,4035489047,3374361702,2110667444,1675577880,3843699074,2538681184,1649639237,2976151520,3144396420,4269907996,4178062228,1883793496,2403728665,2497604743,1383856311,2876494627,1917518562,3810496343,1716890410,3001755655,800440835,2261089178,3543599269,807962610,599762354,33778362,3977675356,2328828971,2809771154,4077384432,1315562145,1708848333,101039829,3509871135,3299278474,875451293,2733856160,92987698,2767645557,193195065,1080094634,1584504582,3178106961,1042385657,2531067453,3711829422,1306967366,2438237621,1908694277,67556463,1615861247,429456164,3602770327,2302690252,1742315127,2968011453,126454664,3877198648,2043211483,2709260871,2084704233,4169408201,0,159417987,841739592,504459436,1817866830,4245618683,260388950,1034867998,908933415,168810852,1750902305,2606453969,607530554,202008497,2472011535,3035535058,463180190,2160117071,1641816226,1517767529,470948374,3801332234,3231722213,1008918595,303765277,235474187,4069246893,766945465,337553864,1475418501,2943682380,4003061179,2743034109,4144047775,1551037884,1147550661,1543208500,2336434550,3408119516,3069049960,3102011747,3610369226,1113818384,328671808,2227573024,2236228733,3535486456,2935566865,3341394285,496906059,3702665459,226906860,2009195472,733156972,2842737049,294930682,1206477858,2835123396,2700099354,1451044056,573804783,2269728455,3644379585,2362090238,2564033334,2801107407,2776292904,3669462566,1068351396,742039012,1350078989,1784663195,1417561698,4136440770,2430122216,775550814,2193862645,2673705150,1775276924,1876241833,3475313331,3366754619,270040487,3902563182,3678124923,3441850377,1851332852,3969562369,2203032232,3868552805,2868897406,566021896,4011190502,3135740889,1248802510,3936291284,699432150,832877231,708780849,3332740144,899835584,1951317047,4236429990,3767586992,866637845,4043610186,1106041591,2144161806,395441711,1984812685,1139781709,3433712980,3835036895,2664543715,1282050075,3240894392,1181045119,2640243204,25965917,4203181171,4211818798,3009879386,2463879762,3910161971,1842759443,2597806476,933301370,1509430414,3943906441,3467192302,3076639029,3776767469,2051518780,2631065433,1441952575,404016761,1942435775,1408749034,1610459739,3745345300,2017778566,3400528769,3110650942,941896748,3265478751,371049330,3168937228,675039627,4279080257,967311729,135050206,3635733660,1683407248,2076935265,3576870512,1215061108,3501741890],C=[1347548327,1400783205,3273267108,2520393566,3409685355,4045380933,2880240216,2471224067,1428173050,4138563181,2441661558,636813900,4233094615,3620022987,2149987652,2411029155,1239331162,1730525723,2554718734,3781033664,46346101,310463728,2743944855,3328955385,3875770207,2501218972,3955191162,3667219033,768917123,3545789473,692707433,1150208456,1786102409,2029293177,1805211710,3710368113,3065962831,401639597,1724457132,3028143674,409198410,2196052529,1620529459,1164071807,3769721975,2226875310,486441376,2499348523,1483753576,428819965,2274680428,3075636216,598438867,3799141122,1474502543,711349675,129166120,53458370,2592523643,2782082824,4063242375,2988687269,3120694122,1559041666,730517276,2460449204,4042459122,2706270690,3446004468,3573941694,533804130,2328143614,2637442643,2695033685,839224033,1973745387,957055980,2856345839,106852767,1371368976,4181598602,1033297158,2933734917,1179510461,3046200461,91341917,1862534868,4284502037,605657339,2547432937,3431546947,2003294622,3182487618,2282195339,954669403,3682191598,1201765386,3917234703,3388507166,0,2198438022,1211247597,2887651696,1315723890,4227665663,1443857720,507358933,657861945,1678381017,560487590,3516619604,975451694,2970356327,261314535,3535072918,2652609425,1333838021,2724322336,1767536459,370938394,182621114,3854606378,1128014560,487725847,185469197,2918353863,3106780840,3356761769,2237133081,1286567175,3152976349,4255350624,2683765030,3160175349,3309594171,878443390,1988838185,3704300486,1756818940,1673061617,3403100636,272786309,1075025698,545572369,2105887268,4174560061,296679730,1841768865,1260232239,4091327024,3960309330,3497509347,1814803222,2578018489,4195456072,575138148,3299409036,446754879,3629546796,4011996048,3347532110,3252238545,4270639778,915985419,3483825537,681933534,651868046,2755636671,3828103837,223377554,2607439820,1649704518,3270937875,3901806776,1580087799,4118987695,3198115200,2087309459,2842678573,3016697106,1003007129,2802849917,1860738147,2077965243,164439672,4100872472,32283319,2827177882,1709610350,2125135846,136428751,3874428392,3652904859,3460984630,3572145929,3593056380,2939266226,824852259,818324884,3224740454,930369212,2801566410,2967507152,355706840,1257309336,4148292826,243256656,790073846,2373340630,1296297904,1422699085,3756299780,3818836405,457992840,3099667487,2135319889,77422314,1560382517,1945798516,788204353,1521706781,1385356242,870912086,325965383,2358957921,2050466060,2388260884,2313884476,4006521127,901210569,3990953189,1014646705,1503449823,1062597235,2031621326,3212035895,3931371469,1533017514,350174575,2256028891,2177544179,1052338372,741876788,1606591296,1914052035,213705253,2334669897,1107234197,1899603969,3725069491,2631447780,2422494913,1635502980,1893020342,1950903388,1120974935],E=[2807058932,1699970625,2764249623,1586903591,1808481195,1173430173,1487645946,59984867,4199882800,1844882806,1989249228,1277555970,3623636965,3419915562,1149249077,2744104290,1514790577,459744698,244860394,3235995134,1963115311,4027744588,2544078150,4190530515,1608975247,2627016082,2062270317,1507497298,2200818878,567498868,1764313568,3359936201,2305455554,2037970062,1047239e3,1910319033,1337376481,2904027272,2892417312,984907214,1243112415,830661914,861968209,2135253587,2011214180,2927934315,2686254721,731183368,1750626376,4246310725,1820824798,4172763771,3542330227,48394827,2404901663,2871682645,671593195,3254988725,2073724613,145085239,2280796200,2779915199,1790575107,2187128086,472615631,3029510009,4075877127,3802222185,4107101658,3201631749,1646252340,4270507174,1402811438,1436590835,3778151818,3950355702,3963161475,4020912224,2667994737,273792366,2331590177,104699613,95345982,3175501286,2377486676,1560637892,3564045318,369057872,4213447064,3919042237,1137477952,2658625497,1119727848,2340947849,1530455833,4007360968,172466556,266959938,516552836,0,2256734592,3980931627,1890328081,1917742170,4294704398,945164165,3575528878,958871085,3647212047,2787207260,1423022939,775562294,1739656202,3876557655,2530391278,2443058075,3310321856,547512796,1265195639,437656594,3121275539,719700128,3762502690,387781147,218828297,3350065803,2830708150,2848461854,428169201,122466165,3720081049,1627235199,648017665,4122762354,1002783846,2117360635,695634755,3336358691,4234721005,4049844452,3704280881,2232435299,574624663,287343814,612205898,1039717051,840019705,2708326185,793451934,821288114,1391201670,3822090177,376187827,3113855344,1224348052,1679968233,2361698556,1058709744,752375421,2431590963,1321699145,3519142200,2734591178,188127444,2177869557,3727205754,2384911031,3215212461,2648976442,2450346104,3432737375,1180849278,331544205,3102249176,4150144569,2952102595,2159976285,2474404304,766078933,313773861,2570832044,2108100632,1668212892,3145456443,2013908262,418672217,3070356634,2594734927,1852171925,3867060991,3473416636,3907448597,2614737639,919489135,164948639,2094410160,2997825956,590424639,2486224549,1723872674,3157750862,3399941250,3501252752,3625268135,2555048196,3673637356,1343127501,4130281361,3599595085,2957853679,1297403050,81781910,3051593425,2283490410,532201772,1367295589,3926170974,895287692,1953757831,1093597963,492483431,3528626907,1446242576,1192455638,1636604631,209336225,344873464,1015671571,669961897,3375740769,3857572124,2973530695,3747192018,1933530610,3464042516,935293895,3454686199,2858115069,1863638845,3683022916,4085369519,3292445032,875313188,1080017571,3279033885,621591778,1233856572,2504130317,24197544,3017672716,3835484340,3247465558,2220981195,3060847922,1551124588,1463996600],R=[4104605777,1097159550,396673818,660510266,2875968315,2638606623,4189115116,3808662347,821712160,1986918061,3430322568,38544885,3856137295,718002117,893681702,1654886325,2975484382,3122358053,3926825029,4274053469,796197571,1290801793,1184342925,3556361835,2405426947,2459735317,1836772287,1381620373,3196267988,1948373848,3764988233,3385345166,3263785589,2390325492,1480485785,3111247143,3780097726,2293045232,548169417,3459953789,3746175075,439452389,1362321559,1400849762,1685577905,1806599355,2174754046,137073913,1214797936,1174215055,3731654548,2079897426,1943217067,1258480242,529487843,1437280870,3945269170,3049390895,3313212038,923313619,679998e3,3215307299,57326082,377642221,3474729866,2041877159,133361907,1776460110,3673476453,96392454,878845905,2801699524,777231668,4082475170,2330014213,4142626212,2213296395,1626319424,1906247262,1846563261,562755902,3708173718,1040559837,3871163981,1418573201,3294430577,114585348,1343618912,2566595609,3186202582,1078185097,3651041127,3896688048,2307622919,425408743,3371096953,2081048481,1108339068,2216610296,0,2156299017,736970802,292596766,1517440620,251657213,2235061775,2933202493,758720310,265905162,1554391400,1532285339,908999204,174567692,1474760595,4002861748,2610011675,3234156416,3693126241,2001430874,303699484,2478443234,2687165888,585122620,454499602,151849742,2345119218,3064510765,514443284,4044981591,1963412655,2581445614,2137062819,19308535,1928707164,1715193156,4219352155,1126790795,600235211,3992742070,3841024952,836553431,1669664834,2535604243,3323011204,1243905413,3141400786,4180808110,698445255,2653899549,2989552604,2253581325,3252932727,3004591147,1891211689,2487810577,3915653703,4237083816,4030667424,2100090966,865136418,1229899655,953270745,3399679628,3557504664,4118925222,2061379749,3079546586,2915017791,983426092,2022837584,1607244650,2118541908,2366882550,3635996816,972512814,3283088770,1568718495,3499326569,3576539503,621982671,2895723464,410887952,2623762152,1002142683,645401037,1494807662,2595684844,1335535747,2507040230,4293295786,3167684641,367585007,3885750714,1865862730,2668221674,2960971305,2763173681,1059270954,2777952454,2724642869,1320957812,2194319100,2429595872,2815956275,77089521,3973773121,3444575871,2448830231,1305906550,4021308739,2857194700,2516901860,3518358430,1787304780,740276417,1699839814,1592394909,2352307457,2272556026,188821243,1729977011,3687994002,274084841,3594982253,3613494426,2701949495,4162096729,322734571,2837966542,1640576439,484830689,1202797690,3537852828,4067639125,349075736,3342319475,4157467219,4255800159,1030690015,1155237496,2951971274,1757691577,607398968,2738905026,499347990,3794078908,1011452712,227885567,2818666809,213114376,3034881240,1455525988,3414450555,850817237,1817998408,3092726480],O=[0,235474187,470948374,303765277,941896748,908933415,607530554,708780849,1883793496,2118214995,1817866830,1649639237,1215061108,1181045119,1417561698,1517767529,3767586992,4003061179,4236429990,4069246893,3635733660,3602770327,3299278474,3400528769,2430122216,2664543715,2362090238,2193862645,2835123396,2801107407,3035535058,3135740889,3678124923,3576870512,3341394285,3374361702,3810496343,3977675356,4279080257,4043610186,2876494627,2776292904,3076639029,3110650942,2472011535,2640243204,2403728665,2169303058,1001089995,899835584,666464733,699432150,59727847,226906860,530400753,294930682,1273168787,1172967064,1475418501,1509430414,1942435775,2110667444,1876241833,1641816226,2910219766,2743034109,2976151520,3211623147,2505202138,2606453969,2302690252,2269728455,3711829422,3543599269,3240894392,3475313331,3843699074,3943906441,4178062228,4144047775,1306967366,1139781709,1374988112,1610459739,1975683434,2076935265,1775276924,1742315127,1034867998,866637845,566021896,800440835,92987698,193195065,429456164,395441711,1984812685,2017778566,1784663195,1683407248,1315562145,1080094634,1383856311,1551037884,101039829,135050206,437757123,337553864,1042385657,807962610,573804783,742039012,2531067453,2564033334,2328828971,2227573024,2935566865,2700099354,3001755655,3168937228,3868552805,3902563182,4203181171,4102977912,3736164937,3501741890,3265478751,3433712980,1106041591,1340463100,1576976609,1408749034,2043211483,2009195472,1708848333,1809054150,832877231,1068351396,766945465,599762354,159417987,126454664,361929877,463180190,2709260871,2943682380,3178106961,3009879386,2572697195,2538681184,2236228733,2336434550,3509871135,3745345300,3441850377,3274667266,3910161971,3877198648,4110568485,4211818798,2597806476,2497604743,2261089178,2295101073,2733856160,2902087851,3202437046,2968011453,3936291284,3835036895,4136440770,4169408201,3535486456,3702665459,3467192302,3231722213,2051518780,1951317047,1716890410,1750902305,1113818384,1282050075,1584504582,1350078989,168810852,67556463,371049330,404016761,841739592,1008918595,775550814,540080725,3969562369,3801332234,4035489047,4269907996,3569255213,3669462566,3366754619,3332740144,2631065433,2463879762,2160117071,2395588676,2767645557,2868897406,3102011747,3069049960,202008497,33778362,270040487,504459436,875451293,975658646,675039627,641025152,2084704233,1917518562,1615861247,1851332852,1147550661,1248802510,1484005843,1451044056,933301370,967311729,733156972,632953703,260388950,25965917,328671808,496906059,1206477858,1239443753,1543208500,1441952575,2144161806,1908694277,1675577880,1842759443,3610369226,3644379585,3408119516,3307916247,4011190502,3776767469,4077384432,4245618683,2809771154,2842737049,3144396420,3043140495,2673705150,2438237621,2203032232,2370213795],L=[0,185469197,370938394,487725847,741876788,657861945,975451694,824852259,1483753576,1400783205,1315723890,1164071807,1950903388,2135319889,1649704518,1767536459,2967507152,3152976349,2801566410,2918353863,2631447780,2547432937,2328143614,2177544179,3901806776,3818836405,4270639778,4118987695,3299409036,3483825537,3535072918,3652904859,2077965243,1893020342,1841768865,1724457132,1474502543,1559041666,1107234197,1257309336,598438867,681933534,901210569,1052338372,261314535,77422314,428819965,310463728,3409685355,3224740454,3710368113,3593056380,3875770207,3960309330,4045380933,4195456072,2471224067,2554718734,2237133081,2388260884,3212035895,3028143674,2842678573,2724322336,4138563181,4255350624,3769721975,3955191162,3667219033,3516619604,3431546947,3347532110,2933734917,2782082824,3099667487,3016697106,2196052529,2313884476,2499348523,2683765030,1179510461,1296297904,1347548327,1533017514,1786102409,1635502980,2087309459,2003294622,507358933,355706840,136428751,53458370,839224033,957055980,605657339,790073846,2373340630,2256028891,2607439820,2422494913,2706270690,2856345839,3075636216,3160175349,3573941694,3725069491,3273267108,3356761769,4181598602,4063242375,4011996048,3828103837,1033297158,915985419,730517276,545572369,296679730,446754879,129166120,213705253,1709610350,1860738147,1945798516,2029293177,1239331162,1120974935,1606591296,1422699085,4148292826,4233094615,3781033664,3931371469,3682191598,3497509347,3446004468,3328955385,2939266226,2755636671,3106780840,2988687269,2198438022,2282195339,2501218972,2652609425,1201765386,1286567175,1371368976,1521706781,1805211710,1620529459,2105887268,1988838185,533804130,350174575,164439672,46346101,870912086,954669403,636813900,788204353,2358957921,2274680428,2592523643,2441661558,2695033685,2880240216,3065962831,3182487618,3572145929,3756299780,3270937875,3388507166,4174560061,4091327024,4006521127,3854606378,1014646705,930369212,711349675,560487590,272786309,457992840,106852767,223377554,1678381017,1862534868,1914052035,2031621326,1211247597,1128014560,1580087799,1428173050,32283319,182621114,401639597,486441376,768917123,651868046,1003007129,818324884,1503449823,1385356242,1333838021,1150208456,1973745387,2125135846,1673061617,1756818940,2970356327,3120694122,2802849917,2887651696,2637442643,2520393566,2334669897,2149987652,3917234703,3799141122,4284502037,4100872472,3309594171,3460984630,3545789473,3629546796,2050466060,1899603969,1814803222,1730525723,1443857720,1560382517,1075025698,1260232239,575138148,692707433,878443390,1062597235,243256656,91341917,409198410,325965383,3403100636,3252238545,3704300486,3620022987,3874428392,3990953189,4042459122,4227665663,2460449204,2578018489,2226875310,2411029155,3198115200,3046200461,2827177882,2743944855],N=[0,218828297,437656594,387781147,875313188,958871085,775562294,590424639,1750626376,1699970625,1917742170,2135253587,1551124588,1367295589,1180849278,1265195639,3501252752,3720081049,3399941250,3350065803,3835484340,3919042237,4270507174,4085369519,3102249176,3051593425,2734591178,2952102595,2361698556,2177869557,2530391278,2614737639,3145456443,3060847922,2708326185,2892417312,2404901663,2187128086,2504130317,2555048196,3542330227,3727205754,3375740769,3292445032,3876557655,3926170974,4246310725,4027744588,1808481195,1723872674,1910319033,2094410160,1608975247,1391201670,1173430173,1224348052,59984867,244860394,428169201,344873464,935293895,984907214,766078933,547512796,1844882806,1627235199,2011214180,2062270317,1507497298,1423022939,1137477952,1321699145,95345982,145085239,532201772,313773861,830661914,1015671571,731183368,648017665,3175501286,2957853679,2807058932,2858115069,2305455554,2220981195,2474404304,2658625497,3575528878,3625268135,3473416636,3254988725,3778151818,3963161475,4213447064,4130281361,3599595085,3683022916,3432737375,3247465558,3802222185,4020912224,4172763771,4122762354,3201631749,3017672716,2764249623,2848461854,2331590177,2280796200,2431590963,2648976442,104699613,188127444,472615631,287343814,840019705,1058709744,671593195,621591778,1852171925,1668212892,1953757831,2037970062,1514790577,1463996600,1080017571,1297403050,3673637356,3623636965,3235995134,3454686199,4007360968,3822090177,4107101658,4190530515,2997825956,3215212461,2830708150,2779915199,2256734592,2340947849,2627016082,2443058075,172466556,122466165,273792366,492483431,1047239e3,861968209,612205898,695634755,1646252340,1863638845,2013908262,1963115311,1446242576,1530455833,1277555970,1093597963,1636604631,1820824798,2073724613,1989249228,1436590835,1487645946,1337376481,1119727848,164948639,81781910,331544205,516552836,1039717051,821288114,669961897,719700128,2973530695,3157750862,2871682645,2787207260,2232435299,2283490410,2667994737,2450346104,3647212047,3564045318,3279033885,3464042516,3980931627,3762502690,4150144569,4199882800,3070356634,3121275539,2904027272,2686254721,2200818878,2384911031,2570832044,2486224549,3747192018,3528626907,3310321856,3359936201,3950355702,3867060991,4049844452,4234721005,1739656202,1790575107,2108100632,1890328081,1402811438,1586903591,1233856572,1149249077,266959938,48394827,369057872,418672217,1002783846,919489135,567498868,752375421,209336225,24197544,376187827,459744698,945164165,895287692,574624663,793451934,1679968233,1764313568,2117360635,1933530610,1343127501,1560637892,1243112415,1192455638,3704280881,3519142200,3336358691,3419915562,3907448597,3857572124,4075877127,4294704398,3029510009,3113855344,2927934315,2744104290,2159976285,2377486676,2594734927,2544078150],W=[0,151849742,303699484,454499602,607398968,758720310,908999204,1059270954,1214797936,1097159550,1517440620,1400849762,1817998408,1699839814,2118541908,2001430874,2429595872,2581445614,2194319100,2345119218,3034881240,3186202582,2801699524,2951971274,3635996816,3518358430,3399679628,3283088770,4237083816,4118925222,4002861748,3885750714,1002142683,850817237,698445255,548169417,529487843,377642221,227885567,77089521,1943217067,2061379749,1640576439,1757691577,1474760595,1592394909,1174215055,1290801793,2875968315,2724642869,3111247143,2960971305,2405426947,2253581325,2638606623,2487810577,3808662347,3926825029,4044981591,4162096729,3342319475,3459953789,3576539503,3693126241,1986918061,2137062819,1685577905,1836772287,1381620373,1532285339,1078185097,1229899655,1040559837,923313619,740276417,621982671,439452389,322734571,137073913,19308535,3871163981,4021308739,4104605777,4255800159,3263785589,3414450555,3499326569,3651041127,2933202493,2815956275,3167684641,3049390895,2330014213,2213296395,2566595609,2448830231,1305906550,1155237496,1607244650,1455525988,1776460110,1626319424,2079897426,1928707164,96392454,213114376,396673818,514443284,562755902,679998e3,865136418,983426092,3708173718,3557504664,3474729866,3323011204,4180808110,4030667424,3945269170,3794078908,2507040230,2623762152,2272556026,2390325492,2975484382,3092726480,2738905026,2857194700,3973773121,3856137295,4274053469,4157467219,3371096953,3252932727,3673476453,3556361835,2763173681,2915017791,3064510765,3215307299,2156299017,2307622919,2459735317,2610011675,2081048481,1963412655,1846563261,1729977011,1480485785,1362321559,1243905413,1126790795,878845905,1030690015,645401037,796197571,274084841,425408743,38544885,188821243,3613494426,3731654548,3313212038,3430322568,4082475170,4189115116,3780097726,3896688048,2668221674,2516901860,2366882550,2216610296,3141400786,2989552604,2837966542,2687165888,1202797690,1320957812,1437280870,1554391400,1669664834,1787304780,1906247262,2022837584,265905162,114585348,499347990,349075736,736970802,585122620,972512814,821712160,2595684844,2478443234,2293045232,2174754046,3196267988,3079546586,2895723464,2777952454,3537852828,3687994002,3234156416,3385345166,4142626212,4293295786,3841024952,3992742070,174567692,57326082,410887952,292596766,777231668,660510266,1011452712,893681702,1108339068,1258480242,1343618912,1494807662,1715193156,1865862730,1948373848,2100090966,2701949495,2818666809,3004591147,3122358053,2235061775,2352307457,2535604243,2653899549,3915653703,3764988233,4219352155,4067639125,3444575871,3294430577,3746175075,3594982253,836553431,953270745,600235211,718002117,367585007,484830689,133361907,251657213,2041877159,1891211689,1806599355,1654886325,1568718495,1418573201,1335535747,1184342925];function j(U){for(var K=[],H=0;H<U.length;H+=4)K.push(U[H]<<24|U[H+1]<<16|U[H+2]<<8|U[H+3]);return K}var te=function U(K){if(!(this instanceof U))throw Error("AES must be instanitated with `new`");Object.defineProperty(this,"key",{value:t(K,!0)}),this._prepare()};te.prototype._prepare=function(){var U=e[this.key.length];if(null==U)throw new Error("invalid key size (must be 16, 24 or 32 bytes)");this._Ke=[],this._Kd=[];for(var K=0;K<=U;K++)this._Ke.push([0,0,0,0]),this._Kd.push([0,0,0,0]);var H,Q=4*(U+1),$=this.key.length/4,ue=j(this.key);for(K=0;K<$;K++)this._Ke[H=K>>2][K%4]=ue[K],this._Kd[U-H][K%4]=ue[K];for(var ae,me=0,be=$;be<Q;){if(ue[0]^=r[(ae=ue[$-1])>>16&255]<<24^r[ae>>8&255]<<16^r[255&ae]<<8^r[ae>>24&255]^o[me]<<24,me+=1,8!=$)for(K=1;K<$;K++)ue[K]^=ue[K-1];else{for(K=1;K<$/2;K++)ue[K]^=ue[K-1];for(ue[$/2]^=r[255&(ae=ue[$/2-1])]^r[ae>>8&255]<<8^r[ae>>16&255]<<16^r[ae>>24&255]<<24,K=$/2+1;K<$;K++)ue[K]^=ue[K-1]}for(K=0;K<$&&be<Q;)this._Ke[Xe=be>>2][Se=be%4]=ue[K],this._Kd[U-Xe][Se]=ue[K++],be++}for(var Xe=1;Xe<U;Xe++)for(var Se=0;Se<4;Se++)this._Kd[Xe][Se]=O[(ae=this._Kd[Xe][Se])>>24&255]^L[ae>>16&255]^N[ae>>8&255]^W[255&ae]},te.prototype.encrypt=function(U){if(16!=U.length)throw new Error("invalid plaintext size (must be 16 bytes)");for(var K=this._Ke.length-1,H=[0,0,0,0],Q=j(U),$=0;$<4;$++)Q[$]^=this._Ke[0][$];for(var ue=1;ue<K;ue++){for($=0;$<4;$++)H[$]=f[Q[$]>>24&255]^g[Q[($+1)%4]>>16&255]^y[Q[($+2)%4]>>8&255]^A[255&Q[($+3)%4]]^this._Ke[ue][$];Q=H.slice()}var ae,me=i(16);for($=0;$<4;$++)me[4*$]=255&(r[Q[$]>>24&255]^(ae=this._Ke[K][$])>>24),me[4*$+1]=255&(r[Q[($+1)%4]>>16&255]^ae>>16),me[4*$+2]=255&(r[Q[($+2)%4]>>8&255]^ae>>8),me[4*$+3]=255&(r[255&Q[($+3)%4]]^ae);return me},te.prototype.decrypt=function(U){if(16!=U.length)throw new Error("invalid ciphertext size (must be 16 bytes)");for(var K=this._Kd.length-1,H=[0,0,0,0],Q=j(U),$=0;$<4;$++)Q[$]^=this._Kd[0][$];for(var ue=1;ue<K;ue++){for($=0;$<4;$++)H[$]=T[Q[$]>>24&255]^C[Q[($+3)%4]>>16&255]^E[Q[($+2)%4]>>8&255]^R[255&Q[($+1)%4]]^this._Kd[ue][$];Q=H.slice()}var ae,me=i(16);for($=0;$<4;$++)me[4*$]=255&(h[Q[$]>>24&255]^(ae=this._Kd[K][$])>>24),me[4*$+1]=255&(h[Q[($+3)%4]>>16&255]^ae>>16),me[4*$+2]=255&(h[Q[($+2)%4]>>8&255]^ae>>8),me[4*$+3]=255&(h[255&Q[($+1)%4]]^ae);return me};var b=function U(K){if(!(this instanceof U))throw Error("AES must be instanitated with `new`");this.description="Electronic Code Block",this.name="ecb",this._aes=new te(K)};b.prototype.encrypt=function(U){if((U=t(U)).length%16!=0)throw new Error("invalid plaintext size (must be multiple of 16 bytes)");for(var K=i(U.length),H=i(16),Q=0;Q<U.length;Q+=16)u(U,H,0,Q,Q+16),u(H=this._aes.encrypt(H),K,Q);return K},b.prototype.decrypt=function(U){if((U=t(U)).length%16!=0)throw new Error("invalid ciphertext size (must be multiple of 16 bytes)");for(var K=i(U.length),H=i(16),Q=0;Q<U.length;Q+=16)u(U,H,0,Q,Q+16),u(H=this._aes.decrypt(H),K,Q);return K};var D=function U(K,H){if(!(this instanceof U))throw Error("AES must be instanitated with `new`");if(this.description="Cipher Block Chaining",this.name="cbc",H){if(16!=H.length)throw new Error("invalid initialation vector size (must be 16 bytes)")}else H=i(16);this._lastCipherblock=t(H,!0),this._aes=new te(K)};D.prototype.encrypt=function(U){if((U=t(U)).length%16!=0)throw new Error("invalid plaintext size (must be multiple of 16 bytes)");for(var K=i(U.length),H=i(16),Q=0;Q<U.length;Q+=16){u(U,H,0,Q,Q+16);for(var $=0;$<16;$++)H[$]^=this._lastCipherblock[$];this._lastCipherblock=this._aes.encrypt(H),u(this._lastCipherblock,K,Q)}return K},D.prototype.decrypt=function(U){if((U=t(U)).length%16!=0)throw new Error("invalid ciphertext size (must be multiple of 16 bytes)");for(var K=i(U.length),H=i(16),Q=0;Q<U.length;Q+=16){u(U,H,0,Q,Q+16),H=this._aes.decrypt(H);for(var $=0;$<16;$++)K[Q+$]=H[$]^this._lastCipherblock[$];u(U,this._lastCipherblock,0,Q,Q+16)}return K};var x=function U(K,H,Q){if(!(this instanceof U))throw Error("AES must be instanitated with `new`");if(this.description="Cipher Feedback",this.name="cfb",H){if(16!=H.length)throw new Error("invalid initialation vector size (must be 16 size)")}else H=i(16);Q||(Q=1),this.segmentSize=Q,this._shiftRegister=t(H,!0),this._aes=new te(K)};x.prototype.encrypt=function(U){if(U.length%this.segmentSize!=0)throw new Error("invalid plaintext size (must be segmentSize bytes)");for(var K,H=t(U,!0),Q=0;Q<H.length;Q+=this.segmentSize){K=this._aes.encrypt(this._shiftRegister);for(var $=0;$<this.segmentSize;$++)H[Q+$]^=K[$];u(this._shiftRegister,this._shiftRegister,0,this.segmentSize),u(H,this._shiftRegister,16-this.segmentSize,Q,Q+this.segmentSize)}return H},x.prototype.decrypt=function(U){if(U.length%this.segmentSize!=0)throw new Error("invalid ciphertext size (must be segmentSize bytes)");for(var K,H=t(U,!0),Q=0;Q<H.length;Q+=this.segmentSize){K=this._aes.encrypt(this._shiftRegister);for(var $=0;$<this.segmentSize;$++)H[Q+$]^=K[$];u(this._shiftRegister,this._shiftRegister,0,this.segmentSize),u(U,this._shiftRegister,16-this.segmentSize,Q,Q+this.segmentSize)}return H};var P=function U(K,H){if(!(this instanceof U))throw Error("AES must be instanitated with `new`");if(this.description="Output Feedback",this.name="ofb",H){if(16!=H.length)throw new Error("invalid initialation vector size (must be 16 bytes)")}else H=i(16);this._lastPrecipher=t(H,!0),this._lastPrecipherIndex=16,this._aes=new te(K)};P.prototype.decrypt=P.prototype.encrypt=function(U){for(var K=t(U,!0),H=0;H<K.length;H++)16===this._lastPrecipherIndex&&(this._lastPrecipher=this._aes.encrypt(this._lastPrecipher),this._lastPrecipherIndex=0),K[H]^=this._lastPrecipher[this._lastPrecipherIndex++];return K};var I=function U(K){if(!(this instanceof U))throw Error("Counter must be instanitated with `new`");0===K||K||(K=1),"number"==typeof K?(this._counter=i(16),this.setValue(K)):this.setBytes(K)};I.prototype.setValue=function(U){if("number"!=typeof U||parseInt(U)!=U)throw new Error("invalid counter value (must be an integer)");if(U>Number.MAX_SAFE_INTEGER)throw new Error("integer value out of safe range");for(var K=15;K>=0;--K)this._counter[K]=U%256,U=parseInt(U/256)},I.prototype.setBytes=function(U){if(16!=(U=t(U,!0)).length)throw new Error("invalid counter bytes size (must be 16 bytes)");this._counter=U},I.prototype.increment=function(){for(var U=15;U>=0;U--){if(255!==this._counter[U]){this._counter[U]++;break}this._counter[U]=0}};var F=function U(K,H){if(!(this instanceof U))throw Error("AES must be instanitated with `new`");this.description="Counter",this.name="ctr",H instanceof I||(H=new I(H)),this._counter=H,this._remainingCounter=null,this._remainingCounterIndex=16,this._aes=new te(K)};F.prototype.decrypt=F.prototype.encrypt=function(U){for(var K=t(U,!0),H=0;H<K.length;H++)16===this._remainingCounterIndex&&(this._remainingCounter=this._aes.encrypt(this._counter._counter),this._remainingCounterIndex=0,this._counter.increment()),K[H]^=this._remainingCounter[this._remainingCounterIndex++];return K};var G={AES:te,Counter:I,ModeOfOperation:{ecb:b,cbc:D,cfb:x,ofb:P,ctr:F},utils:{hex:n,utf8:s},padding:{pkcs7:{pad:function(U){var K=16-(U=t(U,!0)).length%16,H=i(U.length+K);u(U,H);for(var Q=U.length;Q<H.length;Q++)H[Q]=K;return H},strip:function(U){if((U=t(U,!0)).length<16)throw new Error("PKCS#7 invalid length");var K=U[U.length-1];if(K>16)throw new Error("PKCS#7 padding byte out of range");for(var H=U.length-K,Q=0;Q<K;Q++)if(U[H+Q]!==K)throw new Error("PKCS#7 invalid padding byte");var $=i(H);return u(U,$,0,0,H),$}}},_arrayTest:{coerceArray:t,createArray:i,copyArray:u}};p.aesjs&&(G._aesjs=p.aesjs),p.aesjs=G}("undefined"!=typeof window?window:Ne),function(p){("undefined"!=typeof window?window:void 0!==Ne?Ne:"undefined"!=typeof self?self:this).elliptic=function d(l,t,i){function u(n,e){if(!t[n]){if(!l[n]){if(!e&&Ut)return Ut();if(c)return c(n,!0);var o=new Error("Cannot find module '"+n+"'");throw o.code="MODULE_NOT_FOUND",o}var r=t[n]={exports:{}};l[n][0].call(r.exports,function(h){return u(l[n][1][h]||h)},r,r.exports,d,l,t,i)}return t[n].exports}for(var c=Ut,s=0;s<i.length;s++)u(i[s]);return u}({1:[function(d,l,t){var i=t;i.version=d("../package.json").version,i.utils=d("./elliptic/utils"),i.rand=d("brorand"),i.curve=d("./elliptic/curve"),i.curves=d("./elliptic/curves"),i.ec=d("./elliptic/ec"),i.eddsa=d("./elliptic/eddsa")},{"../package.json":30,"./elliptic/curve":4,"./elliptic/curves":7,"./elliptic/ec":8,"./elliptic/eddsa":11,"./elliptic/utils":15,brorand:17}],2:[function(d,l,t){function i(r,h){this.type=r,this.p=new c(h.p,16),this.red=h.prime?c.red(h.prime):c.mont(this.p),this.zero=new c(0).toRed(this.red),this.one=new c(1).toRed(this.red),this.two=new c(2).toRed(this.red),this.n=h.n&&new c(h.n,16),this.g=h.g&&this.pointFromJSON(h.g,h.gRed),this._wnafT1=new Array(4),this._wnafT2=new Array(4),this._wnafT3=new Array(4),this._wnafT4=new Array(4);var f=this.n&&this.p.div(this.n);!f||f.cmpn(100)>0?this.redN=null:(this._maxwellTrick=!0,this.redN=this.n.toRed(this.red))}function u(r,h){this.curve=r,this.type=h,this.precomputed=null}var c=d("bn.js"),s=d("../../elliptic").utils,n=s.getNAF,e=s.getJSF,o=s.assert;l.exports=i,i.prototype.point=function(){throw new Error("Not implemented")},i.prototype.validate=function(){throw new Error("Not implemented")},i.prototype._fixedNafMul=function(r,h){o(r.precomputed);var f=r._getDoubles(),g=n(h,1),y=(1<<f.step+1)-(f.step%2==0?2:1);y/=3;for(var A=[],T=0;T<g.length;T+=f.step){var C=0;for(h=T+f.step-1;h>=T;h--)C=(C<<1)+g[h];A.push(C)}for(var E=this.jpoint(null,null,null),R=this.jpoint(null,null,null),O=y;O>0;O--){for(T=0;T<A.length;T++)(C=A[T])===O?R=R.mixedAdd(f.points[T]):C===-O&&(R=R.mixedAdd(f.points[T].neg()));E=E.add(R)}return E.toP()},i.prototype._wnafMul=function(r,h){for(var f=4,g=r._getNAFPoints(f),y=g.points,A=n(h,f=g.wnd),T=this.jpoint(null,null,null),C=A.length-1;C>=0;C--){for(h=0;C>=0&&0===A[C];C--)h++;if(C>=0&&h++,T=T.dblp(h),C<0)break;var E=A[C];o(0!==E),T="affine"===r.type?T.mixedAdd(E>0?y[E-1>>1]:y[-E-1>>1].neg()):T.add(E>0?y[E-1>>1]:y[-E-1>>1].neg())}return"affine"===r.type?T.toP():T},i.prototype._wnafMulAdd=function(r,h,f,g,y){for(var A=this._wnafT1,T=this._wnafT2,C=this._wnafT3,E=0,R=0;R<g;R++){var O=(U=h[R])._getNAFPoints(r);A[R]=O.wnd,T[R]=O.points}for(R=g-1;R>=1;R-=2){var L=R-1,N=R;if(1===A[L]&&1===A[N]){var W=[h[L],null,null,h[N]];0===h[L].y.cmp(h[N].y)?(W[1]=h[L].add(h[N]),W[2]=h[L].toJ().mixedAdd(h[N].neg())):0===h[L].y.cmp(h[N].y.redNeg())?(W[1]=h[L].toJ().mixedAdd(h[N]),W[2]=h[L].add(h[N].neg())):(W[1]=h[L].toJ().mixedAdd(h[N]),W[2]=h[L].toJ().mixedAdd(h[N].neg()));var j=[-3,-1,-5,-7,0,7,5,1,3],te=e(f[L],f[N]);E=Math.max(te[0].length,E),C[L]=new Array(E),C[N]=new Array(E);for(var b=0;b<E;b++)C[L][b]=j[3*(1+(0|te[0][b]))+(1+(0|te[1][b]))],C[N][b]=0,T[L]=W}else C[L]=n(f[L],A[L]),C[N]=n(f[N],A[N]),E=Math.max(C[L].length,E),E=Math.max(C[N].length,E)}var P=this.jpoint(null,null,null),I=this._wnafT4;for(R=E;R>=0;R--){for(var F=0;R>=0;){var G=!0;for(b=0;b<g;b++)I[b]=0|C[b][R],0!==I[b]&&(G=!1);if(!G)break;F++,R--}if(R>=0&&F++,P=P.dblp(F),R<0)break;for(b=0;b<g;b++){var U,K=I[b];0!==K&&(K>0?U=T[b][K-1>>1]:K<0&&(U=T[b][-K-1>>1].neg()),P="affine"===U.type?P.mixedAdd(U):P.add(U))}}for(R=0;R<g;R++)T[R]=null;return y?P:P.toP()},i.BasePoint=u,u.prototype.eq=function(){throw new Error("Not implemented")},u.prototype.validate=function(){return this.curve.validate(this)},i.prototype.decodePoint=function(r,h){r=s.toArray(r,h);var f=this.p.byteLength();if((4===r[0]||6===r[0]||7===r[0])&&r.length-1==2*f)return 6===r[0]?o(r[r.length-1]%2==0):7===r[0]&&o(r[r.length-1]%2==1),this.point(r.slice(1,1+f),r.slice(1+f,1+2*f));if((2===r[0]||3===r[0])&&r.length-1===f)return this.pointFromX(r.slice(1,1+f),3===r[0]);throw new Error("Unknown point format")},u.prototype.encodeCompressed=function(r){return this.encode(r,!0)},u.prototype._encode=function(r){var h=this.curve.p.byteLength(),f=this.getX().toArray("be",h);return r?[this.getY().isEven()?2:3].concat(f):[4].concat(f,this.getY().toArray("be",h))},u.prototype.encode=function(r,h){return s.encode(this._encode(h),r)},u.prototype.precompute=function(r){if(this.precomputed)return this;var h={doubles:null,naf:null,beta:null};return h.naf=this._getNAFPoints(8),h.doubles=this._getDoubles(4,r),h.beta=this._getBeta(),this.precomputed=h,this},u.prototype._hasDoubles=function(r){if(!this.precomputed)return!1;var h=this.precomputed.doubles;return!!h&&h.points.length>=Math.ceil((r.bitLength()+1)/h.step)},u.prototype._getDoubles=function(r,h){if(this.precomputed&&this.precomputed.doubles)return this.precomputed.doubles;for(var f=[this],g=this,y=0;y<h;y+=r){for(var A=0;A<r;A++)g=g.dbl();f.push(g)}return{step:r,points:f}},u.prototype._getNAFPoints=function(r){if(this.precomputed&&this.precomputed.naf)return this.precomputed.naf;for(var h=[this],f=(1<<r)-1,g=1===f?null:this.dbl(),y=1;y<f;y++)h[y]=h[y-1].add(g);return{wnd:r,points:h}},u.prototype._getBeta=function(){return null},u.prototype.dblp=function(r){for(var h=this,f=0;f<r;f++)h=h.dbl();return h}},{"../../elliptic":1,"bn.js":16}],3:[function(d,l,t){function i(h){this.twisted=1!=(0|h.a),this.mOneA=this.twisted&&-1==(0|h.a),this.extended=this.mOneA,o.call(this,"edwards",h),this.a=new n(h.a,16).umod(this.red.m),this.a=this.a.toRed(this.red),this.c=new n(h.c,16).toRed(this.red),this.c2=this.c.redSqr(),this.d=new n(h.d,16).toRed(this.red),this.dd=this.d.redAdd(this.d),r(!this.twisted||0===this.c.fromRed().cmpn(1)),this.oneC=1==(0|h.c)}function u(h,f,g,y,A){o.BasePoint.call(this,h,"projective"),null===f&&null===g&&null===y?(this.x=this.curve.zero,this.y=this.curve.one,this.z=this.curve.one,this.t=this.curve.zero,this.zOne=!0):(this.x=new n(f,16),this.y=new n(g,16),this.z=y?new n(y,16):this.curve.one,this.t=A&&new n(A,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.t&&!this.t.red&&(this.t=this.t.toRed(this.curve.red)),this.zOne=this.z===this.curve.one,this.curve.extended&&!this.t&&(this.t=this.x.redMul(this.y),this.zOne||(this.t=this.t.redMul(this.z.redInvm()))))}var c=d("../curve"),s=d("../../elliptic"),n=d("bn.js"),e=d("inherits"),o=c.base,r=s.utils.assert;e(i,o),l.exports=i,i.prototype._mulA=function(h){return this.mOneA?h.redNeg():this.a.redMul(h)},i.prototype._mulC=function(h){return this.oneC?h:this.c.redMul(h)},i.prototype.jpoint=function(h,f,g,y){return this.point(h,f,g,y)},i.prototype.pointFromX=function(h,f){(h=new n(h,16)).red||(h=h.toRed(this.red));var g=h.redSqr(),y=this.c2.redSub(this.a.redMul(g)),A=this.one.redSub(this.c2.redMul(this.d).redMul(g)),T=y.redMul(A.redInvm()),C=T.redSqrt();if(0!==C.redSqr().redSub(T).cmp(this.zero))throw new Error("invalid point");var E=C.fromRed().isOdd();return(f&&!E||!f&&E)&&(C=C.redNeg()),this.point(h,C)},i.prototype.pointFromY=function(h,f){(h=new n(h,16)).red||(h=h.toRed(this.red));var g=h.redSqr(),y=g.redSub(this.one),A=g.redMul(this.d).redAdd(this.one),T=y.redMul(A.redInvm());if(0===T.cmp(this.zero)){if(f)throw new Error("invalid point");return this.point(this.zero,h)}var C=T.redSqrt();if(0!==C.redSqr().redSub(T).cmp(this.zero))throw new Error("invalid point");return C.isOdd()!==f&&(C=C.redNeg()),this.point(C,h)},i.prototype.validate=function(h){if(h.isInfinity())return!0;h.normalize();var f=h.x.redSqr(),g=h.y.redSqr(),y=f.redMul(this.a).redAdd(g),A=this.c2.redMul(this.one.redAdd(this.d.redMul(f).redMul(g)));return 0===y.cmp(A)},e(u,o.BasePoint),i.prototype.pointFromJSON=function(h){return u.fromJSON(this,h)},i.prototype.point=function(h,f,g,y){return new u(this,h,f,g,y)},u.fromJSON=function(h,f){return new u(h,f[0],f[1],f[2])},u.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"},u.prototype.isInfinity=function(){return 0===this.x.cmpn(0)&&0===this.y.cmp(this.z)},u.prototype._extDbl=function(){var h=this.x.redSqr(),f=this.y.redSqr(),g=this.z.redSqr();g=g.redIAdd(g);var y=this.curve._mulA(h),A=this.x.redAdd(this.y).redSqr().redISub(h).redISub(f),T=y.redAdd(f),C=T.redSub(g),E=y.redSub(f),R=A.redMul(C),O=T.redMul(E),L=A.redMul(E),N=C.redMul(T);return this.curve.point(R,O,N,L)},u.prototype._projDbl=function(){var h,f,g,y=this.x.redAdd(this.y).redSqr(),A=this.x.redSqr(),T=this.y.redSqr();if(this.curve.twisted){var C=(O=this.curve._mulA(A)).redAdd(T);if(this.zOne)h=y.redSub(A).redSub(T).redMul(C.redSub(this.curve.two)),f=C.redMul(O.redSub(T)),g=C.redSqr().redSub(C).redSub(C);else{var E=this.z.redSqr(),R=C.redSub(E).redISub(E);h=y.redSub(A).redISub(T).redMul(R),f=C.redMul(O.redSub(T)),g=C.redMul(R)}}else{var O=A.redAdd(T);E=this.curve._mulC(this.c.redMul(this.z)).redSqr(),R=O.redSub(E).redSub(E),h=this.curve._mulC(y.redISub(O)).redMul(R),f=this.curve._mulC(O).redMul(A.redISub(T)),g=O.redMul(R)}return this.curve.point(h,f,g)},u.prototype.dbl=function(){return this.isInfinity()?this:this.curve.extended?this._extDbl():this._projDbl()},u.prototype._extAdd=function(h){var f=this.y.redSub(this.x).redMul(h.y.redSub(h.x)),g=this.y.redAdd(this.x).redMul(h.y.redAdd(h.x)),y=this.t.redMul(this.curve.dd).redMul(h.t),A=this.z.redMul(h.z.redAdd(h.z)),T=g.redSub(f),C=A.redSub(y),E=A.redAdd(y),R=g.redAdd(f),O=T.redMul(C),L=E.redMul(R),N=T.redMul(R),W=C.redMul(E);return this.curve.point(O,L,W,N)},u.prototype._projAdd=function(h){var f,g,y=this.z.redMul(h.z),A=y.redSqr(),T=this.x.redMul(h.x),C=this.y.redMul(h.y),E=this.curve.d.redMul(T).redMul(C),R=A.redSub(E),O=A.redAdd(E),L=this.x.redAdd(this.y).redMul(h.x.redAdd(h.y)).redISub(T).redISub(C),N=y.redMul(R).redMul(L);return this.curve.twisted?(f=y.redMul(O).redMul(C.redSub(this.curve._mulA(T))),g=R.redMul(O)):(f=y.redMul(O).redMul(C.redSub(T)),g=this.curve._mulC(R).redMul(O)),this.curve.point(N,f,g)},u.prototype.add=function(h){return this.isInfinity()?h:h.isInfinity()?this:this.curve.extended?this._extAdd(h):this._projAdd(h)},u.prototype.mul=function(h){return this._hasDoubles(h)?this.curve._fixedNafMul(this,h):this.curve._wnafMul(this,h)},u.prototype.mulAdd=function(h,f,g){return this.curve._wnafMulAdd(1,[this,f],[h,g],2,!1)},u.prototype.jmulAdd=function(h,f,g){return this.curve._wnafMulAdd(1,[this,f],[h,g],2,!0)},u.prototype.normalize=function(){if(this.zOne)return this;var h=this.z.redInvm();return this.x=this.x.redMul(h),this.y=this.y.redMul(h),this.t&&(this.t=this.t.redMul(h)),this.z=this.curve.one,this.zOne=!0,this},u.prototype.neg=function(){return this.curve.point(this.x.redNeg(),this.y,this.z,this.t&&this.t.redNeg())},u.prototype.getX=function(){return this.normalize(),this.x.fromRed()},u.prototype.getY=function(){return this.normalize(),this.y.fromRed()},u.prototype.eq=function(h){return this===h||0===this.getX().cmp(h.getX())&&0===this.getY().cmp(h.getY())},u.prototype.eqXToP=function(h){var f=h.toRed(this.curve.red).redMul(this.z);if(0===this.x.cmp(f))return!0;for(var g=h.clone(),y=this.curve.redN.redMul(this.z);;){if(g.iadd(this.curve.n),g.cmp(this.curve.p)>=0)return!1;if(f.redIAdd(y),0===this.x.cmp(f))return!0}return!1},u.prototype.toP=u.prototype.normalize,u.prototype.mixedAdd=u.prototype.add},{"../../elliptic":1,"../curve":4,"bn.js":16,inherits:27}],4:[function(d,l,t){var i=t;i.base=d("./base"),i.short=d("./short"),i.mont=d("./mont"),i.edwards=d("./edwards")},{"./base":2,"./edwards":3,"./mont":5,"./short":6}],5:[function(d,l,t){function i(r){e.call(this,"mont",r),this.a=new s(r.a,16).toRed(this.red),this.b=new s(r.b,16).toRed(this.red),this.i4=new s(4).toRed(this.red).redInvm(),this.two=new s(2).toRed(this.red),this.a24=this.i4.redMul(this.a.redAdd(this.two))}function u(r,h,f){e.BasePoint.call(this,r,"projective"),null===h&&null===f?(this.x=this.curve.one,this.z=this.curve.zero):(this.x=new s(h,16),this.z=new s(f,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)))}var c=d("../curve"),s=d("bn.js"),n=d("inherits"),e=c.base,o=d("../../elliptic").utils;n(i,e),l.exports=i,i.prototype.validate=function(r){var h=r.normalize().x,f=h.redSqr(),g=f.redMul(h).redAdd(f.redMul(this.a)).redAdd(h);return 0===g.redSqrt().redSqr().cmp(g)},n(u,e.BasePoint),i.prototype.decodePoint=function(r,h){return this.point(o.toArray(r,h),1)},i.prototype.point=function(r,h){return new u(this,r,h)},i.prototype.pointFromJSON=function(r){return u.fromJSON(this,r)},u.prototype.precompute=function(){},u.prototype._encode=function(){return this.getX().toArray("be",this.curve.p.byteLength())},u.fromJSON=function(r,h){return new u(r,h[0],h[1]||r.one)},u.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"},u.prototype.isInfinity=function(){return 0===this.z.cmpn(0)},u.prototype.dbl=function(){var r=this.x.redAdd(this.z).redSqr(),h=this.x.redSub(this.z).redSqr(),f=r.redSub(h),g=r.redMul(h),y=f.redMul(h.redAdd(this.curve.a24.redMul(f)));return this.curve.point(g,y)},u.prototype.add=function(){throw new Error("Not supported on Montgomery curve")},u.prototype.diffAdd=function(r,h){var f=this.x.redAdd(this.z),g=this.x.redSub(this.z),y=r.x.redAdd(r.z),A=r.x.redSub(r.z).redMul(f),T=y.redMul(g),C=h.z.redMul(A.redAdd(T).redSqr()),E=h.x.redMul(A.redISub(T).redSqr());return this.curve.point(C,E)},u.prototype.mul=function(r){for(var h=r.clone(),f=this,g=this.curve.point(null,null),y=[];0!==h.cmpn(0);h.iushrn(1))y.push(h.andln(1));for(var A=y.length-1;A>=0;A--)0===y[A]?(f=f.diffAdd(g,this),g=g.dbl()):(g=f.diffAdd(g,this),f=f.dbl());return g},u.prototype.mulAdd=function(){throw new Error("Not supported on Montgomery curve")},u.prototype.jumlAdd=function(){throw new Error("Not supported on Montgomery curve")},u.prototype.eq=function(r){return 0===this.getX().cmp(r.getX())},u.prototype.normalize=function(){return this.x=this.x.redMul(this.z.redInvm()),this.z=this.curve.one,this},u.prototype.getX=function(){return this.normalize(),this.x.fromRed()}},{"../../elliptic":1,"../curve":4,"bn.js":16,inherits:27}],6:[function(d,l,t){function i(f){r.call(this,"short",f),this.a=new e(f.a,16).toRed(this.red),this.b=new e(f.b,16).toRed(this.red),this.tinv=this.two.redInvm(),this.zeroA=0===this.a.fromRed().cmpn(0),this.threeA=0===this.a.fromRed().sub(this.p).cmpn(-3),this.endo=this._getEndomorphism(f),this._endoWnafT1=new Array(4),this._endoWnafT2=new Array(4)}function u(f,g,y,A){r.BasePoint.call(this,f,"affine"),null===g&&null===y?(this.x=null,this.y=null,this.inf=!0):(this.x=new e(g,16),this.y=new e(y,16),A&&(this.x.forceRed(this.curve.red),this.y.forceRed(this.curve.red)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.inf=!1)}function c(f,g,y,A){r.BasePoint.call(this,f,"jacobian"),null===g&&null===y&&null===A?(this.x=this.curve.one,this.y=this.curve.one,this.z=new e(0)):(this.x=new e(g,16),this.y=new e(y,16),this.z=new e(A,16)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.zOne=this.z===this.curve.one}var s=d("../curve"),n=d("../../elliptic"),e=d("bn.js"),o=d("inherits"),r=s.base,h=n.utils.assert;o(i,r),l.exports=i,i.prototype._getEndomorphism=function(f){if(this.zeroA&&this.g&&this.n&&1===this.p.modn(3)){var g,y;if(f.beta)g=new e(f.beta,16).toRed(this.red);else{var A=this._getEndoRoots(this.p);g=(g=A[0].cmp(A[1])<0?A[0]:A[1]).toRed(this.red)}if(f.lambda)y=new e(f.lambda,16);else{var T=this._getEndoRoots(this.n);0===this.g.mul(T[0]).x.cmp(this.g.x.redMul(g))?y=T[0]:h(0===this.g.mul(y=T[1]).x.cmp(this.g.x.redMul(g)))}return{beta:g,lambda:y,basis:f.basis?f.basis.map(function(C){return{a:new e(C.a,16),b:new e(C.b,16)}}):this._getEndoBasis(y)}}},i.prototype._getEndoRoots=function(f){var g=f===this.p?this.red:e.mont(f),y=new e(2).toRed(g).redInvm(),A=y.redNeg(),T=new e(3).toRed(g).redNeg().redSqrt().redMul(y);return[A.redAdd(T).fromRed(),A.redSub(T).fromRed()]},i.prototype._getEndoBasis=function(f){for(var g,y,A,T,C,E,R,O,L,N=this.n.ushrn(Math.floor(this.n.bitLength()/2)),W=f,j=this.n.clone(),te=new e(1),b=new e(0),D=new e(0),x=new e(1),P=0;0!==W.cmpn(0);){var I=j.div(W);O=j.sub(I.mul(W)),L=D.sub(I.mul(te));var F=x.sub(I.mul(b));if(!A&&O.cmp(N)<0)g=R.neg(),y=te,A=O.neg(),T=L;else if(A&&2==++P)break;R=O,j=W,W=O,D=te,te=L,x=b,b=F}C=O.neg(),E=L;var G=A.sqr().add(T.sqr());return C.sqr().add(E.sqr()).cmp(G)>=0&&(C=g,E=y),A.negative&&(A=A.neg(),T=T.neg()),C.negative&&(C=C.neg(),E=E.neg()),[{a:A,b:T},{a:C,b:E}]},i.prototype._endoSplit=function(f){var g=this.endo.basis,y=g[0],A=g[1],T=A.b.mul(f).divRound(this.n),C=y.b.neg().mul(f).divRound(this.n),E=T.mul(y.a),R=C.mul(A.a),O=T.mul(y.b),L=C.mul(A.b);return{k1:f.sub(E).sub(R),k2:O.add(L).neg()}},i.prototype.pointFromX=function(f,g){(f=new e(f,16)).red||(f=f.toRed(this.red));var y=f.redSqr().redMul(f).redIAdd(f.redMul(this.a)).redIAdd(this.b),A=y.redSqrt();if(0!==A.redSqr().redSub(y).cmp(this.zero))throw new Error("invalid point");var T=A.fromRed().isOdd();return(g&&!T||!g&&T)&&(A=A.redNeg()),this.point(f,A)},i.prototype.validate=function(f){if(f.inf)return!0;var g=f.x,y=f.y,A=this.a.redMul(g),T=g.redSqr().redMul(g).redIAdd(A).redIAdd(this.b);return 0===y.redSqr().redISub(T).cmpn(0)},i.prototype._endoWnafMulAdd=function(f,g,y){for(var A=this._endoWnafT1,T=this._endoWnafT2,C=0;C<f.length;C++){var E=this._endoSplit(g[C]),R=f[C],O=R._getBeta();E.k1.negative&&(E.k1.ineg(),R=R.neg(!0)),E.k2.negative&&(E.k2.ineg(),O=O.neg(!0)),A[2*C]=R,A[2*C+1]=O,T[2*C]=E.k1,T[2*C+1]=E.k2}for(var L=this._wnafMulAdd(1,A,T,2*C,y),N=0;N<2*C;N++)A[N]=null,T[N]=null;return L},o(u,r.BasePoint),i.prototype.point=function(f,g,y){return new u(this,f,g,y)},i.prototype.pointFromJSON=function(f,g){return u.fromJSON(this,f,g)},u.prototype._getBeta=function(){if(this.curve.endo){var f=this.precomputed;if(f&&f.beta)return f.beta;var g=this.curve.point(this.x.redMul(this.curve.endo.beta),this.y);if(f){var y=this.curve,A=function(T){return y.point(T.x.redMul(y.endo.beta),T.y)};f.beta=g,g.precomputed={beta:null,naf:f.naf&&{wnd:f.naf.wnd,points:f.naf.points.map(A)},doubles:f.doubles&&{step:f.doubles.step,points:f.doubles.points.map(A)}}}return g}},u.prototype.toJSON=function(){return this.precomputed?[this.x,this.y,this.precomputed&&{doubles:this.precomputed.doubles&&{step:this.precomputed.doubles.step,points:this.precomputed.doubles.points.slice(1)},naf:this.precomputed.naf&&{wnd:this.precomputed.naf.wnd,points:this.precomputed.naf.points.slice(1)}}]:[this.x,this.y]},u.fromJSON=function(f,g,y){function A(E){return f.point(E[0],E[1],y)}"string"==typeof g&&(g=JSON.parse(g));var T=f.point(g[0],g[1],y);if(!g[2])return T;var C=g[2];return T.precomputed={beta:null,doubles:C.doubles&&{step:C.doubles.step,points:[T].concat(C.doubles.points.map(A))},naf:C.naf&&{wnd:C.naf.wnd,points:[T].concat(C.naf.points.map(A))}},T},u.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+">"},u.prototype.isInfinity=function(){return this.inf},u.prototype.add=function(f){if(this.inf)return f;if(f.inf)return this;if(this.eq(f))return this.dbl();if(this.neg().eq(f))return this.curve.point(null,null);if(0===this.x.cmp(f.x))return this.curve.point(null,null);var g=this.y.redSub(f.y);0!==g.cmpn(0)&&(g=g.redMul(this.x.redSub(f.x).redInvm()));var y=g.redSqr().redISub(this.x).redISub(f.x),A=g.redMul(this.x.redSub(y)).redISub(this.y);return this.curve.point(y,A)},u.prototype.dbl=function(){if(this.inf)return this;var f=this.y.redAdd(this.y);if(0===f.cmpn(0))return this.curve.point(null,null);var g=this.curve.a,y=this.x.redSqr(),A=f.redInvm(),T=y.redAdd(y).redIAdd(y).redIAdd(g).redMul(A),C=T.redSqr().redISub(this.x.redAdd(this.x)),E=T.redMul(this.x.redSub(C)).redISub(this.y);return this.curve.point(C,E)},u.prototype.getX=function(){return this.x.fromRed()},u.prototype.getY=function(){return this.y.fromRed()},u.prototype.mul=function(f){return f=new e(f,16),this._hasDoubles(f)?this.curve._fixedNafMul(this,f):this.curve.endo?this.curve._endoWnafMulAdd([this],[f]):this.curve._wnafMul(this,f)},u.prototype.mulAdd=function(f,g,y){var A=[this,g],T=[f,y];return this.curve.endo?this.curve._endoWnafMulAdd(A,T):this.curve._wnafMulAdd(1,A,T,2)},u.prototype.jmulAdd=function(f,g,y){var A=[this,g],T=[f,y];return this.curve.endo?this.curve._endoWnafMulAdd(A,T,!0):this.curve._wnafMulAdd(1,A,T,2,!0)},u.prototype.eq=function(f){return this===f||this.inf===f.inf&&(this.inf||0===this.x.cmp(f.x)&&0===this.y.cmp(f.y))},u.prototype.neg=function(f){if(this.inf)return this;var g=this.curve.point(this.x,this.y.redNeg());if(f&&this.precomputed){var y=this.precomputed,A=function(T){return T.neg()};g.precomputed={naf:y.naf&&{wnd:y.naf.wnd,points:y.naf.points.map(A)},doubles:y.doubles&&{step:y.doubles.step,points:y.doubles.points.map(A)}}}return g},u.prototype.toJ=function(){return this.inf?this.curve.jpoint(null,null,null):this.curve.jpoint(this.x,this.y,this.curve.one)},o(c,r.BasePoint),i.prototype.jpoint=function(f,g,y){return new c(this,f,g,y)},c.prototype.toP=function(){if(this.isInfinity())return this.curve.point(null,null);var f=this.z.redInvm(),g=f.redSqr(),y=this.x.redMul(g),A=this.y.redMul(g).redMul(f);return this.curve.point(y,A)},c.prototype.neg=function(){return this.curve.jpoint(this.x,this.y.redNeg(),this.z)},c.prototype.add=function(f){if(this.isInfinity())return f;if(f.isInfinity())return this;var g=f.z.redSqr(),y=this.z.redSqr(),A=this.x.redMul(g),T=f.x.redMul(y),C=this.y.redMul(g.redMul(f.z)),E=f.y.redMul(y.redMul(this.z)),R=A.redSub(T),O=C.redSub(E);if(0===R.cmpn(0))return 0!==O.cmpn(0)?this.curve.jpoint(null,null,null):this.dbl();var L=R.redSqr(),N=L.redMul(R),W=A.redMul(L),j=O.redSqr().redIAdd(N).redISub(W).redISub(W),te=O.redMul(W.redISub(j)).redISub(C.redMul(N)),b=this.z.redMul(f.z).redMul(R);return this.curve.jpoint(j,te,b)},c.prototype.mixedAdd=function(f){if(this.isInfinity())return f.toJ();if(f.isInfinity())return this;var g=this.z.redSqr(),y=this.x,A=f.x.redMul(g),T=this.y,C=f.y.redMul(g).redMul(this.z),E=y.redSub(A),R=T.redSub(C);if(0===E.cmpn(0))return 0!==R.cmpn(0)?this.curve.jpoint(null,null,null):this.dbl();var O=E.redSqr(),L=O.redMul(E),N=y.redMul(O),W=R.redSqr().redIAdd(L).redISub(N).redISub(N),j=R.redMul(N.redISub(W)).redISub(T.redMul(L)),te=this.z.redMul(E);return this.curve.jpoint(W,j,te)},c.prototype.dblp=function(f){if(0===f)return this;if(this.isInfinity())return this;if(!f)return this.dbl();if(this.curve.zeroA||this.curve.threeA){for(var g=this,y=0;y<f;y++)g=g.dbl();return g}var A=this.curve.a,T=this.curve.tinv,C=this.x,E=this.y,R=this.z,O=R.redSqr().redSqr(),L=E.redAdd(E);for(y=0;y<f;y++){var N=C.redSqr(),W=L.redSqr(),j=W.redSqr(),te=N.redAdd(N).redIAdd(N).redIAdd(A.redMul(O)),b=C.redMul(W),D=te.redSqr().redISub(b.redAdd(b)),x=b.redISub(D),P=te.redMul(x);P=P.redIAdd(P).redISub(j);var I=L.redMul(R);y+1<f&&(O=O.redMul(j)),C=D,R=I,L=P}return this.curve.jpoint(C,L.redMul(T),R)},c.prototype.dbl=function(){return this.isInfinity()?this:this.curve.zeroA?this._zeroDbl():this.curve.threeA?this._threeDbl():this._dbl()},c.prototype._zeroDbl=function(){var f,g,y;if(this.zOne){var A=this.x.redSqr(),T=this.y.redSqr(),C=T.redSqr(),E=this.x.redAdd(T).redSqr().redISub(A).redISub(C);E=E.redIAdd(E);var R=A.redAdd(A).redIAdd(A),O=R.redSqr().redISub(E).redISub(E),L=C.redIAdd(C);L=(L=L.redIAdd(L)).redIAdd(L),f=O,g=R.redMul(E.redISub(O)).redISub(L),y=this.y.redAdd(this.y)}else{var N=this.x.redSqr(),W=this.y.redSqr(),j=W.redSqr(),te=this.x.redAdd(W).redSqr().redISub(N).redISub(j);te=te.redIAdd(te);var b=N.redAdd(N).redIAdd(N),D=b.redSqr(),x=j.redIAdd(j);x=(x=x.redIAdd(x)).redIAdd(x),f=D.redISub(te).redISub(te),g=b.redMul(te.redISub(f)).redISub(x),y=(y=this.y.redMul(this.z)).redIAdd(y)}return this.curve.jpoint(f,g,y)},c.prototype._threeDbl=function(){var f,g,y;if(this.zOne){var A=this.x.redSqr(),T=this.y.redSqr(),C=T.redSqr(),E=this.x.redAdd(T).redSqr().redISub(A).redISub(C);E=E.redIAdd(E);var R=A.redAdd(A).redIAdd(A).redIAdd(this.curve.a),O=R.redSqr().redISub(E).redISub(E);f=O;var L=C.redIAdd(C);L=(L=L.redIAdd(L)).redIAdd(L),g=R.redMul(E.redISub(O)).redISub(L),y=this.y.redAdd(this.y)}else{var N=this.z.redSqr(),W=this.y.redSqr(),j=this.x.redMul(W),te=this.x.redSub(N).redMul(this.x.redAdd(N));te=te.redAdd(te).redIAdd(te);var b=j.redIAdd(j),D=(b=b.redIAdd(b)).redAdd(b);f=te.redSqr().redISub(D),y=this.y.redAdd(this.z).redSqr().redISub(W).redISub(N);var x=W.redSqr();x=(x=(x=x.redIAdd(x)).redIAdd(x)).redIAdd(x),g=te.redMul(b.redISub(f)).redISub(x)}return this.curve.jpoint(f,g,y)},c.prototype._dbl=function(){var f=this.curve.a,g=this.x,y=this.y,A=this.z,T=A.redSqr().redSqr(),C=g.redSqr(),E=y.redSqr(),R=C.redAdd(C).redIAdd(C).redIAdd(f.redMul(T)),O=g.redAdd(g),L=(O=O.redIAdd(O)).redMul(E),N=R.redSqr().redISub(L.redAdd(L)),W=L.redISub(N),j=E.redSqr();j=(j=(j=j.redIAdd(j)).redIAdd(j)).redIAdd(j);var te=R.redMul(W).redISub(j),b=y.redAdd(y).redMul(A);return this.curve.jpoint(N,te,b)},c.prototype.trpl=function(){if(!this.curve.zeroA)return this.dbl().add(this);var f=this.x.redSqr(),g=this.y.redSqr(),y=this.z.redSqr(),A=g.redSqr(),T=f.redAdd(f).redIAdd(f),C=T.redSqr(),E=this.x.redAdd(g).redSqr().redISub(f).redISub(A),R=(E=(E=(E=E.redIAdd(E)).redAdd(E).redIAdd(E)).redISub(C)).redSqr(),O=A.redIAdd(A);O=(O=(O=O.redIAdd(O)).redIAdd(O)).redIAdd(O);var L=T.redIAdd(E).redSqr().redISub(C).redISub(R).redISub(O),N=g.redMul(L);N=(N=N.redIAdd(N)).redIAdd(N);var W=this.x.redMul(R).redISub(N);W=(W=W.redIAdd(W)).redIAdd(W);var j=this.y.redMul(L.redMul(O.redISub(L)).redISub(E.redMul(R)));j=(j=(j=j.redIAdd(j)).redIAdd(j)).redIAdd(j);var te=this.z.redAdd(E).redSqr().redISub(y).redISub(R);return this.curve.jpoint(W,j,te)},c.prototype.mul=function(f,g){return f=new e(f,g),this.curve._wnafMul(this,f)},c.prototype.eq=function(f){if("affine"===f.type)return this.eq(f.toJ());if(this===f)return!0;var g=this.z.redSqr(),y=f.z.redSqr();if(0!==this.x.redMul(y).redISub(f.x.redMul(g)).cmpn(0))return!1;var A=g.redMul(this.z),T=y.redMul(f.z);return 0===this.y.redMul(T).redISub(f.y.redMul(A)).cmpn(0)},c.prototype.eqXToP=function(f){var g=this.z.redSqr(),y=f.toRed(this.curve.red).redMul(g);if(0===this.x.cmp(y))return!0;for(var A=f.clone(),T=this.curve.redN.redMul(g);;){if(A.iadd(this.curve.n),A.cmp(this.curve.p)>=0)return!1;if(y.redIAdd(T),0===this.x.cmp(y))return!0}return!1},c.prototype.inspect=function(){return this.isInfinity()?"<EC JPoint Infinity>":"<EC JPoint x: "+this.x.toString(16,2)+" y: "+this.y.toString(16,2)+" z: "+this.z.toString(16,2)+">"},c.prototype.isInfinity=function(){return 0===this.z.cmpn(0)}},{"../../elliptic":1,"../curve":4,"bn.js":16,inherits:27}],7:[function(d,l,t){function i(r){this.curve="short"===r.type?new e.curve.short(r):"edwards"===r.type?new e.curve.edwards(r):new e.curve.mont(r),this.g=this.curve.g,this.n=this.curve.n,this.hash=r.hash,o(this.g.validate(),"Invalid curve"),o(this.g.mul(this.n).isInfinity(),"Invalid curve, G*N != O")}function u(r,h){Object.defineProperty(s,r,{configurable:!0,enumerable:!0,get:function(){var f=new i(h);return Object.defineProperty(s,r,{configurable:!0,enumerable:!0,value:f}),f}})}var c,s=t,n=d("hash.js"),e=d("../elliptic"),o=e.utils.assert;s.PresetCurve=i,u("p192",{type:"short",prime:"p192",p:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff",a:"ffffffff ffffffff ffffffff fffffffe ffffffff fffffffc",b:"64210519 e59c80e7 0fa7e9ab 72243049 feb8deec c146b9b1",n:"ffffffff ffffffff ffffffff 99def836 146bc9b1 b4d22831",hash:n.sha256,gRed:!1,g:["188da80e b03090f6 7cbf20eb 43a18800 f4ff0afd 82ff1012","07192b95 ffc8da78 631011ed 6b24cdd5 73f977a1 1e794811"]}),u("p224",{type:"short",prime:"p224",p:"ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001",a:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff fffffffe",b:"b4050a85 0c04b3ab f5413256 5044b0b7 d7bfd8ba 270b3943 2355ffb4",n:"ffffffff ffffffff ffffffff ffff16a2 e0b8f03e 13dd2945 5c5c2a3d",hash:n.sha256,gRed:!1,g:["b70e0cbd 6bb4bf7f 321390b9 4a03c1d3 56c21122 343280d6 115c1d21","bd376388 b5f723fb 4c22dfe6 cd4375a0 5a074764 44d58199 85007e34"]}),u("p256",{type:"short",prime:null,p:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff ffffffff",a:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff fffffffc",b:"5ac635d8 aa3a93e7 b3ebbd55 769886bc 651d06b0 cc53b0f6 3bce3c3e 27d2604b",n:"ffffffff 00000000 ffffffff ffffffff bce6faad a7179e84 f3b9cac2 fc632551",hash:n.sha256,gRed:!1,g:["6b17d1f2 e12c4247 f8bce6e5 63a440f2 77037d81 2deb33a0 f4a13945 d898c296","4fe342e2 fe1a7f9b 8ee7eb4a 7c0f9e16 2bce3357 6b315ece cbb64068 37bf51f5"]}),u("p384",{type:"short",prime:null,p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 ffffffff",a:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 fffffffc",b:"b3312fa7 e23ee7e4 988e056b e3f82d19 181d9c6e fe814112 0314088f 5013875a c656398d 8a2ed19d 2a85c8ed d3ec2aef",n:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff c7634d81 f4372ddf 581a0db2 48b0a77a ecec196a ccc52973",hash:n.sha384,gRed:!1,g:["aa87ca22 be8b0537 8eb1c71e f320ad74 6e1d3b62 8ba79b98 59f741e0 82542a38 5502f25d bf55296c 3a545e38 72760ab7","3617de4a 96262c6f 5d9e98bf 9292dc29 f8f41dbd 289a147c e9da3113 b5f0b8c0 0a60b1ce 1d7e819d 7a431d7c 90ea0e5f"]}),u("p521",{type:"short",prime:null,p:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff",a:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffc",b:"00000051 953eb961 8e1c9a1f 929a21a0 b68540ee a2da725b 99b315f3 b8b48991 8ef109e1 56193951 ec7e937b 1652c0bd 3bb1bf07 3573df88 3d2c34f1 ef451fd4 6b503f00",n:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffa 51868783 bf2f966b 7fcc0148 f709a5d0 3bb5c9b8 899c47ae bb6fb71e 91386409",hash:n.sha512,gRed:!1,g:["000000c6 858e06b7 0404e9cd 9e3ecb66 2395b442 9c648139 053fb521 f828af60 6b4d3dba a14b5e77 efe75928 fe1dc127 a2ffa8de 3348b3c1 856a429b f97e7e31 c2e5bd66","00000118 39296a78 9a3bc004 5c8a5fb4 2c7d1bd9 98f54449 579b4468 17afbd17 273e662c 97ee7299 5ef42640 c550b901 3fad0761 353c7086 a272c240 88be9476 9fd16650"]}),u("curve25519",{type:"mont",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"76d06",b:"1",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:n.sha256,gRed:!1,g:["9"]}),u("ed25519",{type:"edwards",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"-1",c:"1",d:"52036cee2b6ffe73 8cc740797779e898 00700a4d4141d8ab 75eb4dca135978a3",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:n.sha256,gRed:!1,g:["216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a","6666666666666666666666666666666666666666666666666666666666666658"]});try{c=d("./precomputed/secp256k1")}catch(r){c=void 0}u("secp256k1",{type:"short",prime:"k256",p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f",a:"0",b:"7",n:"ffffffff ffffffff ffffffff fffffffe baaedce6 af48a03b bfd25e8c d0364141",h:"1",hash:n.sha256,beta:"7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee",lambda:"5363ad4cc05c30e0a5261c028812645a122e22ea20816678df02967c1b23bd72",basis:[{a:"3086d221a7d46bcde86c90e49284eb15",b:"-e4437ed6010e88286f547fa90abfe4c3"},{a:"114ca50f7a8e2f3f657c1108d9d44cfd8",b:"3086d221a7d46bcde86c90e49284eb15"}],gRed:!1,g:["79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798","483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8",c]})},{"../elliptic":1,"./precomputed/secp256k1":14,"hash.js":19}],8:[function(d,l,t){function i(r){return this instanceof i?("string"==typeof r&&(n(s.curves.hasOwnProperty(r),"Unknown curve "+r),r=s.curves[r]),r instanceof s.curves.PresetCurve&&(r={curve:r}),this.curve=r.curve.curve,this.n=this.curve.n,this.nh=this.n.ushrn(1),this.g=this.curve.g,this.g=r.curve.g,this.g.precompute(r.curve.n.bitLength()+1),void(this.hash=r.hash||r.curve.hash)):new i(r)}var u=d("bn.js"),c=d("hmac-drbg"),s=d("../../elliptic"),n=s.utils.assert,e=d("./key"),o=d("./signature");l.exports=i,i.prototype.keyPair=function(r){return new e(this,r)},i.prototype.keyFromPrivate=function(r,h){return e.fromPrivate(this,r,h)},i.prototype.keyFromPublic=function(r,h){return e.fromPublic(this,r,h)},i.prototype.genKeyPair=function(r){r||(r={});for(var h=new c({hash:this.hash,pers:r.pers,persEnc:r.persEnc||"utf8",entropy:r.entropy||s.rand(this.hash.hmacStrength),entropyEnc:r.entropy&&r.entropyEnc||"utf8",nonce:this.n.toArray()}),f=this.n.byteLength(),g=this.n.sub(new u(2));;){var y=new u(h.generate(f));if(!(y.cmp(g)>0))return y.iaddn(1),this.keyFromPrivate(y)}},i.prototype._truncateToN=function(r,h){var f=8*r.byteLength()-this.n.bitLength();return f>0&&(r=r.ushrn(f)),!h&&r.cmp(this.n)>=0?r.sub(this.n):r},i.prototype.sign=function(r,h,f,g){"object"==De(f)&&(g=f,f=null),g||(g={}),h=this.keyFromPrivate(h,f),r=this._truncateToN(new u(r,16));for(var y=this.n.byteLength(),A=h.getPrivate().toArray("be",y),T=r.toArray("be",y),C=new c({hash:this.hash,entropy:A,nonce:T,pers:g.pers,persEnc:g.persEnc||"utf8"}),E=this.n.sub(new u(1)),R=0;;R++){var O=g.k?g.k(R):new u(C.generate(this.n.byteLength()));if(!((O=this._truncateToN(O,!0)).cmpn(1)<=0||O.cmp(E)>=0)){var L=this.g.mul(O);if(!L.isInfinity()){var N=L.getX(),W=N.umod(this.n);if(0!==W.cmpn(0)){var j=O.invm(this.n).mul(W.mul(h.getPrivate()).iadd(r));if(0!==(j=j.umod(this.n)).cmpn(0)){var te=(L.getY().isOdd()?1:0)|(0!==N.cmp(W)?2:0);return g.canonical&&j.cmp(this.nh)>0&&(j=this.n.sub(j),te^=1),new o({r:W,s:j,recoveryParam:te})}}}}}},i.prototype.verify=function(r,h,f,g){r=this._truncateToN(new u(r,16)),f=this.keyFromPublic(f,g);var y=(h=new o(h,"hex")).r,A=h.s;if(y.cmpn(1)<0||y.cmp(this.n)>=0||A.cmpn(1)<0||A.cmp(this.n)>=0)return!1;var T,C=A.invm(this.n),E=C.mul(r).umod(this.n),R=C.mul(y).umod(this.n);return this.curve._maxwellTrick?!(T=this.g.jmulAdd(E,f.getPublic(),R)).isInfinity()&&T.eqXToP(y):!(T=this.g.mulAdd(E,f.getPublic(),R)).isInfinity()&&0===T.getX().umod(this.n).cmp(y)},i.prototype.recoverPubKey=function(r,h,f,g){n((3&f)===f,"The recovery param is more than two bits"),h=new o(h,g);var y=this.n,A=new u(r),T=h.r,C=h.s,E=1&f,R=f>>1;if(T.cmp(this.curve.p.umod(this.curve.n))>=0&&R)throw new Error("Unable to find sencond key candinate");T=this.curve.pointFromX(R?T.add(this.curve.n):T,E);var O=h.r.invm(y),L=y.sub(A).mul(O).umod(y),N=C.mul(O).umod(y);return this.g.mulAdd(L,T,N)},i.prototype.getKeyRecoveryParam=function(r,h,f,g){if(null!==(h=new o(h,g)).recoveryParam)return h.recoveryParam;for(var y=0;y<4;y++){var A;try{A=this.recoverPubKey(r,h,y)}catch(T){continue}if(A.eq(f))return y}throw new Error("Unable to find valid recovery factor")}},{"../../elliptic":1,"./key":9,"./signature":10,"bn.js":16,"hmac-drbg":25}],9:[function(d,l,t){function i(s,n){this.ec=s,this.priv=null,this.pub=null,n.priv&&this._importPrivate(n.priv,n.privEnc),n.pub&&this._importPublic(n.pub,n.pubEnc)}var u=d("bn.js"),c=d("../../elliptic").utils.assert;l.exports=i,i.fromPublic=function(s,n,e){return n instanceof i?n:new i(s,{pub:n,pubEnc:e})},i.fromPrivate=function(s,n,e){return n instanceof i?n:new i(s,{priv:n,privEnc:e})},i.prototype.validate=function(){var s=this.getPublic();return s.isInfinity()?{result:!1,reason:"Invalid public key"}:s.validate()?s.mul(this.ec.curve.n).isInfinity()?{result:!0,reason:null}:{result:!1,reason:"Public key * N != O"}:{result:!1,reason:"Public key is not a point"}},i.prototype.getPublic=function(s,n){return"string"==typeof s&&(n=s,s=null),this.pub||(this.pub=this.ec.g.mul(this.priv)),n?this.pub.encode(n,s):this.pub},i.prototype.getPrivate=function(s){return"hex"===s?this.priv.toString(16,2):this.priv},i.prototype._importPrivate=function(s,n){this.priv=new u(s,n||16),this.priv=this.priv.umod(this.ec.curve.n)},i.prototype._importPublic=function(s,n){return s.x||s.y?("mont"===this.ec.curve.type?c(s.x,"Need x coordinate"):"short"!==this.ec.curve.type&&"edwards"!==this.ec.curve.type||c(s.x&&s.y,"Need both x and y coordinate"),void(this.pub=this.ec.curve.point(s.x,s.y))):void(this.pub=this.ec.curve.decodePoint(s,n))},i.prototype.derive=function(s){return s.mul(this.priv).getX()},i.prototype.sign=function(s,n,e){return this.ec.sign(s,this,n,e)},i.prototype.verify=function(s,n){return this.ec.verify(s,n,this)},i.prototype.inspect=function(){return"<Key priv: "+(this.priv&&this.priv.toString(16,2))+" pub: "+(this.pub&&this.pub.inspect())+" >"}},{"../../elliptic":1,"bn.js":16}],10:[function(d,l,t){function i(h,f){return h instanceof i?h:void(this._importDER(h,f)||(r(h.r&&h.s,"Signature without r or s"),this.r=new e(h.r,16),this.s=new e(h.s,16),this.recoveryParam=void 0===h.recoveryParam?null:h.recoveryParam))}function u(){this.place=0}function c(h,f){var g=h[f.place++];if(!(128&g))return g;for(var y=15&g,A=0,T=0,C=f.place;T<y;T++,C++)A<<=8,A|=h[C];return f.place=C,A}function s(h){for(var f=0,g=h.length-1;!h[f]&&!(128&h[f+1])&&f<g;)f++;return 0===f?h:h.slice(f)}function n(h,f){if(f<128)h.push(f);else{var g=1+(Math.log(f)/Math.LN2>>>3);for(h.push(128|g);--g;)h.push(f>>>(g<<3)&255);h.push(f)}}var e=d("bn.js"),o=d("../../elliptic").utils,r=o.assert;l.exports=i,i.prototype._importDER=function(h,f){h=o.toArray(h,f);var g=new u;if(48!==h[g.place++]||c(h,g)+g.place!==h.length||2!==h[g.place++])return!1;var y=c(h,g),A=h.slice(g.place,y+g.place);if(g.place+=y,2!==h[g.place++])return!1;var T=c(h,g);if(h.length!==T+g.place)return!1;var C=h.slice(g.place,T+g.place);return 0===A[0]&&128&A[1]&&(A=A.slice(1)),0===C[0]&&128&C[1]&&(C=C.slice(1)),this.r=new e(A),this.s=new e(C),this.recoveryParam=null,!0},i.prototype.toDER=function(h){var f=this.r.toArray(),g=this.s.toArray();for(128&f[0]&&(f=[0].concat(f)),128&g[0]&&(g=[0].concat(g)),f=s(f),g=s(g);!(g[0]||128&g[1]);)g=g.slice(1);var y=[2];n(y,f.length),(y=y.concat(f)).push(2),n(y,g.length);var A=y.concat(g),T=[48];return n(T,A.length),T=T.concat(A),o.encode(T,h)}},{"../../elliptic":1,"bn.js":16}],11:[function(d,l,t){function i(h){if(n("ed25519"===h,"only tested with ed25519 so far"),!(this instanceof i))return new i(h);this.curve=h=c.curves[h].curve,this.g=h.g,this.g.precompute(h.n.bitLength()+1),this.pointClass=h.point().constructor,this.encodingLength=Math.ceil(h.n.bitLength()/8),this.hash=u.sha512}var u=d("hash.js"),c=d("../../elliptic"),s=c.utils,n=s.assert,e=s.parseBytes,o=d("./key"),r=d("./signature");l.exports=i,i.prototype.sign=function(h,f){h=e(h);var g=this.keyFromSecret(f),y=this.hashInt(g.messagePrefix(),h),A=this.g.mul(y),T=this.encodePoint(A),C=this.hashInt(T,g.pubBytes(),h).mul(g.priv()),E=y.add(C).umod(this.curve.n);return this.makeSignature({R:A,S:E,Rencoded:T})},i.prototype.verify=function(h,f,g){h=e(h),f=this.makeSignature(f);var y=this.keyFromPublic(g),A=this.hashInt(f.Rencoded(),y.pubBytes(),h),T=this.g.mul(f.S());return f.R().add(y.pub().mul(A)).eq(T)},i.prototype.hashInt=function(){for(var h=this.hash(),f=0;f<arguments.length;f++)h.update(arguments[f]);return s.intFromLE(h.digest()).umod(this.curve.n)},i.prototype.keyFromPublic=function(h){return o.fromPublic(this,h)},i.prototype.keyFromSecret=function(h){return o.fromSecret(this,h)},i.prototype.makeSignature=function(h){return h instanceof r?h:new r(this,h)},i.prototype.encodePoint=function(h){var f=h.getY().toArray("le",this.encodingLength);return f[this.encodingLength-1]|=h.getX().isOdd()?128:0,f},i.prototype.decodePoint=function(h){var f=(h=s.parseBytes(h)).length-1,g=h.slice(0,f).concat(-129&h[f]),y=0!=(128&h[f]),A=s.intFromLE(g);return this.curve.pointFromY(A,y)},i.prototype.encodeInt=function(h){return h.toArray("le",this.encodingLength)},i.prototype.decodeInt=function(h){return s.intFromLE(h)},i.prototype.isPoint=function(h){return h instanceof this.pointClass}},{"../../elliptic":1,"./key":12,"./signature":13,"hash.js":19}],12:[function(d,l,t){function i(e,o){this.eddsa=e,this._secret=s(o.secret),e.isPoint(o.pub)?this._pub=o.pub:this._pubBytes=s(o.pub)}var u=d("../../elliptic").utils,c=u.assert,s=u.parseBytes,n=u.cachedProperty;i.fromPublic=function(e,o){return o instanceof i?o:new i(e,{pub:o})},i.fromSecret=function(e,o){return o instanceof i?o:new i(e,{secret:o})},i.prototype.secret=function(){return this._secret},n(i,"pubBytes",function(){return this.eddsa.encodePoint(this.pub())}),n(i,"pub",function(){return this._pubBytes?this.eddsa.decodePoint(this._pubBytes):this.eddsa.g.mul(this.priv())}),n(i,"privBytes",function(){var e=this.eddsa,o=this.hash(),r=e.encodingLength-1,h=o.slice(0,e.encodingLength);return h[0]&=248,h[r]&=127,h[r]|=64,h}),n(i,"priv",function(){return this.eddsa.decodeInt(this.privBytes())}),n(i,"hash",function(){return this.eddsa.hash().update(this.secret()).digest()}),n(i,"messagePrefix",function(){return this.hash().slice(this.eddsa.encodingLength)}),i.prototype.sign=function(e){return c(this._secret,"KeyPair can only verify"),this.eddsa.sign(e,this)},i.prototype.verify=function(e,o){return this.eddsa.verify(e,o,this)},i.prototype.getSecret=function(e){return c(this._secret,"KeyPair is public only"),u.encode(this.secret(),e)},i.prototype.getPublic=function(e){return u.encode(this.pubBytes(),e)},l.exports=i},{"../../elliptic":1}],13:[function(d,l,t){function i(o,r){this.eddsa=o,"object"!=De(r)&&(r=e(r)),Array.isArray(r)&&(r={R:r.slice(0,o.encodingLength),S:r.slice(o.encodingLength)}),s(r.R&&r.S,"Signature without R or S"),o.isPoint(r.R)&&(this._R=r.R),r.S instanceof u&&(this._S=r.S),this._Rencoded=Array.isArray(r.R)?r.R:r.Rencoded,this._Sencoded=Array.isArray(r.S)?r.S:r.Sencoded}var u=d("bn.js"),c=d("../../elliptic").utils,s=c.assert,n=c.cachedProperty,e=c.parseBytes;n(i,"S",function(){return this.eddsa.decodeInt(this.Sencoded())}),n(i,"R",function(){return this.eddsa.decodePoint(this.Rencoded())}),n(i,"Rencoded",function(){return this.eddsa.encodePoint(this.R())}),n(i,"Sencoded",function(){return this.eddsa.encodeInt(this.S())}),i.prototype.toBytes=function(){return this.Rencoded().concat(this.Sencoded())},i.prototype.toHex=function(){return c.encode(this.toBytes(),"hex").toUpperCase()},l.exports=i},{"../../elliptic":1,"bn.js":16}],14:[function(d,l,t){l.exports={doubles:{step:4,points:[["e60fce93b59e9ec53011aabc21c23e97b2a31369b87a5ae9c44ee89e2a6dec0a","f7e3507399e595929db99f34f57937101296891e44d23f0be1f32cce69616821"],["8282263212c609d9ea2a6e3e172de238d8c39cabd5ac1ca10646e23fd5f51508","11f8a8098557dfe45e8256e830b60ace62d613ac2f7b17bed31b6eaff6e26caf"],["175e159f728b865a72f99cc6c6fc846de0b93833fd2222ed73fce5b551e5b739","d3506e0d9e3c79eba4ef97a51ff71f5eacb5955add24345c6efa6ffee9fed695"],["363d90d447b00c9c99ceac05b6262ee053441c7e55552ffe526bad8f83ff4640","4e273adfc732221953b445397f3363145b9a89008199ecb62003c7f3bee9de9"],["8b4b5f165df3c2be8c6244b5b745638843e4a781a15bcd1b69f79a55dffdf80c","4aad0a6f68d308b4b3fbd7813ab0da04f9e336546162ee56b3eff0c65fd4fd36"],["723cbaa6e5db996d6bf771c00bd548c7b700dbffa6c0e77bcb6115925232fcda","96e867b5595cc498a921137488824d6e2660a0653779494801dc069d9eb39f5f"],["eebfa4d493bebf98ba5feec812c2d3b50947961237a919839a533eca0e7dd7fa","5d9a8ca3970ef0f269ee7edaf178089d9ae4cdc3a711f712ddfd4fdae1de8999"],["100f44da696e71672791d0a09b7bde459f1215a29b3c03bfefd7835b39a48db0","cdd9e13192a00b772ec8f3300c090666b7ff4a18ff5195ac0fbd5cd62bc65a09"],["e1031be262c7ed1b1dc9227a4a04c017a77f8d4464f3b3852c8acde6e534fd2d","9d7061928940405e6bb6a4176597535af292dd419e1ced79a44f18f29456a00d"],["feea6cae46d55b530ac2839f143bd7ec5cf8b266a41d6af52d5e688d9094696d","e57c6b6c97dce1bab06e4e12bf3ecd5c981c8957cc41442d3155debf18090088"],["da67a91d91049cdcb367be4be6ffca3cfeed657d808583de33fa978bc1ec6cb1","9bacaa35481642bc41f463f7ec9780e5dec7adc508f740a17e9ea8e27a68be1d"],["53904faa0b334cdda6e000935ef22151ec08d0f7bb11069f57545ccc1a37b7c0","5bc087d0bc80106d88c9eccac20d3c1c13999981e14434699dcb096b022771c8"],["8e7bcd0bd35983a7719cca7764ca906779b53a043a9b8bcaeff959f43ad86047","10b7770b2a3da4b3940310420ca9514579e88e2e47fd68b3ea10047e8460372a"],["385eed34c1cdff21e6d0818689b81bde71a7f4f18397e6690a841e1599c43862","283bebc3e8ea23f56701de19e9ebf4576b304eec2086dc8cc0458fe5542e5453"],["6f9d9b803ecf191637c73a4413dfa180fddf84a5947fbc9c606ed86c3fac3a7","7c80c68e603059ba69b8e2a30e45c4d47ea4dd2f5c281002d86890603a842160"],["3322d401243c4e2582a2147c104d6ecbf774d163db0f5e5313b7e0e742d0e6bd","56e70797e9664ef5bfb019bc4ddaf9b72805f63ea2873af624f3a2e96c28b2a0"],["85672c7d2de0b7da2bd1770d89665868741b3f9af7643397721d74d28134ab83","7c481b9b5b43b2eb6374049bfa62c2e5e77f17fcc5298f44c8e3094f790313a6"],["948bf809b1988a46b06c9f1919413b10f9226c60f668832ffd959af60c82a0a","53a562856dcb6646dc6b74c5d1c3418c6d4dff08c97cd2bed4cb7f88d8c8e589"],["6260ce7f461801c34f067ce0f02873a8f1b0e44dfc69752accecd819f38fd8e8","bc2da82b6fa5b571a7f09049776a1ef7ecd292238051c198c1a84e95b2b4ae17"],["e5037de0afc1d8d43d8348414bbf4103043ec8f575bfdc432953cc8d2037fa2d","4571534baa94d3b5f9f98d09fb990bddbd5f5b03ec481f10e0e5dc841d755bda"],["e06372b0f4a207adf5ea905e8f1771b4e7e8dbd1c6a6c5b725866a0ae4fce725","7a908974bce18cfe12a27bb2ad5a488cd7484a7787104870b27034f94eee31dd"],["213c7a715cd5d45358d0bbf9dc0ce02204b10bdde2a3f58540ad6908d0559754","4b6dad0b5ae462507013ad06245ba190bb4850f5f36a7eeddff2c27534b458f2"],["4e7c272a7af4b34e8dbb9352a5419a87e2838c70adc62cddf0cc3a3b08fbd53c","17749c766c9d0b18e16fd09f6def681b530b9614bff7dd33e0b3941817dcaae6"],["fea74e3dbe778b1b10f238ad61686aa5c76e3db2be43057632427e2840fb27b6","6e0568db9b0b13297cf674deccb6af93126b596b973f7b77701d3db7f23cb96f"],["76e64113f677cf0e10a2570d599968d31544e179b760432952c02a4417bdde39","c90ddf8dee4e95cf577066d70681f0d35e2a33d2b56d2032b4b1752d1901ac01"],["c738c56b03b2abe1e8281baa743f8f9a8f7cc643df26cbee3ab150242bcbb891","893fb578951ad2537f718f2eacbfbbbb82314eef7880cfe917e735d9699a84c3"],["d895626548b65b81e264c7637c972877d1d72e5f3a925014372e9f6588f6c14b","febfaa38f2bc7eae728ec60818c340eb03428d632bb067e179363ed75d7d991f"],["b8da94032a957518eb0f6433571e8761ceffc73693e84edd49150a564f676e03","2804dfa44805a1e4d7c99cc9762808b092cc584d95ff3b511488e4e74efdf6e7"],["e80fea14441fb33a7d8adab9475d7fab2019effb5156a792f1a11778e3c0df5d","eed1de7f638e00771e89768ca3ca94472d155e80af322ea9fcb4291b6ac9ec78"],["a301697bdfcd704313ba48e51d567543f2a182031efd6915ddc07bbcc4e16070","7370f91cfb67e4f5081809fa25d40f9b1735dbf7c0a11a130c0d1a041e177ea1"],["90ad85b389d6b936463f9d0512678de208cc330b11307fffab7ac63e3fb04ed4","e507a3620a38261affdcbd9427222b839aefabe1582894d991d4d48cb6ef150"],["8f68b9d2f63b5f339239c1ad981f162ee88c5678723ea3351b7b444c9ec4c0da","662a9f2dba063986de1d90c2b6be215dbbea2cfe95510bfdf23cbf79501fff82"],["e4f3fb0176af85d65ff99ff9198c36091f48e86503681e3e6686fd5053231e11","1e63633ad0ef4f1c1661a6d0ea02b7286cc7e74ec951d1c9822c38576feb73bc"],["8c00fa9b18ebf331eb961537a45a4266c7034f2f0d4e1d0716fb6eae20eae29e","efa47267fea521a1a9dc343a3736c974c2fadafa81e36c54e7d2a4c66702414b"],["e7a26ce69dd4829f3e10cec0a9e98ed3143d084f308b92c0997fddfc60cb3e41","2a758e300fa7984b471b006a1aafbb18d0a6b2c0420e83e20e8a9421cf2cfd51"],["b6459e0ee3662ec8d23540c223bcbdc571cbcb967d79424f3cf29eb3de6b80ef","67c876d06f3e06de1dadf16e5661db3c4b3ae6d48e35b2ff30bf0b61a71ba45"],["d68a80c8280bb840793234aa118f06231d6f1fc67e73c5a5deda0f5b496943e8","db8ba9fff4b586d00c4b1f9177b0e28b5b0e7b8f7845295a294c84266b133120"],["324aed7df65c804252dc0270907a30b09612aeb973449cea4095980fc28d3d5d","648a365774b61f2ff130c0c35aec1f4f19213b0c7e332843967224af96ab7c84"],["4df9c14919cde61f6d51dfdbe5fee5dceec4143ba8d1ca888e8bd373fd054c96","35ec51092d8728050974c23a1d85d4b5d506cdc288490192ebac06cad10d5d"],["9c3919a84a474870faed8a9c1cc66021523489054d7f0308cbfc99c8ac1f98cd","ddb84f0f4a4ddd57584f044bf260e641905326f76c64c8e6be7e5e03d4fc599d"],["6057170b1dd12fdf8de05f281d8e06bb91e1493a8b91d4cc5a21382120a959e5","9a1af0b26a6a4807add9a2daf71df262465152bc3ee24c65e899be932385a2a8"],["a576df8e23a08411421439a4518da31880cef0fba7d4df12b1a6973eecb94266","40a6bf20e76640b2c92b97afe58cd82c432e10a7f514d9f3ee8be11ae1b28ec8"],["7778a78c28dec3e30a05fe9629de8c38bb30d1f5cf9a3a208f763889be58ad71","34626d9ab5a5b22ff7098e12f2ff580087b38411ff24ac563b513fc1fd9f43ac"],["928955ee637a84463729fd30e7afd2ed5f96274e5ad7e5cb09eda9c06d903ac","c25621003d3f42a827b78a13093a95eeac3d26efa8a8d83fc5180e935bcd091f"],["85d0fef3ec6db109399064f3a0e3b2855645b4a907ad354527aae75163d82751","1f03648413a38c0be29d496e582cf5663e8751e96877331582c237a24eb1f962"],["ff2b0dce97eece97c1c9b6041798b85dfdfb6d8882da20308f5404824526087e","493d13fef524ba188af4c4dc54d07936c7b7ed6fb90e2ceb2c951e01f0c29907"],["827fbbe4b1e880ea9ed2b2e6301b212b57f1ee148cd6dd28780e5e2cf856e241","c60f9c923c727b0b71bef2c67d1d12687ff7a63186903166d605b68baec293ec"],["eaa649f21f51bdbae7be4ae34ce6e5217a58fdce7f47f9aa7f3b58fa2120e2b3","be3279ed5bbbb03ac69a80f89879aa5a01a6b965f13f7e59d47a5305ba5ad93d"],["e4a42d43c5cf169d9391df6decf42ee541b6d8f0c9a137401e23632dda34d24f","4d9f92e716d1c73526fc99ccfb8ad34ce886eedfa8d8e4f13a7f7131deba9414"],["1ec80fef360cbdd954160fadab352b6b92b53576a88fea4947173b9d4300bf19","aeefe93756b5340d2f3a4958a7abbf5e0146e77f6295a07b671cdc1cc107cefd"],["146a778c04670c2f91b00af4680dfa8bce3490717d58ba889ddb5928366642be","b318e0ec3354028add669827f9d4b2870aaa971d2f7e5ed1d0b297483d83efd0"],["fa50c0f61d22e5f07e3acebb1aa07b128d0012209a28b9776d76a8793180eef9","6b84c6922397eba9b72cd2872281a68a5e683293a57a213b38cd8d7d3f4f2811"],["da1d61d0ca721a11b1a5bf6b7d88e8421a288ab5d5bba5220e53d32b5f067ec2","8157f55a7c99306c79c0766161c91e2966a73899d279b48a655fba0f1ad836f1"],["a8e282ff0c9706907215ff98e8fd416615311de0446f1e062a73b0610d064e13","7f97355b8db81c09abfb7f3c5b2515888b679a3e50dd6bd6cef7c73111f4cc0c"],["174a53b9c9a285872d39e56e6913cab15d59b1fa512508c022f382de8319497c","ccc9dc37abfc9c1657b4155f2c47f9e6646b3a1d8cb9854383da13ac079afa73"],["959396981943785c3d3e57edf5018cdbe039e730e4918b3d884fdff09475b7ba","2e7e552888c331dd8ba0386a4b9cd6849c653f64c8709385e9b8abf87524f2fd"],["d2a63a50ae401e56d645a1153b109a8fcca0a43d561fba2dbb51340c9d82b151","e82d86fb6443fcb7565aee58b2948220a70f750af484ca52d4142174dcf89405"],["64587e2335471eb890ee7896d7cfdc866bacbdbd3839317b3436f9b45617e073","d99fcdd5bf6902e2ae96dd6447c299a185b90a39133aeab358299e5e9faf6589"],["8481bde0e4e4d885b3a546d3e549de042f0aa6cea250e7fd358d6c86dd45e458","38ee7b8cba5404dd84a25bf39cecb2ca900a79c42b262e556d64b1b59779057e"],["13464a57a78102aa62b6979ae817f4637ffcfed3c4b1ce30bcd6303f6caf666b","69be159004614580ef7e433453ccb0ca48f300a81d0942e13f495a907f6ecc27"],["bc4a9df5b713fe2e9aef430bcc1dc97a0cd9ccede2f28588cada3a0d2d83f366","d3a81ca6e785c06383937adf4b798caa6e8a9fbfa547b16d758d666581f33c1"],["8c28a97bf8298bc0d23d8c749452a32e694b65e30a9472a3954ab30fe5324caa","40a30463a3305193378fedf31f7cc0eb7ae784f0451cb9459e71dc73cbef9482"],["8ea9666139527a8c1dd94ce4f071fd23c8b350c5a4bb33748c4ba111faccae0","620efabbc8ee2782e24e7c0cfb95c5d735b783be9cf0f8e955af34a30e62b945"],["dd3625faef5ba06074669716bbd3788d89bdde815959968092f76cc4eb9a9787","7a188fa3520e30d461da2501045731ca941461982883395937f68d00c644a573"],["f710d79d9eb962297e4f6232b40e8f7feb2bc63814614d692c12de752408221e","ea98e67232d3b3295d3b535532115ccac8612c721851617526ae47a9c77bfc82"]]},naf:{wnd:7,points:[["f9308a019258c31049344f85f89d5229b531c845836f99b08601f113bce036f9","388f7b0f632de8140fe337e62a37f3566500a99934c2231b6cb9fd7584b8e672"],["2f8bde4d1a07209355b4a7250a5c5128e88b84bddc619ab7cba8d569b240efe4","d8ac222636e5e3d6d4dba9dda6c9c426f788271bab0d6840dca87d3aa6ac62d6"],["5cbdf0646e5db4eaa398f365f2ea7a0e3d419b7e0330e39ce92bddedcac4f9bc","6aebca40ba255960a3178d6d861a54dba813d0b813fde7b5a5082628087264da"],["acd484e2f0c7f65309ad178a9f559abde09796974c57e714c35f110dfc27ccbe","cc338921b0a7d9fd64380971763b61e9add888a4375f8e0f05cc262ac64f9c37"],["774ae7f858a9411e5ef4246b70c65aac5649980be5c17891bbec17895da008cb","d984a032eb6b5e190243dd56d7b7b365372db1e2dff9d6a8301d74c9c953c61b"],["f28773c2d975288bc7d1d205c3748651b075fbc6610e58cddeeddf8f19405aa8","ab0902e8d880a89758212eb65cdaf473a1a06da521fa91f29b5cb52db03ed81"],["d7924d4f7d43ea965a465ae3095ff41131e5946f3c85f79e44adbcf8e27e080e","581e2872a86c72a683842ec228cc6defea40af2bd896d3a5c504dc9ff6a26b58"],["defdea4cdb677750a420fee807eacf21eb9898ae79b9768766e4faa04a2d4a34","4211ab0694635168e997b0ead2a93daeced1f4a04a95c0f6cfb199f69e56eb77"],["2b4ea0a797a443d293ef5cff444f4979f06acfebd7e86d277475656138385b6c","85e89bc037945d93b343083b5a1c86131a01f60c50269763b570c854e5c09b7a"],["352bbf4a4cdd12564f93fa332ce333301d9ad40271f8107181340aef25be59d5","321eb4075348f534d59c18259dda3e1f4a1b3b2e71b1039c67bd3d8bcf81998c"],["2fa2104d6b38d11b0230010559879124e42ab8dfeff5ff29dc9cdadd4ecacc3f","2de1068295dd865b64569335bd5dd80181d70ecfc882648423ba76b532b7d67"],["9248279b09b4d68dab21a9b066edda83263c3d84e09572e269ca0cd7f5453714","73016f7bf234aade5d1aa71bdea2b1ff3fc0de2a887912ffe54a32ce97cb3402"],["daed4f2be3a8bf278e70132fb0beb7522f570e144bf615c07e996d443dee8729","a69dce4a7d6c98e8d4a1aca87ef8d7003f83c230f3afa726ab40e52290be1c55"],["c44d12c7065d812e8acf28d7cbb19f9011ecd9e9fdf281b0e6a3b5e87d22e7db","2119a460ce326cdc76c45926c982fdac0e106e861edf61c5a039063f0e0e6482"],["6a245bf6dc698504c89a20cfded60853152b695336c28063b61c65cbd269e6b4","e022cf42c2bd4a708b3f5126f16a24ad8b33ba48d0423b6efd5e6348100d8a82"],["1697ffa6fd9de627c077e3d2fe541084ce13300b0bec1146f95ae57f0d0bd6a5","b9c398f186806f5d27561506e4557433a2cf15009e498ae7adee9d63d01b2396"],["605bdb019981718b986d0f07e834cb0d9deb8360ffb7f61df982345ef27a7479","2972d2de4f8d20681a78d93ec96fe23c26bfae84fb14db43b01e1e9056b8c49"],["62d14dab4150bf497402fdc45a215e10dcb01c354959b10cfe31c7e9d87ff33d","80fc06bd8cc5b01098088a1950eed0db01aa132967ab472235f5642483b25eaf"],["80c60ad0040f27dade5b4b06c408e56b2c50e9f56b9b8b425e555c2f86308b6f","1c38303f1cc5c30f26e66bad7fe72f70a65eed4cbe7024eb1aa01f56430bd57a"],["7a9375ad6167ad54aa74c6348cc54d344cc5dc9487d847049d5eabb0fa03c8fb","d0e3fa9eca8726909559e0d79269046bdc59ea10c70ce2b02d499ec224dc7f7"],["d528ecd9b696b54c907a9ed045447a79bb408ec39b68df504bb51f459bc3ffc9","eecf41253136e5f99966f21881fd656ebc4345405c520dbc063465b521409933"],["49370a4b5f43412ea25f514e8ecdad05266115e4a7ecb1387231808f8b45963","758f3f41afd6ed428b3081b0512fd62a54c3f3afbb5b6764b653052a12949c9a"],["77f230936ee88cbbd73df930d64702ef881d811e0e1498e2f1c13eb1fc345d74","958ef42a7886b6400a08266e9ba1b37896c95330d97077cbbe8eb3c7671c60d6"],["f2dac991cc4ce4b9ea44887e5c7c0bce58c80074ab9d4dbaeb28531b7739f530","e0dedc9b3b2f8dad4da1f32dec2531df9eb5fbeb0598e4fd1a117dba703a3c37"],["463b3d9f662621fb1b4be8fbbe2520125a216cdfc9dae3debcba4850c690d45b","5ed430d78c296c3543114306dd8622d7c622e27c970a1de31cb377b01af7307e"],["f16f804244e46e2a09232d4aff3b59976b98fac14328a2d1a32496b49998f247","cedabd9b82203f7e13d206fcdf4e33d92a6c53c26e5cce26d6579962c4e31df6"],["caf754272dc84563b0352b7a14311af55d245315ace27c65369e15f7151d41d1","cb474660ef35f5f2a41b643fa5e460575f4fa9b7962232a5c32f908318a04476"],["2600ca4b282cb986f85d0f1709979d8b44a09c07cb86d7c124497bc86f082120","4119b88753c15bd6a693b03fcddbb45d5ac6be74ab5f0ef44b0be9475a7e4b40"],["7635ca72d7e8432c338ec53cd12220bc01c48685e24f7dc8c602a7746998e435","91b649609489d613d1d5e590f78e6d74ecfc061d57048bad9e76f302c5b9c61"],["754e3239f325570cdbbf4a87deee8a66b7f2b33479d468fbc1a50743bf56cc18","673fb86e5bda30fb3cd0ed304ea49a023ee33d0197a695d0c5d98093c536683"],["e3e6bd1071a1e96aff57859c82d570f0330800661d1c952f9fe2694691d9b9e8","59c9e0bba394e76f40c0aa58379a3cb6a5a2283993e90c4167002af4920e37f5"],["186b483d056a033826ae73d88f732985c4ccb1f32ba35f4b4cc47fdcf04aa6eb","3b952d32c67cf77e2e17446e204180ab21fb8090895138b4a4a797f86e80888b"],["df9d70a6b9876ce544c98561f4be4f725442e6d2b737d9c91a8321724ce0963f","55eb2dafd84d6ccd5f862b785dc39d4ab157222720ef9da217b8c45cf2ba2417"],["5edd5cc23c51e87a497ca815d5dce0f8ab52554f849ed8995de64c5f34ce7143","efae9c8dbc14130661e8cec030c89ad0c13c66c0d17a2905cdc706ab7399a868"],["290798c2b6476830da12fe02287e9e777aa3fba1c355b17a722d362f84614fba","e38da76dcd440621988d00bcf79af25d5b29c094db2a23146d003afd41943e7a"],["af3c423a95d9f5b3054754efa150ac39cd29552fe360257362dfdecef4053b45","f98a3fd831eb2b749a93b0e6f35cfb40c8cd5aa667a15581bc2feded498fd9c6"],["766dbb24d134e745cccaa28c99bf274906bb66b26dcf98df8d2fed50d884249a","744b1152eacbe5e38dcc887980da38b897584a65fa06cedd2c924f97cbac5996"],["59dbf46f8c94759ba21277c33784f41645f7b44f6c596a58ce92e666191abe3e","c534ad44175fbc300f4ea6ce648309a042ce739a7919798cd85e216c4a307f6e"],["f13ada95103c4537305e691e74e9a4a8dd647e711a95e73cb62dc6018cfd87b8","e13817b44ee14de663bf4bc808341f326949e21a6a75c2570778419bdaf5733d"],["7754b4fa0e8aced06d4167a2c59cca4cda1869c06ebadfb6488550015a88522c","30e93e864e669d82224b967c3020b8fa8d1e4e350b6cbcc537a48b57841163a2"],["948dcadf5990e048aa3874d46abef9d701858f95de8041d2a6828c99e2262519","e491a42537f6e597d5d28a3224b1bc25df9154efbd2ef1d2cbba2cae5347d57e"],["7962414450c76c1689c7b48f8202ec37fb224cf5ac0bfa1570328a8a3d7c77ab","100b610ec4ffb4760d5c1fc133ef6f6b12507a051f04ac5760afa5b29db83437"],["3514087834964b54b15b160644d915485a16977225b8847bb0dd085137ec47ca","ef0afbb2056205448e1652c48e8127fc6039e77c15c2378b7e7d15a0de293311"],["d3cc30ad6b483e4bc79ce2c9dd8bc54993e947eb8df787b442943d3f7b527eaf","8b378a22d827278d89c5e9be8f9508ae3c2ad46290358630afb34db04eede0a4"],["1624d84780732860ce1c78fcbfefe08b2b29823db913f6493975ba0ff4847610","68651cf9b6da903e0914448c6cd9d4ca896878f5282be4c8cc06e2a404078575"],["733ce80da955a8a26902c95633e62a985192474b5af207da6df7b4fd5fc61cd4","f5435a2bd2badf7d485a4d8b8db9fcce3e1ef8e0201e4578c54673bc1dc5ea1d"],["15d9441254945064cf1a1c33bbd3b49f8966c5092171e699ef258dfab81c045c","d56eb30b69463e7234f5137b73b84177434800bacebfc685fc37bbe9efe4070d"],["a1d0fcf2ec9de675b612136e5ce70d271c21417c9d2b8aaaac138599d0717940","edd77f50bcb5a3cab2e90737309667f2641462a54070f3d519212d39c197a629"],["e22fbe15c0af8ccc5780c0735f84dbe9a790badee8245c06c7ca37331cb36980","a855babad5cd60c88b430a69f53a1a7a38289154964799be43d06d77d31da06"],["311091dd9860e8e20ee13473c1155f5f69635e394704eaa74009452246cfa9b3","66db656f87d1f04fffd1f04788c06830871ec5a64feee685bd80f0b1286d8374"],["34c1fd04d301be89b31c0442d3e6ac24883928b45a9340781867d4232ec2dbdf","9414685e97b1b5954bd46f730174136d57f1ceeb487443dc5321857ba73abee"],["f219ea5d6b54701c1c14de5b557eb42a8d13f3abbcd08affcc2a5e6b049b8d63","4cb95957e83d40b0f73af4544cccf6b1f4b08d3c07b27fb8d8c2962a400766d1"],["d7b8740f74a8fbaab1f683db8f45de26543a5490bca627087236912469a0b448","fa77968128d9c92ee1010f337ad4717eff15db5ed3c049b3411e0315eaa4593b"],["32d31c222f8f6f0ef86f7c98d3a3335ead5bcd32abdd94289fe4d3091aa824bf","5f3032f5892156e39ccd3d7915b9e1da2e6dac9e6f26e961118d14b8462e1661"],["7461f371914ab32671045a155d9831ea8793d77cd59592c4340f86cbc18347b5","8ec0ba238b96bec0cbdddcae0aa442542eee1ff50c986ea6b39847b3cc092ff6"],["ee079adb1df1860074356a25aa38206a6d716b2c3e67453d287698bad7b2b2d6","8dc2412aafe3be5c4c5f37e0ecc5f9f6a446989af04c4e25ebaac479ec1c8c1e"],["16ec93e447ec83f0467b18302ee620f7e65de331874c9dc72bfd8616ba9da6b5","5e4631150e62fb40d0e8c2a7ca5804a39d58186a50e497139626778e25b0674d"],["eaa5f980c245f6f038978290afa70b6bd8855897f98b6aa485b96065d537bd99","f65f5d3e292c2e0819a528391c994624d784869d7e6ea67fb18041024edc07dc"],["78c9407544ac132692ee1910a02439958ae04877151342ea96c4b6b35a49f51","f3e0319169eb9b85d5404795539a5e68fa1fbd583c064d2462b675f194a3ddb4"],["494f4be219a1a77016dcd838431aea0001cdc8ae7a6fc688726578d9702857a5","42242a969283a5f339ba7f075e36ba2af925ce30d767ed6e55f4b031880d562c"],["a598a8030da6d86c6bc7f2f5144ea549d28211ea58faa70ebf4c1e665c1fe9b5","204b5d6f84822c307e4b4a7140737aec23fc63b65b35f86a10026dbd2d864e6b"],["c41916365abb2b5d09192f5f2dbeafec208f020f12570a184dbadc3e58595997","4f14351d0087efa49d245b328984989d5caf9450f34bfc0ed16e96b58fa9913"],["841d6063a586fa475a724604da03bc5b92a2e0d2e0a36acfe4c73a5514742881","73867f59c0659e81904f9a1c7543698e62562d6744c169ce7a36de01a8d6154"],["5e95bb399a6971d376026947f89bde2f282b33810928be4ded112ac4d70e20d5","39f23f366809085beebfc71181313775a99c9aed7d8ba38b161384c746012865"],["36e4641a53948fd476c39f8a99fd974e5ec07564b5315d8bf99471bca0ef2f66","d2424b1b1abe4eb8164227b085c9aa9456ea13493fd563e06fd51cf5694c78fc"],["336581ea7bfbbb290c191a2f507a41cf5643842170e914faeab27c2c579f726","ead12168595fe1be99252129b6e56b3391f7ab1410cd1e0ef3dcdcabd2fda224"],["8ab89816dadfd6b6a1f2634fcf00ec8403781025ed6890c4849742706bd43ede","6fdcef09f2f6d0a044e654aef624136f503d459c3e89845858a47a9129cdd24e"],["1e33f1a746c9c5778133344d9299fcaa20b0938e8acff2544bb40284b8c5fb94","60660257dd11b3aa9c8ed618d24edff2306d320f1d03010e33a7d2057f3b3b6"],["85b7c1dcb3cec1b7ee7f30ded79dd20a0ed1f4cc18cbcfcfa410361fd8f08f31","3d98a9cdd026dd43f39048f25a8847f4fcafad1895d7a633c6fed3c35e999511"],["29df9fbd8d9e46509275f4b125d6d45d7fbe9a3b878a7af872a2800661ac5f51","b4c4fe99c775a606e2d8862179139ffda61dc861c019e55cd2876eb2a27d84b"],["a0b1cae06b0a847a3fea6e671aaf8adfdfe58ca2f768105c8082b2e449fce252","ae434102edde0958ec4b19d917a6a28e6b72da1834aff0e650f049503a296cf2"],["4e8ceafb9b3e9a136dc7ff67e840295b499dfb3b2133e4ba113f2e4c0e121e5","cf2174118c8b6d7a4b48f6d534ce5c79422c086a63460502b827ce62a326683c"],["d24a44e047e19b6f5afb81c7ca2f69080a5076689a010919f42725c2b789a33b","6fb8d5591b466f8fc63db50f1c0f1c69013f996887b8244d2cdec417afea8fa3"],["ea01606a7a6c9cdd249fdfcfacb99584001edd28abbab77b5104e98e8e3b35d4","322af4908c7312b0cfbfe369f7a7b3cdb7d4494bc2823700cfd652188a3ea98d"],["af8addbf2b661c8a6c6328655eb96651252007d8c5ea31be4ad196de8ce2131f","6749e67c029b85f52a034eafd096836b2520818680e26ac8f3dfbcdb71749700"],["e3ae1974566ca06cc516d47e0fb165a674a3dabcfca15e722f0e3450f45889","2aeabe7e4531510116217f07bf4d07300de97e4874f81f533420a72eeb0bd6a4"],["591ee355313d99721cf6993ffed1e3e301993ff3ed258802075ea8ced397e246","b0ea558a113c30bea60fc4775460c7901ff0b053d25ca2bdeee98f1a4be5d196"],["11396d55fda54c49f19aa97318d8da61fa8584e47b084945077cf03255b52984","998c74a8cd45ac01289d5833a7beb4744ff536b01b257be4c5767bea93ea57a4"],["3c5d2a1ba39c5a1790000738c9e0c40b8dcdfd5468754b6405540157e017aa7a","b2284279995a34e2f9d4de7396fc18b80f9b8b9fdd270f6661f79ca4c81bd257"],["cc8704b8a60a0defa3a99a7299f2e9c3fbc395afb04ac078425ef8a1793cc030","bdd46039feed17881d1e0862db347f8cf395b74fc4bcdc4e940b74e3ac1f1b13"],["c533e4f7ea8555aacd9777ac5cad29b97dd4defccc53ee7ea204119b2889b197","6f0a256bc5efdf429a2fb6242f1a43a2d9b925bb4a4b3a26bb8e0f45eb596096"],["c14f8f2ccb27d6f109f6d08d03cc96a69ba8c34eec07bbcf566d48e33da6593","c359d6923bb398f7fd4473e16fe1c28475b740dd098075e6c0e8649113dc3a38"],["a6cbc3046bc6a450bac24789fa17115a4c9739ed75f8f21ce441f72e0b90e6ef","21ae7f4680e889bb130619e2c0f95a360ceb573c70603139862afd617fa9b9f"],["347d6d9a02c48927ebfb86c1359b1caf130a3c0267d11ce6344b39f99d43cc38","60ea7f61a353524d1c987f6ecec92f086d565ab687870cb12689ff1e31c74448"],["da6545d2181db8d983f7dcb375ef5866d47c67b1bf31c8cf855ef7437b72656a","49b96715ab6878a79e78f07ce5680c5d6673051b4935bd897fea824b77dc208a"],["c40747cc9d012cb1a13b8148309c6de7ec25d6945d657146b9d5994b8feb1111","5ca560753be2a12fc6de6caf2cb489565db936156b9514e1bb5e83037e0fa2d4"],["4e42c8ec82c99798ccf3a610be870e78338c7f713348bd34c8203ef4037f3502","7571d74ee5e0fb92a7a8b33a07783341a5492144cc54bcc40a94473693606437"],["3775ab7089bc6af823aba2e1af70b236d251cadb0c86743287522a1b3b0dedea","be52d107bcfa09d8bcb9736a828cfa7fac8db17bf7a76a2c42ad961409018cf7"],["cee31cbf7e34ec379d94fb814d3d775ad954595d1314ba8846959e3e82f74e26","8fd64a14c06b589c26b947ae2bcf6bfa0149ef0be14ed4d80f448a01c43b1c6d"],["b4f9eaea09b6917619f6ea6a4eb5464efddb58fd45b1ebefcdc1a01d08b47986","39e5c9925b5a54b07433a4f18c61726f8bb131c012ca542eb24a8ac07200682a"],["d4263dfc3d2df923a0179a48966d30ce84e2515afc3dccc1b77907792ebcc60e","62dfaf07a0f78feb30e30d6295853ce189e127760ad6cf7fae164e122a208d54"],["48457524820fa65a4f8d35eb6930857c0032acc0a4a2de422233eeda897612c4","25a748ab367979d98733c38a1fa1c2e7dc6cc07db2d60a9ae7a76aaa49bd0f77"],["dfeeef1881101f2cb11644f3a2afdfc2045e19919152923f367a1767c11cceda","ecfb7056cf1de042f9420bab396793c0c390bde74b4bbdff16a83ae09a9a7517"],["6d7ef6b17543f8373c573f44e1f389835d89bcbc6062ced36c82df83b8fae859","cd450ec335438986dfefa10c57fea9bcc521a0959b2d80bbf74b190dca712d10"],["e75605d59102a5a2684500d3b991f2e3f3c88b93225547035af25af66e04541f","f5c54754a8f71ee540b9b48728473e314f729ac5308b06938360990e2bfad125"],["eb98660f4c4dfaa06a2be453d5020bc99a0c2e60abe388457dd43fefb1ed620c","6cb9a8876d9cb8520609af3add26cd20a0a7cd8a9411131ce85f44100099223e"],["13e87b027d8514d35939f2e6892b19922154596941888336dc3563e3b8dba942","fef5a3c68059a6dec5d624114bf1e91aac2b9da568d6abeb2570d55646b8adf1"],["ee163026e9fd6fe017c38f06a5be6fc125424b371ce2708e7bf4491691e5764a","1acb250f255dd61c43d94ccc670d0f58f49ae3fa15b96623e5430da0ad6c62b2"],["b268f5ef9ad51e4d78de3a750c2dc89b1e626d43505867999932e5db33af3d80","5f310d4b3c99b9ebb19f77d41c1dee018cf0d34fd4191614003e945a1216e423"],["ff07f3118a9df035e9fad85eb6c7bfe42b02f01ca99ceea3bf7ffdba93c4750d","438136d603e858a3a5c440c38eccbaddc1d2942114e2eddd4740d098ced1f0d8"],["8d8b9855c7c052a34146fd20ffb658bea4b9f69e0d825ebec16e8c3ce2b526a1","cdb559eedc2d79f926baf44fb84ea4d44bcf50fee51d7ceb30e2e7f463036758"],["52db0b5384dfbf05bfa9d472d7ae26dfe4b851ceca91b1eba54263180da32b63","c3b997d050ee5d423ebaf66a6db9f57b3180c902875679de924b69d84a7b375"],["e62f9490d3d51da6395efd24e80919cc7d0f29c3f3fa48c6fff543becbd43352","6d89ad7ba4876b0b22c2ca280c682862f342c8591f1daf5170e07bfd9ccafa7d"],["7f30ea2476b399b4957509c88f77d0191afa2ff5cb7b14fd6d8e7d65aaab1193","ca5ef7d4b231c94c3b15389a5f6311e9daff7bb67b103e9880ef4bff637acaec"],["5098ff1e1d9f14fb46a210fada6c903fef0fb7b4a1dd1d9ac60a0361800b7a00","9731141d81fc8f8084d37c6e7541896b3ee1b40d60dfe5362a5b132fd17ddc0"],["32b78c7de9ee512a72895be6b9cbefa6e2f3c4ccce445c96b9f2c81e2778ad58","ee1849f513df71e32efc3896ee28260c73bb80547ae2275ba497237794c8753c"],["e2cb74fddc8e9fbcd076eef2a7c72b0ce37d50f08269dfc074b581550547a4f7","d3aa2ed71c9dd2247a62df062736eb0baddea9e36122d2be8641abcb005cc4a4"],["8438447566d4d7bedadc299496ab357426009a35f235cb141be0d99cd10ae3a8","c4e1020916980a4da5d01ac5e6ad330734ef0d7906631c4f2390426b2edd791f"],["4162d488b89402039b584c6fc6c308870587d9c46f660b878ab65c82c711d67e","67163e903236289f776f22c25fb8a3afc1732f2b84b4e95dbda47ae5a0852649"],["3fad3fa84caf0f34f0f89bfd2dcf54fc175d767aec3e50684f3ba4a4bf5f683d","cd1bc7cb6cc407bb2f0ca647c718a730cf71872e7d0d2a53fa20efcdfe61826"],["674f2600a3007a00568c1a7ce05d0816c1fb84bf1370798f1c69532faeb1a86b","299d21f9413f33b3edf43b257004580b70db57da0b182259e09eecc69e0d38a5"],["d32f4da54ade74abb81b815ad1fb3b263d82d6c692714bcff87d29bd5ee9f08f","f9429e738b8e53b968e99016c059707782e14f4535359d582fc416910b3eea87"],["30e4e670435385556e593657135845d36fbb6931f72b08cb1ed954f1e3ce3ff6","462f9bce619898638499350113bbc9b10a878d35da70740dc695a559eb88db7b"],["be2062003c51cc3004682904330e4dee7f3dcd10b01e580bf1971b04d4cad297","62188bc49d61e5428573d48a74e1c655b1c61090905682a0d5558ed72dccb9bc"],["93144423ace3451ed29e0fb9ac2af211cb6e84a601df5993c419859fff5df04a","7c10dfb164c3425f5c71a3f9d7992038f1065224f72bb9d1d902a6d13037b47c"],["b015f8044f5fcbdcf21ca26d6c34fb8197829205c7b7d2a7cb66418c157b112c","ab8c1e086d04e813744a655b2df8d5f83b3cdc6faa3088c1d3aea1454e3a1d5f"],["d5e9e1da649d97d89e4868117a465a3a4f8a18de57a140d36b3f2af341a21b52","4cb04437f391ed73111a13cc1d4dd0db1693465c2240480d8955e8592f27447a"],["d3ae41047dd7ca065dbf8ed77b992439983005cd72e16d6f996a5316d36966bb","bd1aeb21ad22ebb22a10f0303417c6d964f8cdd7df0aca614b10dc14d125ac46"],["463e2763d885f958fc66cdd22800f0a487197d0a82e377b49f80af87c897b065","bfefacdb0e5d0fd7df3a311a94de062b26b80c61fbc97508b79992671ef7ca7f"],["7985fdfd127c0567c6f53ec1bb63ec3158e597c40bfe747c83cddfc910641917","603c12daf3d9862ef2b25fe1de289aed24ed291e0ec6708703a5bd567f32ed03"],["74a1ad6b5f76e39db2dd249410eac7f99e74c59cb83d2d0ed5ff1543da7703e9","cc6157ef18c9c63cd6193d83631bbea0093e0968942e8c33d5737fd790e0db08"],["30682a50703375f602d416664ba19b7fc9bab42c72747463a71d0896b22f6da3","553e04f6b018b4fa6c8f39e7f311d3176290d0e0f19ca73f17714d9977a22ff8"],["9e2158f0d7c0d5f26c3791efefa79597654e7a2b2464f52b1ee6c1347769ef57","712fcdd1b9053f09003a3481fa7762e9ffd7c8ef35a38509e2fbf2629008373"],["176e26989a43c9cfeba4029c202538c28172e566e3c4fce7322857f3be327d66","ed8cc9d04b29eb877d270b4878dc43c19aefd31f4eee09ee7b47834c1fa4b1c3"],["75d46efea3771e6e68abb89a13ad747ecf1892393dfc4f1b7004788c50374da8","9852390a99507679fd0b86fd2b39a868d7efc22151346e1a3ca4726586a6bed8"],["809a20c67d64900ffb698c4c825f6d5f2310fb0451c869345b7319f645605721","9e994980d9917e22b76b061927fa04143d096ccc54963e6a5ebfa5f3f8e286c1"],["1b38903a43f7f114ed4500b4eac7083fdefece1cf29c63528d563446f972c180","4036edc931a60ae889353f77fd53de4a2708b26b6f5da72ad3394119daf408f9"]]}}},{}],15:[function(d,l,t){var i=t,u=d("bn.js"),c=d("minimalistic-assert"),s=d("minimalistic-crypto-utils");i.assert=c,i.toArray=s.toArray,i.zero2=s.zero2,i.toHex=s.toHex,i.encode=s.encode,i.getNAF=function(n,e){for(var o=[],r=1<<e+1,h=n.clone();h.cmpn(1)>=0;){var f;if(h.isOdd()){var g=h.andln(r-1);h.isubn(f=g>(r>>1)-1?(r>>1)-g:g)}else f=0;o.push(f);for(var y=0!==h.cmpn(0)&&0===h.andln(r-1)?e+1:1,A=1;A<y;A++)o.push(0);h.iushrn(y)}return o},i.getJSF=function(n,e){var o=[[],[]];n=n.clone(),e=e.clone();for(var r=0,h=0;n.cmpn(-r)>0||e.cmpn(-h)>0;){var f,g,y,A=n.andln(3)+r&3,T=e.andln(3)+h&3;3===A&&(A=-1),3===T&&(T=-1),f=0==(1&A)?0:3!=(y=n.andln(7)+r&7)&&5!==y||2!==T?A:-A,o[0].push(f),g=0==(1&T)?0:3!=(y=e.andln(7)+h&7)&&5!==y||2!==A?T:-T,o[1].push(g),2*r===f+1&&(r=1-r),2*h===g+1&&(h=1-h),n.iushrn(1),e.iushrn(1)}return o},i.cachedProperty=function(n,e,o){var r="_"+e;n.prototype[e]=function(){return void 0!==this[r]?this[r]:this[r]=o.call(this)}},i.parseBytes=function(n){return"string"==typeof n?i.toArray(n,"hex"):n},i.intFromLE=function(n){return new u(n,"hex","le")}},{"bn.js":16,"minimalistic-assert":28,"minimalistic-crypto-utils":29}],16:[function(d,l,t){!function(i,u){function c(b,D){if(!b)throw new Error(D||"Assertion failed")}function s(b,D){b.super_=D;var x=function(){};x.prototype=D.prototype,b.prototype=new x,b.prototype.constructor=b}function n(b,D,x){return n.isBN(b)?b:(this.negative=0,this.words=null,this.length=0,this.red=null,void(null!==b&&("le"!==D&&"be"!==D||(x=D,D=10),this._init(b||0,D||10,x||"be"))))}function e(b,D,x){for(var P=0,I=Math.min(b.length,x),F=D;F<I;F++){var G=b.charCodeAt(F)-48;P<<=4,P|=G>=49&&G<=54?G-49+10:G>=17&&G<=22?G-17+10:15&G}return P}function o(b,D,x,P){for(var I=0,F=Math.min(b.length,x),G=D;G<F;G++){var U=b.charCodeAt(G)-48;I*=P,I+=U>=49?U-49+10:U>=17?U-17+10:U}return I}function r(b,D,x){x.negative=D.negative^b.negative;var P=b.length+D.length|0;x.length=P,P=P-1|0;var I=0|b.words[0],F=0|D.words[0],G=I*F,K=G/67108864|0;x.words[0]=67108863&G;for(var H=1;H<P;H++){for(var Q=K>>>26,$=67108863&K,ue=Math.min(H,D.length-1),ae=Math.max(0,H-b.length+1);ae<=ue;ae++)Q+=(G=(I=0|b.words[H-ae|0])*(F=0|D.words[ae])+$)/67108864|0,$=67108863&G;x.words[H]=0|$,K=0|Q}return 0!==K?x.words[H]=0|K:x.length--,x.strip()}function h(b,D,x){return(new f).mulp(b,D,x)}function f(b,D){this.x=b,this.y=D}function g(b,D){this.name=b,this.p=new n(D,16),this.n=this.p.bitLength(),this.k=new n(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function y(){g.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function A(){g.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function T(){g.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function C(){g.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function E(b){if("string"==typeof b){var D=n._prime(b);this.m=D.p,this.prime=D}else c(b.gtn(1),"modulus must be greater than 1"),this.m=b,this.prime=null}function R(b){E.call(this,b),this.shift=this.m.bitLength(),this.shift%26!=0&&(this.shift+=26-this.shift%26),this.r=new n(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}var O;"object"==De(i)?i.exports=n:u.BN=n,n.BN=n,n.wordSize=26;try{O=d("buffer").Buffer}catch(b){}n.isBN=function(b){return b instanceof n||null!==b&&"object"==De(b)&&b.constructor.wordSize===n.wordSize&&Array.isArray(b.words)},n.max=function(b,D){return b.cmp(D)>0?b:D},n.min=function(b,D){return b.cmp(D)<0?b:D},n.prototype._init=function(b,D,x){if("number"==typeof b)return this._initNumber(b,D,x);if("object"==De(b))return this._initArray(b,D,x);"hex"===D&&(D=16),c(D===(0|D)&&D>=2&&D<=36);var P=0;"-"===(b=b.toString().replace(/\s+/g,""))[0]&&P++,16===D?this._parseHex(b,P):this._parseBase(b,D,P),"-"===b[0]&&(this.negative=1),this.strip(),"le"===x&&this._initArray(this.toArray(),D,x)},n.prototype._initNumber=function(b,D,x){b<0&&(this.negative=1,b=-b),b<67108864?(this.words=[67108863&b],this.length=1):b<4503599627370496?(this.words=[67108863&b,b/67108864&67108863],this.length=2):(c(b<9007199254740992),this.words=[67108863&b,b/67108864&67108863,1],this.length=3),"le"===x&&this._initArray(this.toArray(),D,x)},n.prototype._initArray=function(b,D,x){if(c("number"==typeof b.length),b.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(b.length/3),this.words=new Array(this.length);for(var P=0;P<this.length;P++)this.words[P]=0;var I,F,G=0;if("be"===x)for(P=b.length-1,I=0;P>=0;P-=3)this.words[I]|=(F=b[P]|b[P-1]<<8|b[P-2]<<16)<<G&67108863,this.words[I+1]=F>>>26-G&67108863,(G+=24)>=26&&(G-=26,I++);else if("le"===x)for(P=0,I=0;P<b.length;P+=3)this.words[I]|=(F=b[P]|b[P+1]<<8|b[P+2]<<16)<<G&67108863,this.words[I+1]=F>>>26-G&67108863,(G+=24)>=26&&(G-=26,I++);return this.strip()},n.prototype._parseHex=function(b,D){this.length=Math.ceil((b.length-D)/6),this.words=new Array(this.length);for(var x=0;x<this.length;x++)this.words[x]=0;var P,I,F=0;for(x=b.length-6,P=0;x>=D;x-=6)I=e(b,x,x+6),this.words[P]|=I<<F&67108863,this.words[P+1]|=I>>>26-F&4194303,(F+=24)>=26&&(F-=26,P++);x+6!==D&&(I=e(b,D,x+6),this.words[P]|=I<<F&67108863,this.words[P+1]|=I>>>26-F&4194303),this.strip()},n.prototype._parseBase=function(b,D,x){this.words=[0],this.length=1;for(var P=0,I=1;I<=67108863;I*=D)P++;P--,I=I/D|0;for(var F=b.length-x,G=F%P,U=Math.min(F,F-G)+x,K=0,H=x;H<U;H+=P)K=o(b,H,H+P,D),this.imuln(I),this.words[0]+K<67108864?this.words[0]+=K:this._iaddn(K);if(0!==G){var Q=1;for(K=o(b,H,b.length,D),H=0;H<G;H++)Q*=D;this.imuln(Q),this.words[0]+K<67108864?this.words[0]+=K:this._iaddn(K)}},n.prototype.copy=function(b){b.words=new Array(this.length);for(var D=0;D<this.length;D++)b.words[D]=this.words[D];b.length=this.length,b.negative=this.negative,b.red=this.red},n.prototype.clone=function(){var b=new n(null);return this.copy(b),b},n.prototype._expand=function(b){for(;this.length<b;)this.words[this.length++]=0;return this},n.prototype.strip=function(){for(;this.length>1&&0===this.words[this.length-1];)this.length--;return this._normSign()},n.prototype._normSign=function(){return 1===this.length&&0===this.words[0]&&(this.negative=0),this},n.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var L=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],N=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],W=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];n.prototype.toString=function(b,D){var x;if(D=0|D||1,16===(b=b||10)||"hex"===b){x="";for(var P=0,I=0,F=0;F<this.length;F++){var G=this.words[F],U=(16777215&(G<<P|I)).toString(16);x=0!=(I=G>>>24-P&16777215)||F!==this.length-1?L[6-U.length]+U+x:U+x,(P+=2)>=26&&(P-=26,F--)}for(0!==I&&(x=I.toString(16)+x);x.length%D!=0;)x="0"+x;return 0!==this.negative&&(x="-"+x),x}if(b===(0|b)&&b>=2&&b<=36){var K=N[b],H=W[b];x="";var Q=this.clone();for(Q.negative=0;!Q.isZero();){var $=Q.modn(H).toString(b);x=(Q=Q.idivn(H)).isZero()?$+x:L[K-$.length]+$+x}for(this.isZero()&&(x="0"+x);x.length%D!=0;)x="0"+x;return 0!==this.negative&&(x="-"+x),x}c(!1,"Base should be between 2 and 36")},n.prototype.toNumber=function(){var b=this.words[0];return 2===this.length?b+=67108864*this.words[1]:3===this.length&&1===this.words[2]?b+=4503599627370496+67108864*this.words[1]:this.length>2&&c(!1,"Number can only safely store up to 53 bits"),0!==this.negative?-b:b},n.prototype.toJSON=function(){return this.toString(16)},n.prototype.toBuffer=function(b,D){return c(void 0!==O),this.toArrayLike(O,b,D)},n.prototype.toArray=function(b,D){return this.toArrayLike(Array,b,D)},n.prototype.toArrayLike=function(b,D,x){var P=this.byteLength(),I=x||Math.max(1,P);c(P<=I,"byte array longer than desired length"),c(I>0,"Requested array length <= 0"),this.strip();var F,G,U="le"===D,K=new b(I),H=this.clone();if(U){for(G=0;!H.isZero();G++)F=H.andln(255),H.iushrn(8),K[G]=F;for(;G<I;G++)K[G]=0}else{for(G=0;G<I-P;G++)K[G]=0;for(G=0;!H.isZero();G++)F=H.andln(255),H.iushrn(8),K[I-G-1]=F}return K},n.prototype._countBits=Math.clz32?function(b){return 32-Math.clz32(b)}:function(b){var D=b,x=0;return D>=4096&&(x+=13,D>>>=13),D>=64&&(x+=7,D>>>=7),D>=8&&(x+=4,D>>>=4),D>=2&&(x+=2,D>>>=2),x+D},n.prototype._zeroBits=function(b){if(0===b)return 26;var D=b,x=0;return 0==(8191&D)&&(x+=13,D>>>=13),0==(127&D)&&(x+=7,D>>>=7),0==(15&D)&&(x+=4,D>>>=4),0==(3&D)&&(x+=2,D>>>=2),0==(1&D)&&x++,x},n.prototype.bitLength=function(){var D=this._countBits(this.words[this.length-1]);return 26*(this.length-1)+D},n.prototype.zeroBits=function(){if(this.isZero())return 0;for(var b=0,D=0;D<this.length;D++){var x=this._zeroBits(this.words[D]);if(b+=x,26!==x)break}return b},n.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},n.prototype.toTwos=function(b){return 0!==this.negative?this.abs().inotn(b).iaddn(1):this.clone()},n.prototype.fromTwos=function(b){return this.testn(b-1)?this.notn(b).iaddn(1).ineg():this.clone()},n.prototype.isNeg=function(){return 0!==this.negative},n.prototype.neg=function(){return this.clone().ineg()},n.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},n.prototype.iuor=function(b){for(;this.length<b.length;)this.words[this.length++]=0;for(var D=0;D<b.length;D++)this.words[D]=this.words[D]|b.words[D];return this.strip()},n.prototype.ior=function(b){return c(0==(this.negative|b.negative)),this.iuor(b)},n.prototype.or=function(b){return this.length>b.length?this.clone().ior(b):b.clone().ior(this)},n.prototype.uor=function(b){return this.length>b.length?this.clone().iuor(b):b.clone().iuor(this)},n.prototype.iuand=function(b){var D;D=this.length>b.length?b:this;for(var x=0;x<D.length;x++)this.words[x]=this.words[x]&b.words[x];return this.length=D.length,this.strip()},n.prototype.iand=function(b){return c(0==(this.negative|b.negative)),this.iuand(b)},n.prototype.and=function(b){return this.length>b.length?this.clone().iand(b):b.clone().iand(this)},n.prototype.uand=function(b){return this.length>b.length?this.clone().iuand(b):b.clone().iuand(this)},n.prototype.iuxor=function(b){var D,x;this.length>b.length?(D=this,x=b):(D=b,x=this);for(var P=0;P<x.length;P++)this.words[P]=D.words[P]^x.words[P];if(this!==D)for(;P<D.length;P++)this.words[P]=D.words[P];return this.length=D.length,this.strip()},n.prototype.ixor=function(b){return c(0==(this.negative|b.negative)),this.iuxor(b)},n.prototype.xor=function(b){return this.length>b.length?this.clone().ixor(b):b.clone().ixor(this)},n.prototype.uxor=function(b){return this.length>b.length?this.clone().iuxor(b):b.clone().iuxor(this)},n.prototype.inotn=function(b){c("number"==typeof b&&b>=0);var D=0|Math.ceil(b/26),x=b%26;this._expand(D),x>0&&D--;for(var P=0;P<D;P++)this.words[P]=67108863&~this.words[P];return x>0&&(this.words[P]=~this.words[P]&67108863>>26-x),this.strip()},n.prototype.notn=function(b){return this.clone().inotn(b)},n.prototype.setn=function(b,D){c("number"==typeof b&&b>=0);var x=b/26|0,P=b%26;return this._expand(x+1),this.words[x]=D?this.words[x]|1<<P:this.words[x]&~(1<<P),this.strip()},n.prototype.iadd=function(b){var D,x,P;if(0!==this.negative&&0===b.negative)return this.negative=0,D=this.isub(b),this.negative^=1,this._normSign();if(0===this.negative&&0!==b.negative)return b.negative=0,D=this.isub(b),b.negative=1,D._normSign();this.length>b.length?(x=this,P=b):(x=b,P=this);for(var I=0,F=0;F<P.length;F++)this.words[F]=67108863&(D=(0|x.words[F])+(0|P.words[F])+I),I=D>>>26;for(;0!==I&&F<x.length;F++)this.words[F]=67108863&(D=(0|x.words[F])+I),I=D>>>26;if(this.length=x.length,0!==I)this.words[this.length]=I,this.length++;else if(x!==this)for(;F<x.length;F++)this.words[F]=x.words[F];return this},n.prototype.add=function(b){var D;return 0!==b.negative&&0===this.negative?(b.negative=0,D=this.sub(b),b.negative^=1,D):0===b.negative&&0!==this.negative?(this.negative=0,D=b.sub(this),this.negative=1,D):this.length>b.length?this.clone().iadd(b):b.clone().iadd(this)},n.prototype.isub=function(b){if(0!==b.negative){b.negative=0;var D=this.iadd(b);return b.negative=1,D._normSign()}if(0!==this.negative)return this.negative=0,this.iadd(b),this.negative=1,this._normSign();var x,P,I=this.cmp(b);if(0===I)return this.negative=0,this.length=1,this.words[0]=0,this;I>0?(x=this,P=b):(x=b,P=this);for(var F=0,G=0;G<P.length;G++)F=(D=(0|x.words[G])-(0|P.words[G])+F)>>26,this.words[G]=67108863&D;for(;0!==F&&G<x.length;G++)F=(D=(0|x.words[G])+F)>>26,this.words[G]=67108863&D;if(0===F&&G<x.length&&x!==this)for(;G<x.length;G++)this.words[G]=x.words[G];return this.length=Math.max(this.length,G),x!==this&&(this.negative=1),this.strip()},n.prototype.sub=function(b){return this.clone().isub(b)};var j=function(b,D,x){var P,I,F,G=b.words,U=D.words,K=x.words,H=0,Q=0|G[0],$=8191&Q,ue=Q>>>13,ae=0|G[1],me=8191&ae,be=ae>>>13,Xe=0|G[2],Se=8191&Xe,Ce=Xe>>>13,Zt=0|G[3],Le=8191&Zt,Je=Zt>>>13,vt=0|G[4],Te=8191&vt,ne=vt>>>13,de=0|G[5],Z=8191&de,ie=de>>>13,Ae=0|G[6],ye=8191&Ae,_e=Ae>>>13,ct=0|G[7],ke=8191&ct,Pe=ct>>>13,ut=0|G[8],Re=8191&ut,we=ut>>>13,Et=0|G[9],Fe=8191&Et,je=Et>>>13,yt=0|U[0],We=8191&yt,Ge=yt>>>13,Rt=0|U[1],Ke=8191&Rt,He=Rt>>>13,pt=0|U[2],Be=8191&pt,qe=pt>>>13,St=0|U[3],Ue=8191&St,Qe=St>>>13,Nt=0|U[4],Ie=8191&Nt,ze=Nt>>>13,Dt=0|U[5],Me=8191&Dt,Ve=Dt>>>13,Ln=0|U[6],nt=8191&Ln,ot=Ln>>>13,qn=0|U[7],Oe=8191&qn,it=qn>>>13,On=0|U[8],Ze=8191&On,rt=On>>>13,hn=0|U[9],st=8191&hn,$e=hn>>>13;x.negative=b.negative^D.negative,x.length=19;var dn=(H+(P=Math.imul($,We))|0)+((8191&(I=(I=Math.imul($,Ge))+Math.imul(ue,We)|0))<<13)|0;H=((F=Math.imul(ue,Ge))+(I>>>13)|0)+(dn>>>26)|0,dn&=67108863,P=Math.imul(me,We),I=(I=Math.imul(me,Ge))+Math.imul(be,We)|0,F=Math.imul(be,Ge);var en=(H+(P=P+Math.imul($,Ke)|0)|0)+((8191&(I=(I=I+Math.imul($,He)|0)+Math.imul(ue,Ke)|0))<<13)|0;H=((F=F+Math.imul(ue,He)|0)+(I>>>13)|0)+(en>>>26)|0,en&=67108863,P=Math.imul(Se,We),I=(I=Math.imul(Se,Ge))+Math.imul(Ce,We)|0,F=Math.imul(Ce,Ge),P=P+Math.imul(me,Ke)|0,I=(I=I+Math.imul(me,He)|0)+Math.imul(be,Ke)|0,F=F+Math.imul(be,He)|0;var pn=(H+(P=P+Math.imul($,Be)|0)|0)+((8191&(I=(I=I+Math.imul($,qe)|0)+Math.imul(ue,Be)|0))<<13)|0;H=((F=F+Math.imul(ue,qe)|0)+(I>>>13)|0)+(pn>>>26)|0,pn&=67108863,P=Math.imul(Le,We),I=(I=Math.imul(Le,Ge))+Math.imul(Je,We)|0,F=Math.imul(Je,Ge),P=P+Math.imul(Se,Ke)|0,I=(I=I+Math.imul(Se,He)|0)+Math.imul(Ce,Ke)|0,F=F+Math.imul(Ce,He)|0,P=P+Math.imul(me,Be)|0,I=(I=I+Math.imul(me,qe)|0)+Math.imul(be,Be)|0,F=F+Math.imul(be,qe)|0;var fn=(H+(P=P+Math.imul($,Ue)|0)|0)+((8191&(I=(I=I+Math.imul($,Qe)|0)+Math.imul(ue,Ue)|0))<<13)|0;H=((F=F+Math.imul(ue,Qe)|0)+(I>>>13)|0)+(fn>>>26)|0,fn&=67108863,P=Math.imul(Te,We),I=(I=Math.imul(Te,Ge))+Math.imul(ne,We)|0,F=Math.imul(ne,Ge),P=P+Math.imul(Le,Ke)|0,I=(I=I+Math.imul(Le,He)|0)+Math.imul(Je,Ke)|0,F=F+Math.imul(Je,He)|0,P=P+Math.imul(Se,Be)|0,I=(I=I+Math.imul(Se,qe)|0)+Math.imul(Ce,Be)|0,F=F+Math.imul(Ce,qe)|0,P=P+Math.imul(me,Ue)|0,I=(I=I+Math.imul(me,Qe)|0)+Math.imul(be,Ue)|0,F=F+Math.imul(be,Qe)|0;var mn=(H+(P=P+Math.imul($,Ie)|0)|0)+((8191&(I=(I=I+Math.imul($,ze)|0)+Math.imul(ue,Ie)|0))<<13)|0;H=((F=F+Math.imul(ue,ze)|0)+(I>>>13)|0)+(mn>>>26)|0,mn&=67108863,P=Math.imul(Z,We),I=(I=Math.imul(Z,Ge))+Math.imul(ie,We)|0,F=Math.imul(ie,Ge),P=P+Math.imul(Te,Ke)|0,I=(I=I+Math.imul(Te,He)|0)+Math.imul(ne,Ke)|0,F=F+Math.imul(ne,He)|0,P=P+Math.imul(Le,Be)|0,I=(I=I+Math.imul(Le,qe)|0)+Math.imul(Je,Be)|0,F=F+Math.imul(Je,qe)|0,P=P+Math.imul(Se,Ue)|0,I=(I=I+Math.imul(Se,Qe)|0)+Math.imul(Ce,Ue)|0,F=F+Math.imul(Ce,Qe)|0,P=P+Math.imul(me,Ie)|0,I=(I=I+Math.imul(me,ze)|0)+Math.imul(be,Ie)|0,F=F+Math.imul(be,ze)|0;var Vt=(H+(P=P+Math.imul($,Me)|0)|0)+((8191&(I=(I=I+Math.imul($,Ve)|0)+Math.imul(ue,Me)|0))<<13)|0;H=((F=F+Math.imul(ue,Ve)|0)+(I>>>13)|0)+(Vt>>>26)|0,Vt&=67108863,P=Math.imul(ye,We),I=(I=Math.imul(ye,Ge))+Math.imul(_e,We)|0,F=Math.imul(_e,Ge),P=P+Math.imul(Z,Ke)|0,I=(I=I+Math.imul(Z,He)|0)+Math.imul(ie,Ke)|0,F=F+Math.imul(ie,He)|0,P=P+Math.imul(Te,Be)|0,I=(I=I+Math.imul(Te,qe)|0)+Math.imul(ne,Be)|0,F=F+Math.imul(ne,qe)|0,P=P+Math.imul(Le,Ue)|0,I=(I=I+Math.imul(Le,Qe)|0)+Math.imul(Je,Ue)|0,F=F+Math.imul(Je,Qe)|0,P=P+Math.imul(Se,Ie)|0,I=(I=I+Math.imul(Se,ze)|0)+Math.imul(Ce,Ie)|0,F=F+Math.imul(Ce,ze)|0,P=P+Math.imul(me,Me)|0,I=(I=I+Math.imul(me,Ve)|0)+Math.imul(be,Me)|0,F=F+Math.imul(be,Ve)|0;var _n=(H+(P=P+Math.imul($,nt)|0)|0)+((8191&(I=(I=I+Math.imul($,ot)|0)+Math.imul(ue,nt)|0))<<13)|0;H=((F=F+Math.imul(ue,ot)|0)+(I>>>13)|0)+(_n>>>26)|0,_n&=67108863,P=Math.imul(ke,We),I=(I=Math.imul(ke,Ge))+Math.imul(Pe,We)|0,F=Math.imul(Pe,Ge),P=P+Math.imul(ye,Ke)|0,I=(I=I+Math.imul(ye,He)|0)+Math.imul(_e,Ke)|0,F=F+Math.imul(_e,He)|0,P=P+Math.imul(Z,Be)|0,I=(I=I+Math.imul(Z,qe)|0)+Math.imul(ie,Be)|0,F=F+Math.imul(ie,qe)|0,P=P+Math.imul(Te,Ue)|0,I=(I=I+Math.imul(Te,Qe)|0)+Math.imul(ne,Ue)|0,F=F+Math.imul(ne,Qe)|0,P=P+Math.imul(Le,Ie)|0,I=(I=I+Math.imul(Le,ze)|0)+Math.imul(Je,Ie)|0,F=F+Math.imul(Je,ze)|0,P=P+Math.imul(Se,Me)|0,I=(I=I+Math.imul(Se,Ve)|0)+Math.imul(Ce,Me)|0,F=F+Math.imul(Ce,Ve)|0,P=P+Math.imul(me,nt)|0,I=(I=I+Math.imul(me,ot)|0)+Math.imul(be,nt)|0,F=F+Math.imul(be,ot)|0;var Gt=(H+(P=P+Math.imul($,Oe)|0)|0)+((8191&(I=(I=I+Math.imul($,it)|0)+Math.imul(ue,Oe)|0))<<13)|0;H=((F=F+Math.imul(ue,it)|0)+(I>>>13)|0)+(Gt>>>26)|0,Gt&=67108863,P=Math.imul(Re,We),I=(I=Math.imul(Re,Ge))+Math.imul(we,We)|0,F=Math.imul(we,Ge),P=P+Math.imul(ke,Ke)|0,I=(I=I+Math.imul(ke,He)|0)+Math.imul(Pe,Ke)|0,F=F+Math.imul(Pe,He)|0,P=P+Math.imul(ye,Be)|0,I=(I=I+Math.imul(ye,qe)|0)+Math.imul(_e,Be)|0,F=F+Math.imul(_e,qe)|0,P=P+Math.imul(Z,Ue)|0,I=(I=I+Math.imul(Z,Qe)|0)+Math.imul(ie,Ue)|0,F=F+Math.imul(ie,Qe)|0,P=P+Math.imul(Te,Ie)|0,I=(I=I+Math.imul(Te,ze)|0)+Math.imul(ne,Ie)|0,F=F+Math.imul(ne,ze)|0,P=P+Math.imul(Le,Me)|0,I=(I=I+Math.imul(Le,Ve)|0)+Math.imul(Je,Me)|0,F=F+Math.imul(Je,Ve)|0,P=P+Math.imul(Se,nt)|0,I=(I=I+Math.imul(Se,ot)|0)+Math.imul(Ce,nt)|0,F=F+Math.imul(Ce,ot)|0,P=P+Math.imul(me,Oe)|0,I=(I=I+Math.imul(me,it)|0)+Math.imul(be,Oe)|0,F=F+Math.imul(be,it)|0;var gn=(H+(P=P+Math.imul($,Ze)|0)|0)+((8191&(I=(I=I+Math.imul($,rt)|0)+Math.imul(ue,Ze)|0))<<13)|0;H=((F=F+Math.imul(ue,rt)|0)+(I>>>13)|0)+(gn>>>26)|0,gn&=67108863,P=Math.imul(Fe,We),I=(I=Math.imul(Fe,Ge))+Math.imul(je,We)|0,F=Math.imul(je,Ge),P=P+Math.imul(Re,Ke)|0,I=(I=I+Math.imul(Re,He)|0)+Math.imul(we,Ke)|0,F=F+Math.imul(we,He)|0,P=P+Math.imul(ke,Be)|0,I=(I=I+Math.imul(ke,qe)|0)+Math.imul(Pe,Be)|0,F=F+Math.imul(Pe,qe)|0,P=P+Math.imul(ye,Ue)|0,I=(I=I+Math.imul(ye,Qe)|0)+Math.imul(_e,Ue)|0,F=F+Math.imul(_e,Qe)|0,P=P+Math.imul(Z,Ie)|0,I=(I=I+Math.imul(Z,ze)|0)+Math.imul(ie,Ie)|0,F=F+Math.imul(ie,ze)|0,P=P+Math.imul(Te,Me)|0,I=(I=I+Math.imul(Te,Ve)|0)+Math.imul(ne,Me)|0,F=F+Math.imul(ne,Ve)|0,P=P+Math.imul(Le,nt)|0,I=(I=I+Math.imul(Le,ot)|0)+Math.imul(Je,nt)|0,F=F+Math.imul(Je,ot)|0,P=P+Math.imul(Se,Oe)|0,I=(I=I+Math.imul(Se,it)|0)+Math.imul(Ce,Oe)|0,F=F+Math.imul(Ce,it)|0,P=P+Math.imul(me,Ze)|0,I=(I=I+Math.imul(me,rt)|0)+Math.imul(be,Ze)|0,F=F+Math.imul(be,rt)|0;var vn=(H+(P=P+Math.imul($,st)|0)|0)+((8191&(I=(I=I+Math.imul($,$e)|0)+Math.imul(ue,st)|0))<<13)|0;H=((F=F+Math.imul(ue,$e)|0)+(I>>>13)|0)+(vn>>>26)|0,vn&=67108863,P=Math.imul(Fe,Ke),I=(I=Math.imul(Fe,He))+Math.imul(je,Ke)|0,F=Math.imul(je,He),P=P+Math.imul(Re,Be)|0,I=(I=I+Math.imul(Re,qe)|0)+Math.imul(we,Be)|0,F=F+Math.imul(we,qe)|0,P=P+Math.imul(ke,Ue)|0,I=(I=I+Math.imul(ke,Qe)|0)+Math.imul(Pe,Ue)|0,F=F+Math.imul(Pe,Qe)|0,P=P+Math.imul(ye,Ie)|0,I=(I=I+Math.imul(ye,ze)|0)+Math.imul(_e,Ie)|0,F=F+Math.imul(_e,ze)|0,P=P+Math.imul(Z,Me)|0,I=(I=I+Math.imul(Z,Ve)|0)+Math.imul(ie,Me)|0,F=F+Math.imul(ie,Ve)|0,P=P+Math.imul(Te,nt)|0,I=(I=I+Math.imul(Te,ot)|0)+Math.imul(ne,nt)|0,F=F+Math.imul(ne,ot)|0,P=P+Math.imul(Le,Oe)|0,I=(I=I+Math.imul(Le,it)|0)+Math.imul(Je,Oe)|0,F=F+Math.imul(Je,it)|0,P=P+Math.imul(Se,Ze)|0,I=(I=I+Math.imul(Se,rt)|0)+Math.imul(Ce,Ze)|0,F=F+Math.imul(Ce,rt)|0;var yn=(H+(P=P+Math.imul(me,st)|0)|0)+((8191&(I=(I=I+Math.imul(me,$e)|0)+Math.imul(be,st)|0))<<13)|0;H=((F=F+Math.imul(be,$e)|0)+(I>>>13)|0)+(yn>>>26)|0,yn&=67108863,P=Math.imul(Fe,Be),I=(I=Math.imul(Fe,qe))+Math.imul(je,Be)|0,F=Math.imul(je,qe),P=P+Math.imul(Re,Ue)|0,I=(I=I+Math.imul(Re,Qe)|0)+Math.imul(we,Ue)|0,F=F+Math.imul(we,Qe)|0,P=P+Math.imul(ke,Ie)|0,I=(I=I+Math.imul(ke,ze)|0)+Math.imul(Pe,Ie)|0,F=F+Math.imul(Pe,ze)|0,P=P+Math.imul(ye,Me)|0,I=(I=I+Math.imul(ye,Ve)|0)+Math.imul(_e,Me)|0,F=F+Math.imul(_e,Ve)|0,P=P+Math.imul(Z,nt)|0,I=(I=I+Math.imul(Z,ot)|0)+Math.imul(ie,nt)|0,F=F+Math.imul(ie,ot)|0,P=P+Math.imul(Te,Oe)|0,I=(I=I+Math.imul(Te,it)|0)+Math.imul(ne,Oe)|0,F=F+Math.imul(ne,it)|0,P=P+Math.imul(Le,Ze)|0,I=(I=I+Math.imul(Le,rt)|0)+Math.imul(Je,Ze)|0,F=F+Math.imul(Je,rt)|0;var bn=(H+(P=P+Math.imul(Se,st)|0)|0)+((8191&(I=(I=I+Math.imul(Se,$e)|0)+Math.imul(Ce,st)|0))<<13)|0;H=((F=F+Math.imul(Ce,$e)|0)+(I>>>13)|0)+(bn>>>26)|0,bn&=67108863,P=Math.imul(Fe,Ue),I=(I=Math.imul(Fe,Qe))+Math.imul(je,Ue)|0,F=Math.imul(je,Qe),P=P+Math.imul(Re,Ie)|0,I=(I=I+Math.imul(Re,ze)|0)+Math.imul(we,Ie)|0,F=F+Math.imul(we,ze)|0,P=P+Math.imul(ke,Me)|0,I=(I=I+Math.imul(ke,Ve)|0)+Math.imul(Pe,Me)|0,F=F+Math.imul(Pe,Ve)|0,P=P+Math.imul(ye,nt)|0,I=(I=I+Math.imul(ye,ot)|0)+Math.imul(_e,nt)|0,F=F+Math.imul(_e,ot)|0,P=P+Math.imul(Z,Oe)|0,I=(I=I+Math.imul(Z,it)|0)+Math.imul(ie,Oe)|0,F=F+Math.imul(ie,it)|0,P=P+Math.imul(Te,Ze)|0,I=(I=I+Math.imul(Te,rt)|0)+Math.imul(ne,Ze)|0,F=F+Math.imul(ne,rt)|0;var Ft=(H+(P=P+Math.imul(Le,st)|0)|0)+((8191&(I=(I=I+Math.imul(Le,$e)|0)+Math.imul(Je,st)|0))<<13)|0;H=((F=F+Math.imul(Je,$e)|0)+(I>>>13)|0)+(Ft>>>26)|0,Ft&=67108863,P=Math.imul(Fe,Ie),I=(I=Math.imul(Fe,ze))+Math.imul(je,Ie)|0,F=Math.imul(je,ze),P=P+Math.imul(Re,Me)|0,I=(I=I+Math.imul(Re,Ve)|0)+Math.imul(we,Me)|0,F=F+Math.imul(we,Ve)|0,P=P+Math.imul(ke,nt)|0,I=(I=I+Math.imul(ke,ot)|0)+Math.imul(Pe,nt)|0,F=F+Math.imul(Pe,ot)|0,P=P+Math.imul(ye,Oe)|0,I=(I=I+Math.imul(ye,it)|0)+Math.imul(_e,Oe)|0,F=F+Math.imul(_e,it)|0,P=P+Math.imul(Z,Ze)|0,I=(I=I+Math.imul(Z,rt)|0)+Math.imul(ie,Ze)|0,F=F+Math.imul(ie,rt)|0;var Mt=(H+(P=P+Math.imul(Te,st)|0)|0)+((8191&(I=(I=I+Math.imul(Te,$e)|0)+Math.imul(ne,st)|0))<<13)|0;H=((F=F+Math.imul(ne,$e)|0)+(I>>>13)|0)+(Mt>>>26)|0,Mt&=67108863,P=Math.imul(Fe,Me),I=(I=Math.imul(Fe,Ve))+Math.imul(je,Me)|0,F=Math.imul(je,Ve),P=P+Math.imul(Re,nt)|0,I=(I=I+Math.imul(Re,ot)|0)+Math.imul(we,nt)|0,F=F+Math.imul(we,ot)|0,P=P+Math.imul(ke,Oe)|0,I=(I=I+Math.imul(ke,it)|0)+Math.imul(Pe,Oe)|0,F=F+Math.imul(Pe,it)|0,P=P+Math.imul(ye,Ze)|0,I=(I=I+Math.imul(ye,rt)|0)+Math.imul(_e,Ze)|0,F=F+Math.imul(_e,rt)|0;var et=(H+(P=P+Math.imul(Z,st)|0)|0)+((8191&(I=(I=I+Math.imul(Z,$e)|0)+Math.imul(ie,st)|0))<<13)|0;H=((F=F+Math.imul(ie,$e)|0)+(I>>>13)|0)+(et>>>26)|0,et&=67108863,P=Math.imul(Fe,nt),I=(I=Math.imul(Fe,ot))+Math.imul(je,nt)|0,F=Math.imul(je,ot),P=P+Math.imul(Re,Oe)|0,I=(I=I+Math.imul(Re,it)|0)+Math.imul(we,Oe)|0,F=F+Math.imul(we,it)|0,P=P+Math.imul(ke,Ze)|0,I=(I=I+Math.imul(ke,rt)|0)+Math.imul(Pe,Ze)|0,F=F+Math.imul(Pe,rt)|0;var An=(H+(P=P+Math.imul(ye,st)|0)|0)+((8191&(I=(I=I+Math.imul(ye,$e)|0)+Math.imul(_e,st)|0))<<13)|0;H=((F=F+Math.imul(_e,$e)|0)+(I>>>13)|0)+(An>>>26)|0,An&=67108863,P=Math.imul(Fe,Oe),I=(I=Math.imul(Fe,it))+Math.imul(je,Oe)|0,F=Math.imul(je,it),P=P+Math.imul(Re,Ze)|0,I=(I=I+Math.imul(Re,rt)|0)+Math.imul(we,Ze)|0,F=F+Math.imul(we,rt)|0;var Sn=(H+(P=P+Math.imul(ke,st)|0)|0)+((8191&(I=(I=I+Math.imul(ke,$e)|0)+Math.imul(Pe,st)|0))<<13)|0;H=((F=F+Math.imul(Pe,$e)|0)+(I>>>13)|0)+(Sn>>>26)|0,Sn&=67108863,P=Math.imul(Fe,Ze),I=(I=Math.imul(Fe,rt))+Math.imul(je,Ze)|0,F=Math.imul(je,rt);var tn=(H+(P=P+Math.imul(Re,st)|0)|0)+((8191&(I=(I=I+Math.imul(Re,$e)|0)+Math.imul(we,st)|0))<<13)|0;H=((F=F+Math.imul(we,$e)|0)+(I>>>13)|0)+(tn>>>26)|0,tn&=67108863;var Cn=(H+(P=Math.imul(Fe,st))|0)+((8191&(I=(I=Math.imul(Fe,$e))+Math.imul(je,st)|0))<<13)|0;return H=((F=Math.imul(je,$e))+(I>>>13)|0)+(Cn>>>26)|0,Cn&=67108863,K[0]=dn,K[1]=en,K[2]=pn,K[3]=fn,K[4]=mn,K[5]=Vt,K[6]=_n,K[7]=Gt,K[8]=gn,K[9]=vn,K[10]=yn,K[11]=bn,K[12]=Ft,K[13]=Mt,K[14]=et,K[15]=An,K[16]=Sn,K[17]=tn,K[18]=Cn,0!==H&&(K[19]=H,x.length++),x};Math.imul||(j=r),n.prototype.mulTo=function(b,D){var x=this.length+b.length;return 10===this.length&&10===b.length?j(this,b,D):x<63?r(this,b,D):x<1024?function(P,I,F){F.negative=I.negative^P.negative,F.length=P.length+I.length;for(var G=0,U=0,K=0;K<F.length-1;K++){var H=U;U=0;for(var Q=67108863&G,$=Math.min(K,I.length-1),ue=Math.max(0,K-P.length+1);ue<=$;ue++){var me=(0|P.words[K-ue])*(0|I.words[ue]),be=67108863&me;Q=67108863&(be=be+Q|0),U+=(H=(H=H+(me/67108864|0)|0)+(be>>>26)|0)>>>26,H&=67108863}F.words[K]=Q,G=H,H=U}return 0!==G?F.words[K]=G:F.length--,F.strip()}(this,b,D):h(this,b,D)},f.prototype.makeRBT=function(b){for(var D=new Array(b),x=n.prototype._countBits(b)-1,P=0;P<b;P++)D[P]=this.revBin(P,x,b);return D},f.prototype.revBin=function(b,D,x){if(0===b||b===x-1)return b;for(var P=0,I=0;I<D;I++)P|=(1&b)<<D-I-1,b>>=1;return P},f.prototype.permute=function(b,D,x,P,I,F){for(var G=0;G<F;G++)P[G]=D[b[G]],I[G]=x[b[G]]},f.prototype.transform=function(b,D,x,P,I,F){this.permute(F,b,D,x,P,I);for(var G=1;G<I;G<<=1)for(var U=G<<1,K=Math.cos(2*Math.PI/U),H=Math.sin(2*Math.PI/U),Q=0;Q<I;Q+=U)for(var $=K,ue=H,ae=0;ae<G;ae++){var me=x[Q+ae],be=P[Q+ae],Xe=x[Q+ae+G],Se=P[Q+ae+G],Ce=$*Xe-ue*Se;Se=$*Se+ue*Xe,x[Q+ae]=me+(Xe=Ce),P[Q+ae]=be+Se,x[Q+ae+G]=me-Xe,P[Q+ae+G]=be-Se,ae!==U&&(Ce=K*$-H*ue,ue=K*ue+H*$,$=Ce)}},f.prototype.guessLen13b=function(b,D){var x=1|Math.max(D,b),P=1&x,I=0;for(x=x/2|0;x;x>>>=1)I++;return 1<<I+1+P},f.prototype.conjugate=function(b,D,x){if(!(x<=1))for(var P=0;P<x/2;P++){var I=b[P];b[P]=b[x-P-1],b[x-P-1]=I,I=D[P],D[P]=-D[x-P-1],D[x-P-1]=-I}},f.prototype.normalize13b=function(b,D){for(var x=0,P=0;P<D/2;P++){var I=8192*Math.round(b[2*P+1]/D)+Math.round(b[2*P]/D)+x;b[P]=67108863&I,x=I<67108864?0:I/67108864|0}return b},f.prototype.convert13b=function(b,D,x,P){for(var I=0,F=0;F<D;F++)x[2*F]=8191&(I+=0|b[F]),x[2*F+1]=8191&(I>>>=13),I>>>=13;for(F=2*D;F<P;++F)x[F]=0;c(0===I),c(0==(-8192&I))},f.prototype.stub=function(b){for(var D=new Array(b),x=0;x<b;x++)D[x]=0;return D},f.prototype.mulp=function(b,D,x){var P=2*this.guessLen13b(b.length,D.length),I=this.makeRBT(P),F=this.stub(P),G=new Array(P),U=new Array(P),K=new Array(P),H=new Array(P),Q=new Array(P),$=new Array(P),ue=x.words;ue.length=P,this.convert13b(b.words,b.length,G,P),this.convert13b(D.words,D.length,H,P),this.transform(G,F,U,K,P,I),this.transform(H,F,Q,$,P,I);for(var ae=0;ae<P;ae++){var me=U[ae]*Q[ae]-K[ae]*$[ae];K[ae]=U[ae]*$[ae]+K[ae]*Q[ae],U[ae]=me}return this.conjugate(U,K,P),this.transform(U,K,ue,F,P,I),this.conjugate(ue,F,P),this.normalize13b(ue,P),x.negative=b.negative^D.negative,x.length=b.length+D.length,x.strip()},n.prototype.mul=function(b){var D=new n(null);return D.words=new Array(this.length+b.length),this.mulTo(b,D)},n.prototype.mulf=function(b){var D=new n(null);return D.words=new Array(this.length+b.length),h(this,b,D)},n.prototype.imul=function(b){return this.clone().mulTo(b,this)},n.prototype.imuln=function(b){c("number"==typeof b),c(b<67108864);for(var D=0,x=0;x<this.length;x++){var P=(0|this.words[x])*b,I=(67108863&P)+(67108863&D);D>>=26,D+=P/67108864|0,D+=I>>>26,this.words[x]=67108863&I}return 0!==D&&(this.words[x]=D,this.length++),this},n.prototype.muln=function(b){return this.clone().imuln(b)},n.prototype.sqr=function(){return this.mul(this)},n.prototype.isqr=function(){return this.imul(this.clone())},n.prototype.pow=function(b){var D=function(F){for(var G=new Array(F.bitLength()),U=0;U<G.length;U++){var H=U%26;G[U]=(F.words[U/26|0]&1<<H)>>>H}return G}(b);if(0===D.length)return new n(1);for(var x=this,P=0;P<D.length&&0===D[P];P++,x=x.sqr());if(++P<D.length)for(var I=x.sqr();P<D.length;P++,I=I.sqr())0!==D[P]&&(x=x.mul(I));return x},n.prototype.iushln=function(b){c("number"==typeof b&&b>=0);var D,x=b%26,P=(b-x)/26,I=67108863>>>26-x<<26-x;if(0!==x){var F=0;for(D=0;D<this.length;D++){var G=this.words[D]&I;this.words[D]=(0|this.words[D])-G<<x|F,F=G>>>26-x}F&&(this.words[D]=F,this.length++)}if(0!==P){for(D=this.length-1;D>=0;D--)this.words[D+P]=this.words[D];for(D=0;D<P;D++)this.words[D]=0;this.length+=P}return this.strip()},n.prototype.ishln=function(b){return c(0===this.negative),this.iushln(b)},n.prototype.iushrn=function(b,D,x){var P;c("number"==typeof b&&b>=0),P=D?(D-D%26)/26:0;var I=b%26,F=Math.min((b-I)/26,this.length),G=67108863^67108863>>>I<<I,U=x;if(P-=F,P=Math.max(0,P),U){for(var K=0;K<F;K++)U.words[K]=this.words[K];U.length=F}if(0!==F)if(this.length>F)for(this.length-=F,K=0;K<this.length;K++)this.words[K]=this.words[K+F];else this.words[0]=0,this.length=1;var H=0;for(K=this.length-1;K>=0&&(0!==H||K>=P);K--){var Q=0|this.words[K];this.words[K]=H<<26-I|Q>>>I,H=Q&G}return U&&0!==H&&(U.words[U.length++]=H),0===this.length&&(this.words[0]=0,this.length=1),this.strip()},n.prototype.ishrn=function(b,D,x){return c(0===this.negative),this.iushrn(b,D,x)},n.prototype.shln=function(b){return this.clone().ishln(b)},n.prototype.ushln=function(b){return this.clone().iushln(b)},n.prototype.shrn=function(b){return this.clone().ishrn(b)},n.prototype.ushrn=function(b){return this.clone().iushrn(b)},n.prototype.testn=function(b){c("number"==typeof b&&b>=0);var D=b%26,x=(b-D)/26;return!(this.length<=x||!(this.words[x]&1<<D))},n.prototype.imaskn=function(b){c("number"==typeof b&&b>=0);var D=b%26,x=(b-D)/26;return c(0===this.negative,"imaskn works only with positive numbers"),this.length<=x?this:(0!==D&&x++,this.length=Math.min(x,this.length),0!==D&&(this.words[this.length-1]&=67108863^67108863>>>D<<D),this.strip())},n.prototype.maskn=function(b){return this.clone().imaskn(b)},n.prototype.iaddn=function(b){return c("number"==typeof b),c(b<67108864),b<0?this.isubn(-b):0!==this.negative?1===this.length&&(0|this.words[0])<b?(this.words[0]=b-(0|this.words[0]),this.negative=0,this):(this.negative=0,this.isubn(b),this.negative=1,this):this._iaddn(b)},n.prototype._iaddn=function(b){this.words[0]+=b;for(var D=0;D<this.length&&this.words[D]>=67108864;D++)this.words[D]-=67108864,D===this.length-1?this.words[D+1]=1:this.words[D+1]++;return this.length=Math.max(this.length,D+1),this},n.prototype.isubn=function(b){if(c("number"==typeof b),c(b<67108864),b<0)return this.iaddn(-b);if(0!==this.negative)return this.negative=0,this.iaddn(b),this.negative=1,this;if(this.words[0]-=b,1===this.length&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var D=0;D<this.length&&this.words[D]<0;D++)this.words[D]+=67108864,this.words[D+1]-=1;return this.strip()},n.prototype.addn=function(b){return this.clone().iaddn(b)},n.prototype.subn=function(b){return this.clone().isubn(b)},n.prototype.iabs=function(){return this.negative=0,this},n.prototype.abs=function(){return this.clone().iabs()},n.prototype._ishlnsubmul=function(b,D,x){var P;this._expand(b.length+x);var F,G=0;for(P=0;P<b.length;P++){F=(0|this.words[P+x])+G;var U=(0|b.words[P])*D;G=((F-=67108863&U)>>26)-(U/67108864|0),this.words[P+x]=67108863&F}for(;P<this.length-x;P++)G=(F=(0|this.words[P+x])+G)>>26,this.words[P+x]=67108863&F;if(0===G)return this.strip();for(c(-1===G),G=0,P=0;P<this.length;P++)G=(F=-(0|this.words[P])+G)>>26,this.words[P]=67108863&F;return this.negative=1,this.strip()},n.prototype._wordDiv=function(b,D){var x,P=this.clone(),I=b,F=0|I.words[I.length-1];0!=(x=26-this._countBits(F))&&(I=I.ushln(x),P.iushln(x),F=0|I.words[I.length-1]);var G,U=P.length-I.length;if("mod"!==D){(G=new n(null)).length=U+1,G.words=new Array(G.length);for(var K=0;K<G.length;K++)G.words[K]=0}var H=P.clone()._ishlnsubmul(I,1,U);0===H.negative&&(P=H,G&&(G.words[U]=1));for(var Q=U-1;Q>=0;Q--){var $=67108864*(0|P.words[I.length+Q])+(0|P.words[I.length+Q-1]);for($=Math.min($/F|0,67108863),P._ishlnsubmul(I,$,Q);0!==P.negative;)$--,P.negative=0,P._ishlnsubmul(I,1,Q),P.isZero()||(P.negative^=1);G&&(G.words[Q]=$)}return G&&G.strip(),P.strip(),"div"!==D&&0!==x&&P.iushrn(x),{div:G||null,mod:P}},n.prototype.divmod=function(b,D,x){return c(!b.isZero()),this.isZero()?{div:new n(0),mod:new n(0)}:0!==this.negative&&0===b.negative?(F=this.neg().divmod(b,D),"mod"!==D&&(P=F.div.neg()),"div"!==D&&(I=F.mod.neg(),x&&0!==I.negative&&I.iadd(b)),{div:P,mod:I}):0===this.negative&&0!==b.negative?(F=this.divmod(b.neg(),D),"mod"!==D&&(P=F.div.neg()),{div:P,mod:F.mod}):0!=(this.negative&b.negative)?(F=this.neg().divmod(b.neg(),D),"div"!==D&&(I=F.mod.neg(),x&&0!==I.negative&&I.isub(b)),{div:F.div,mod:I}):b.length>this.length||this.cmp(b)<0?{div:new n(0),mod:this}:1===b.length?"div"===D?{div:this.divn(b.words[0]),mod:null}:"mod"===D?{div:null,mod:new n(this.modn(b.words[0]))}:{div:this.divn(b.words[0]),mod:new n(this.modn(b.words[0]))}:this._wordDiv(b,D);var P,I,F},n.prototype.div=function(b){return this.divmod(b,"div",!1).div},n.prototype.mod=function(b){return this.divmod(b,"mod",!1).mod},n.prototype.umod=function(b){return this.divmod(b,"mod",!0).mod},n.prototype.divRound=function(b){var D=this.divmod(b);if(D.mod.isZero())return D.div;var x=0!==D.div.negative?D.mod.isub(b):D.mod,P=b.ushrn(1),I=b.andln(1),F=x.cmp(P);return F<0||1===I&&0===F?D.div:0!==D.div.negative?D.div.isubn(1):D.div.iaddn(1)},n.prototype.modn=function(b){c(b<=67108863);for(var D=(1<<26)%b,x=0,P=this.length-1;P>=0;P--)x=(D*x+(0|this.words[P]))%b;return x},n.prototype.idivn=function(b){c(b<=67108863);for(var D=0,x=this.length-1;x>=0;x--){var P=(0|this.words[x])+67108864*D;this.words[x]=P/b|0,D=P%b}return this.strip()},n.prototype.divn=function(b){return this.clone().idivn(b)},n.prototype.egcd=function(b){c(0===b.negative),c(!b.isZero());var D=this,x=b.clone();D=0!==D.negative?D.umod(b):D.clone();for(var P=new n(1),I=new n(0),F=new n(0),G=new n(1),U=0;D.isEven()&&x.isEven();)D.iushrn(1),x.iushrn(1),++U;for(var K=x.clone(),H=D.clone();!D.isZero();){for(var Q=0,$=1;0==(D.words[0]&$)&&Q<26;++Q,$<<=1);if(Q>0)for(D.iushrn(Q);Q-- >0;)(P.isOdd()||I.isOdd())&&(P.iadd(K),I.isub(H)),P.iushrn(1),I.iushrn(1);for(var ue=0,ae=1;0==(x.words[0]&ae)&&ue<26;++ue,ae<<=1);if(ue>0)for(x.iushrn(ue);ue-- >0;)(F.isOdd()||G.isOdd())&&(F.iadd(K),G.isub(H)),F.iushrn(1),G.iushrn(1);D.cmp(x)>=0?(D.isub(x),P.isub(F),I.isub(G)):(x.isub(D),F.isub(P),G.isub(I))}return{a:F,b:G,gcd:x.iushln(U)}},n.prototype._invmp=function(b){c(0===b.negative),c(!b.isZero());var D,x=this,P=b.clone();x=0!==x.negative?x.umod(b):x.clone();for(var I=new n(1),F=new n(0),G=P.clone();x.cmpn(1)>0&&P.cmpn(1)>0;){for(var U=0,K=1;0==(x.words[0]&K)&&U<26;++U,K<<=1);if(U>0)for(x.iushrn(U);U-- >0;)I.isOdd()&&I.iadd(G),I.iushrn(1);for(var H=0,Q=1;0==(P.words[0]&Q)&&H<26;++H,Q<<=1);if(H>0)for(P.iushrn(H);H-- >0;)F.isOdd()&&F.iadd(G),F.iushrn(1);x.cmp(P)>=0?(x.isub(P),I.isub(F)):(P.isub(x),F.isub(I))}return(D=0===x.cmpn(1)?I:F).cmpn(0)<0&&D.iadd(b),D},n.prototype.gcd=function(b){if(this.isZero())return b.abs();if(b.isZero())return this.abs();var D=this.clone(),x=b.clone();D.negative=0,x.negative=0;for(var P=0;D.isEven()&&x.isEven();P++)D.iushrn(1),x.iushrn(1);for(;;){for(;D.isEven();)D.iushrn(1);for(;x.isEven();)x.iushrn(1);var I=D.cmp(x);if(I<0){var F=D;D=x,x=F}else if(0===I||0===x.cmpn(1))break;D.isub(x)}return x.iushln(P)},n.prototype.invm=function(b){return this.egcd(b).a.umod(b)},n.prototype.isEven=function(){return 0==(1&this.words[0])},n.prototype.isOdd=function(){return 1==(1&this.words[0])},n.prototype.andln=function(b){return this.words[0]&b},n.prototype.bincn=function(b){c("number"==typeof b);var D=b%26,x=(b-D)/26,P=1<<D;if(this.length<=x)return this._expand(x+1),this.words[x]|=P,this;for(var I=P,F=x;0!==I&&F<this.length;F++){var G=0|this.words[F];I=(G+=I)>>>26,this.words[F]=G&=67108863}return 0!==I&&(this.words[F]=I,this.length++),this},n.prototype.isZero=function(){return 1===this.length&&0===this.words[0]},n.prototype.cmpn=function(b){var D,x=b<0;if(0!==this.negative&&!x)return-1;if(0===this.negative&&x)return 1;if(this.strip(),this.length>1)D=1;else{x&&(b=-b),c(b<=67108863,"Number is too big");var P=0|this.words[0];D=P===b?0:P<b?-1:1}return 0!==this.negative?0|-D:D},n.prototype.cmp=function(b){if(0!==this.negative&&0===b.negative)return-1;if(0===this.negative&&0!==b.negative)return 1;var D=this.ucmp(b);return 0!==this.negative?0|-D:D},n.prototype.ucmp=function(b){if(this.length>b.length)return 1;if(this.length<b.length)return-1;for(var D=0,x=this.length-1;x>=0;x--){var P=0|this.words[x],I=0|b.words[x];if(P!==I){P<I?D=-1:P>I&&(D=1);break}}return D},n.prototype.gtn=function(b){return 1===this.cmpn(b)},n.prototype.gt=function(b){return 1===this.cmp(b)},n.prototype.gten=function(b){return this.cmpn(b)>=0},n.prototype.gte=function(b){return this.cmp(b)>=0},n.prototype.ltn=function(b){return-1===this.cmpn(b)},n.prototype.lt=function(b){return-1===this.cmp(b)},n.prototype.lten=function(b){return this.cmpn(b)<=0},n.prototype.lte=function(b){return this.cmp(b)<=0},n.prototype.eqn=function(b){return 0===this.cmpn(b)},n.prototype.eq=function(b){return 0===this.cmp(b)},n.red=function(b){return new E(b)},n.prototype.toRed=function(b){return c(!this.red,"Already a number in reduction context"),c(0===this.negative,"red works only with positives"),b.convertTo(this)._forceRed(b)},n.prototype.fromRed=function(){return c(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},n.prototype._forceRed=function(b){return this.red=b,this},n.prototype.forceRed=function(b){return c(!this.red,"Already a number in reduction context"),this._forceRed(b)},n.prototype.redAdd=function(b){return c(this.red,"redAdd works only with red numbers"),this.red.add(this,b)},n.prototype.redIAdd=function(b){return c(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,b)},n.prototype.redSub=function(b){return c(this.red,"redSub works only with red numbers"),this.red.sub(this,b)},n.prototype.redISub=function(b){return c(this.red,"redISub works only with red numbers"),this.red.isub(this,b)},n.prototype.redShl=function(b){return c(this.red,"redShl works only with red numbers"),this.red.shl(this,b)},n.prototype.redMul=function(b){return c(this.red,"redMul works only with red numbers"),this.red._verify2(this,b),this.red.mul(this,b)},n.prototype.redIMul=function(b){return c(this.red,"redMul works only with red numbers"),this.red._verify2(this,b),this.red.imul(this,b)},n.prototype.redSqr=function(){return c(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},n.prototype.redISqr=function(){return c(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},n.prototype.redSqrt=function(){return c(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},n.prototype.redInvm=function(){return c(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},n.prototype.redNeg=function(){return c(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},n.prototype.redPow=function(b){return c(this.red&&!b.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,b)};var te={k256:null,p224:null,p192:null,p25519:null};g.prototype._tmp=function(){var b=new n(null);return b.words=new Array(Math.ceil(this.n/13)),b},g.prototype.ireduce=function(b){var D,x=b;do{this.split(x,this.tmp),D=(x=(x=this.imulK(x)).iadd(this.tmp)).bitLength()}while(D>this.n);var P=D<this.n?-1:x.ucmp(this.p);return 0===P?(x.words[0]=0,x.length=1):P>0?x.isub(this.p):x.strip(),x},g.prototype.split=function(b,D){b.iushrn(this.n,0,D)},g.prototype.imulK=function(b){return b.imul(this.k)},s(y,g),y.prototype.split=function(b,D){for(var x=4194303,P=Math.min(b.length,9),I=0;I<P;I++)D.words[I]=b.words[I];if(D.length=P,b.length<=9)return b.words[0]=0,void(b.length=1);var F=b.words[9];for(D.words[D.length++]=F&x,I=10;I<b.length;I++){var G=0|b.words[I];b.words[I-10]=(G&x)<<4|F>>>22,F=G}b.words[I-10]=F>>>=22,b.length-=0===F&&b.length>10?10:9},y.prototype.imulK=function(b){b.words[b.length]=0,b.words[b.length+1]=0,b.length+=2;for(var D=0,x=0;x<b.length;x++){var P=0|b.words[x];b.words[x]=67108863&(D+=977*P),D=64*P+(D/67108864|0)}return 0===b.words[b.length-1]&&(b.length--,0===b.words[b.length-1]&&b.length--),b},s(A,g),s(T,g),s(C,g),C.prototype.imulK=function(b){for(var D=0,x=0;x<b.length;x++){var P=19*(0|b.words[x])+D,I=67108863&P;P>>>=26,b.words[x]=I,D=P}return 0!==D&&(b.words[b.length++]=D),b},n._prime=function(b){if(te[b])return te[b];var D;if("k256"===b)D=new y;else if("p224"===b)D=new A;else if("p192"===b)D=new T;else{if("p25519"!==b)throw new Error("Unknown prime "+b);D=new C}return te[b]=D,D},E.prototype._verify1=function(b){c(0===b.negative,"red works only with positives"),c(b.red,"red works only with red numbers")},E.prototype._verify2=function(b,D){c(0==(b.negative|D.negative),"red works only with positives"),c(b.red&&b.red===D.red,"red works only with red numbers")},E.prototype.imod=function(b){return this.prime?this.prime.ireduce(b)._forceRed(this):b.umod(this.m)._forceRed(this)},E.prototype.neg=function(b){return b.isZero()?b.clone():this.m.sub(b)._forceRed(this)},E.prototype.add=function(b,D){this._verify2(b,D);var x=b.add(D);return x.cmp(this.m)>=0&&x.isub(this.m),x._forceRed(this)},E.prototype.iadd=function(b,D){this._verify2(b,D);var x=b.iadd(D);return x.cmp(this.m)>=0&&x.isub(this.m),x},E.prototype.sub=function(b,D){this._verify2(b,D);var x=b.sub(D);return x.cmpn(0)<0&&x.iadd(this.m),x._forceRed(this)},E.prototype.isub=function(b,D){this._verify2(b,D);var x=b.isub(D);return x.cmpn(0)<0&&x.iadd(this.m),x},E.prototype.shl=function(b,D){return this._verify1(b),this.imod(b.ushln(D))},E.prototype.imul=function(b,D){return this._verify2(b,D),this.imod(b.imul(D))},E.prototype.mul=function(b,D){return this._verify2(b,D),this.imod(b.mul(D))},E.prototype.isqr=function(b){return this.imul(b,b.clone())},E.prototype.sqr=function(b){return this.mul(b,b)},E.prototype.sqrt=function(b){if(b.isZero())return b.clone();var D=this.m.andln(3);if(c(D%2==1),3===D){var x=this.m.add(new n(1)).iushrn(2);return this.pow(b,x)}for(var P=this.m.subn(1),I=0;!P.isZero()&&0===P.andln(1);)I++,P.iushrn(1);c(!P.isZero());var F=new n(1).toRed(this),G=F.redNeg(),U=this.m.subn(1).iushrn(1),K=this.m.bitLength();for(K=new n(2*K*K).toRed(this);0!==this.pow(K,U).cmp(G);)K.redIAdd(G);for(var H=this.pow(K,P),Q=this.pow(b,P.addn(1).iushrn(1)),$=this.pow(b,P),ue=I;0!==$.cmp(F);){for(var ae=$,me=0;0!==ae.cmp(F);me++)ae=ae.redSqr();c(me<ue);var be=this.pow(H,new n(1).iushln(ue-me-1));Q=Q.redMul(be),H=be.redSqr(),$=$.redMul(H),ue=me}return Q},E.prototype.invm=function(b){var D=b._invmp(this.m);return 0!==D.negative?(D.negative=0,this.imod(D).redNeg()):this.imod(D)},E.prototype.pow=function(b,D){if(D.isZero())return new n(1);if(0===D.cmpn(1))return b.clone();var x=new Array(16);x[0]=new n(1).toRed(this),x[1]=b;for(var P=2;P<x.length;P++)x[P]=this.mul(x[P-1],b);var I=x[0],F=0,G=0,U=D.bitLength()%26;for(0===U&&(U=26),P=D.length-1;P>=0;P--){for(var K=D.words[P],H=U-1;H>=0;H--){var Q=K>>H&1;I!==x[0]&&(I=this.sqr(I)),0!==Q||0!==F?(F<<=1,F|=Q,(4==++G||0===P&&0===H)&&(I=this.mul(I,x[F]),G=0,F=0)):G=0}U=26}return I},E.prototype.convertTo=function(b){var D=b.umod(this.m);return D===b?D.clone():D},E.prototype.convertFrom=function(b){var D=b.clone();return D.red=null,D},n.mont=function(b){return new R(b)},s(R,E),R.prototype.convertTo=function(b){return this.imod(b.ushln(this.shift))},R.prototype.convertFrom=function(b){var D=this.imod(b.mul(this.rinv));return D.red=null,D},R.prototype.imul=function(b,D){if(b.isZero()||D.isZero())return b.words[0]=0,b.length=1,b;var x=b.imul(D),P=x.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),I=x.isub(P).iushrn(this.shift),F=I;return I.cmp(this.m)>=0?F=I.isub(this.m):I.cmpn(0)<0&&(F=I.iadd(this.m)),F._forceRed(this)},R.prototype.mul=function(b,D){if(b.isZero()||D.isZero())return new n(0)._forceRed(this);var x=b.mul(D),P=x.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),I=x.isub(P).iushrn(this.shift),F=I;return I.cmp(this.m)>=0?F=I.isub(this.m):I.cmpn(0)<0&&(F=I.iadd(this.m)),F._forceRed(this)},R.prototype.invm=function(b){return this.imod(b._invmp(this.m).mul(this.r2))._forceRed(this)}}(void 0===l||l,this)},{}],17:[function(d,l,t){function i(s){this.rand=s}var u;if(l.exports=function(s){return u||(u=new i(null)),u.generate(s)},l.exports.Rand=i,i.prototype.generate=function(s){return this._rand(s)},"object"==("undefined"==typeof self?"undefined":De(self)))i.prototype._rand=self.crypto&&self.crypto.getRandomValues?function(s){var n=new Uint8Array(s);return self.crypto.getRandomValues(n),n}:self.msCrypto&&self.msCrypto.getRandomValues?function(s){var n=new Uint8Array(s);return self.msCrypto.getRandomValues(n),n}:function(){throw new Error("Not implemented yet")};else try{var c=d("crypto");i.prototype._rand=function(s){return c.randomBytes(s)}}catch(s){i.prototype._rand=function(n){for(var e=new Uint8Array(n),o=0;o<e.length;o++)e[o]=this.rand.getByte();return e}}},{crypto:18}],18:[function(d,l,t){},{}],19:[function(d,l,t){var i=t;i.utils=d("./hash/utils"),i.common=d("./hash/common"),i.sha=d("./hash/sha"),i.ripemd=d("./hash/ripemd"),i.hmac=d("./hash/hmac"),i.sha1=i.sha.sha1,i.sha256=i.sha.sha256,i.sha224=i.sha.sha224,i.sha384=i.sha.sha384,i.sha512=i.sha.sha512,i.ripemd160=i.ripemd.ripemd160},{"./hash/common":20,"./hash/hmac":21,"./hash/ripemd":22,"./hash/sha":23,"./hash/utils":24}],20:[function(d,l,t){function i(){this.pending=null,this.pendingTotal=0,this.blockSize=this.constructor.blockSize,this.outSize=this.constructor.outSize,this.hmacStrength=this.constructor.hmacStrength,this.padLength=this.constructor.padLength/8,this.endian="big",this._delta8=this.blockSize/8,this._delta32=this.blockSize/32}var u=d("../hash").utils,c=u.assert;t.BlockHash=i,i.prototype.update=function(s,n){if(s=u.toArray(s,n),this.pending=this.pending?this.pending.concat(s):s,this.pendingTotal+=s.length,this.pending.length>=this._delta8){var e=(s=this.pending).length%this._delta8;this.pending=s.slice(s.length-e,s.length),0===this.pending.length&&(this.pending=null),s=u.join32(s,0,s.length-e,this.endian);for(var o=0;o<s.length;o+=this._delta32)this._update(s,o,o+this._delta32)}return this},i.prototype.digest=function(s){return this.update(this._pad()),c(null===this.pending),this._digest(s)},i.prototype._pad=function(){var s=this.pendingTotal,n=this._delta8,e=n-(s+this.padLength)%n,o=new Array(e+this.padLength);o[0]=128;for(var r=1;r<e;r++)o[r]=0;if(s<<=3,"big"===this.endian){for(var h=8;h<this.padLength;h++)o[r++]=0;o[r++]=0,o[r++]=0,o[r++]=0,o[r++]=0,o[r++]=s>>>24&255,o[r++]=s>>>16&255,o[r++]=s>>>8&255,o[r++]=255&s}else for(o[r++]=255&s,o[r++]=s>>>8&255,o[r++]=s>>>16&255,o[r++]=s>>>24&255,o[r++]=0,o[r++]=0,o[r++]=0,o[r++]=0,h=8;h<this.padLength;h++)o[r++]=0;return o}},{"../hash":19}],21:[function(d,l,t){function i(s,n,e){return this instanceof i?(this.Hash=s,this.blockSize=s.blockSize/8,this.outSize=s.outSize/8,this.inner=null,this.outer=null,void this._init(u.toArray(n,e))):new i(s,n,e)}var u=d("../hash").utils,c=u.assert;l.exports=i,i.prototype._init=function(s){s.length>this.blockSize&&(s=(new this.Hash).update(s).digest()),c(s.length<=this.blockSize);for(var n=s.length;n<this.blockSize;n++)s.push(0);for(n=0;n<s.length;n++)s[n]^=54;for(this.inner=(new this.Hash).update(s),n=0;n<s.length;n++)s[n]^=106;this.outer=(new this.Hash).update(s)},i.prototype.update=function(s,n){return this.inner.update(s,n),this},i.prototype.digest=function(s){return this.outer.update(this.inner.digest()),this.outer.digest(s)}},{"../hash":19}],22:[function(d,l,t){function i(){return this instanceof i?(g.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],void(this.endian="little")):new i}function u(E,R,O,L){return E<=15?R^O^L:E<=31?R&O|~R&L:E<=47?(R|~O)^L:E<=63?R&L|O&~L:R^(O|~L)}function c(E){return E<=15?0:E<=31?1518500249:E<=47?1859775393:E<=63?2400959708:2840853838}function s(E){return E<=15?1352829926:E<=31?1548603684:E<=47?1836072691:E<=63?2053994217:0}var n=d("../hash"),e=n.utils,o=e.rotl32,r=e.sum32,h=e.sum32_3,f=e.sum32_4,g=n.common.BlockHash;e.inherits(i,g),t.ripemd160=i,i.blockSize=512,i.outSize=160,i.hmacStrength=192,i.padLength=64,i.prototype._update=function(E,R){for(var O=this.h[0],L=this.h[1],N=this.h[2],W=this.h[3],j=this.h[4],te=O,b=L,D=N,x=W,P=j,I=0;I<80;I++){var F=r(o(f(O,u(I,L,N,W),E[y[I]+R],c(I)),T[I]),j);O=j,j=W,W=o(N,10),N=L,L=F,F=r(o(f(te,u(79-I,b,D,x),E[A[I]+R],s(I)),C[I]),P),te=P,P=x,x=o(D,10),D=b,b=F}F=h(this.h[1],N,x),this.h[1]=h(this.h[2],W,P),this.h[2]=h(this.h[3],j,te),this.h[3]=h(this.h[4],O,b),this.h[4]=h(this.h[0],L,D),this.h[0]=F},i.prototype._digest=function(E){return"hex"===E?e.toHex32(this.h,"little"):e.split32(this.h,"little")};var y=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],A=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],T=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],C=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]},{"../hash":19}],23:[function(d,l,t){function i(){return this instanceof i?(Le.call(this),this.h=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],this.k=Je,void(this.W=new Array(64))):new i}function u(){return this instanceof u?(i.call(this),void(this.h=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])):new u}function c(){return this instanceof c?(Le.call(this),this.h=[1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209],this.k=vt,void(this.W=new Array(160))):new c}function s(){return this instanceof s?(c.call(this),void(this.h=[3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428])):new s}function n(){return this instanceof n?(Le.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],void(this.W=new Array(80))):new n}function e(ne,de,Z){return ne&de^~ne&Z}function o(ne,de,Z){return ne&de^ne&Z^de&Z}function r(ne){return I(ne,2)^I(ne,13)^I(ne,22)}function h(ne){return I(ne,6)^I(ne,11)^I(ne,25)}function f(ne){return I(ne,7)^I(ne,18)^ne>>>3}function g(ne){return I(ne,17)^I(ne,19)^ne>>>10}function y(ne,de,Z,ie){return 0===ne?e(de,Z,ie):1===ne||3===ne?de^Z^ie:2===ne?o(de,Z,ie):void 0}function A(ne,de,Z,ie,Ae,ye){var _e=ne&Z^~ne&Ae;return _e<0&&(_e+=4294967296),_e}function T(ne,de,Z,ie,Ae,ye){var _e=de&ie^~de&ye;return _e<0&&(_e+=4294967296),_e}function C(ne,de,Z,ie,Ae,ye){var _e=ne&Z^ne&Ae^Z&Ae;return _e<0&&(_e+=4294967296),_e}function E(ne,de,Z,ie,Ae,ye){var _e=de&ie^de&ye^ie&ye;return _e<0&&(_e+=4294967296),_e}function R(ne,de){var Z=H(ne,de,28)^H(de,ne,2)^H(de,ne,7);return Z<0&&(Z+=4294967296),Z}function O(ne,de){var Z=Q(ne,de,28)^Q(de,ne,2)^Q(de,ne,7);return Z<0&&(Z+=4294967296),Z}function L(ne,de){var Z=H(ne,de,14)^H(ne,de,18)^H(de,ne,9);return Z<0&&(Z+=4294967296),Z}function N(ne,de){var Z=Q(ne,de,14)^Q(ne,de,18)^Q(de,ne,9);return Z<0&&(Z+=4294967296),Z}function W(ne,de){var Z=H(ne,de,1)^H(ne,de,8)^$(ne,de,7);return Z<0&&(Z+=4294967296),Z}function j(ne,de){var Z=Q(ne,de,1)^Q(ne,de,8)^ue(ne,de,7);return Z<0&&(Z+=4294967296),Z}function te(ne,de){var Z=H(ne,de,19)^H(de,ne,29)^$(ne,de,6);return Z<0&&(Z+=4294967296),Z}function b(ne,de){var Z=Q(ne,de,19)^Q(de,ne,29)^ue(ne,de,6);return Z<0&&(Z+=4294967296),Z}var D=d("../hash"),x=D.utils,P=x.assert,I=x.rotr32,F=x.rotl32,G=x.sum32,U=x.sum32_4,K=x.sum32_5,H=x.rotr64_hi,Q=x.rotr64_lo,$=x.shr64_hi,ue=x.shr64_lo,ae=x.sum64,me=x.sum64_hi,be=x.sum64_lo,Xe=x.sum64_4_hi,Se=x.sum64_4_lo,Ce=x.sum64_5_hi,Zt=x.sum64_5_lo,Le=D.common.BlockHash,Je=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],vt=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591],Te=[1518500249,1859775393,2400959708,3395469782];x.inherits(i,Le),t.sha256=i,i.blockSize=512,i.outSize=256,i.hmacStrength=192,i.padLength=64,i.prototype._update=function(ne,de){for(var Z=this.W,ie=0;ie<16;ie++)Z[ie]=ne[de+ie];for(;ie<Z.length;ie++)Z[ie]=U(g(Z[ie-2]),Z[ie-7],f(Z[ie-15]),Z[ie-16]);var Ae=this.h[0],ye=this.h[1],_e=this.h[2],ct=this.h[3],ke=this.h[4],Pe=this.h[5],ut=this.h[6],Re=this.h[7];for(P(this.k.length===Z.length),ie=0;ie<Z.length;ie++){var we=K(Re,h(ke),e(ke,Pe,ut),this.k[ie],Z[ie]),Et=G(r(Ae),o(Ae,ye,_e));Re=ut,ut=Pe,Pe=ke,ke=G(ct,we),ct=_e,_e=ye,ye=Ae,Ae=G(we,Et)}this.h[0]=G(this.h[0],Ae),this.h[1]=G(this.h[1],ye),this.h[2]=G(this.h[2],_e),this.h[3]=G(this.h[3],ct),this.h[4]=G(this.h[4],ke),this.h[5]=G(this.h[5],Pe),this.h[6]=G(this.h[6],ut),this.h[7]=G(this.h[7],Re)},i.prototype._digest=function(ne){return"hex"===ne?x.toHex32(this.h,"big"):x.split32(this.h,"big")},x.inherits(u,i),t.sha224=u,u.blockSize=512,u.outSize=224,u.hmacStrength=192,u.padLength=64,u.prototype._digest=function(ne){return"hex"===ne?x.toHex32(this.h.slice(0,7),"big"):x.split32(this.h.slice(0,7),"big")},x.inherits(c,Le),t.sha512=c,c.blockSize=1024,c.outSize=512,c.hmacStrength=192,c.padLength=128,c.prototype._prepareBlock=function(ne,de){for(var Z=this.W,ie=0;ie<32;ie++)Z[ie]=ne[de+ie];for(;ie<Z.length;ie+=2){var Ae=te(Z[ie-4],Z[ie-3]),ye=b(Z[ie-4],Z[ie-3]),_e=Z[ie-14],ct=Z[ie-13],ke=W(Z[ie-30],Z[ie-29]),Pe=j(Z[ie-30],Z[ie-29]),ut=Z[ie-32],Re=Z[ie-31];Z[ie]=Xe(Ae,ye,_e,ct,ke,Pe,ut,Re),Z[ie+1]=Se(Ae,ye,_e,ct,ke,Pe,ut,Re)}},c.prototype._update=function(ne,de){this._prepareBlock(ne,de);var Z=this.W,ie=this.h[0],Ae=this.h[1],ye=this.h[2],_e=this.h[3],ct=this.h[4],ke=this.h[5],Pe=this.h[6],ut=this.h[7],Re=this.h[8],we=this.h[9],Et=this.h[10],Fe=this.h[11],je=this.h[12],yt=this.h[13],We=this.h[14],Ge=this.h[15];P(this.k.length===Z.length);for(var Rt=0;Rt<Z.length;Rt+=2){var Ke=We,He=Ge,pt=L(Re,we),Be=N(Re,we),qe=A(Re,0,Et,0,je),St=T(0,we,0,Fe,0,yt),Ue=this.k[Rt],Qe=this.k[Rt+1],Nt=Z[Rt],Ie=Z[Rt+1],ze=Ce(Ke,He,pt,Be,qe,St,Ue,Qe,Nt,Ie),Dt=Zt(Ke,He,pt,Be,qe,St,Ue,Qe,Nt,Ie),Me=(Ke=R(ie,Ae),He=O(ie,Ae),pt=C(ie,0,ye,0,ct),Be=E(0,Ae,0,_e,0,ke),me(Ke,He,pt,Be)),Ve=be(Ke,He,pt,Be);We=je,Ge=yt,je=Et,yt=Fe,Et=Re,Fe=we,Re=me(Pe,ut,ze,Dt),we=be(ut,ut,ze,Dt),Pe=ct,ut=ke,ct=ye,ke=_e,ye=ie,_e=Ae,ie=me(ze,Dt,Me,Ve),Ae=be(ze,Dt,Me,Ve)}ae(this.h,0,ie,Ae),ae(this.h,2,ye,_e),ae(this.h,4,ct,ke),ae(this.h,6,Pe,ut),ae(this.h,8,Re,we),ae(this.h,10,Et,Fe),ae(this.h,12,je,yt),ae(this.h,14,We,Ge)},c.prototype._digest=function(ne){return"hex"===ne?x.toHex32(this.h,"big"):x.split32(this.h,"big")},x.inherits(s,c),t.sha384=s,s.blockSize=1024,s.outSize=384,s.hmacStrength=192,s.padLength=128,s.prototype._digest=function(ne){return"hex"===ne?x.toHex32(this.h.slice(0,12),"big"):x.split32(this.h.slice(0,12),"big")},x.inherits(n,Le),t.sha1=n,n.blockSize=512,n.outSize=160,n.hmacStrength=80,n.padLength=64,n.prototype._update=function(ne,de){for(var Z=this.W,ie=0;ie<16;ie++)Z[ie]=ne[de+ie];for(;ie<Z.length;ie++)Z[ie]=F(Z[ie-3]^Z[ie-8]^Z[ie-14]^Z[ie-16],1);var Ae=this.h[0],ye=this.h[1],_e=this.h[2],ct=this.h[3],ke=this.h[4];for(ie=0;ie<Z.length;ie++){var Pe=~~(ie/20),ut=K(F(Ae,5),y(Pe,ye,_e,ct),ke,Z[ie],Te[Pe]);ke=ct,ct=_e,_e=F(ye,30),ye=Ae,Ae=ut}this.h[0]=G(this.h[0],Ae),this.h[1]=G(this.h[1],ye),this.h[2]=G(this.h[2],_e),this.h[3]=G(this.h[3],ct),this.h[4]=G(this.h[4],ke)},n.prototype._digest=function(ne){return"hex"===ne?x.toHex32(this.h,"big"):x.split32(this.h,"big")}},{"../hash":19}],24:[function(d,l,t){function i(o){return(o>>>24|o>>>8&65280|o<<8&16711680|(255&o)<<24)>>>0}function u(o){return 1===o.length?"0"+o:o}function c(o){return 7===o.length?"0"+o:6===o.length?"00"+o:5===o.length?"000"+o:4===o.length?"0000"+o:3===o.length?"00000"+o:2===o.length?"000000"+o:1===o.length?"0000000"+o:o}function s(o,r){if(!o)throw new Error(r||"Assertion failed")}var n=t,e=d("inherits");n.toArray=function(o,r){if(Array.isArray(o))return o.slice();if(!o)return[];var h=[];if("string"==typeof o)if(r){if("hex"===r){(o=o.replace(/[^a-z0-9]+/gi,"")).length%2!=0&&(o="0"+o);for(var f=0;f<o.length;f+=2)h.push(parseInt(o[f]+o[f+1],16))}}else for(f=0;f<o.length;f++){var g=o.charCodeAt(f),y=g>>8,A=255&g;y?h.push(y,A):h.push(A)}else for(f=0;f<o.length;f++)h[f]=0|o[f];return h},n.toHex=function(o){for(var r="",h=0;h<o.length;h++)r+=u(o[h].toString(16));return r},n.htonl=i,n.toHex32=function(o,r){for(var h="",f=0;f<o.length;f++){var g=o[f];"little"===r&&(g=i(g)),h+=c(g.toString(16))}return h},n.zero2=u,n.zero8=c,n.join32=function(o,r,h,f){var g=h-r;s(g%4==0);for(var y=new Array(g/4),A=0,T=r;A<y.length;A++,T+=4)y[A]=("big"===f?o[T]<<24|o[T+1]<<16|o[T+2]<<8|o[T+3]:o[T+3]<<24|o[T+2]<<16|o[T+1]<<8|o[T])>>>0;return y},n.split32=function(o,r){for(var h=new Array(4*o.length),f=0,g=0;f<o.length;f++,g+=4){var y=o[f];"big"===r?(h[g]=y>>>24,h[g+1]=y>>>16&255,h[g+2]=y>>>8&255,h[g+3]=255&y):(h[g+3]=y>>>24,h[g+2]=y>>>16&255,h[g+1]=y>>>8&255,h[g]=255&y)}return h},n.rotr32=function(o,r){return o>>>r|o<<32-r},n.rotl32=function(o,r){return o<<r|o>>>32-r},n.sum32=function(o,r){return o+r>>>0},n.sum32_3=function(o,r,h){return o+r+h>>>0},n.sum32_4=function(o,r,h,f){return o+r+h+f>>>0},n.sum32_5=function(o,r,h,f,g){return o+r+h+f+g>>>0},n.assert=s,n.inherits=e,t.sum64=function(o,r,h,f){var y=f+o[r+1]>>>0;o[r]=(y<f?1:0)+h+o[r]>>>0,o[r+1]=y},t.sum64_hi=function(o,r,h,f){return(r+f>>>0<r?1:0)+o+h>>>0},t.sum64_lo=function(o,r,h,f){return r+f>>>0},t.sum64_4_hi=function(o,r,h,f,g,y,A,T){var C=0,E=r;return C+=(E=E+f>>>0)<r?1:0,C+=(E=E+y>>>0)<y?1:0,o+h+g+A+(C+=(E=E+T>>>0)<T?1:0)>>>0},t.sum64_4_lo=function(o,r,h,f,g,y,A,T){return r+f+y+T>>>0},t.sum64_5_hi=function(o,r,h,f,g,y,A,T,C,E){var R=0,O=r;return R+=(O=O+f>>>0)<r?1:0,R+=(O=O+y>>>0)<y?1:0,R+=(O=O+T>>>0)<T?1:0,o+h+g+A+C+(R+=(O=O+E>>>0)<E?1:0)>>>0},t.sum64_5_lo=function(o,r,h,f,g,y,A,T,C,E){return r+f+y+T+E>>>0},t.rotr64_hi=function(o,r,h){return(r<<32-h|o>>>h)>>>0},t.rotr64_lo=function(o,r,h){return(o<<32-h|r>>>h)>>>0},t.shr64_hi=function(o,r,h){return o>>>h},t.shr64_lo=function(o,r,h){return(o<<32-h|r>>>h)>>>0}},{inherits:27}],25:[function(d,l,t){function i(n){if(!(this instanceof i))return new i(n);this.hash=n.hash,this.predResist=!!n.predResist,this.outLen=this.hash.outSize,this.minEntropy=n.minEntropy||this.hash.hmacStrength,this.reseed=null,this.reseedInterval=null,this.K=null,this.V=null;var e=c.toArray(n.entropy,n.entropyEnc||"hex"),o=c.toArray(n.nonce,n.nonceEnc||"hex"),r=c.toArray(n.pers,n.persEnc||"hex");s(e.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._init(e,o,r)}var u=d("hash.js"),c=d("minimalistic-crypto-utils"),s=d("minimalistic-assert");l.exports=i,i.prototype._init=function(n,e,o){var r=n.concat(e).concat(o);this.K=new Array(this.outLen/8),this.V=new Array(this.outLen/8);for(var h=0;h<this.V.length;h++)this.K[h]=0,this.V[h]=1;this._update(r),this.reseed=1,this.reseedInterval=281474976710656},i.prototype._hmac=function(){return new u.hmac(this.hash,this.K)},i.prototype._update=function(n){var e=this._hmac().update(this.V).update([0]);n&&(e=e.update(n)),this.K=e.digest(),this.V=this._hmac().update(this.V).digest(),n&&(this.K=this._hmac().update(this.V).update([1]).update(n).digest(),this.V=this._hmac().update(this.V).digest())},i.prototype.reseed=function(n,e,o,r){"string"!=typeof e&&(r=o,o=e,e=null),n=c.toArray(n,e),o=c.toArray(o,r),s(n.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._update(n.concat(o||[])),this.reseed=1},i.prototype.generate=function(n,e,o,r){if(this.reseed>this.reseedInterval)throw new Error("Reseed is required");"string"!=typeof e&&(r=o,o=e,e=null),o&&(o=c.toArray(o,r||"hex"),this._update(o));for(var h=[];h.length<n;)this.V=this._hmac().update(this.V).digest(),h=h.concat(this.V);var f=h.slice(0,n);return this._update(o),this.reseed++,c.encode(f,e)}},{"hash.js":19,"minimalistic-assert":28,"minimalistic-crypto-utils":26}],26:[function(d,l,t){function i(s){return 1===s.length?"0"+s:s}function u(s){for(var n="",e=0;e<s.length;e++)n+=i(s[e].toString(16));return n}var c=t;c.toArray=function(s,n){if(Array.isArray(s))return s.slice();if(!s)return[];var e=[];if("string"!=typeof s){for(var o=0;o<s.length;o++)e[o]=0|s[o];return e}if("hex"===n)for((s=s.replace(/[^a-z0-9]+/gi,"")).length%2!=0&&(s="0"+s),o=0;o<s.length;o+=2)e.push(parseInt(s[o]+s[o+1],16));else for(o=0;o<s.length;o++){var r=s.charCodeAt(o),h=r>>8,f=255&r;h?e.push(h,f):e.push(f)}return e},c.zero2=i,c.toHex=u,c.encode=function(s,n){return"hex"===n?u(s):s}},{}],27:[function(d,l,t){l.exports="function"==typeof Object.create?function(i,u){i.super_=u,i.prototype=Object.create(u.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}})}:function(i,u){i.super_=u;var c=function(){};c.prototype=u.prototype,i.prototype=new c,i.prototype.constructor=i}},{}],28:[function(d,l,t){function i(u,c){if(!u)throw new Error(c||"Assertion failed")}l.exports=i,i.equal=function(u,c,s){if(u!=c)throw new Error(s||"Assertion failed: "+u+" != "+c)}},{}],29:[function(d,l,t){function i(s){return 1===s.length?"0"+s:s}function u(s){for(var n="",e=0;e<s.length;e++)n+=i(s[e].toString(16));return n}var c=t;c.toArray=function(s,n){if(Array.isArray(s))return s.slice();if(!s)return[];var e=[];if("string"!=typeof s){for(var o=0;o<s.length;o++)e[o]=0|s[o];return e}if(n){if("hex"===n)for((s=s.replace(/[^a-z0-9]+/gi,"")).length%2!=0&&(s="0"+s),o=0;o<s.length;o+=2)e.push(parseInt(s[o]+s[o+1],16))}else for(o=0;o<s.length;o++){var r=s.charCodeAt(o),h=r>>8,f=255&r;h?e.push(h,f):e.push(f)}return e},c.zero2=i,c.toHex=u,c.encode=function(s,n){return"hex"===n?u(s):s}},{}],30:[function(d,l,t){l.exports={name:"elliptic",version:"6.4.0",description:"EC cryptography",main:"lib/elliptic.js",files:["lib"],scripts:{jscs:"jscs benchmarks/*.js lib/*.js lib/**/*.js lib/**/**/*.js test/index.js",jshint:"jscs benchmarks/*.js lib/*.js lib/**/*.js lib/**/**/*.js test/index.js",lint:"npm run jscs && npm run jshint",unit:"istanbul test _mocha --reporter=spec test/index.js",test:"npm run lint && npm run unit",version:"grunt dist && git add dist/"},repository:{type:"git",url:"git@github.com:indutny/elliptic"},keywords:["EC","Elliptic","curve","Cryptography"],author:"Fedor Indutny <fedor@indutny.com>",license:"MIT",bugs:{url:"https://github.com/indutny/elliptic/issues"},homepage:"https://github.com/indutny/elliptic",devDependencies:{brfs:"^1.4.3",coveralls:"^2.11.3",grunt:"^0.4.5","grunt-browserify":"^5.0.0","grunt-cli":"^1.2.0","grunt-contrib-connect":"^1.0.0","grunt-contrib-copy":"^1.0.0","grunt-contrib-uglify":"^1.0.1","grunt-mocha-istanbul":"^3.0.1","grunt-saucelabs":"^8.6.2",istanbul:"^0.4.2",jscs:"^2.9.0",jshint:"^2.6.0",mocha:"^2.1.0"},dependencies:{"bn.js":"^4.4.0",brorand:"^1.0.1","hash.js":"^1.0.0","hmac-drbg":"^1.0.0",inherits:"^2.0.1","minimalistic-assert":"^1.0.0","minimalistic-crypto-utils":"^1.0.0"}}},{}]},{},[1])(1)}(),function(p){var d="input is invalid type",l=!p.JS_SHA256_NO_ARRAY_BUFFER&&"undefined"!=typeof ArrayBuffer,t="0123456789abcdef".split(""),i=[-2147483648,8388608,32768,128],u=[24,16,8,0],c=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],s=["hex","array","digest","arrayBuffer"],n=[];!p.JS_SHA256_NO_NODE_JS&&Array.isArray||(Array.isArray=function(A){return"[object Array]"===Object.prototype.toString.call(A)}),!l||!p.JS_SHA256_NO_ARRAY_BUFFER_IS_VIEW&&ArrayBuffer.isView||(ArrayBuffer.isView=function(A){return"object"===De(A)&&A.buffer&&A.buffer.constructor===ArrayBuffer});var e=function(A,T){return function(C){return new f(T,!0).update(C)[A]()}},o=function(A){var T=e("hex",A);T.create=function(){return new f(A)},T.update=function(R){return T.create().update(R)};for(var C=0;C<s.length;++C){var E=s[C];T[E]=e(E,A)}return T},r=function(A,T){return function(C,E){return new g(C,T,!0).update(E)[A]()}},h=function(A){var T=r("hex",A);T.create=function(R){return new g(R,A)},T.update=function(R,O){return T.create(R).update(O)};for(var C=0;C<s.length;++C){var E=s[C];T[E]=r(E,A)}return T};function f(A,T){T?(n[0]=n[16]=n[1]=n[2]=n[3]=n[4]=n[5]=n[6]=n[7]=n[8]=n[9]=n[10]=n[11]=n[12]=n[13]=n[14]=n[15]=0,this.blocks=n):this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],A?(this.h0=3238371032,this.h1=914150663,this.h2=812702999,this.h3=4144912697,this.h4=4290775857,this.h5=1750603025,this.h6=1694076839,this.h7=3204075428):(this.h0=1779033703,this.h1=3144134277,this.h2=1013904242,this.h3=2773480762,this.h4=1359893119,this.h5=2600822924,this.h6=528734635,this.h7=1541459225),this.block=this.start=this.bytes=this.hBytes=0,this.finalized=this.hashed=!1,this.first=!0,this.is224=A}function g(A,T,C){var E,R=De(A);if("string"===R){var O,L=[],N=A.length,W=0;for(E=0;E<N;++E)(O=A.charCodeAt(E))<128?L[W++]=O:O<2048?(L[W++]=192|O>>6,L[W++]=128|63&O):O<55296||O>=57344?(L[W++]=224|O>>12,L[W++]=128|O>>6&63,L[W++]=128|63&O):(O=65536+((1023&O)<<10|1023&A.charCodeAt(++E)),L[W++]=240|O>>18,L[W++]=128|O>>12&63,L[W++]=128|O>>6&63,L[W++]=128|63&O);A=L}else{if("object"!==R)throw new Error(d);if(null===A)throw new Error(d);if(l&&A.constructor===ArrayBuffer)A=new Uint8Array(A);else if(!(Array.isArray(A)||l&&ArrayBuffer.isView(A)))throw new Error(d)}A.length>64&&(A=new f(T,!0).update(A).array());var j=[],te=[];for(E=0;E<64;++E){var b=A[E]||0;j[E]=92^b,te[E]=54^b}f.call(this,T,C),this.update(te),this.oKeyPad=j,this.inner=!0,this.sharedMemory=C}f.prototype.update=function(A){if(!this.finalized){var T,C=De(A);if("string"!==C){if("object"!==C)throw new Error(d);if(null===A)throw new Error(d);if(l&&A.constructor===ArrayBuffer)A=new Uint8Array(A);else if(!(Array.isArray(A)||l&&ArrayBuffer.isView(A)))throw new Error(d);T=!0}for(var E,R,O=0,L=A.length,N=this.blocks;O<L;){if(this.hashed&&(this.hashed=!1,N[0]=this.block,N[16]=N[1]=N[2]=N[3]=N[4]=N[5]=N[6]=N[7]=N[8]=N[9]=N[10]=N[11]=N[12]=N[13]=N[14]=N[15]=0),T)for(R=this.start;O<L&&R<64;++O)N[R>>2]|=A[O]<<u[3&R++];else for(R=this.start;O<L&&R<64;++O)(E=A.charCodeAt(O))<128?N[R>>2]|=E<<u[3&R++]:E<2048?(N[R>>2]|=(192|E>>6)<<u[3&R++],N[R>>2]|=(128|63&E)<<u[3&R++]):E<55296||E>=57344?(N[R>>2]|=(224|E>>12)<<u[3&R++],N[R>>2]|=(128|E>>6&63)<<u[3&R++],N[R>>2]|=(128|63&E)<<u[3&R++]):(E=65536+((1023&E)<<10|1023&A.charCodeAt(++O)),N[R>>2]|=(240|E>>18)<<u[3&R++],N[R>>2]|=(128|E>>12&63)<<u[3&R++],N[R>>2]|=(128|E>>6&63)<<u[3&R++],N[R>>2]|=(128|63&E)<<u[3&R++]);this.lastByteIndex=R,this.bytes+=R-this.start,R>=64?(this.block=N[16],this.start=R-64,this.hash(),this.hashed=!0):this.start=R}return this.bytes>4294967295&&(this.hBytes+=this.bytes/4294967296<<0,this.bytes=this.bytes%4294967296),this}},f.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var A=this.blocks,T=this.lastByteIndex;A[16]=this.block,A[T>>2]|=i[3&T],this.block=A[16],T>=56&&(this.hashed||this.hash(),A[0]=this.block,A[16]=A[1]=A[2]=A[3]=A[4]=A[5]=A[6]=A[7]=A[8]=A[9]=A[10]=A[11]=A[12]=A[13]=A[14]=A[15]=0),A[14]=this.hBytes<<3|this.bytes>>>29,A[15]=this.bytes<<3,this.hash()}},f.prototype.hash=function(){var A,T,C,E,R,O,L,N,W,j=this.h0,te=this.h1,b=this.h2,D=this.h3,x=this.h4,P=this.h5,I=this.h6,F=this.h7,G=this.blocks;for(A=16;A<64;++A)T=((R=G[A-15])>>>7|R<<25)^(R>>>18|R<<14)^R>>>3,C=((R=G[A-2])>>>17|R<<15)^(R>>>19|R<<13)^R>>>10,G[A]=G[A-16]+T+G[A-7]+C<<0;for(W=te&b,A=0;A<64;A+=4)this.first?(this.is224?(O=300032,F=(R=G[0]-1413257819)-150054599<<0,D=R+24177077<<0):(O=704751109,F=(R=G[0]-210244248)-1521486534<<0,D=R+143694565<<0),this.first=!1):(E=(O=j&te)^j&b^W,F=D+(R=F+(C=(x>>>6|x<<26)^(x>>>11|x<<21)^(x>>>25|x<<7))+(x&P^~x&I)+c[A]+G[A])<<0,D=R+((T=(j>>>2|j<<30)^(j>>>13|j<<19)^(j>>>22|j<<10))+E)<<0),E=(L=D&j)^D&te^O,I=b+(R=I+(C=(F>>>6|F<<26)^(F>>>11|F<<21)^(F>>>25|F<<7))+(F&x^~F&P)+c[A+1]+G[A+1])<<0,T=((b=R+((T=(D>>>2|D<<30)^(D>>>13|D<<19)^(D>>>22|D<<10))+E)<<0)>>>2|b<<30)^(b>>>13|b<<19)^(b>>>22|b<<10),E=(N=b&D)^b&j^L,P=te+(R=P+(C=(I>>>6|I<<26)^(I>>>11|I<<21)^(I>>>25|I<<7))+(I&F^~I&x)+c[A+2]+G[A+2])<<0,T=((te=R+(T+E)<<0)>>>2|te<<30)^(te>>>13|te<<19)^(te>>>22|te<<10),E=(W=te&b)^te&D^N,x=j+(R=x+(C=(P>>>6|P<<26)^(P>>>11|P<<21)^(P>>>25|P<<7))+(P&I^~P&F)+c[A+3]+G[A+3])<<0,j=R+(T+E)<<0;this.h0=this.h0+j<<0,this.h1=this.h1+te<<0,this.h2=this.h2+b<<0,this.h3=this.h3+D<<0,this.h4=this.h4+x<<0,this.h5=this.h5+P<<0,this.h6=this.h6+I<<0,this.h7=this.h7+F<<0},f.prototype.toString=f.prototype.hex=function(){this.finalize();var A=this.h0,T=this.h1,C=this.h2,E=this.h3,R=this.h4,O=this.h5,L=this.h6,N=this.h7,W=t[A>>28&15]+t[A>>24&15]+t[A>>20&15]+t[A>>16&15]+t[A>>12&15]+t[A>>8&15]+t[A>>4&15]+t[15&A]+t[T>>28&15]+t[T>>24&15]+t[T>>20&15]+t[T>>16&15]+t[T>>12&15]+t[T>>8&15]+t[T>>4&15]+t[15&T]+t[C>>28&15]+t[C>>24&15]+t[C>>20&15]+t[C>>16&15]+t[C>>12&15]+t[C>>8&15]+t[C>>4&15]+t[15&C]+t[E>>28&15]+t[E>>24&15]+t[E>>20&15]+t[E>>16&15]+t[E>>12&15]+t[E>>8&15]+t[E>>4&15]+t[15&E]+t[R>>28&15]+t[R>>24&15]+t[R>>20&15]+t[R>>16&15]+t[R>>12&15]+t[R>>8&15]+t[R>>4&15]+t[15&R]+t[O>>28&15]+t[O>>24&15]+t[O>>20&15]+t[O>>16&15]+t[O>>12&15]+t[O>>8&15]+t[O>>4&15]+t[15&O]+t[L>>28&15]+t[L>>24&15]+t[L>>20&15]+t[L>>16&15]+t[L>>12&15]+t[L>>8&15]+t[L>>4&15]+t[15&L];return this.is224||(W+=t[N>>28&15]+t[N>>24&15]+t[N>>20&15]+t[N>>16&15]+t[N>>12&15]+t[N>>8&15]+t[N>>4&15]+t[15&N]),W},f.prototype.array=f.prototype.digest=function(){this.finalize();var A=this.h0,T=this.h1,C=this.h2,E=this.h3,R=this.h4,O=this.h5,L=this.h6,N=this.h7,W=[A>>24&255,A>>16&255,A>>8&255,255&A,T>>24&255,T>>16&255,T>>8&255,255&T,C>>24&255,C>>16&255,C>>8&255,255&C,E>>24&255,E>>16&255,E>>8&255,255&E,R>>24&255,R>>16&255,R>>8&255,255&R,O>>24&255,O>>16&255,O>>8&255,255&O,L>>24&255,L>>16&255,L>>8&255,255&L];return this.is224||W.push(N>>24&255,N>>16&255,N>>8&255,255&N),W},f.prototype.arrayBuffer=function(){this.finalize();var A=new ArrayBuffer(this.is224?28:32),T=new DataView(A);return T.setUint32(0,this.h0),T.setUint32(4,this.h1),T.setUint32(8,this.h2),T.setUint32(12,this.h3),T.setUint32(16,this.h4),T.setUint32(20,this.h5),T.setUint32(24,this.h6),this.is224||T.setUint32(28,this.h7),A},(g.prototype=new f).finalize=function(){if(f.prototype.finalize.call(this),this.inner){this.inner=!1;var A=this.array();f.call(this,this.is224,this.sharedMemory),this.update(this.oKeyPad),this.update(A),f.prototype.finalize.call(this)}};var y=o();y.sha256=y,y.sha224=o(!0),y.sha256.hmac=h(),y.sha224.hmac=h(!0),p.sha256=y.sha256,p.sha224=y.sha224}("undefined"!=typeof window?window:Ne),function(p){!function(d){!function(l){var t;!function(i){var u=function(){function s(n){this.flowId=n}return s.prototype.getFlowId=function(){return this.flowId},s}();i.ApprovalControlFlowExecutionContext=u;var c=function(){function s(n,e,o){this._session=e,this._sdk=n,this._clientContext=o,this._uiHandler=n.currentUiHandler,this._uiContextImpl=new t.impl.UIContextImpl(n)}return s.prototype.getUiContext=function(){return this._uiContextImpl},s.prototype.run=function(){var n=this;return this._sdk.log(t.LogLevel.Debug,function(){return"approvals: Starting session"}),this.queryApprovalsFromServer().then(function(e){return new Promise(function(o,r){n._completeFn=o,n._rejectFn=r,n.kickStartSession(e)})})},s.prototype.approve=function(n,e){return this.changeApprovalStatus(n,t.MobileApprovalStatus.Approved,e)},s.prototype.deny=function(n){return this.changeApprovalStatus(n,t.MobileApprovalStatus.Denied).then(function(e){return!0})},s.prototype.requestRefreshApprovals=function(){var n=this;return this.queryApprovalsFromServer().then(function(e){return n.updateManagedApprovals(e),!0},function(e){throw t.impl.AuthenticationErrorImpl.ensureAuthenticationError(e)})},s.prototype.finishSession=function(){if(!this._appSession)throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Internal,"Attempt to finish a non started approval session.");this._appSession.endSession(),this._appSession=null,this._completeFn(!0)},s.prototype.kickStartSession=function(n){this._appSession=this._sdk.currentUiHandler.createApprovalsSession(this._session.user.displayName),this._appSession?(this.updateManagedApprovals(n),this._appSession.startSession(this,null,this._clientContext)):this._rejectFn(t.impl.AuthenticationErrorImpl.appImplementationError("Invalid return from createTicketWaitSession."))},s.prototype.updateManagedApprovals=function(n){if(this._managedApprovals=n,!this._appSession)throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Internal,"Attempt to update approvals on a non started approval session.");this._appSession.setSessionApprovalsList(n)},s.prototype.queryApprovalsFromServer=function(){var n=this;this._sdk.log(t.LogLevel.Debug,function(){return"approvals: Initiating collection"});var e=this._sdk.promiseCollectionResult();return t.util.wrapPromiseWithActivityIndicator(this._uiHandler,null,this._clientContext,e.then(function(o){n._sdk.log(t.LogLevel.Debug,function(){return"approvals: Collection done; setting up request to query approvals"});var r=n._session.createApprovalsFetchRequest(o);return n._sdk.log(t.LogLevel.Debug,function(){return"approvals: Sending request to query approvals"}),n._session.performSessionExchange(r).then(function(h){return h.data.approvals.map(function(f){return new t.impl.ManagedMobileApprovalImpl(f)})})}))},s.prototype.changeApprovalStatus=function(n,e,o){var r=this;return this._sdk.log(t.LogLevel.Debug,function(){return"approval: change status of approval "+n.getApproval().getApprovalId()+" to "+e}),this._sdk.log(t.LogLevel.Debug,function(){return"approval: Initiating request promise"}),this._sdk.promiseCollectionResult().then(function(h){return r._sdk.log(t.LogLevel.Debug,function(){return"approval: Collection done; setting up request"}),r._session.createApprovalReplyRequest(h,n.getApproval().getApprovalId(),e)}).then(function(h){r._sdk.log(t.LogLevel.Debug,function(){return"approval: Initiating control flow"});var f=new u(h.getFlowId());return f.approval=n.getApproval(),r._session.startControlFlow(h,f,o||r._clientContext).then(function(g){return n.getApproval().updateStatus(e),r.updateManagedApprovals(r._managedApprovals),g},function(g){var y=t.impl.AuthenticationErrorImpl.ensureAuthenticationError(g);throw r._sdk.log(t.LogLevel.Debug,function(){return"approval: Got server error "+y}),y.getErrorCode()==t.AuthenticationErrorCode.Internal&&y.getData()&&6001==y.getData().server_error_code?(r._sdk.log(t.LogLevel.Debug,function(){return"approval: Converting server error"}),new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.ApprovalWrongState,y.getMessage())):y})})},s}();i.ApprovalSessionProcessor=c}((t=l.sdk||(l.sdk={})).core||(t.core={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={}));var S,It=Ne&&Ne.__awaiter||function(p,d,l,t){return new(l||(l=Promise))(function(i,u){function c(e){try{n(t.next(e))}catch(o){u(o)}}function s(e){try{n(t.throw(e))}catch(o){u(o)}}function n(e){var o;e.done?i(e.value):(o=e.value,o instanceof l?o:new l(function(r){r(o)})).then(c,s)}n((t=t.apply(p,d||[])).next())})},zt=Ne&&Ne.__generator||function(p,d){var l,t,i,u,c={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return u={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(u[Symbol.iterator]=function(){return this}),u;function s(n){return function(e){return function(o){if(l)throw new TypeError("Generator is already executing.");for(;c;)try{if(l=1,t&&(i=2&o[0]?t.return:o[0]?t.throw||((i=t.return)&&i.call(t),0):t.next)&&!(i=i.call(t,o[1])).done)return i;switch(t=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return c.label++,{value:o[1],done:!1};case 5:c.label++,t=o[1],o=[0];continue;case 7:o=c.ops.pop(),c.trys.pop();continue;default:if(!(i=(i=c.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){c=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){c.label=o[1];break}if(6===o[0]&&c.label<i[1]){c.label=i[1],i=o;break}if(i&&c.label<i[2]){c.label=i[2],c.ops.push(o);break}i[2]&&c.ops.pop(),c.trys.pop();continue}o=d.call(p,c)}catch(r){o=[6,r],t=0}finally{l=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([n,e])}}};(function(p){!function(d){!function(l){var t;!function(i){var u=function(y){function A(T,C){var E=y.call(this,T)||this;return C&&(E.flowId=C),E}return V(A,y),A.prototype.serializeTo=function(T){y.prototype.serializeTo.call(this,T),T.writePrimitive("flowId",this.flowId)},A.prototype.serializeFrom=function(T){y.prototype.serializeFrom.call(this,T),this.flowId=T.readPrimitive("flowId")},A}(i.MultiStageResumableProcessContinuation);i.ResumableControlFlowRequestContinuation=u;var c=function(y){function A(T,C){var E=y.call(this)||this;return T instanceof i.Session?E.initFromSession(T):E.serializeFrom(T),E}return V(A,y),Object.defineProperty(A.prototype,"userRecord",{get:function(){return this._userRecord},enumerable:!1,configurable:!0}),Object.defineProperty(A.prototype,"usedSessionJson",{get:function(){return this._sessionJson},enumerable:!1,configurable:!0}),Object.defineProperty(A.prototype,"controlFlowContinuation",{get:function(){return this._cflowContinuation},enumerable:!1,configurable:!0}),A.prototype.createUsedSession=function(T){var C=i.User.fromUserRecord(this._userRecord,T);return i.Session.fromJsonWithUser(T,this._sessionJson,C)},A.prototype.serializeTo=function(T){T.writePrimitive("user",this._userRecord),T.writePrimitive("session",this._sessionJson),T.writeObject("cflowContinuation",this._cflowContinuation)},A.prototype.serializeFrom=function(T){this._userRecord=T.readPrimitive("user"),this._sessionJson=T.readPrimitive("session"),this._cflowContinuation=T.readObject("cflowContinuation")},A.prototype.initFromSession=function(T){this._sessionJson=T.toJson(),this._userRecord=i.User.toUserRecord(T.user),this._cflowContinuation=T.createCurrentControlFlowContinuation()},A}(i.ResumableProcessStageContinuation);i.ExecuteControlFlowStageContinuation=c;var s=function(){function y(A){this._ownerRequest=A,this._rtContext=A.rtContext}return Object.defineProperty(y.prototype,"clientContext",{get:function(){return this._rtContext.clientContext},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"sdk",{get:function(){return this._rtContext.sdk},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"uiHandler",{get:function(){return this._rtContext.uiHandler},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"sdkSessionManagementServices",{get:function(){return this._rtContext.sdkSessionManagementServices},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"session",{get:function(){return this._usedSession},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"user",{get:function(){return this._usedSession.user},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"additionalParameters",{get:function(){return this._additionalParameters},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"policy",{get:function(){return this._policy},enumerable:!1,configurable:!0}),y.prototype.run=function(){return this.runOrContinue()},y.prototype.resume=function(A,T){var C=this;return new Promise(function(E,R){if(!(A instanceof c))return Promise.reject(new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Internal,"Invalid continuation type for resume"));C.restoreParametersFromContinuation(A),C.runOrContinue(A,T).then(E,R)})},y.prototype.restoreParametersFromContinuation=function(A){this._usedSession=A.createUsedSession(this.sdk)},y.prototype.postProcessControlFlowResult=function(A){return A},y.prototype.prepareForControlFlowExecution=function(){},y.prototype.handleControlFlowError=function(A){},y.prototype.createNextStage=function(A){return new e(this._ownerRequest,this._usedSession,A)},y.prototype.runOrContinue=function(A,T){var C=this;return this._usedSession.lock(),new Promise(function(E,R){var O;C.sdk.log(t.LogLevel.Debug,function(){return"Running "+C.opName+" for user "+(C.user.userId||C.user.idToken)+"; continuation: "+!!A}),C.sdk.ensureConfigured(),C.prepareForControlFlowExecution(),A?(C.sdk.log(t.LogLevel.Debug,function(){return C.opName+": Resuming control flow from continuation"}),O=C._usedSession.continueControlFlow(A.controlFlowContinuation,T,C._ownerRequest,C.clientContext)):C._inlineControlFlowInitiationServerResponse?(C.sdk.log(t.LogLevel.Debug,function(){return C.opName+": Non continuation, starting control flow with inline server response"}),O=C._usedSession.startControlFlow(C._inlineControlFlowInitiationServerResponse,C._ownerRequest,C.clientContext)):(C.sdk.log(t.LogLevel.Debug,function(){return C.opName+": Non continuation, starting control flow with server request"}),O=t.util.wrapPromiseWithActivityIndicator(C.uiHandler,null,C.clientContext,C.generateControlFlowRequest()).then(function(L){return C.sdk.log(t.LogLevel.Debug,function(){return C.opName+": Starting control flow"}),C._usedSession.startControlFlow(L,C._ownerRequest,C.clientContext)})),O.then(function(L){return E(C.postProcessControlFlowResult(L))},function(L){if(L.getErrorCode()==t.AuthenticationErrorCode.Internal&&L.getData()){var N=L.getData();L=t.impl.AuthenticationErrorImpl.errorForHostInternalErrorData(N)||L}C.handleControlFlowError(L),R(L)})}).finally(function(){C._usedSession.unlock()}).catch(function(E){return Promise.reject(t.impl.AuthenticationErrorImpl.ensureAuthenticationError(E))}).then(function(E){return C.createNextStage(E)})},y.prototype.getFlowId=function(){return this._ownerRequest.getFlowId()},y}();i.ExecuteControlFlowStage=s;var n=function(y){function A(T){var C=y.call(this)||this;return T instanceof e?C.initFromProc(T):C.serializeFrom(T),C}return V(A,y),Object.defineProperty(A.prototype,"redirectionContinuation",{get:function(){return this._redirectionContinuation},enumerable:!1,configurable:!0}),A.prototype.serializeTo=function(T){T.writeObject("redirectionContinuation",this._redirectionContinuation)},A.prototype.serializeFrom=function(T){this._redirectionContinuation=T.readNonNullObject("redirectionContinuation")},A.prototype.initFromProc=function(T){var C=T.requestProcess;if(!C)throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Internal,"Invalid state for requesting contination");this._redirectionContinuation=C.createContinuation()},A.prototype.createResumableProcess=function(T){return new e(T)},z([i.Serializable("RunRedirectsStageContinuation"),$t("design:paramtypes",[Object])],A)}(i.ResumableProcessStageContinuation),e=function(){function y(A,T,C){this._ownerRequest=A,this._rtContext=A.rtContext,this._usedSession=T||null,this._authResult=C||null;var E=C&&this._authResult.getInternalData();this._redirectData=E&&E.redirect&&E.redirect}return Object.defineProperty(y.prototype,"requestProcess",{get:function(){return this._requestProcess},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"clientContext",{get:function(){return this._rtContext.clientContext},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"sdk",{get:function(){return this._rtContext.sdk},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"uiHandler",{get:function(){return this._rtContext.uiHandler},enumerable:!1,configurable:!0}),y.prototype.createContinuation=function(){return new n(this)},y.prototype.run=function(){return It(this,void 0,void 0,function(){var A,E;return zt(this,function(R){switch(R.label){case 0:if(!this._authResult)throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Internal,"Invalid resumable control flow request state");return this._redirectData?[3,1]:[2,this._authResult];case 1:return[4,this.uiHandler.handlePolicyRedirect(i.Protocol.RedirectTypeMap[(A=this._redirectData).redirect_type],A.policy_id||null,A.target.user_id||A.target.token||null,A.params,this.clientContext)];case 2:switch((E=R.sent()).getAdditionalParametersOverride()&&(A.params=E.getAdditionalParametersOverride()),E.getRedirectResponse()){case t.RedirectResponseType.RedirectToPolicy:return[2,this.processRedirectRequest(A)];case t.RedirectResponseType.CancelRedirect:throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.UserCanceled,"Redirection to next policy canceled.");default:throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Internal,"Invalid redirect response type.")}case 3:return[2]}})})},y.prototype.resume=function(A,T){return A instanceof n?(this._requestProcess=A.redirectionContinuation.createResumableProcess(this._rtContext),this._requestProcess.resume(A.redirectionContinuation,T)):Promise.reject(new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Internal,"Invalid continuation type for resume"))},y.prototype.runtimeContextForCallee=function(){return{clientContext:this.clientContext,sdk:this.sdk,sdkSessionManagementServices:this._ownerRequest.rtContext.sdkSessionManagementServices,uiHandler:this.uiHandler,caller:this._ownerRequest}},y.prototype.processRedirectRequest=function(A){return It(this,void 0,void 0,function(){var T,C,E,R,O,L,N,W,j,te,b,D=this;return zt(this,function(x){if(!this._usedSession)throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Internal,"Invalid resumable control flow request state");if(T=A.policy_id||null,C=A.params,E=this._usedSession.user,"current"!=A.target.type)if("user_id"==A.target.type){if(!(R=A.target.user_id||this._usedSession.user.userId))throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Internal,"failed to resolve user id for redirect request <"+A.redirect_type+", "+A.target.type+">");R!=this._usedSession.user.userId&&(this.sdk.log(t.LogLevel.Debug,function(){return"User id in request is different than that of the current user <"+R+", "+D._usedSession.user.userId+">"}),E=i.User.findUser(this.sdk,R)||i.User.createUserWithUserId(this.sdk,R))}else{if("uid_token"!=A.target.type)throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Internal,"Unhandled redirect target type '"+A.target.type+"'");if(O=A.target.uid_hash,!(L=A.target.token||this._usedSession.user.idToken))throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Internal,"failed to resolve id token for redirect request <"+A.redirect_type+", "+A.target.type+">");L!=this._usedSession.user.idToken&&(this.sdk.log(t.LogLevel.Debug,function(){return"Id token in request is different than that of the current user <"+L+", "+D._usedSession.user.idToken+">"}),E=O&&i.User.findUserByUidHash(this.sdk,O)||i.User.findUser(this.sdk,L)||i.User.createUserWithIdToken(this.sdk,L,O))}switch(this.sdk.log(t.LogLevel.Info,function(){return"control flow || type:"+A.redirect_type+" policy: "+T}),(N=A.redirect_type)===i.Protocol.RedirectTypeName.RedirectTypeNameBindOrAuthenticate&&(N=E.deviceBound?i.Protocol.RedirectTypeName.RedirectTypeNameAuthenticate:i.Protocol.RedirectTypeName.RedirectTypeNameBind),W=this.runtimeContextForCallee(),N){case i.Protocol.RedirectTypeName.RedirectTypeNameAuthenticate:return j=new i.AuthenticateControlFlowRequest(W,this._ownerRequest.getFlowId()),this._requestProcess=j,[2,j.run(E,T,C)];case i.Protocol.RedirectTypeName.RedirectTypeNameBind:return te=new i.BindControlFlowRequest(W,this._ownerRequest.getFlowId()),this._requestProcess=te,[2,te.run(E,C)];case i.Protocol.RedirectTypeName.RedirectTypeNameInvokePolicy:return b=new i.InvokePolicyControlFlowRequest(W,this._ownerRequest.getFlowId()),this._requestProcess=b,[2,b.run(T,C)];default:throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Internal,"Unhandled redirect type '"+A.redirect_type+"'")}})})},y}();i.RunRedirectsStage=e;var o=function(y){function A(T,C){var E=y.call(this,T)||this;return E._flowId=C,E}return V(A,y),Object.defineProperty(A.prototype,"topmost",{get:function(){for(var T=this;T.rtContext.caller;)T=T.rtContext.caller;return T},enumerable:!1,configurable:!0}),A.prototype.getFlowId=function(){return this._flowId},A}(i.MultiStageResumableProcess);i.ResumableControlFlowRequest=o;var r=function(y){function A(){return null!==y&&y.apply(this,arguments)||this}return V(A,y),A.prototype.prepareForControlFlowExecution=function(){if(this.sdk.currentSession)throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.AppImplementation,"Attempt to start a session (bind) with a current primary active session.");this.sdkSessionManagementServices.setCurrentSession(this._usedSession)},A.prototype.handleControlFlowError=function(T){this.sdk.log(t.LogLevel.Debug,function(){return"Clearing session after error"}),this.sdkSessionManagementServices.setCurrentSession(null),this.sdkSessionManagementServices.saveCurrentSession()},A.prototype.postProcessControlFlowResult=function(T){return this._usedSession.persistUserData&&i.User.save(this.sdk,this._usedSession.user),this.sdkSessionManagementServices.saveCurrentSession(),i.Session.notifySessionObserversOnMainSessionLogin(this._usedSession),T},A.prototype.createNextStage=function(T){return new f(this._ownerRequest,this._usedSession,T)},A}(s);i.SessionSetupExecuteControlFlowStage=r;var h=function(y){function A(){return null!==y&&y.apply(this,arguments)||this}return V(A,y),A.prototype.createResumableProcess=function(T){return new f(T)},z([i.Serializable("SessionSetupProcessRedirectsStageContination")],A)}(n),f=function(y){function A(){return null!==y&&y.apply(this,arguments)||this}return V(A,y),A.prototype.resume=function(T,C){var E=this;return y.prototype.resume.call(this,T,C).catch(function(R){return E.handleRedirectionError(R)})},A.prototype.processRedirectRequest=function(T){var C=this;return y.prototype.processRedirectRequest.call(this,T).catch(function(E){return C.handleRedirectionError(E)})},A.prototype.createContinuation=function(){return new h(this)},A.prototype.handleRedirectionError=function(T){return this.sdk.apiLevel>=10?(this.sdk.log(t.LogLevel.Debug,function(){return"Error in redirect after session establishing call. Logging out session."}),this.sdk.logout().then(function(C){throw T},function(C){throw T})):Promise.reject(T)},A}(e);i.SessionSetupRunRedirectsStage=f;var g=function(y){function A(){return null!==y&&y.apply(this,arguments)||this}return V(A,y),A}(o);i.SessionSetupResumableControlFlowRequest=g}((t=l.sdk||(l.sdk={})).core||(t.core={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))})(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){var u=function(e){function o(){return null!==e&&e.apply(this,arguments)||this}return V(o,e),o.prototype.createResumableProcess=function(r){return new c(r)},z([i.Serializable("AuthenticateRequestExecuteControlFlowStageContinuation")],o)}(i.ExecuteControlFlowStageContinuation);i.AuthenticateRequestExecuteControlFlowStageContinuation=u;var c=function(e){function o(r,h,f,g){void 0===g&&(g=null);var y=e.call(this,r)||this;return y.opName="authenticate",h&&(y._usedSession=h,y._additionalParameters=f,y._policy=g),y}return V(o,e),o.generateLoginRequest=function(r,h){var f={collection_result:r.toJson(),push_token:h.sdkSessionManagementServices.lastReceivedPushToken};return h.policy&&(f.policy_request_id=h.policy),h.additionalParameters&&(f.params=h.additionalParameters),new i.SessionExchangeRequest("POST","auth/login",f,[],h.getFlowId())},o.prototype.generateControlFlowRequest=function(){var r=this;return this.sdk.promiseCollectionResult().then(function(h){return r.sdk.log(t.LogLevel.Debug,function(){return"authenticate: Collection done; setting up request"}),o.generateLoginRequest(h,r)})},o.prototype.postProcessControlFlowResult=function(r){return this.sdk.log(t.LogLevel.Debug,function(){return"authenticate: marking user has logged in after succesful completion"}),this.user.markLoggedIn(),e.prototype.postProcessControlFlowResult.call(this,r)},o.prototype.createContinuation=function(){return new u(this.session,this.getFlowId())},o}(i.SessionSetupExecuteControlFlowStage);i.AuthenticateRequestExecuteControlFlowStage=c;var s=function(e){function o(){return null!==e&&e.apply(this,arguments)||this}return V(o,e),o.prototype.createResumableProcess=function(r){return new n(r,this.flowId)},z([i.Serializable("AuthenticateControlFlowRequestContinuation")],o)}(i.ResumableControlFlowRequestContinuation),n=function(e){function o(){return null!==e&&e.apply(this,arguments)||this}return V(o,e),o.prototype.createContinuation=function(){return new s(this,this.getFlowId())},o.prototype.run=function(r,h,f){return this.startWithStage(new c(this,new i.Session(this.rtContext.sdk,r),f,h))},o}(i.SessionSetupResumableControlFlowRequest);i.AuthenticateControlFlowRequest=n}(t.core||(t.core={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){!function(u){var c,n;(n=c=u.AuthenticatorPrototype||(u.AuthenticatorPrototype={}))[n.Builtin=0]="Builtin",n[n.Placeholder=1]="Placeholder",n[n.Fido=2]="Fido",n[n.OTP=3]="OTP",n[n.Totp=4]="Totp",n[n.MobileApprove=5]="MobileApprove";var s=function(){function n(e,o,r,h){this._session=e,this._authenticatorId=o;var f=o.match(/^placeholder_(.*)$/);f?(this._authenticatorPrototype=c.Placeholder,this._placeholderId=f[1],this._authetnicationMethodTypeName=r.placeholder_type):o.match(/^fido_(.*)$/)?(this._authenticatorPrototype=c.Fido,this._authetnicationMethodTypeName=r.authenticator_type):o.match(/^otp_(.*)$/)?(this._authenticatorPrototype=c.OTP,this._authetnicationMethodTypeName=this.getAuthenticatorIdForMultiStep()):o.match(/^totp_(.*)$/)?(this._authenticatorPrototype=c.Totp,this._authetnicationMethodTypeName=this.getAuthenticatorIdForMultiStep()):o.match(/^mobile_approve_(.*)$/)?(this._authenticatorPrototype=c.MobileApprove,this._authetnicationMethodTypeName=this.getAuthenticatorIdForMobileApprove()):(this._authenticatorPrototype=c.Builtin,this._authetnicationMethodTypeName=this._authenticatorId),this._authenticatorMethodConfig=r,this._serverReportedRegistrationStatus=h.status,this._expired=h.expired||!1,this._locked=h.locked||!1,r.recovery_escape&&(this._recoveryEscapeOption=new p.ts.mobile.sdk.impl.EscapeOptionImpl(r.recovery_escape))}return Object.defineProperty(n.prototype,"authenticationDriverDescriptor",{get:function(){var e=this.internalAuthenticationDriverDescriptor();if(!e)throw new p.ts.mobile.sdk.impl.AuthenticationErrorImpl(p.ts.mobile.sdk.AuthenticationErrorCode.Internal,"Unhandled authenticator: "+this.getAuthenticatorId());return e},enumerable:!1,configurable:!0}),n.prototype.internalAuthenticationDriverDescriptor=function(){switch(this._authenticatorPrototype){case c.Placeholder:return u.AuthenticatorDrivers.__placeholder;case c.Fido:return new u.AuthenticationDriverDescriptorFido(this._authenticatorMethodConfig.fido_policy);case c.Totp:case c.OTP:var e=this.getAuthenticatorIdForMultiStep();return u.AuthenticatorDrivers[e];case c.MobileApprove:var o=this.getAuthenticatorIdForMobileApprove();return u.AuthenticatorDrivers[o];default:return u.AuthenticatorDrivers[this.getAuthenticatorId()]}},n.prototype.getAuthenticatorIdForMobileApprove=function(){var e=this._authenticatorId.split("_");return e[0]+"_"+e[1]},n.prototype.getAuthenticatorIdForMultiStep=function(){return""+this._authenticatorId.split("_")[0]},n.prototype.getAuthenticatorId=function(){return this._authenticatorId},n.prototype.getType=function(){var e=i.Protocol.AuthTypeData[this._authetnicationMethodTypeName];return e&&"authTypeEnum"in e?e.authTypeEnum:t.AuthenticatorType.Generic},n.prototype.getName=function(){var e=i.Protocol.AuthTypeData[this._authetnicationMethodTypeName];return e&&e.authTypeName||"Generic"},n.prototype.getExpired=function(){return this._expired},n.prototype.getRegistered=function(){return this.getRegistrationStatus()==t.AuthenticatorRegistrationStatus.Registered},n.prototype.getRegistrationStatus=function(){return this._serverReportedRegistrationStatus!=i.Protocol.AuthenticationMethodStatus.Registered?t.AuthenticatorRegistrationStatus.Unregistered:this.authenticationDriverDescriptor.evaluateLocalRegistrationStatus(this._session)},n.prototype.getLocked=function(){return this._locked},n.prototype.getDefaultAuthenticator=function(){return this._session.user.defaultAuthId==this.getAuthenticatorId()},n.prototype.getSupportedOnDevice=function(){return this.internalAuthenticationDriverDescriptor()&&this.authenticationDriverDescriptor.isSupportedOnDevice(this._session)},n.prototype.getPlaceholderId=function(){return this._placeholderId},n.prototype.updateWithAuthenticatorState=function(e){this._expired=e.expired||!1,this._locked=e.locked||!1,this._serverReportedRegistrationStatus=e.status},n.prototype.getCredentialRecoveryEscapeOption=function(){return this._recoveryEscapeOption},n}();u.AuthenticatorDescriptionImpl=s}(i.authenticationdrivers||(i.authenticationdrivers={}))}(t.core||(t.core={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){var t,i,u,c;c=l.sdk||(l.sdk={}),t=c.core||(c.core={}),i=function(s){function n(){return null!==s&&s.apply(this,arguments)||this}return V(n,s),n.prototype.getEnabled=function(){return this.getSupportedOnDevice()},n}(t.authenticationdrivers.AuthenticatorDescriptionImpl),u=function(){function s(n,e,o,r){this._sdk=n,this._session=e,this._token=r||null,this._clientContext=o,this._uiHandler=this._sdk.currentUiHandler,this._uiContextImpl=new c.impl.UIContextImpl(n)}return s.prototype.getUiContext=function(){return this._uiContextImpl},s.prototype.run=function(){var n=this;return this._sdk.log(c.LogLevel.Debug,function(){return"configuration: Starting session"}),this.queryConfigMenuFromServerAndFilter().then(function(e){return new Promise(function(o,r){n.kickStartSession(e),n._completeFn=o,n._rejectFn=r})})},s.prototype.registerAuthenticator=function(n,e){return this.requestAuthenticatorRegistrationChange(n,!0,e)},s.prototype.reregisterAuthenticator=function(n,e){return this.requestAuthenticatorRegistrationChange(n,!0,e)},s.prototype.setDefaultAuthenticator=function(n){var e=this;return this._sdk.log(c.LogLevel.Info,function(){return"Configuration: Updating user default authenticator."}),new Promise(function(o,r){if(!e._session.anonymous){var h=e._session.user;h.updateDefaultAuthId(n.getDescription().getAuthenticatorId()),e._session.persistUserData&&t.User.save(e._sdk,h)}o(!0),e.updateManagedAuthenticators(e._authenticators)})},s.prototype.unregisterAuthenticator=function(n,e){return this.requestAuthenticatorRegistrationChange(n,!1,e).then(function(o){return!0})},s.prototype.requestRefreshAuthenticators=function(){var n=this;return this.queryConfigMenuFromServerAndFilter().then(function(e){return n.updateManagedAuthenticators(e),!0},function(e){throw c.impl.AuthenticationErrorImpl.ensureAuthenticationError(e)})},s.prototype.finishSession=function(){if(!this._appSession)throw new c.impl.AuthenticationErrorImpl(c.AuthenticationErrorCode.Internal,"Attempt to finish a non started config session.");this._appSession.endSession(),this._appSession=null,this._completeFn(!0)},s.prototype.kickStartSession=function(n){this._appSession=this._uiHandler.createAuthenticationConfigurationSession(this._session.user.displayName),this._appSession?(this._appSession.startSession(this,null,this._clientContext),this.updateManagedAuthenticators(n)):this._rejectFn(c.impl.AuthenticationErrorImpl.appImplementationError("Invalid return from createAuthenticationConfigurationSession."))},s.prototype.updateManagedAuthenticators=function(n){if(!this._appSession)throw new c.impl.AuthenticationErrorImpl(c.AuthenticationErrorCode.Internal,"Attempt to work with a non started config session.");var e={};n.forEach(function(o){e[o.getDescription().getAuthenticatorId()]=o}),this._authenticators=n,this._authenticatorsByName=e,this._appSession.setAuthenticatorsList(n)},s.prototype.queryConfigMenuFromServerAndFilter=function(){var n=this;this._sdk.log(c.LogLevel.Debug,function(){return"configuration: Initiating collection"});var e=this._sdk.promiseCollectionResult();return c.util.wrapPromiseWithActivityIndicator(this._uiHandler,null,this._clientContext,e.then(function(o){n._sdk.log(c.LogLevel.Debug,function(){return"configuration: Collection done; setting up request to query for config menu"});var r=n._session.createConfigMenuFetchRequest(o,n._token);return n._sdk.log(c.LogLevel.Debug,function(){return"configuration: Sending request to query approvals"}),n._session.performSessionExchange(r).then(function(h){var f=h.data&&"configuration"==h.data.type&&h.data;if(!f)throw new c.impl.AuthenticationErrorImpl(c.AuthenticationErrorCode.Internal,"Invalid configuration screen structure encountered.");return f.methods.map(function(g){var y=new i(n._session,g.type,g,g);return new c.impl.ConfigurableAuthenticatorImpl(y,g.options)}).filter(function(g){return g.getDescription().getSupportedOnDevice()})})}))},s.prototype.requestAuthenticatorRegistrationChange=function(n,e,o){var r=this;this._sdk.log(c.LogLevel.Debug,function(){return"configuration: Authenticator "+n.getDescription().getName()+" request (un)registration "+e}),this._sdk.log(c.LogLevel.Debug,function(){return"configuration: Initiating registration request promise"});var h=this._sdk.promiseCollectionResult().then(function(f){return r._sdk.log(c.LogLevel.Debug,function(){return"configuration: Collection done; setting up request"}),r._session.createAuthRegistrationRequest(f,n.getDescription().getAuthenticatorId(),e,r._token)});return this._sdk.log(c.LogLevel.Debug,function(){return"configuration: Initiating control flow"}),h.then(function(f){return r._session.startControlFlow(f,null,o||r._clientContext).then(function(g){var y=g.getInternalData(),A=!1;if(y&&y.methods&&y.methods.length&&(r._sdk.log(c.LogLevel.Debug,function(){return"configuration: Processing updates."}),y.methods.forEach(function(C){var E=r._authenticatorsByName[C.type];E&&(E.getDescription().updateWithAuthenticatorState(C),A=!0)})),A){if(!e&&n.getDescription().getDefaultAuthenticator()&&!r._session.anonymous){var T=r._session.user;T.updateDefaultAuthId(""),r._session.persistUserData&&t.User.save(r._sdk,T)}r.updateManagedAuthenticators(r._authenticators)}return g},function(g){throw c.impl.AuthenticationErrorImpl.ensureAuthenticationError(g)})})},s}(),t.AuthenticationConfigurationSessionProcessor=u}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){var t;!function(i){var u=function(){function s(n,e){this._sdk=n,this._user=e}return Object.defineProperty(s.prototype,"user",{get:function(){return this._user},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"sdk",{get:function(){return this._sdk},enumerable:!1,configurable:!0}),s}();i.BaseSession=u;var c=function(s){function n(){return null!==s&&s.apply(this,arguments)||this}return V(n,s),n}(u);i.LocalSession=c}((t=l.sdk||(l.sdk={})).core||(t.core={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){var u=function(e){function o(){return null!==e&&e.apply(this,arguments)||this}return V(o,e),o.prototype.createResumableProcess=function(r){return new c(r)},z([i.Serializable("BindRequestExecuteControlFlowStageContinuation")],o)}(i.ExecuteControlFlowStageContinuation),c=function(e){function o(r,h,f){var g=e.call(this,r)||this;return g.opName="bind",h&&(g._usedSession=h,g._additionalParameters=f),g}return V(o,e),o.prototype.generateControlFlowRequest=function(){var r=this;this.sdk.log(t.LogLevel.Debug,function(){return r.opName+": Generating new device keys for "+(r.user.userId||r.user.idToken)});var h=this.sdk.host.generateKeyPair(this.user.deviceSigningKeyTag,l.sdkhost.KeyClass.StdSigningKey,l.sdkhost.KeyBiometricProtectionMode.None,!0),f=this.sdk.host.generateKeyPair(this.user.deviceEncryptionKeyTag,l.sdkhost.KeyClass.StdEncryptionKey,l.sdkhost.KeyBiometricProtectionMode.None,!0);return Promise.all([h,f]).then(function(g){var y=g[0],A=g[1];return r.sdk.log(t.LogLevel.Debug,function(){return r.opName+": key generation done"}),r.sdk.promiseCollectionResult().then(function(T){r.sdk.log(t.LogLevel.Debug,function(){return r.opName+": Collection result completed, Initiating request promise"});var C={collection_result:T.toJson(),public_key:y.publicKeyToJson(),push_token:r.sdkSessionManagementServices.lastReceivedPushToken};return A&&(C.encryption_public_key=A.publicKeyToJson()),r.additionalParameters&&(C.params=r.additionalParameters),new i.SessionExchangeRequest("POST","auth/bind",C,[],r.getFlowId())})})},o.prototype.postProcessControlFlowResult=function(r){var h=this,f=this.sdk.currentSession&&this.sdk.currentSession.deviceId();return this.sdk.currentSession&&f&&(this.sdk.log(t.LogLevel.Debug,function(){return h.opName+": binding device to user after succesful completion"}),this.sdk.currentSession.user.bindDeviceToUser(f)),e.prototype.postProcessControlFlowResult.call(this,r)},o.prototype.createContinuation=function(){return new u(this.session,this.getFlowId())},o}(i.SessionSetupExecuteControlFlowStage);i.BindRequestExecuteControlFlowStage=c;var s=function(e){function o(){return null!==e&&e.apply(this,arguments)||this}return V(o,e),o.prototype.createResumableProcess=function(r){return new n(r,this.flowId)},z([i.Serializable("BindControlFlowRequestContinuation")],o)}(i.ResumableControlFlowRequestContinuation),n=function(e){function o(){return null!==e&&e.apply(this,arguments)||this}return V(o,e),o.prototype.createContinuation=function(){return new s(this,this.getFlowId())},o.prototype.run=function(r,h){var f=this;return new Promise(function(g,y){f._ctxt.sdk.deviceSupportsCryptoBinding()?r.deviceBound?y(new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.AppImplementation,"Attempt to bind an already bound user on this device.",{user:r.userHandle})):g(f.startWithStage(new c(f,new i.Session(f.rtContext.sdk,r),h))):y(new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.AppImplementation,"cryptographic binding is not supported for this device"))})},o}(i.SessionSetupResumableControlFlowRequest);i.BindControlFlowRequest=n}(t.core||(t.core={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){var t,i,u;t=(u=l.sdk||(l.sdk={})).core||(u.core={}),i=function(){function c(s,n){if(this.sdk=s,this.ec=new elliptic.ec("secp256k1"),n&&(this.sessionId=n.session_id,this.aesKey=this.base64ToJsArray(n.key),!this.isReady()))throw new u.impl.AuthenticationErrorImpl(u.AuthenticationErrorCode.Internal,"Can't deserialize crypto session")}return c.prototype.getExchangeRequestHeader=function(){if(!this.kp){var s={entropy:this.sdk.host.generateRandomHexString(192),entropyEnc:"hex"};this.kp=this.ec.genKeyPair(s)}return{type:"key_exchange",scheme:2,y:this.jsArrayToBase64(this.kp.getPublic().encode())}},c.prototype.processExchangeResponseHeader=function(s){if(2!=s.scheme)throw"Unsupported crypto scheme "+s.scheme;this.sessionId=s.crypto_session_id;var n=this.kp.derive(this.ec.keyFromPublic(atob(s.y)).getPublic()),e=sha256.create();e.update(n.toArray("be",32)),this.aesKey=e.digest()},c.prototype.isReady=function(){return!(!this.aesKey||!this.sessionId)},c.prototype.decryptResponse=function(s){var n=null;if(s.headers.forEach(function(g){"encryption"==g.type&&(n=g)}),n){var e=this.base64ToJsArray(n.iv),o=new aesjs.ModeOfOperation.cbc(this.aesKey,e),r=this.base64ToJsArray(s.data),h=o.decrypt(r),f=aesjs.utils.utf8.fromBytes(h);f=this.pkcs7Unpad(f),s.data=JSON.parse(f)}return s},c.prototype.encryptRequest=function(s){var n=this,e=this.sdk.host.generateRandomHexString(32),o=aesjs.utils.hex.toBytes(e),r={type:"encryption",iv:u.util.hexToBase64(e),crypto_session_id:this.sessionId},h=s.headers.map(function(y){return n.encryptStringToBase64(JSON.stringify(y),o)}),f=JSON.stringify(s.data),g=this.encryptStringToBase64(f,o);s.headers=[r],s.enc_headers=h,s.data=g},c.prototype.encryptStringToBase64=function(s,n){var e=new aesjs.ModeOfOperation.cbc(this.aesKey,n),o=aesjs.utils.utf8.toBytes(s),r=this.pkcs7Pad(o),h=e.encrypt(r);return this.jsArrayToBase64(h)},c.prototype.toJson=function(){return{scheme:2,session_id:this.sessionId,key:this.jsArrayToBase64(this.aesKey)}},c.fromJson=function(s,n){return new c(s,n)},c.prototype.jsArrayToBase64=function(s){for(var n="",e=0;e<s.length;e++)n+=String.fromCharCode(s[e]);return btoa(n)},c.prototype.base64ToJsArray=function(s){for(var n=atob(s),e=[],o=0;o<n.length;o++)e.push(n.charCodeAt(o));return e},c.prototype.pkcs7Pad=function(s){var n=16-s.length%16,e=new Uint8Array(s.length+n);e.set(s,0);for(var o=0;o<n;o++)e[s.length+o]=n;return e},c.prototype.pkcs7Unpad=function(s){var n=s.charCodeAt(s.length-1);return s.slice(0,-n)},c}(),t.Scheme2CryptoSession=i}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){var t;!function(i){var u,s;(s=u=i.DeviceManagementSessionProcessorReturnReason||(i.DeviceManagementSessionProcessorReturnReason={}))[s.FinishSession=0]="FinishSession",s[s.CurrentDeviceDeleted=1]="CurrentDeviceDeleted";var c=function(){function s(n,e,o,r){this._sdk=n,this._session=e,this._clientContext=o,this._token=r||null,this._uiHandler=this._sdk.currentUiHandler,this._uiContextImpl=new t.impl.UIContextImpl(n)}return s.prototype.getUiContext=function(){return this._uiContextImpl},s.prototype.run=function(){var n=this;return this._sdk.log(t.LogLevel.Debug,function(){return"device management: Starting session"}),this.queryDevicesFromServer().then(function(e){return new Promise(function(o,r){n._completeFn=o,n._rejectFn=r,n.kickStartSession(e)})})},s.prototype.removeDevice=function(n,e){var o=this;return new Promise(function(r,h){if(n.getInfo().getIsCurrent())throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.AppImplementation,"Illegal attempt to delete the current device using 'DeviceManagementSessionServices.removeDevice'. The current device must only be deleted using DeviceManagementSessionServices.removeCurrentDeviceAndFinishSession.");var f=o.ensureValidDevice(n);o.performDeviceAction(f,t.DeviceManagementAction.Remove,e,null).then(function(g){return o._sdk.log(t.LogLevel.Debug,function(){return"device management: Updating device state locally"}),f.getInfo().setStatus(t.DeviceStatus.Removed),o.updateManagedDevices(o._managedDevices.filter(function(y){return y!=f})),!0}).then(r,h)})},s.prototype.removeCurrentDeviceAndFinishSession=function(n){var e,o=this;return this._appSession?(e=this._appSession,new Promise(function(r,h){o._sdk.log(t.LogLevel.Debug,function(){return"device management: Start removing current device"});var f=o._managedDevices.filter(function(y){return y.getInfo().getIsCurrent()});if(1!=f.length)throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Internal,"Couldn't locate current device in device list.");var g=f[0];o.performDeviceAction(g,t.DeviceManagementAction.Remove,n,null).then(function(y){return o._sdk.log(t.LogLevel.Debug,function(){return"device management: Updating device state locally"}),g.getInfo().setStatus(t.DeviceStatus.Removed),!0}).then(function(){r(!0),e.endSession(),o._appSession=null,o._completeFn(u.CurrentDeviceDeleted)}).catch(h)})):Promise.reject(new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Internal,"Attempt to finish a non started device management session."))},s.prototype.renameDevice=function(n,e,o){var r=this;return new Promise(function(h,f){var g=r.ensureValidDevice(n);return r.performDeviceAction(g,t.DeviceManagementAction.Rename,o,{name:e}).then(function(A){return r._sdk.log(t.LogLevel.Debug,function(){return"device management: Updating device state locally"}),g.getInfo().setName(e),r.updateManagedDevices(r._managedDevices),!0}).then(h,f)})},s.prototype.requestRefreshDevices=function(){var n=this;return this.queryDevicesFromServer().then(function(e){return n.updateManagedDevices(e),!0},function(e){throw t.impl.AuthenticationErrorImpl.ensureAuthenticationError(e)})},s.prototype.finishSession=function(){if(!this._appSession)throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Internal,"Attempt to finish a non started device management session.");this._appSession.endSession(),this._appSession=null,this._completeFn(u.FinishSession)},s.prototype.kickStartSession=function(n){this._appSession=this._sdk.currentUiHandler.createDeviceManagementSession(this._session.user.displayName),this._appSession?(this.updateManagedDevices(n),this._appSession.startSession(this,null,this._clientContext)):this._rejectFn(t.impl.AuthenticationErrorImpl.appImplementationError("Invalid return from createDeviceManagementSession."))},s.prototype.updateManagedDevices=function(n){if(!this._appSession)throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Internal,"Attempt to update device list for a non started device management session.");this._managedDevices=n,this._appSession.setSessionDevicesList(n)},s.prototype.queryDevicesFromServer=function(){var n=this;this._sdk.log(t.LogLevel.Debug,function(){return"device management: Initiating collection"});var e=this._sdk.promiseCollectionResult();return t.util.wrapPromiseWithActivityIndicator(this._uiHandler,null,this._clientContext,e.then(function(o){n._sdk.log(t.LogLevel.Debug,function(){return"device management: Collection done; setting up request to query devices"});var r=n._session.createDevicesFetchRequest(o,n._token);return n._sdk.log(t.LogLevel.Debug,function(){return"device management: Sending request to query devices"}),n._session.startControlFlow(r,null,n._clientContext).then(function(h){return n._uiHandler.endActivityIndicator(null,n._clientContext),h.getInternalData().devices.map(function(f){var g=new t.impl.ManagedDeviceImpl(f);return g.getInfo().getDeviecId()==n._session.user.deviceId&&g.getInfo().forceCurrent(),g})})}))},s.prototype.performDeviceAction=function(n,e,o,r){var h,f=this,g=o||this._clientContext;switch(e){case t.DeviceManagementAction.Remove:h="remove";break;case t.DeviceManagementAction.Rename:h="name";break;default:return Promise.reject(new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Internal,"Invalid device action specified "+e))}this._sdk.log(t.LogLevel.Debug,function(){return"devices: action "+h+" on "+n.getInfo().getDeviecId()}),this._sdk.log(t.LogLevel.Debug,function(){return"devices: Initiating collection"});var y=this._sdk.promiseCollectionResult();return t.util.wrapPromiseWithActivityIndicator(this._uiHandler,null,g,y.then(function(A){f._sdk.log(t.LogLevel.Debug,function(){return"devices: Collection done; setting up request"});var T=f._session.createDeviceActionRequest(A,f._token,n.getInfo().getDeviecId(),h,r);return f._sdk.log(t.LogLevel.Debug,function(){return"devices: Sending request"}),f._session.startControlFlow(T,null,g).then(function(C){return C.getInternalData()})}).catch(function(A){throw t.impl.AuthenticationErrorImpl.ensureAuthenticationError(A)}))},s.prototype.ensureValidDevice=function(n){var e=this._managedDevices.indexOf(n);if(e<0)throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.AppImplementation,"Attempt to perform a device action on a device not originally included in device management session.");return this._managedDevices[e]},s}();i.DeviceManagementSessionProcessor=c}((t=l.sdk||(l.sdk={})).core||(t.core={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){var u=function(){function c(s){this._name=s,this._extensions=[],c._extensionPoints[s]=this}return c.prototype.extend=function(s){this._extensions.push(s)},c.prototype.forEach=function(s){this._extensions.forEach(s)},c.prototype.first=function(s){var n=null;return this._extensions.forEach(function(e){!n&&s(e)&&(n=e)}),n},c.prototype.firstNonNull=function(s){var n=null;return this._extensions.forEach(function(e){n||(n=s(e))}),n},c.byName=function(s){var n=this._extensionPoints[s];if(!n)throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Internal,"Invalid extension point requested: "+s);return n},c._extensionPoints={},c}();i.ExtensionPoint=u}(t.core||(t.core={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){var u=function(c){function s(){return null!==c&&c.apply(this,arguments)||this}return V(s,c),s.createSuccessResponse=function(n){var e=new i.Fido2AuthenticatorSuccessResponse;return e.setFido2Response(n),e},s.createdFailedResponse=function(n){var e=new i.Fido2AuthenticationFailedResponse;return e.setFailureError(n),e},s}(t.InputResponseType);i.Fido2InputResponseInternal=u}(t.core||(t.core={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){var u=function(c){function s(){return null!==c&&c.apply(this,arguments)||this}return V(s,c),s.prototype.getFailureError=function(){return this._failureError},s.prototype.setFailureError=function(n){this._failureError=n},s}(i.Fido2InputResponseInternal);i.Fido2AuthenticationFailedResponse=u}(t.core||(t.core={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){var u=function(c){function s(){return null!==c&&c.apply(this,arguments)||this}return V(s,c),s.prototype.getFido2Response=function(){return this._fido2Response},s.prototype.setFido2Response=function(n){this._fido2Response=n},s}(i.Fido2InputResponseInternal);i.Fido2AuthenticatorSuccessResponse=u}(t.core||(t.core={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){var u=function(e){function o(){return null!==e&&e.apply(this,arguments)||this}return V(o,e),o.prototype.createResumableProcess=function(r){return new c(r)},z([i.Serializable("InvokeAnonymousPolicyRequestExecuteControlFlowStageContinuation")],o)}(i.ExecuteControlFlowStageContinuation);i.InvokeAnonymousPolicyRequestExecuteControlFlowStageContinuation=u;var c=function(e){function o(r,h,f,g){void 0===f&&(f=null);var y=e.call(this,r)||this;return y.opName="invokeAnonymousPolicy",h&&(y._usedSession=h,null===f||"string"==typeof f?(y._additionalParameters=g,y._policy=f):y._inlineControlFlowInitiationServerResponse=f),y}return V(o,e),o.prototype.generateControlFlowRequest=function(){var r=this;return this.sdk.promiseCollectionResult(this.sdk.enabledCollectorsAnonymous).then(function(h){r.sdk.log(t.LogLevel.Debug,function(){return"authenticate: Collection done; setting up request"});var f={collection_result:h.toJson(),push_token:r.sdkSessionManagementServices.lastReceivedPushToken};return r.policy&&(f.policy_request_id=r.policy),r.additionalParameters&&(f.params=r.additionalParameters),new i.SessionExchangeRequest("POST","auth/anonymous_invoke",f,[],r.getFlowId())})},o.prototype.createContinuation=function(){return new u(this.session,this.getFlowId())},o}(i.ExecuteControlFlowStage);i.InvokeAnonymousPolicyRequestExecuteControlFlowStage=c;var s=function(e){function o(){return null!==e&&e.apply(this,arguments)||this}return V(o,e),o.prototype.createResumableProcess=function(r){return new n(r,this.flowId)},z([i.Serializable("InvokeAnonymousPolicyControlFlowRequestContinuation")],o)}(i.ResumableControlFlowRequestContinuation),n=function(e){function o(){return null!==e&&e.apply(this,arguments)||this}return V(o,e),o.prototype.createContinuation=function(){return new s(this,this.getFlowId())},o.prototype.run=function(r,h){var f,g=i.Session.createAnonymousSession(this.rtContext.sdk);return f="string"!=typeof r&&r?new c(this,g,r):new c(this,g,r,h),this.startWithStage(f)},o}(i.ResumableControlFlowRequest);i.InvokeAnonymousPolicyControlFlowRequest=n}(t.core||(t.core={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){var u=function(e){function o(){return null!==e&&e.apply(this,arguments)||this}return V(o,e),o.prototype.createResumableProcess=function(r){return new c(r)},z([i.Serializable("InvokePolicyRequestExecuteControlFlowStageContinuation")],o)}(i.ExecuteControlFlowStageContinuation),c=function(e){function o(r,h,f,g){void 0===g&&(g=null);var y=e.call(this,r)||this;return y.opName="invokePolicy",h&&(y._usedSession=h,y._additionalParameters=f,y._policy=g),y}return V(o,e),o.prototype.generateControlFlowRequest=function(){var r=this;return this.sdk.promiseCollectionResult().then(function(h){return r.sdk.log(t.LogLevel.Debug,function(){return"invokePolicy: Collection done; setting up request"}),i.AuthenticateRequestExecuteControlFlowStage.generateLoginRequest(h,r)})},o.prototype.restoreParametersFromContinuation=function(r){if(!this.sdk.currentSession)throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Internal,"Attempt to resume invokePolicy without an existing session.");e.prototype.restoreParametersFromContinuation.call(this,r);var h=this._usedSession;this._usedSession=this.sdk.currentSession,this.sdk.currentSession.updateFromContinuedSession(h)},o.prototype.createContinuation=function(){return new u(this.session,this.getFlowId())},o}(i.ExecuteControlFlowStage);i.InvokePolicyRequestControlFlowStage=c;var s=function(e){function o(){return null!==e&&e.apply(this,arguments)||this}return V(o,e),o.prototype.createResumableProcess=function(r){return new n(r,this.flowId)},z([i.Serializable("InvokePolicyControlFlowRequestContinuation")],o)}(i.ResumableControlFlowRequestContinuation),n=function(e){function o(){return null!==e&&e.apply(this,arguments)||this}return V(o,e),o.prototype.createContinuation=function(){return new s(this,this.getFlowId())},o.prototype.run=function(r,h){return this.rtContext.sdk.currentSession?this.startWithStage(new c(this,this.rtContext.sdk.currentSession,h,r)):Promise.reject(new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Internal,"Attempt to resume invokePolicy without an existing session."))},o}(i.ResumableControlFlowRequest);i.InvokePolicyControlFlowRequest=n}(t.core||(t.core={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){var t,i,u;t=(u=l.sdk||(l.sdk={})).core||(u.core={}),i=function(){function c(){}return c.installOnSdk=function(s){s.setExternalLogger(new c)},c.prototype.log=function(s,n,e){var o="["+n+"] "+e;switch(s){case u.LogLevel.Debug:console.log(o);break;case u.LogLevel.Info:console.info(o);break;case u.LogLevel.Warning:console.warn(o);break;case u.LogLevel.Error:case u.LogLevel.Critical:console.error(o)}},c}(),t.JsConsoleLogger=i}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){var t;!function(i){var u,c,o;(o=u=i.LocalEnrollmentStatus||(i.LocalEnrollmentStatus={})).Registering="registering",o.Registered="registered",o.Unregistered="unregistered",function(o){o.None="none",o.Validated="validated",o.Invalidated="invalidated"}(c=i.LocalEnrollmentValidationStatus||(i.LocalEnrollmentValidationStatus={}));var s=function(){function o(r,h){this.pbkdf_iterations_count=r,this.pbkdf_key_size=h}return o.prototype.duplicate=function(){return new o(this.pbkdf_iterations_count,this.pbkdf_key_size)},o.prototype.toRecordFormat=function(){return{pbkdf_iterations_count:this.pbkdf_iterations_count,pbkdf_key_size:this.pbkdf_key_size}},o}();i.ClientCryptoSettingsRecordFormat=s;var n=function(){function o(r,h,f,g,y,A,T){this.salt=r,this.status=h,this.version=f,this.authenticatorId=g,this.cryptoSettings=y,this.validationStatus=A,this.publicKeyHash=T}return o.prototype.duplicate=function(){var r=null;this.cryptoSettings&&(r=this.cryptoSettings.duplicate());var h=new o(this.salt,this.status,this.version,this.authenticatorId,r,this.validationStatus,this.publicKeyHash);return h.keyMeterial=this.keyMeterial,this.authenticatorConfig&&(h.authenticatorConfig=JSON.parse(JSON.stringify(this.authenticatorConfig))),h},o.prototype.toRecordFormat=function(){var r=null;return this.cryptoSettings&&(r=this.cryptoSettings.toRecordFormat()),{salt:this.salt,status:this.status,version:this.version,authenticatorId:this.authenticatorId,cryptoSettings:r,validationStatus:this.validationStatus,publicKeyHash:this.publicKeyHash,keyMeterial:this.keyMeterial,authenticatorConfig:this.authenticatorConfig}},o}();i.LocalEnrollmentRecordFormat=n;var e=function(){function o(){}return Object.defineProperty(o.prototype,"salt",{get:function(){return this._record.salt},set:function(r){this._record.salt=r},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"status",{get:function(){return this._record.status||u.Unregistered},set:function(r){this._record.status=r},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"version",{get:function(){return this._record.version},set:function(r){this._record.version=r},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"authenticatorId",{get:function(){return this._record.authenticatorId},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"validationStatus",{get:function(){return this._record.validationStatus},set:function(r){this._record.validationStatus=r},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"publicKeyHash",{get:function(){return this._record.publicKeyHash},set:function(r){this._record.publicKeyHash=r},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"cryptoSettings",{get:function(){return this._record.cryptoSettings?t.ClientCryptoSettings.create(this._record.cryptoSettings.pbkdf_iterations_count):null},set:function(r){this._record.cryptoSettings=r?new s(r.getLocalEnrollmentKeyIterationCount(),r.getLocalEnrollmentKeySizeInBytes()):null},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"keyMaterial",{get:function(){return this._record.keyMeterial},set:function(r){this._record.keyMeterial=r},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"authenticatorConfig",{get:function(){return this._record.authenticatorConfig},set:function(r){this._record.authenticatorConfig=r},enumerable:!1,configurable:!0}),o.prototype.setFingerprintDbSnapshot=function(r){this._record.fingerprintDbSsnapshot=r},o.enrollmentWithRecord=function(r){var h=new o,f=null;return r.cryptoSettings&&(f=new s(r.cryptoSettings.pbkdf_iterations_count,r.cryptoSettings.pbkdf_key_size)),h._record=new n(r.salt,r.status,r.version,r.authenticatorId,f,r.validationStatus,r.publicKeyHash),h.authenticatorConfig=r.authenticatorConfig,h.keyMaterial=r.keyMeterial,h},o.migrateFPEnrollmentsToDeviceBiometricsIfNeeded=function(r,h,f){var g=f.host.queryHostInfo(l.sdkhost.HostInformationKey.DeviceBiometricsSupported);if(g&&"false"!=g&&"true"==f.host.queryHostInfo(l.sdkhost.HostInformationKey.DeviceBiometricsFPContinuation)){var y=r[i.authenticationdrivers.AuthenticationDriverDescriptorFingerprint.authenticatorName];y&&(f.log(t.LogLevel.Debug,function(){return"migrating Fingerprint enrollment to DeviceBiometrics for user "+h.displayName}),y.version="v0_"+y.version,y.authenticatorId=i.authenticationdrivers.AuthenticationDriverDescriptorDeviceBiometrics.authenticatorName,delete r[i.authenticationdrivers.AuthenticationDriverDescriptorFingerprint.authenticatorName],r[i.authenticationdrivers.AuthenticationDriverDescriptorDeviceBiometrics.authenticatorName]=y,f.host.writeStorageKey(this.storageKeyForEnrollmentsForUser(h.guid),r))}return r},o.enrollmentsForUser=function(r,h){var f={},g=h.host.readStorageKey(this.storageKeyForEnrollmentsForUser(r.guid));for(var y in g=o.migrateFPEnrollmentsToDeviceBiometricsIfNeeded(g,r,h),h.log(t.LogLevel.Debug,function(){return"Got db "+JSON.stringify(g)}),g)h.log(t.LogLevel.Debug,function(){return"Got db wEnrollmentKey"+y}),f[y]=o.enrollmentWithRecord(g[y]);return f},o.deleteEnrollmentsForUser=function(r,h){h.host.deleteStorageKey(this.storageKeyForEnrollmentsForUser(r.guid))},o.createNew=function(r,h,f,g,y){var A=new n(f,u.Unregistered,h,r,null,c.None,y),T=new o;return T._record=A,T},o.prototype.duplicate=function(){var r=new o;return r._record=this._record.duplicate(),r},o.updateEnrollmentsForUser=function(r,h,f){var g={};for(var y in h)g[y]=h[y]._record.toRecordFormat();f.host.writeStorageKey(this.storageKeyForEnrollmentsForUser(r.guid),g)},o.invalidateLocalRegistrationStatusAndNotifyUIHandler=function(r,h){return new Promise(function(f,g){if(!r)throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Internal,"No user interaction session provider!");r._sdk.log(t.LogLevel.Info,function(){return"Marking authenticator as invalidated and invoking UI Handler"});var y=r._session.user.localEnrollments[h.getAuthenticatorId()];y.validationStatus=c.Invalidated,r._session.user.updateEnrollmentRecord(y),r._uiHandler.localAuthenticatorInvalidated(h,r._clientContext).then(function(A){f(A)})})},o.storageKeyForEnrollmentsForUser=function(r){return new i.TarsusKeyPath("per_user",r.toString(),"local_enrollments")},o.listInvalidatedLocalEnrollments=function(r){var h,f=new Array;for(var g in r.user.localEnrollments)(h=r.user.localEnrollments[g]).validationStatus==c.Invalidated&&f.push(h);return f},o}();i.LocalEnrollment=e}((t=l.sdk||(l.sdk={})).core||(t.core={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){!function(u){function c(s){return void 0!==s.ref}u.isRefType=c,u.unwrap=function(s){if(c(s))throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Internal,"style property "+s+" is not the right format");return s}}(i.Protocol||(i.Protocol={}))}(t.core||(t.core={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){t.TARSUS_EXTENSION_POINT_NAME_MESSAGE_FILTERS="com.ts.mobile.sdk.core.messageFilters",t.TARSUS_EXTENSION_POINT_NAME_SESSION_OBSERVERS="com.ts.mobile.sdk.core.sessionObservers",t.TARSUS_EXTENSION_POINT_NAME_PLACEHOLDER_EXTENSION="com.ts.mobile.sdk.core.placeholderExtension",t.TARSUS_EXTENSION_POINT_NAME_FORMS_EXTENSION="com.ts.mobile.plugins.form.settings",t.TARSUS_EXTENSION_POINT_NAME_IDP_LOGIN_PROVIDER="com.ts.mobile.plugins.providers.idp",t.TARSUS_EXTENSION_POINT_NAME_KYC="com.ts.mobile.plugins.kyc",t.TARSUS_EXTENSION_POINT_NAME_SEED_BASED_TOTP_CALCULATOR="com.ts.mobile.plugins.totp.seedBasedTotpCalculator"}(l.tarsusplugin||(l.tarsusplugin={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){var t,i,u;u=l.sdk||(l.sdk={}),t=u.core||(u.core={}),i=function(){function c(s){this._sdk=s}return Object.defineProperty(c.prototype,"sdk",{get:function(){return this._sdk},enumerable:!1,configurable:!0}),c.prototype.createClientStringsRequest=function(s){return new t.PublicExchangeRequest("GET","resources/localization?locale="+s+"&v=1",{})},c.prototype.performRequest=function(s){var n=this;return this._sdk.log(u.LogLevel.Debug,function(){return"Preprocess request "+JSON.stringify(s)}),this.createTransportRequestForPublicExchangeRequest(s).then(function(e){return n.prepareTransportRequest(e).then(function(o){return n._sdk.log(u.LogLevel.Debug,function(){return"Will send request "+JSON.stringify(o)}),n._sdk.transportProvider.sendRequest(o).then(function(r){n._sdk.log(u.LogLevel.Debug,function(){return"Got response "+JSON.stringify(r)});try{var h=JSON.parse(r.getBodyJson())}catch(g){throw u.impl.AuthenticationErrorImpl.errorForTransportResponse(r)}var f=h.data&&h.data.state==t.Protocol.AuthSessionState.Rejected;if(200==r.getStatus()&&!h.error_code||401==r.getStatus()&&f)return h;throw 200==r.getStatus()||h.error_code?u.impl.AuthenticationErrorImpl.errorForServerResponse(h):u.impl.AuthenticationErrorImpl.errorForTransportResponse(r)})})})},c.prototype.createTransportRequestForPublicExchangeRequest=function(s){var n=this;return new Promise(function(e,o){var r={headers:s.envelopeHeaders,data:s.body},h=new u.TransportRequest;h.setMethod(s.method);var f=n._sdk.connectionSettings.getRealm()||"",g=f.length?"/"+f:"";h.setUrl(""+n._sdk.connectionSettings.getServerAddress()+g+"/api/v2/"+s.serverRelativeUrl),h.setBodyJson(JSON.stringify(r)),e(h)})},c.prototype.prepareTransportRequest=function(s){var n={aid:this._sdk.connectionSettings.getAppId()};s.setUrl(this.urlWithConcatenatedQuery(s.getUrl(),n));var e=s.getHeaders()||[];return s.setHeaders(e),Promise.resolve(s)},c.prototype.urlWithConcatenatedQuery=function(s,n){var e="";return s.indexOf("?")<0?e="?":"&"!=s[s.length-1]&&(e="&"),s+e+Object.keys(n).map(function(o){return o+"="+encodeURIComponent(n[o])}).join("&")},c}(),t.PublicNetworkRequest=i}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){var i=function(){function u(){}return u.prototype.getUrl=function(){return this._url},u.prototype.setUrl=function(c){this._url=c},u.prototype.getMethod=function(){return this._method},u.prototype.setMethod=function(c){this._method=c},u.prototype.getHeaders=function(){return this._headers},u.prototype.setHeaders=function(c){this._headers=c},u.prototype.getBodyJson=function(){return this._bodyJson},u.prototype.setBodyJson=function(c){this._bodyJson=c},u.__tarsusInterfaceName="TransportRequest",u}();t.TransportRequest=i}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){var t;!function(i){var u=function(n){function e(o,r){var h=n.call(this,o,r)||this;return h._lockCount=0,h._invalidated=!1,h._persistUserData=o.currentPersistUserData,h._deviceId=r&&(r.deviceBound||r.hasLoggedIn)&&r.deviceId||null,h}return V(e,n),Object.defineProperty(e.prototype,"anonymous",{get:function(){return this._anonymous},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"invalidated",{get:function(){return this._invalidated},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"persistUserData",{get:function(){return this._persistUserData},enumerable:!1,configurable:!0}),e.createAnonymousSession=function(o){var r=new e(o,i.User.createEphemeralUser(o));return r._anonymous=!0,r},e.prototype.createLogoutRequest=function(){return new i.SessionExchangeRequest("POST","auth/logout",{},[],this.getFlowId())},e.prototype.createApprovalsFetchRequest=function(o){var r={collection_result:o.toJson()};return new i.SessionExchangeRequest("POST","approvals/actions/fetch",r,[],this.getFlowId())},e.prototype.createApprovalReplyRequest=function(o,r,h){var f={collection_result:o.toJson(),status:h==t.MobileApprovalStatus.Approved?i.Protocol.ServerResponseDataApprovalsApprovalStatus.Approved:i.Protocol.ServerResponseDataApprovalsApprovalStatus.Denied};return new i.SessionExchangeRequest("POST","auth/approve?apid="+r,f,[],this.getFlowId())},e.prototype.createDevicesFetchRequest=function(o,r){var h={collection_result:o.toJson()};return r&&(h.token=r),new i.SessionExchangeRequest("POST","authenticate/physical/devices",h,[],this.getFlowId())},e.prototype.createDeviceActionRequest=function(o,r,h,f,g){var y={collection_result:o.toJson(),device_id:h};return r&&(y.token=r),g&&Object.keys(g).forEach(function(A){y[A]=g[A]}),new i.SessionExchangeRequest("POST","authenticate/physical/device/action?action="+f,y,[],this.getFlowId())},e.prototype.createConfigMenuFetchRequest=function(o,r){var h={collection_result:o.toJson()};return r&&(h.token=r),new i.SessionExchangeRequest("POST","auth/authenticator/config_menu",h,[],this.getFlowId())},e.prototype.createAuthRegistrationRequest=function(o,r,h,f){var g={collection_result:o.toJson(),type:r};return f&&(g.token=f),new i.SessionExchangeRequest("POST","auth/authenticator/"+(h?"register":"unregister"),g,[],this.getFlowId())},e.prototype.startControlFlow=function(o,r,h){var f=new i.ControlFlowProcessor(this.sdk,this,h,r);return this.runWithSessionControlFlow(f,function(g){return g.startControlFlow(o)})},e.prototype.continueControlFlow=function(o,r,h,f){var g=new i.ControlFlowProcessorRuntimeContext;g.cflowRequestContext=h,g.clientContext=f,g.sdk=this.sdk,g.session=this,g.uiHandler=this.sdk.currentUiHandler;var y=o.createResumableProcess(g);return this.runWithSessionControlFlow(y,function(A){return A.resume(o,r)})},e.prototype.createCurrentControlFlowContinuation=function(){if(!this._currentControlFlow)throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Internal,"Attempt to create continuation for a session without an active control flow");return this._currentControlFlow.createContinuation()},e.prototype.runWithSessionControlFlow=function(o,r){var h=this;return new Promise(function(f,g){if(h._currentControlFlow)throw h.sdk.log(t.LogLevel.Error,function(){return"Attempt to start a control flow while an existing control flow ("+h._currentControlFlow.challenge+") is running."}),new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.AppImplementation,"Attempt to start a control flow while an existing control flow ("+h._currentControlFlow.challenge+") is running.");h._currentControlFlow=o,h.sdk.log(t.LogLevel.Debug,function(){return"Start control flow"}),i.authenticationdrivers.SimpleAuthenticationDriverDescriptor.refreshInvalidatedAuthenticatorsEnrollments(h).catch(function(y){h.sdk.log(t.LogLevel.Warning,function(){return"Could not refresh invalidated authenticators enrollments: "+y})}).then(function(){return r(o)}).finally(function(){h.sdk.log(t.LogLevel.Debug,function(){return"Done control flow "+o.challenge}),h._currentControlFlow=null}).then(f,g)})},e.prototype.getCurrentUserInteractionSessionProvider=function(){return this._currentControlFlow},e.prototype.generateInvalidatedAuthenticatorsHeadersIfNeeded=function(){for(var o,r=new Array,h=0,f=i.LocalEnrollment.listInvalidatedLocalEnrollments(this);h<f.length;h++)o=f[h],this._sdk.log(t.LogLevel.Debug,function(){return"Found invalidated authenticator: "+o.authenticatorId}),o.publicKeyHash&&r.push({type:"registration_invalidated",method:o.authenticatorId,registration_id:{type:"public_key_hash",hash:o.publicKeyHash}});return r},Object.defineProperty(e.prototype,"deviceSigningKeyPair",{get:function(){if(!this._deviceKeyPair&&!this._anonymous&&this._sdk.deviceSupportsCryptoBinding()&&(this._deviceKeyPair=this._sdk.host.getKeyPair(this._user.deviceSigningKeyTag,l.sdkhost.KeyClass.StdSigningKey,l.sdkhost.KeyBiometricProtectionMode.None),this.user.deviceBound&&!this._deviceKeyPair))throw this._sdk.log(t.LogLevel.Error,function(){return"Could not load device signing key pair for this device."}),new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.InvalidDeviceBinding,"Invalid device signature - could not load device signing key pair.");return this._deviceKeyPair},enumerable:!1,configurable:!0}),e.prototype.performSessionExchange=function(o){return this.performSessionExchangeInternal(o,!0,!0,!0).catch(function(r){throw t.impl.AuthenticationErrorImpl.ensureAuthenticationError(r)})},e.prototype.performSessionExchangeInternal=function(o,r,h,f){var g=this;if(this._invalidated)return this._sdk.log(t.LogLevel.Error,function(){return"Attempt to execute a session exchange from invalidated session."}),Promise.reject(new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.SessionRequired,"Session was invalidated by server."));if(this.connectionSettings().getCryptoMode()==t.ConnectionCryptoMode.Full&&!this._currentCryptoSession&&f){var y=new i.SessionExchangeRequest("POST","auth/key_exchange",{r:"Hello Encrypted World"},[],this.getFlowId());return this.performSessionExchangeInternal(y,r,h).then(function(A){return g.performSessionExchangeInternal(o,r)})}return this._sdk.log(t.LogLevel.Debug,function(){return"Preprocess request "+JSON.stringify(o)}),this.preprocessSessionExchangeRequest(o).then(function(A){return g.promisePossiblyEncryptedTransportRequest(A).then(function(T){return g.preprocessTransportRequest(T).then(function(C){return g._sdk.log(t.LogLevel.Debug,function(){return"Will send request "+JSON.stringify(C)}),g._sdk.transportProvider.sendRequest(C).then(function(E){g._sdk.log(t.LogLevel.Debug,function(){return"Got response "+JSON.stringify(E)});try{var R=JSON.parse(E.getBodyJson())}catch(N){throw t.impl.AuthenticationErrorImpl.errorForTransportResponse(E)}g.postprocessResponse(R);var O=(R=g.possiblyDecryptResponse(R)).data&&R.data.state==i.Protocol.AuthSessionState.Rejected;if(200==E.getStatus()&&!R.error_code||401==E.getStatus()&&O)return R;if(200==E.getStatus()||R.error_code){if(R.error_code==i.Protocol.ServerResponseErrorCode.EncryptionStateError&&h)return g._currentCryptoSession=null,g.performSessionExchangeInternal(o,r,!1,!0);if(R.error_code==i.Protocol.ServerResponseErrorCode.DeviceKeyExpired){if(g._sdk.log(t.LogLevel.Debug,function(){return"DeviceKeyRoll: device key expired rejection received"}),r){var L=g._sdk.host.generateRandomHexString(24);return g._sdk.host.generateKeyPair(g._user.getPendingDeviceSigningKeyTag(L),l.sdkhost.KeyClass.StdSigningKey,l.sdkhost.KeyBiometricProtectionMode.None,!0).then(function(N){var W=void 0;return g.verifyDevicePublicKey(R.data.key_id)||(g._sdk.log(t.LogLevel.Warning,function(){return"DeviceKeyRoll: server response device public key hash doesn't match."}),W="Device public key hash and server response public key hash do not match."),g._deviceKeyRollData={deviceKeyPair:N,salt:L,message:W},g.performSessionExchangeInternal(o,!1,!0,!0)})}if(g._sdk.log(t.LogLevel.Warning,function(){return"DeviceKeyRoll: already attempted to roll device key and failed. Aborting second attempt."}),g._deviceKeyRollData)try{g._sdk.host.deleteKeyPair(g._user.getPendingDeviceSigningKeyTag(g._deviceKeyRollData.salt))}catch(N){g._sdk.log(t.LogLevel.Warning,function(){return"DeviceKeyRoll: Can't delete pending device signing key."})}}else R.error_code==i.Protocol.ServerResponseErrorCode.UserIdTokenExpired&&i.User.resetUserIdTokenForSession(g);throw t.impl.AuthenticationErrorImpl.errorForServerResponse(R)}throw t.impl.AuthenticationErrorImpl.errorForTransportResponse(E)})})})})},e.prototype.processInlineResponse=function(o){return this.postprocessResponse(o),Promise.resolve(o)},e.prototype.cancelCurrentControlFlow=function(){this._currentControlFlow?this._currentControlFlow.cancelFlow():this._sdk.log(t.LogLevel.Error,function(){return"No current control flow."})},e.prototype.deviceId=function(){return this._deviceId},e.prototype.preprocessTransportRequest=function(o){var r=this,h={aid:this.connectionSettings().getAppId()};this._deviceId&&(h.did=this._deviceId),this._sessionId&&(h.sid=this._sessionId),this._sdk.uiAssetsData&&this._sdk.uiAssetsData.locale&&(h.locale=this._sdk.uiAssetsData.locale),o.setUrl(this.urlWithConcatenatedQuery(o.getUrl(),h));var f=o.getHeaders()||[],g=new t.TransportHeader;g.setName("X-TS-Client-Version"),g.setValue(this.clientVersionHeader),f.push(g);var y=new t.TransportHeader;y.setName("Authorization"),y.setValue("TSToken "+this.connectionSettings().getToken()+"; tid="+this.connectionSettings().getTokenName()),f.push(y);try{if(this._deviceId&&this.deviceSigningKeyPair)return this.generateSignatureForRequest(o).then(function(A){var T=t.util.calcPublicKeyHexStringEncodedSha256Hash(r.deviceSigningKeyPair,r._sdk),C=new t.TransportHeader;return C.setName("Content-Signature"),C.setValue("data:"+A+";key-id:"+T+";scheme:4"),f.push(C),o.setHeaders(f),o})}catch(A){return Promise.reject(A)}return o.setHeaders(f),Promise.resolve(o)},e.prototype.postprocessResponse=function(o){var r=this;o.headers&&o.headers.forEach(function(h){e.headerProcessors[h.type].call(r,h)})},e.prototype.encryptEnvelopedMessageIfNeeded=function(o){var r=this.generateKeyExchangeHeaderIfNeeded();this._currentCryptoSession&&this._currentCryptoSession.isReady()&&this._currentCryptoSession.encryptRequest(o),r&&o.headers.push(r)},e.prototype.promisePossiblyEncryptedTransportRequest=function(o){var r=this;return new Promise(function(h,f){var g,y={headers:o.envelopeHeaders,data:o.body};r.encryptEnvelopedMessageIfNeeded(y);var A=new t.TransportRequest;A.setHeaders([]),A.setMethod(o.method);var T=r._sdk.connectionSettings.getRealm()||"",C=T.length?"/"+T:"";A.setUrl(""+r._sdk.connectionSettings.getServerAddress()+C+"/api/v2/"+o.serverRelativeUrl),A.setBodyJson(JSON.stringify(y));var E=null===(g=o.envelopeHeaders.filter(function(O){return O.type===i.Protocol.flowIdHeaderName}))||void 0===g?void 0:g[0];if(r.connectionSettings().shouldSendFlowIdAsHttpHeader()&&E){var R=new t.TransportHeader;R.setName(E.type),R.setValue(E[i.Protocol.flowIdHeaderName]),A.getHeaders().push(R)}h(A)})},e.prototype.possiblyDecryptResponse=function(o){return this._currentCryptoSession&&this._currentCryptoSession.isReady()&&(o=this._currentCryptoSession.decryptResponse(o)),o},e.prototype.generateKeyExchangeHeaderIfNeeded=function(){return this.connectionSettings().getCryptoMode()==t.ConnectionCryptoMode.None||this._currentCryptoSession?null:(this._currentCryptoSession=new i.Scheme2CryptoSession(this._sdk),this._currentCryptoSession.getExchangeRequestHeader())},e.prototype.preprocessSessionExchangeRequest=function(o){var r=this;return new Promise(function(h,f){var g=r.generateUserIDHeaderIfNeeded();g&&o.addEnvelopeHeader(g);var y=r.generateInvalidatedAuthenticatorsHeadersIfNeeded();if(y)for(var A=0,T=y;A<T.length;A++)o.addEnvelopeHeader(T[A]);var E=r.generateDeviceKeyRollHeaderIfNeeded();E&&o.addEnvelopeHeader(E);var R=Promise.resolve(!0),O=new s(o);e.messageFilteringExtensionPoint.forEach(function(L){R=R.then(function(N){return L.filterMessage(r.createPluginSessionInfo(),O).catch(function(W){return r.sdk.log(t.LogLevel.Warning,function(){return"Error during message filtering: "+W}),!0})})}),R.then(function(L){return h(o)},f)})},e.prototype.getFlowId=function(){var o,r;return null===(r=null===(o=this._currentControlFlow)||void 0===o?void 0:o.requestContext)||void 0===r?void 0:r.getFlowId()},e.prototype.generateDeviceKeyRollHeaderIfNeeded=function(){if(!this._deviceKeyRollData)return null;var o={type:"device_key_roll"};return o.device_key_roll=this._deviceKeyRollData.deviceKeyPair.publicKeyToJson(),this._deviceKeyRollData.message&&(o.message=this._deviceKeyRollData.message),o},e.prototype.generateUserIDHeaderIfNeeded=function(){if(this.connectionSettings().getCryptoMode()==t.ConnectionCryptoMode.Full&&!this._currentCryptoSession)return null;if(this._anonymous){if(this._user.ephemeralUserId)return{type:"uid",uid:this._user.ephemeralUserId}}else{if(this._user.userId)return{type:"uid",uid:this._user.userId};if(this._user.idToken)return{type:"uid_token",token:this._user.idToken}}return null},e.prototype.processKeyExchangeResponseHeader=function(o){this._currentCryptoSession&&this._currentCryptoSession.processExchangeResponseHeader(o)},e.prototype.generateSignatureForRequest=function(o){var r=o.getUrl(),h=r.indexOf("?");if(h>0){var f=o.getUrl().substring(h+1);r=o.getUrl().substring(0,h)+"?"+f.split("&").sort().join("&")}var g=/%%/g,y=r.substr(this.connectionSettings().getServerAddress().length).replace(g,"\\%")+"%%"+this.clientVersionHeader.replace(g,"\\%")+"%%"+o.getBodyJson().replace(g,"\\%"),A=t.util.asciiToHex(y);return this.deviceSigningKeyPair.signHex(A).then(function(T){return t.util.hexToBase64(T)})},e.prototype.connectionSettings=function(){return this._sdk.connectionSettings},e.prototype.processSessionIdHeader=function(o){this._sdk.log(t.LogLevel.Debug,function(){return"Processing session ID header "+o}),this._sessionId=o.session_id},e.prototype.processDeviceIdHeader=function(o){var r=this;this._sdk.log(t.LogLevel.Debug,function(){return"Processing Device ID header "+o}),this._deviceId?this._deviceId!=o.device_id&&this._sdk.log(t.LogLevel.Warning,function(){return"Received device ID "+o.device_id+" in a session with an existing device id "+r._deviceId}):(this._user.setProvisionalDeviceId(o.device_id),this._deviceId=o.device_id)},e.prototype.processSessionStateChangeHeader=function(o){if(this._sdk.log(t.LogLevel.Debug,function(){return"Processing session state change header "+o+" to state "+o.state}),o.state!==i.Protocol.SessionStateChangeState.Closed)throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Communication,"Invalid session state change encountered in header.");this._sdk.log(t.LogLevel.Debug,function(){return"Invalidating session."}),this._invalidated=!0},e.prototype.processSessionEphemeralUserHeader=function(o){this._sdk.log(t.LogLevel.Debug,function(){return"Processing ephemeral user Id header "+o}),this._user.updateEphemeralUserId(o.uid)},e.prototype.noHeaderProcessing=function(o){},e.prototype.processEncryptedSharedSecretHeader=function(o){},e.prototype.processDisplayNameHeader=function(o){this._sdk.log(t.LogLevel.Debug,function(){return"Processing display name header '"+o.display_name+"'"}),i.User.updateUserDisplayName(o.display_name,this._user,this._sdk)},e.prototype.processUidTokenHeader=function(o){this._sdk.log(t.LogLevel.Debug,function(){return"Processing uid_token header '"+o.token+"', uid hash '"+o.uid_hash+"'"}),i.User.updateUserIdTokenForSession(o.token,this,o.uid_hash)},e.prototype.processDeviceKeyRollSuccess=function(o){if(this._sdk.log(t.LogLevel.Debug,function(){return"DeviceKeyRoll: Processing device_key_roll_success header. device_key_roll_success = '"+o.device_key_roll_success+"'."}),o.device_key_roll_success&&this._deviceKeyRollData){var r=this._user.deviceSigningKeyTag;this._user.updateDeviceKeyTagSaltAndSave(this._deviceKeyRollData.salt),this._deviceKeyPair=this._deviceKeyRollData.deviceKeyPair,this._deviceKeyRollData=null;try{this._sdk.host.deleteKeyPair(r)}catch(h){this._sdk.log(t.LogLevel.Warning,function(){return"DeviceKeyRoll: Can't delete old device signing key."})}}},e.prototype.verifyDevicePublicKey=function(o){var r=t.util.calcPublicKeyHexStringEncodedSha256Hash(this.deviceSigningKeyPair,this._sdk);return this._sdk.log(t.LogLevel.Debug,function(){return"DeviceKeyRoll: verify server key hash matches device key hash: "+(r===o)}),r===o},e.prototype.urlWithConcatenatedQuery=function(o,r){var h="";return o.indexOf("?")<0?h="?":"&"!=o[o.length-1]&&(h="&"),o+h+Object.keys(r).map(function(f){return f+"="+encodeURIComponent(r[f])}).join("&")},Object.defineProperty(e.prototype,"clientVersionHeader",{get:function(){if(!this._cachedClientVersionHeader){var o=this._sdk.getClientFeatureSet().join(",");this._cachedClientVersionHeader=this._sdk.getVersionInfo().getSdkVersion()+";["+o+"]"}return this._cachedClientVersionHeader},enumerable:!1,configurable:!0}),e.prototype.createPluginSessionInfo=function(){return new c(this)},e.prototype.lock=function(){var o=this;this._sdk.log(t.LogLevel.Debug,function(){return"Locking session "+o._sessionId}),this._lockCount++},e.prototype.unlock=function(){var o=this;if(this._sdk.log(t.LogLevel.Debug,function(){return"Unlocking session "+o._sessionId}),this._lockCount--,this._lockCount<0)throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Internal,"Unbalanced session locking: Attempt to unlock an already unlocked sessoin.")},e.prototype.canTerminate=function(){return!this._lockCount},e.prototype.toJson=function(){var o={session_id:this._sessionId,user_guid:this._user.guid.toString(),device_id:this._deviceId,invalidated:this._invalidated,persistUserData:this._persistUserData,anonymous:this._anonymous};return this._persistUserData||(o.nonPersistentUser=i.User.toUserRecord(this._user)),this._currentCryptoSession&&this._currentCryptoSession.isReady()&&(o.c_session=this._currentCryptoSession.toJson()),o},e.fromJson=function(o,r){var h=r,f=h.persistUserData?i.User.findUserByGuid(o,i.UserGuid.createFromString(h.user_guid)):h.nonPersistentUser&&i.User.fromUserRecord(h.nonPersistentUser,o);if(!f)throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Internal,"Can't deserialize session -- user "+h.user_guid+" not found.");return this.fromJsonWithUser(o,r,f)},e.fromJsonWithUser=function(o,r,h){var f=r,g=new e(o,h);return g._sessionId=f.session_id,g._deviceId=f.device_id,g._invalidated=f.invalidated||!1,g._persistUserData=f.persistUserData||!0,g._anonymous=f.anonymous||!1,f.c_session&&(g._currentCryptoSession=i.Scheme2CryptoSession.fromJson(o,f.c_session)),g},e.prototype.updateFromContinuedSession=function(o){this.user.updateFromContinuedSessionUser(o.user)},e.notifySessionObserversOnMainSessionLogin=function(o){var r=o.createPluginSessionInfo();this.sessionObservationExtensionPoint.forEach(function(h){h.mainSessionStarted(r)})},e.notifySessionObserversOnMainSessionLogout=function(o){var r=o.createPluginSessionInfo();this.sessionObservationExtensionPoint.forEach(function(h){h.mainSessionEnded(r)})},e.headerProcessors={session_id:e.prototype.processSessionIdHeader,device_id:e.prototype.processDeviceIdHeader,encrypted_shared_secret:e.prototype.processEncryptedSharedSecretHeader,session_state:e.prototype.processSessionStateChangeHeader,ephemeral_uid:e.prototype.processSessionEphemeralUserHeader,key_exchange:e.prototype.processKeyExchangeResponseHeader,encryption:e.prototype.noHeaderProcessing,display_name:e.prototype.processDisplayNameHeader,uid_token:e.prototype.processUidTokenHeader,device_key_roll_success:e.prototype.processDeviceKeyRollSuccess},e.messageFilteringExtensionPoint=new i.ExtensionPoint(l.tarsusplugin.TARSUS_EXTENSION_POINT_NAME_MESSAGE_FILTERS),e.sessionObservationExtensionPoint=new i.ExtensionPoint(l.tarsusplugin.TARSUS_EXTENSION_POINT_NAME_SESSION_OBSERVERS),e}(i.BaseSession);i.Session=u;var c=function(){function n(e){this._underlying=e}return n.prototype.getUsername=function(){return this._underlying.user.displayName},n}(),s=function(){function n(e){this._underlying=e}return n.prototype.getMethod=function(){return this._underlying.method},n.prototype.getBody=function(){return this._underlying.body},n.prototype.getHeaders=function(){return this._underlying.envelopeHeaders},n.prototype.addHeader=function(e){this._underlying.addEnvelopeHeader(e)},n}()}((t=l.sdk||(l.sdk={})).core||(t.core={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){var u=function(){function n(e,o,r,h,f){if(this.flowId=f,e instanceof i.SerializationContext)this.serializeFrom(e);else{if("string"!=typeof e||!o||!r)throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Internal,"Invalid arguments for constructing session message");this._requestMethod=e,this._requestServerRelativeUrl=o,this._requestBody=r,this._envelopeHeaders=h||[]}var g=this.createFlowIdSdkHeader();g&&this._envelopeHeaders.push(g)}return n.prototype.addEnvelopeHeader=function(e){this._envelopeHeaders.push(e)},Object.defineProperty(n.prototype,"method",{get:function(){return this._requestMethod},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"serverRelativeUrl",{get:function(){return this._requestServerRelativeUrl},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"body",{get:function(){return this._requestBody},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"envelopeHeaders",{get:function(){return this._envelopeHeaders},enumerable:!1,configurable:!0}),n.prototype.serializeTo=function(e){e.writePrimitive("envelopeHeaders",this._envelopeHeaders),e.writePrimitive("requestBody",this._requestBody),e.writePrimitive("requestMethod",this._requestMethod),e.writePrimitive("requestServerRelativeUrl",this._requestServerRelativeUrl)},n.prototype.serializeFrom=function(e){this._envelopeHeaders=e.readPrimitive("envelopeHeaders"),this._requestBody=e.readPrimitive("requestBody"),this._requestMethod=e.readPrimitive("requestMethod"),this._requestServerRelativeUrl=e.readPrimitive("requestServerRelativeUrl")},n.prototype.getFlowId=function(){return this.flowId},n.prototype.createFlowIdSdkHeader=function(){var e;return this.flowId?((e={type:i.Protocol.flowIdHeaderName})[i.Protocol.flowIdHeaderName]=this.flowId,e):null},z([i.Serializable("ExchangeRequest"),$t("design:paramtypes",[Object,String,Object,Array,String])],n)}();i.BaseExchangeRequest=u;var c=function(n){function e(){return null!==n&&n.apply(this,arguments)||this}return V(e,n),z([i.Serializable("SessionExchangeReqeust")],e)}(u);i.SessionExchangeRequest=c;var s=function(n){function e(){return null!==n&&n.apply(this,arguments)||this}return V(e,n),e}(u);i.PublicExchangeRequest=s}(t.core||(t.core={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){var t;!function(i){var u=function(){function s(n,e){this._sdk=n,this._hostedPluginName=e.getPluginInfo().getPluginName()}return s.prototype.extend=function(n,e){i.ExtensionPoint.byName(n).extend(e)},s.prototype.getSdk=function(){return this._sdk},s.prototype.generateRandomHexString=function(n){return this._sdk.host.generateRandomHexString(n)},s.prototype.suspendControlFlowToDefaultSuspensionContext=function(n){this._sdk.suspendControlFlowToDefaultSuspensionContext(n)},s.prototype.log=function(n,e){this._sdk.host.log(n,"TransmitSDK/Tarsus/Plugin/"+this._hostedPluginName,e)},s}();i.TarsusPluginHostImpl=u;var c=function(){function s(n){this._installedPluginsAndConfigs={},this._initializedPlugins=[],this._sdk=n}return s.prototype.getInitializedPlugins=function(){return this._initializedPlugins.concat([])},s.prototype.installPlugin=function(n,e){if(this._installedPluginsAndConfigs[n])throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.AppImplementation,"Attempt to install plugin "+n+" twice.");this._installedPluginsAndConfigs[n]=e},s.prototype.initializePlugins=function(){var n=this;this._sdk.log(t.LogLevel.Debug,function(){return"Starting plugin initialization..."});var e=Object.keys(this._installedPluginsAndConfigs).map(function(o){return n._sdk.log(t.LogLevel.Debug,function(){return"Loading plugin "+o+"..."}),n._sdk.host.loadPlugin(o).then(function(r){var h=r.getPluginInfo(),f=l.tarsusplugin.impl.PluginInfoImpl.toString(h);if(r.getPluginInfo().getPluginName()!=o)throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.AppImplementation,"Plugin "+o+": getPluginInfo() reported mismatched name -- "+f+".");n._sdk.log(t.LogLevel.Info,function(){return"Initializing plugin "+f+"..."});var g=new u(n._sdk,r);return r.initialize(g,n._installedPluginsAndConfigs[o]).then(function(){n._initializedPlugins.push(r)}).catch(function(y){n._sdk.log(t.LogLevel.Error,function(){return"Couldn't initialize plugin "+f+": "+y})})})});return Promise.all(e).then(function(){n._sdk.log(t.LogLevel.Debug,function(){return"Plugin initialization completed sucessfuly"})})},s}();i.TarsusPluginManager=c}((t=l.sdk||(l.sdk={})).core||(t.core={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){var t,i,u;u=l.sdk||(l.sdk={}),t=u.core||(u.core={}),i=function(){function c(s,n){this._locale=n,this._sdk=s,this._serverClientStrings=new t.ClientStrings({}),this._cachedClientStrings=new t.ClientStrings({})}return Object.defineProperty(c.prototype,"locale",{get:function(){return this._locale},enumerable:!1,configurable:!0}),c.prototype.isServerClientStringsEmpty=function(){var s=this._serverClientStrings.strings;return null==s||0===Object.keys(s).length&&s.constructor===Object},c.prototype.setServerClientStrings=function(s){this._serverClientStrings=s,this._cachedClientStrings=new t.ClientStrings({})},c.prototype.applyGlobalStyleSheetJson=function(s){this._styleSheetJson||(this._styleSheetJson=JSON.parse(this._sdk.host.getUIStyles())),this._styleSheetJson=t.UIStyleSheets.merge(this._styleSheetJson,s),this._cachedBaseStylesheet=null},Object.defineProperty(c.prototype,"uiStylesheets",{get:function(){return this.getUiStylesheetsWithOverrides()},enumerable:!1,configurable:!0}),c.prototype.getUiStylesheetsWithOverrides=function(){for(var s=[],n=0;n<arguments.length;n++)s[n]=arguments[n];return this._styleSheetJson||(this._styleSheetJson=JSON.parse(this._sdk.host.getUIStyles())),s.length?new(t.UIStyleSheets.bind.apply(t.UIStyleSheets,Wt([void 0,this._styleSheetJson],s))):(this._cachedBaseStylesheet||(this._cachedBaseStylesheet=new t.UIStyleSheets(this._styleSheetJson)),this._cachedBaseStylesheet)},c.prototype.getString=function(s){var n=null;return(n=this._cachedClientStrings.getString(s))||(this._serverClientStrings&&(n=this._serverClientStrings.getString(s)),null==n&&(n=this._sdk.host.getString(s,this._locale)),n&&this.storeInLocalCache(s,n)),n},c.prototype.storeInLocalCache=function(s,n){n&&this._cachedClientStrings&&(this._cachedClientStrings.strings[s]=n)},c}(),t.UIAssetsData=i}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){var t;!function(i){var u=function(){function s(){}return s.prototype.toString=function(){return this._guidStr},s.prototype.equalString=function(n){return this._guidStr==n},s.prototype.equalsUserGuid=function(n){return this.toString()==n.toString()},s.createWithLength=function(n,e){var o=new s;return o._guidStr=e.host.generateRandomHexString(n),o},s.createFromString=function(n){var e=new s;return e._guidStr=n,e},s}();i.UserGuid=u;var c=function(){function s(){}return Object.defineProperty(s.prototype,"guid",{get:function(){return this._guid},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"userId",{get:function(){return this._userId},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"displayName",{get:function(){return(this._ephemeral?"anonymous":this._displayName)||this._userId},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"idToken",{get:function(){return this._idToken},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"uidHash",{get:function(){return this._uidHash},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"deviceId",{get:function(){return this._deviceId},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"phoneNumber",{get:function(){return this._phoneNumber},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"defaultAuthId",{get:function(){return this._defaultAuthId},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"deviceBound",{get:function(){return this._deviceBound},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"hasLoggedIn",{get:function(){return this._hasLoggedIn},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"deviceEncryptionKeyTag",{get:function(){return new i.TarsusKeyPath("per_user",this._guid.toString(),"enc_enabled")},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"ephemeralUserId",{get:function(){return this._ephemeralUserId},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"userHandle",{get:function(){return this._userId||this._idToken},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"userHandleType",{get:function(){return this._userId?t.UserHandleType.UserId:t.UserHandleType.IdToken},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"deviceSigningKeyTag",{get:function(){return this._deviceSigningKeyTagSalt?new i.TarsusKeyPath("per_user",this._guid.toString(),"device_key",this._deviceSigningKeyTagSalt):new i.TarsusKeyPath("per_user",this._guid.toString(),"device_key")},enumerable:!1,configurable:!0}),s.prototype.getPendingDeviceSigningKeyTag=function(n){return new i.TarsusKeyPath("per_user",this._guid.toString(),"device_key",n)},s.prototype.updateDeviceKeyTagSaltAndSave=function(n){this._deviceSigningKeyTagSalt=n,s.save(this._sdk,this)},Object.defineProperty(s.prototype,"localEnrollments",{get:function(){return this._localEnrollments||(this._localEnrollments=i.LocalEnrollment.enrollmentsForUser(this,this._sdk)),this._localEnrollments},enumerable:!1,configurable:!0}),s.prototype.updateDefaultAuthId=function(n){this._defaultAuthId=n},s.prototype.updateEphemeralUserId=function(n){if(!this._ephemeral)throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Internal,"Invalid ephemeral user name update reaquest header, user is not ephemeral.");if(this._ephemeralUserId)throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Internal,"Attempt to set an ephemeral userId after it has already been updated once.");this._ephemeralUserId=n},s.updateUserDisplayName=function(n,e,o){e._displayName=n,o.currentSession&&o.currentSession.persistUserData&&s.save(o,e)},s.updateUserIdTokenForSession=function(n,e,o){var r=e.user;r._idToken=n,r._uidHash=o,delete r._userId,e.persistUserData&&s.save(e.sdk,r)},s.resetUserIdTokenForSession=function(n){var e=n.user;delete e._idToken,n.persistUserData&&s.save(n.sdk,e)},s.prototype.updateFromContinuedSessionUser=function(n){if(!this._guid.equalsUserGuid(n.guid))throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Internal,"GUID mismatch when updating user from continuation");this._defaultAuthId=n._defaultAuthId,this._deviceBound=n._deviceBound,this._hasLoggedIn=n._hasLoggedIn,this._deviceId=n._deviceId,this._phoneNumber=n._phoneNumber,this._userId=n._userId,this._idToken=n._idToken,this._displayName=n._displayName,this._uidHash=n._uidHash},s.prototype.setProvisionalDeviceId=function(n){if(this.deviceBound)throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Internal,"Attempt to record a provisional device ID for an already bound user record.",{});this._deviceId=n},s.prototype.bindDeviceToUser=function(n){if(this.deviceBound)throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Internal,"Attempt to record a device for an already bound user record.",{});if(this._deviceId!=n)throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Internal,"Attempt to bind user to a device ID different than provisional device ID.",{});this._deviceBound=!0},s.prototype.markLoggedIn=function(){this._hasLoggedIn=!0},s.iterateUsers=function(n,e){for(var o=n.host.readStorageKey(s.storageKey),r=n.currentSession&&n.currentSession.user,h=0;h<o.length;h++){var f=s.fromUserRecord(o[h],n),g=e(f);if(null!=g)return g;r&&r.guid.equalsUserGuid(f.guid)&&(r=null)}return r?e(r):null},s.findUserByUidToken=function(n,e){return s.iterateUsers(n,function(o){return o.idToken&&o.idToken===e?(n.log(t.LogLevel.Debug,function(){return"Located user based on id token, guid: '"+o.guid+"'"}),o):null})},s.calculateUidHash=function(n,e){var o=e.toLowerCase(),r=t.util.hexToBase64(n.host.calcHexStringEncodedSha256Hash(t.util.asciiToHex(o)));return n.log(t.LogLevel.Debug,function(){return"Calculated uid hash, input: '"+o+", hash: '"+r+"'"}),r},s.findUserByUidHash=function(n,e){var o=this;return n.log(t.LogLevel.Debug,function(){return"Looking up user based on user id hash, hash: '"+e+"'"}),s.iterateUsers(n,function(r){return e==r._uidHash?(n.log(t.LogLevel.Debug,function(){return"Located user based on uid hash, guid: '"+r.guid+"'"}),r):r.userId&&o.calculateUidHash(n,r.userId)==e?(n.log(t.LogLevel.Debug,function(){return"Located user with user id based on uid hash, guid: '"+r.guid+"'"}),r):null})},s.findUserByUserId=function(n,e){var o=this.calculateUidHash(n,e);return n.log(t.LogLevel.Debug,function(){return"Looking up user based on user id, userId: '"+e+"'"}),s.iterateUsers(n,function(r){return r.userId&&r.userId.toLowerCase()===e.toLowerCase()?(n.log(t.LogLevel.Debug,function(){return"Located user based on user id, guid: '"+r.guid+"'"}),r):r.userId||o!=r._uidHash?null:(n.log(t.LogLevel.Debug,function(){return"Located user based on uid hash, guid: '"+r.guid+"'"}),r.idToken||(r._userId=e),r)})},s.findUserByGuid=function(n,e){return s.iterateUsers(n,function(o){return o.guid.equalsUserGuid(e)?(n.log(t.LogLevel.Debug,function(){return"Located user based on guid, guid: '"+o.guid+"'"}),o):null})},s.findUser=function(n,e){return 0==e.indexOf("uidt:")?this.findUserByUidToken(n,e):this.findUserByUserId(n,e)},s.findUserWithType=function(n,e,o){if(o){if(o===t.UserHandleType.IdToken)return this.findUserByUidToken(n,e);if(o===t.UserHandleType.UserId)return this.findUserByUserId(n,e);throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Internal,"Unsupported user handle type",{user_handle_type:o})}return this.findUser(n,e)},s.createUserWithUserId=function(n,e){if(!e)throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.AppImplementation,"userHandle must not be empty");var o=this.createBaseUser(n);return o._userId=e,o._uidHash=t.util.hexToBase64(n.host.calcHexStringEncodedSha256Hash(t.util.asciiToHex(e))),o},s.createUserWithIdToken=function(n,e,o){if(!e)throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.AppImplementation,"userHandle must not be empty");var r=this.createBaseUser(n);return r._idToken=e,r._uidHash=o,r},s.createBaseUser=function(n){var e=new s;return e._guid=u.createWithLength(32,n),e._deviceBound=!1,e._hasLoggedIn=!1,e._phoneNumber="",e._sdk=n,e._ephemeral=!1,e._deviceSigningKeyTagSalt=n.host.generateRandomHexString(24),e},s.createEphemeralUser=function(n){var e=new s;return e._guid=u.createWithLength(32,n),e._deviceBound=!1,e._hasLoggedIn=!1,e._phoneNumber="",e._sdk=n,e._ephemeral=!0,e._ephemeralUserId=null,e},s.deleteUser=function(n,e){var o=e.host.readStorageKey(s.storageKey);e.log(t.LogLevel.Warning,function(){return"=== CURRENTL LEN    "+o.length});for(var r=0;r<o.length;r++){var h=s.fromUserRecord(o[r],e);if(n.guid.equalsUserGuid(h.guid))break}if(r<o.length){for(;r<o.length-1;)o[r]=o[r+1],r++;var f=o.length-1;delete o[o.length-1],o.length=f,e.host.writeStorageKey(s.storageKey,o)}else e.log(t.LogLevel.Warning,function(){return"Attempt to delete nonexisting user "+n.userHandle})},s.prototype.createEnrollmentRecord=function(n,e,o,r,h){var f=i.LocalEnrollment.createNew(n,e,o,this._sdk,h);return f.status=r,f},s.prototype.updateEnrollmentRecord=function(n){if(this._ephemeral)throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Internal,"Attempt to update enrollment record for ephemeral user.",{});var e={};for(var o in this.localEnrollments)e[o]=this.localEnrollments[o];e[n.authenticatorId]=n,i.LocalEnrollment.updateEnrollmentsForUser(this,e,this._sdk),this._localEnrollments=e},s.toUserRecord=function(n){var e={default_auth_id:n._defaultAuthId,device_bound:n._deviceBound,has_logged_in:n._hasLoggedIn,device_id:n._deviceId,last_auth:"<null>",guid:n._guid.toString(),user_id:n.userId,display_name:n._displayName,id_token:n._idToken,uid_hash:n._uidHash,user_number:n._phoneNumber,schemeVersion:"v1",device_signing_key_tag_salt:n._deviceSigningKeyTagSalt};return n._ephemeralUserId&&(e.ephemeral_id=n._ephemeralUserId),e},s.save=function(n,e){if(e._ephemeral)throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Internal,"Attempt to save ephemeral user record to persistent store.",{});var o=n.host.readStorageKey(s.storageKey);o.length=o.length||0;for(var r=0;r<o.length&&!s.fromUserRecord(o[r],n).guid.equalsUserGuid(e.guid);r++);o[r]=s.toUserRecord(e),o.length<r+1&&(o.length=r+1),n.host.writeStorageKey(s.storageKey,o)},s.fromUserRecord=function(n,e){var o=new s;return o._sdk=e,o._defaultAuthId=n.default_auth_id,o._deviceBound=n.device_bound,o._hasLoggedIn=n.has_logged_in,o._deviceId=n.device_id,o._phoneNumber=n.user_number,o._deviceSigningKeyTagSalt=n.device_signing_key_tag_salt,o._userId=n.user_id,o._idToken=n.id_token,o._uidHash=n.uid_hash,n.ephemeral_id&&(o._ephemeral=!0,o._ephemeralUserId=n.ephemeral_id),n.schemeVersion?(o._guid=u.createFromString(n.guid),o._displayName=n.display_name):(o._guid=u.createFromString(n.user_id),o._displayName=n.user_id),o},s.storageKey=new i.TarsusKeyPath("users"),s}();i.User=c}((t=l.sdk||(l.sdk={})).core||(t.core={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){t.InternalErrorWrongBiometric=1e3,t.InternalErrorBiometricInvalidated=1001,t.InternalErrorBiometricKeyStoreError=1002,t.InternalErrorBiometricNotConfigured=1003,t.InternalErrorBiometricOsLockTemporary=1004,t.InternalErrorBiometricOsLockPermanent=1005,t.InternalErrorBiometricFallbackPressed=1006,t.InternalErrorCouldNotGenerateSecureKey=1007,t.ErrorDataInternalError="internal_error",t.ErrorDataNumFailures="num_failures",t.ErrorDataServerErrorCode="server_error_code",t.ErrorDataServerErrorMessage="server_error_message",t.ErrorDataServerErrorData="server_error_data",t.ErrorDataRetriesLeft="retries",t.ErrorDataCommunicationError="communication_error",t.ErrorDataCommunicationSSL="ssl",t.FeatureCodeServerHeaders=1,t.FeatureCodeAuthFailover=2,t.FeatureCodeUnifiedRegFlow=3,t.FeatureCodePromotionAction=6,t.FeatureCodeSilentFingerprintRegistration=7,t.FeatureCodeMultiMethodRegistrationAction=8,t.FeatureCodeOtpCodeInvalidated=10,t.FeatureCodeEnvelopedClientRequest=11,t.FeatureCodeUnregistrationFlow=12,t.FeatureCodeFaceIdAuthentication=13,t.FeatureCodeDynamicPolicySupport=14,t.FeatureCodeAutoRequestForSignContent=19,t.FeatureDeviceBiometricsFPContinuation=27,t.FeatureCodeDebugBreakpointActionSupport=28,t.FeatureCodeFido2ClientEcKeyExtSupport=37,t.FeatureCodeMultiCredVaultFido2Support=38}(l.sdkhost||(l.sdkhost={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){i.TARSUS_VERSION="6.3.0",i.API_LEVEL=11,i.STATIC_FEATURE_SET=[l.sdkhost.FeatureCodeServerHeaders,l.sdkhost.FeatureCodeAuthFailover,l.sdkhost.FeatureCodeUnifiedRegFlow,l.sdkhost.FeatureCodePromotionAction,l.sdkhost.FeatureCodeSilentFingerprintRegistration,l.sdkhost.FeatureCodeMultiMethodRegistrationAction,l.sdkhost.FeatureCodeOtpCodeInvalidated,l.sdkhost.FeatureCodeEnvelopedClientRequest,l.sdkhost.FeatureCodeUnregistrationFlow,l.sdkhost.FeatureCodeDynamicPolicySupport,l.sdkhost.FeatureCodeDebugBreakpointActionSupport]}(t.core||(t.core={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){!function(u){var c=function(s){function n(e,o){var r=s.call(this,e,o)||this;return r._clientContext=r._controlFlowProcessor._clientContext,r._cancellationHolder=new t.util.CancelablePromiseHolder,r}return V(n,s),n.prototype.run=function(){var e=this;return this._cancellationHolder.resolveWith(function(o,r){e.doRunAction().then(o,r)}),this._cancellationHolder.cancellablePromise.catch(function(o){if(o==t.util.CancelablePromiseHolder.CancelRequest)return e._controlFlowProcessor.createExternalCancellationRejectionPromise();throw o})},n.prototype.cancelRun=function(){this._cancellationHolder.cancel()},n}(u.ActionDriver);u.SimpleCancellationActionDriver=c}(i.actiondrivers||(i.actiondrivers={}))}(t.core||(t.core={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){!function(u){var c=function(s){function n(e,o){return s.call(this,e,o)||this}return V(n,s),n.prototype.doRunAction=function(){var e=this;return this._sdk.log(t.LogLevel.Debug,function(){return"Executing Anonymous FIDO2 authentication."}),this._sdk.host.fido2CredentialsOp(this._uiHandler,this._controlFlowProcessor,this._policyAction,l.sdkhost.Fido2CredentialsOpType.Get,this._action.credentialRequestOptions).then(function(r){return e.sendAssertionRequest("authenticate",{assertion_credential:r})}).catch(function(r){var h=p.ts.mobile.sdk.impl.AuthenticationErrorImpl.ensureAuthenticationError(r);if(h.getErrorCode()===t.AuthenticationErrorCode.UserCanceled){e._sdk.log(t.LogLevel.Debug,function(){return"Received FIDO2 cancellation request."});var f=e._policyAction.getEscapeOptions().filter(function(y){return y.getPresentation()==p.ts.mobile.sdk.ActionEscapeOptionPresentation.Cancel})[0];if(f){e._sdk.log(t.LogLevel.Debug,function(){return"Got cancel escape option; responding with that."});var g=new t.ActionEscapeRequest;return g.setEscapeOption(f),e.processEscapeRequest(g)}}throw h})},n}(u.SimpleCancellationActionDriver);u.ActionDriverAnonymousFido2Authenticate=c}(i.actiondrivers||(i.actiondrivers={}))}(t.core||(t.core={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){!function(u){var c=function(n){function e(o,r,h,f,g,y,A,T){var C=n.call(this,A._controlFlowProcessor._session,o,r,h)||this;return C._assertionId=f,C._retriesLeft=g,C._actionDriver=A,C._fallback=y,C._registration=T,C}return V(e,n),Object.defineProperty(e.prototype,"authDriver",{get:function(){return this._authDriver||(this._authDriver=this.authenticationDriverDescriptor.createAuthenticationDriver(this._actionDriver,this._authenticatorMethodConfig,this)),this._authDriver},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"suggestedParameters",{get:function(){return this.getEnabled()?this.authenticationDriverDescriptor.suggestParameters(this._authenticatorMethodConfig,this):[]},enumerable:!1,configurable:!0}),e.prototype.getEnabled=function(){return(this._registration||this.getRegistered()&&!this.getLocked())&&this.getSupportedOnDevice()},Object.defineProperty(e.prototype,"fallback",{get:function(){return this._fallback},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"assertionId",{get:function(){return this._assertionId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"retriesLeft",{get:function(){return this._retriesLeft},enumerable:!1,configurable:!0}),e.prototype.updateWithAssertionResult=function(o){o.retries_left&&(this._retriesLeft=o.retries_left),o.locked&&(this._locked=o.locked)},e.fromUnregistrationAction=function(o,r){return new e(o.method,o,o,o.assertion_id,null,null,r,!1)},e.fromPromotionAction=function(o,r){return new e(o.method,o,o,o.assertion_id,o.retries_left,o.fallback||null,r,!0)},e.fromAuthenticationActionMenuOption=function(o,r){return new e(o.type,o,o,o.assertion_id,o.retries_left,o.fallback||null,r,!1)},e.fromRegistrationAction=function(o,r){return new e(o.method,o,o,o.assertion_id,null,null,r,!0)},e}(i.authenticationdrivers.AuthenticatorDescriptionImpl);u.AuthenticationMenuAuthenticator=c;var s=function(n){function e(o,r){var h=n.call(this,o,r)||this;return h._externallyCancelled=!1,h}return V(e,n),e.prototype.doRunAction=function(){var o=this;return new Promise(function(r,h){o._completionFunction=r,o._rejectionFunction=h,o.runActionWithCompletionFunctions()})},Object.defineProperty(e.prototype,"availableAuthenticatorsForSwitching",{get:function(){return this.availableAuthenticators},enumerable:!1,configurable:!0}),e.prototype.sendPollingRequest=function(o,r){return n.prototype.sendPollingRequest.call(this,o,r)},e.prototype.sendAuthenticatorAssertionRequest=function(o,r,h,f){this._sdk.log(t.LogLevel.Debug,function(){return"Sending authenticator asserion request for "+o.getAuthenticatorId()+": assert="+r});var g={assertion_id:o.assertionId,method:o.getAuthenticatorId()};if(f)for(var y in f)g[y]=f[y];return this.sendAssertionRequest(r,h,g)},e.prototype.completeAuthenticationWithAssertionResult=function(o){this._completionFunction(o)},e.prototype.completeAuthenticationWithError=function(o){this._rejectionFunction(o)},e.prototype.completeWithEscapeRequest=function(o){var r=this;this.processEscapeRequest(o).then(function(h){r.completeAuthenticationWithAssertionResult(h)},function(h){r.completeAuthenticationWithError(h)})},e.prototype.prepareForRunningAuthenticationDriver=function(o){return this._externallyCancelled?(this.completeAuthenticationWithError(this._controlFlowProcessor.createExternalCancellationError()),!1):(this._runningAuthenticatorDriver=o,!0)},e.prototype.cancelRun=function(){this._externallyCancelled=!0,this._runningAuthenticatorDriver&&this._runningAuthenticatorDriver.onCancelRun(),n.prototype.cancelRun.call(this)},e}(u.SimpleCancellationActionDriver);u.ActionDriverAuthenticatorOp=s}(i.actiondrivers||(i.actiondrivers={}))}(t.core||(t.core={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){!function(u){var c=function(s){function n(e,o){return s.call(this,e,o)||this}return V(n,s),n.prototype.runActionWithCompletionFunctions=function(){var e=this._action;this._sdk.log(t.LogLevel.Debug,function(){return"Loading authenticator descriptions"}),this.loadAuthenticatorDescriptionsFromAction(e),this._shouldUpdateDefaultAuth=e.options&&e.options.update_default,this._sdk.log(t.LogLevel.Debug,function(){return"Starting auth presentation"}),this.runWithPresentationMode(e.options&&e.options.start_with||i.Protocol.AuthMenuPresentationMode.DefaultAuthenticator)},Object.defineProperty(n.prototype,"availableAuthenticators",{get:function(){return this.updateAvailableAuthenticatorsList(),this._availableAuthenticators.concat([])},enumerable:!1,configurable:!0}),n.prototype.runWithPresentationMode=function(e,o){var r=this;this.updateAvailableAuthenticatorsList();var h=e==i.Protocol.AuthMenuPresentationMode.AuthenticatorMenu&&this._uiHandler.shouldIncludeDisabledAuthenticatorsInMenu(this.policyAction(),this._clientContext)?this._allAuthenticators:this._availableAuthenticators;if(o&&(h=h.filter(function(g){return o.filter(function(y){return y.getAuthenticatorId()==g.getAuthenticatorId()}).length>0})),h.length)switch(e){case i.Protocol.AuthMenuPresentationMode.AuthenticatorMenu:var f=h.map(function(g){return new t.impl.AuthenticationOptionImpl(g,g.suggestedParameters)});this._uiHandler.selectAuthenticator(f,this.policyAction(),this._clientContext).then(function(g){switch(g.getResultType()){case t.AuthenticatorSelectionResultType.Abort:r.completeAuthenticationWithError(new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.UserCanceled,"Cancel during authenticator selection."));break;case t.AuthenticatorSelectionResultType.SelectAuthenticator:if(!(f.filter(function(y){return y.getAuthenticator()==g.getSelectedAuthenticator()}).length>0)){r.completeAuthenticationWithError(new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.AppImplementation,"selectAuthenticator returned an authenticator not within options."));break}if(!g.getSelectedAuthenticator().getEnabled()){r.completeAuthenticationWithError(new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.AppImplementation,"selectAuthenticator returned a non-enabled authenticator."));break}r.runAuthenticator(g.getSelectedAuthenticator(),g.getSelectedAuthenticationParameters());break;case t.AuthenticatorSelectionResultType.Escape:r.completeWithEscapeRequest(g.getActionEscapeRequest())}});break;case i.Protocol.AuthMenuPresentationMode.DefaultAuthenticator:this._defaultAuthenticator&&this._availableAuthenticators.indexOf(this._defaultAuthenticator)>=0?this.runAuthenticator(this._defaultAuthenticator,[]):(this._sdk.log(t.LogLevel.Warning,function(){return"Default authenticator for user not found. Falling back to first authenticator in list."}),this.runAuthenticator(this._availableAuthenticators[0],[]));break;case i.Protocol.AuthMenuPresentationMode.FirstAuthenticator:this.runAuthenticator(this._availableAuthenticators[0],[])}else this._allAuthenticators.filter(function(g){return g.getLocked()}).length>0?this.completeAuthenticationWithError(new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.AllAuthenticatorsLocked,"All authenticators locked.")):this.completeAuthenticationWithError(new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.NoRegisteredAuthenticator,"No registered authenticator available."))},n.prototype.loadAuthenticatorDescriptionsFromAction=function(e){var o=this;this._allAuthenticators=e.methods.map(function(r){return u.AuthenticationMenuAuthenticator.fromAuthenticationActionMenuOption(r,o)})},n.prototype.updateAvailableAuthenticatorsList=function(){var e=this;this._defaultAuthenticator=null,this._availableAuthenticators=[],this._allAuthenticators.forEach(function(o){o.getEnabled()&&e._availableAuthenticators.push(o),o.getDefaultAuthenticator()&&(e._defaultAuthenticator=o)}),this._defaultAuthenticator||(this._defaultAuthenticator=this._availableAuthenticators[0]),this._sdk.log(t.LogLevel.Debug,function(){return"Updated available authenticators list; "+e._availableAuthenticators.length+" available authenticators"})},n.prototype.runAuthenticator=function(e,o){var r=this,h=e.authDriver;this.prepareForRunningAuthenticationDriver(h)&&h.runAuthentication(o).then(function(f){if(f instanceof i.authenticationdrivers.AuthenticationDriverSessionResultSwitchAuthenticator)f.requiredAuthenticator?r.runAuthenticator(f.requiredAuthenticator,[]):r.runWithPresentationMode(i.Protocol.AuthMenuPresentationMode.AuthenticatorMenu,f.allowedAuthenticators);else if(f instanceof i.authenticationdrivers.AuthenticationDriverSessionResultAuthenticationCompleted){if(r._shouldUpdateDefaultAuth&&(r._sdk.log(t.LogLevel.Info,function(){return"Updating user default authenticator."}),!r._controlFlowProcessor._session.anonymous)){var g=r._controlFlowProcessor._session.user;g.updateDefaultAuthId(e.getAuthenticatorId()),r._controlFlowProcessor._session.persistUserData&&i.User.save(r._sdk,g)}r.completeAuthenticationWithAssertionResult(f.assertionResult)}else f instanceof i.authenticationdrivers.AuthenticationDriverSessionResultEscapeRequested?r.completeWithEscapeRequest(f.escapeRequest):r.completeAuthenticationWithError(new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Internal,"Unknown authentication driver result type encountered."))},function(f){r._sdk.log(t.LogLevel.Debug,function(){return"Received authentication driver error "+f}),r.completeAuthenticationWithError(f)})},n}(u.ActionDriverAuthenticatorOp);u.ActionDriverAuthentication=c}(i.actiondrivers||(i.actiondrivers={}))}(t.core||(t.core={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){!function(u){var c=function(s){function n(e,o){return s.call(this,e,o)||this}return V(n,s),n.prototype.doRunAction=function(){var e=this;this._sdk.log(t.LogLevel.Debug,function(){return"Executing confirmation action."});var o=this._action;return this._uiHandler.getConfirmationInput(o.title,o.text,o.continue_button_text,o.cancel_button_text,this.policyAction(),this._clientContext).then(function(r){var h=r.getActionEscapeRequest();if(h)return e.processEscapeRequest(h);var f={user_cancelled:1==r.getUserChoice()},g=Promise.resolve(f);if(o.require_sign_content){var y={params:{title:o.title,text:o.text,continue_button_text:o.continue_button_text,cancel_button_text:o.cancel_button_text,parameters:o.parameters,image:o.image},user_input:f.user_cancelled?o.cancel_button_text:o.continue_button_text};g=g.then(function(A){return u.ActionDriverSignContent.augmentAssertionDataWithSignedContent(A,y,e._controlFlowProcessor._session.deviceSigningKeyPair,e._sdk)})}return g.then(function(A){return e._sdk.log(t.LogLevel.Debug,function(){return"Asserting confirmation: "+A}),e.sendAssertionRequest(null,A).then(function(T){return T})})})},n}(u.SimpleCancellationActionDriver);u.ActionDriverConfirmation=c}(i.actiondrivers||(i.actiondrivers={}))}(t.core||(t.core={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){!function(u){var c=function(s){function n(e,o){return s.call(this,e,o)||this}return V(n,s),n.prototype.doRunAction=function(){var e=this;return this._sdk.log(t.LogLevel.Debug,function(){return"Executing debug break action."}),this._sdk.host.setDebugIndicatorVisible(!0),this.pollUntilDone().finally(function(){e._sdk.host.setDebugIndicatorVisible(!1)})},n.prototype.pollUntilDone=function(){var e=this,o={};return t.util.wrapPromiseWithActivityIndicator(this._uiHandler,this._policyAction,this._clientContext,this._sdk.host.createDelayedPromise(250)).then(function(){return e.sendAssertionRequest(null,o)}).then(function(r){return r.assertion_error_code==i.Protocol.AssertionErrorCode.NotFinished?e.pollUntilDone():r})},n}(u.SimpleCancellationActionDriver);u.ActionDriverDebugBreak=c}(i.actiondrivers||(i.actiondrivers={}))}(t.core||(t.core={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){!function(u){var c=function(s){function n(e,o){return s.call(this,e,o)||this}return V(n,s),n.prototype.doRunAction=function(){var e=this;this._sdk.log(t.LogLevel.Debug,function(){return"Executing disable TOTP action..."});var o=this._action,r=i.totp.TotpPropertiesProcessor.createWithUser(this._controlFlowProcessor._session.user,this._sdk,this._clientContext,this._controlFlowProcessor._session);return this._sdk.log(t.LogLevel.Debug,function(){return"Obtained TOTP processor."}),o.config_ids.forEach(function(h){e._sdk.log(t.LogLevel.Debug,function(){return"Deleting TOTP processor "+h+"."}),r.deleteProvisionForGenerator(h),e._sdk.log(t.LogLevel.Debug,function(){return"TOTP processor "+h+" deleted."})}),this.sendAssertionRequest()},n}(u.SimpleCancellationActionDriver);u.ActionDriverDisableTotp=c}(i.actiondrivers||(i.actiondrivers={}))}(t.core||(t.core={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){!function(u){var c=function(s){function n(e,o){return s.call(this,e,o)||this}return V(n,s),n.prototype.doRunAction=function(){var e=this,o=this._action,r=n.formExtensionPoint.firstNonNull(function(h){return h.createFormSession(o.form_id,o.app_data)});return r?(this._sdk.log(t.LogLevel.Debug,function(){return'Using extension of type "com.ts.mobile.plugins.form.settings" for formId '+o.form_id}),this.session=r):this.session=this._uiHandler.createFormSession(o.form_id,o.app_data),this.session?new Promise(function(h,f){e.completionFunction=h,e.rejectionFunction=f,e.session.startSession(e._clientContext,e.policyAction()),e.session.promiseFormInput().then(function(g){return e.processPromiseResult(g)},e.rejectionFunction)}):Promise.reject(t.impl.AuthenticationErrorImpl.appImplementationError("Invalid return from createFormSession."))},n.prototype.processPromiseResult=function(e){switch(e.getControlRequest()){case t.FormControlRequest.Submit:var o={input:e.getJsonData()};this.request(o);break;case t.FormControlRequest.Abort:this.terminateSession(),this.rejectionFunction(new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.UserCanceled,"User cancelled a form action."));break;case t.FormControlRequest.Escape:this.terminateSession(),this.processEscapeRequest(e.getActionEscapeRequest()).then(this.completionFunction,this.rejectionFunction)}},n.prototype.terminateSession=function(){this.session&&(this.session.endSession(),delete this.session)},n.prototype.request=function(e){var o=this;this.sendAssertionRequest(null,null,e).then(function(r){var h=r.data;switch(r.assertion_error_code){case i.Protocol.AssertionErrorCode.NotFinished:o.session.onContinue(h),o.session.promiseFormInput().then(function(f){return o.processPromiseResult(f)},o.rejectionFunction);break;case i.Protocol.AssertionErrorCode.RepeatCurrentStep:o.session.onError(h),o.session.promiseFormInput().then(function(f){return o.processPromiseResult(f)},o.rejectionFunction);break;default:o.terminateSession(),o.completionFunction(r)}}).catch(function(r){o.terminateSession(),o.rejectionFunction(r)})},n.formExtensionPoint=new i.ExtensionPoint(l.tarsusplugin.TARSUS_EXTENSION_POINT_NAME_FORMS_EXTENSION),n}(u.SimpleCancellationActionDriver);u.ActionDriverForm=c}(i.actiondrivers||(i.actiondrivers={}))}(t.core||(t.core={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){!function(u){var c=function(s){function n(e,o){return s.call(this,e,o)||this}return V(n,s),n.prototype.doRunAction=function(){var e=this;this._sdk.log(t.LogLevel.Debug,function(){return"Executing information action."});var o=this._action;return this._uiHandler.getInformationResponse(o.title,o.text,o.button_text,this.policyAction(),this._clientContext).then(function(r){if(r.getActionEscapeRequest())return e.processEscapeRequest(r.getActionEscapeRequest());if(e._sdk.log(t.LogLevel.Debug,function(){return"Asserting information"}),-1!=r.getUserChoice())throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.AppImplementation,"ConfirmationInput.getUserChoice must be set to -1.");return e.sendAssertionRequest()})},n}(u.SimpleCancellationActionDriver);u.ActionDriverInformation=c}(i.actiondrivers||(i.actiondrivers={}))}(t.core||(t.core={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){!function(u){var c=function(n){function e(o,r){var h=n.call(this,o)||this;return o instanceof i.SerializationContext||(h._idpSessionContinuationData=r),h}return V(e,n),Object.defineProperty(e.prototype,"idpSessionContinuationData",{get:function(){return this._idpSessionContinuationData},enumerable:!1,configurable:!0}),e.prototype.createResumableProcess=function(o){return new s(o,this)},e.prototype.serializeTo=function(o){n.prototype.serializeTo.call(this,o),o.writePrimitive("idpSessionContinuation",this._idpSessionContinuationData)},e.prototype.serializeFrom=function(o){n.prototype.serializeFrom.call(this,o),this._idpSessionContinuationData=o.readPrimitive("idpSessionContinuation")},z([i.Serializable("ActionDriverInvokeIdpContinuation"),$t("design:paramtypes",[Object,Object])],e)}(u.ResumableProcessActionContinuation);u.ActionDriverInvokeIdpContinuation=c;var s=function(n){function e(){return null!==n&&n.apply(this,arguments)||this}return V(e,n),e.prototype.extensionPointForIdp=function(){var o=this,r=e.idpExtensionPoint.first(function(h){return h.canHandleIdp(o.idpName)});if(!r)throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.AppImplementation,"Could not locate IDP handler plugin for idp "+this.idpName+".");return r},e.prototype.resume=function(o,r){var h=this;if(!(o instanceof c))throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Internal,"Invalid continuation type for ActionDriverInvokeIdp");return new Promise(function(f,g){h.extensionPointForIdp().resumeFromContinuation(o.idpSessionContinuationData,r).then(function(y){return h.processIdpResponse(y)}).then(f,g)})},e.prototype.createContinuation=function(){return new c(this._action,this._activeIdpAuthSession&&this._activeIdpAuthSession.serializeContinuationData())},e.prototype.run=function(){var o=this;return new Promise(function(r,h){var f=o.extensionPointForIdp().createIdpAuthSession(o.idpName);o._activeIdpAuthSession=f,f.startSession(o._controlFlowProcessor._session.user.userHandle,o._action,o.policyAction(),o._clientContext),o._activeIdpAuthSession.invokeIdp().finally(function(){f.endSession(),o._activeIdpAuthSession=null}).then(function(g){return o.processIdpResponse(g)}).then(r,h)})},Object.defineProperty(e.prototype,"idpName",{get:function(){return this._action.idp_name},enumerable:!1,configurable:!0}),e.prototype.processIdpResponse=function(o){return this.sendAssertionRequest(null,{idp_response:o.getResultPayload()})},e.idpExtensionPoint=new i.ExtensionPoint(l.tarsusplugin.TARSUS_EXTENSION_POINT_NAME_IDP_LOGIN_PROVIDER),e}(u.ResumableProcessActionDriver);u.ActionDriverInvokeIdp=s}(i.actiondrivers||(i.actiondrivers={}))}(t.core||(t.core={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){!function(u){var c=function(s){function n(e,o){return s.call(this,e,o)||this}return V(n,s),n.prototype.run=function(){var e=this;return this._sdk.log(t.LogLevel.Debug,function(){return"Executing JSON data action."}),this.sendAssertionRequest().then(function(o){return e._sdk.log(t.LogLevel.Debug,function(){return"Executing JSON data action: "+o}),n.handleJsonDataByUiHandler(e._uiHandler,o,o.data.json_data,e._policyAction,e._clientContext)})},n.handleJsonDataByUiHandler=function(e,o,r,h,f){return e.processJsonData(r,h,f).then(function(g){if(g.getContinueProcessing())return o;throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.UserCanceled,"User cancelled a JSON action.")})},n}(u.ActionDriver);u.ActionDriverJsonData=c}(i.actiondrivers||(i.actiondrivers={}))}(t.core||(t.core={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){!function(u){var c=function(s){function n(e,o){return s.call(this,e,o)||this}return V(n,s),n.prototype.doRunAction=function(){return It(this,void 0,void 0,function(){var e,o,r,f,g;return zt(this,function(y){switch(y.label){case 0:e=this.extensionPointForKyc(),(o=e.createSession(this.action.vendor_name,this.action.payload)).startSession(this._controlFlowProcessor._clientContext,this.policyAction()),y.label=1;case 1:y.trys.push([1,8,9,10]),r=null,y.label=2;case 2:return r&&r.assertion_error_code!=i.Protocol.AssertionErrorCode.NotFinished?[3,7]:[4,o.collectKycData(r?r.data.payload:this.action.payload)];case 3:return(f=y.sent()).isControlRequest()?[2,this.handleControlRequest(f.getControlRequest())]:[3,4];case 4:return[4,this.handleUserResponse(f.getResponse())];case 5:r=y.sent(),y.label=6;case 6:return[3,2];case 7:return[2,r];case 8:return g=y.sent(),[2,Promise.reject(g)];case 9:return o.endSession(),[7];case 10:return[2]}})})},n.prototype.handleControlRequest=function(e){return this.logDebug(function(){return"Processing control request "+e.getRequestType()}),e.getRequestType()===t.ControlRequestType.AbortAuthentication?this.rejectedPromise(t.AuthenticationErrorCode.UserCanceled,"Scan qr code action canceled by user."):this.rejectedPromise(t.AuthenticationErrorCode.AppImplementation,"Unsupported control request: "+e.getRequestType()+" for kyc action.")},n.prototype.handleUserResponse=function(e){return It(this,void 0,void 0,function(){var o,h;return zt(this,function(f){switch(f.label){case 0:return this.logDebug(function(){return"Processing kyc data"}),o=e.getPayload(),[4,this.sendAssertionRequest(n.AssertActionSendData,{payload:o})];case 1:h=f.sent(),this.logDebug(function(){return"Server result: "+h.assertion_error_code}),f.label=2;case 2:return h.assertion_error_code!=i.Protocol.AssertionErrorCode.ExternalProcessPending?[3,5]:[4,this.delay(3e3)];case 3:return f.sent(),[4,this.sendAssertionRequest(n.AssertActionPoll,{})];case 4:return h=f.sent(),this.logDebug(function(){return"Server result: "+h.assertion_error_code}),[3,2];case 5:return[2,h]}})})},n.prototype.extensionPointForKyc=function(){var e=this,o=n.kycExtensionPoint.firstNonNull(function(r){return r.canHandleProvider(e.action.vendor_name)?r:null});if(!o)throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.AppImplementation,"Could not locate KYC handler plugin for kyc provider "+this.action.vendor_name+".");return o},Object.defineProperty(n.prototype,"action",{get:function(){return this._action},enumerable:!1,configurable:!0}),n.prototype.rejectedPromise=function(e,o){return Promise.reject(new t.impl.AuthenticationErrorImpl(e,o))},n.prototype.logDebug=function(e){this._sdk.log(t.LogLevel.Debug,e)},n.prototype.delay=function(e){return this._sdk.host.createDelayedPromise(e)},n.AssertActionPoll="poll",n.AssertActionSendData="data",n.kycExtensionPoint=new i.ExtensionPoint(l.tarsusplugin.TARSUS_EXTENSION_POINT_NAME_KYC),n}(u.SimpleCancellationActionDriver);u.ActionDriverKyc=c}(i.actiondrivers||(i.actiondrivers={}))}(t.core||(t.core={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){!function(u){var c=function(s){function n(e,o){var r=s.call(this,e,o)||this;return r.isAssertionContainerNotComplete=!1,r}return V(n,s),n.prototype.strategyStatePerUserStorageKey=function(){return new i.TarsusKeyPath("per_user",this._controlFlowProcessor._session.user.guid.toString(),"promotion_strategy_state")},n.prototype.runActionWithCompletionFunctions=function(){var e=this;if(this._sdk.log(t.LogLevel.Debug,function(){return"ActionDriverPromotion#runActionWithCompletionFunctions() started"}),this._action=this._action,this._action.assertions.length<1)return this._sdk.log(t.LogLevel.Info,function(){return"runActionWithCompletionFunctions() Promotion has no assertions, finishing action."}),void this.completeWithDeclineAssertion();if(!this.shouldDisplayPromotion())return this._sdk.log(t.LogLevel.Info,function(){return"runActionWithCompletionFunctions() Promotion stragety stop, finishing action."}),void this.completeWithDeclineAssertion();if(this._session=this._uiHandler.createRegistrationPromotionSession(this._controlFlowProcessor._session.user.displayName,this._policyAction),this._session){this._session.startSession(this._clientContext,this.policyAction());var o=this._action.options;this._session.promptIntroduction(o.title,o.text,o.ok_button,o.decline_button).then(function(r){if(e.handlePromotionInputControlOrEscapeRequest(r)){for(var h=e._action.assertions,f=new Array,g=0;g<h.length;g++){var y=u.AuthenticationMenuAuthenticator.fromPromotionAction(h[g],e);y.getSupportedOnDevice()&&f.push(y)}e._authenticatorList=f,e.suggestAuthenticators()}})}else this._rejectionFunction(t.impl.AuthenticationErrorImpl.appImplementationError("Invalid return from createRegistrationPromotionSession."))},n.prototype.sendAssertionRequest=function(e,o,r){var h=this;return this.isAssertionContainerNotComplete=!1,s.prototype.sendAssertionRequest.call(this,e,o,r).then(function(f){return f.assertion_error_code==i.Protocol.AssertionErrorCode.AssertionContainerNotComplete&&(f.assertion_error_code=void 0,h.isAssertionContainerNotComplete=!0),f})},n.prototype.suggestAuthenticators=function(e){var o=this;if(void 0===e&&(e=this._authenticatorList),this._currentAuthentictorSelected){var r=e.indexOf(this._currentAuthentictorSelected);r>-1&&e.splice(r,1)}this._session.setPromotedAuthenticators(e).then(function(h){if(o.handlePromotionInputControlOrEscapeRequest(h)){var f=h.getSelectedAuthenticator();o._currentAuthentictorSelected=f,o.prepareForRunningAuthenticationDriver(f.authDriver)&&f.authDriver.runRegistration().then(function(y){if(y instanceof i.authenticationdrivers.AuthenticationDriverSessionResultAuthenticationCompleted)o.isAssertionContainerNotComplete?(o._sdk.log(t.LogLevel.Debug,function(){return"suggestAuthenticators() callback result: promotion not completed. showing list again."}),o.suggestAuthenticators()):(o._sdk.log(t.LogLevel.Debug,function(){return"suggestAuthenticators() callback result: promotion completed. finishing"}),o.completeAuthenticationWithAssertionResult(y.assertionResult));else if(y instanceof i.authenticationdrivers.AuthenticationDriverSessionResultSwitchAuthenticator)if(y.allowedAuthenticators){o._sdk.log(t.LogLevel.Debug,function(){return"suggestAuthenticators() callback result: switch authentciator with allowed authenticators called"});var A=y.allowedAuthenticators;o._currentAuthentictorSelected=null,o.suggestAuthenticators(A)}else o._sdk.log(t.LogLevel.Debug,function(){return"suggestAuthenticators() callback result: switch authentciator called"}),o._currentAuthentictorSelected=null,o.suggestAuthenticators();else y instanceof i.authenticationdrivers.AuthenticationDriverSessionResultEscapeRequested?o.completeWithEscapeRequest(y.escapeRequest):(o._sdk.log(t.LogLevel.Error,function(){return"suggestAuthenticators() unexpected callback result: stopping with error.'"}),o.completeAuthenticationWithError(new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Internal,"Unknown authentication driver result type encountered during registration.")))},function(y){o._sdk.log(t.LogLevel.Error,function(){return"suggestAuthenticators() error callback result: stopping with error. error: '"+y._data+"'"}),o.completeAuthenticationWithError(y)})}else o._sdk.log(t.LogLevel.Debug,function(){return"suggestAuthenticators() stopped by ControlRequest of type "+h.getControlRequest()})})},n.prototype.handlePromotionInputControlOrEscapeRequest=function(e){if(e.getActionEscapeRequest())return this.completeWithEscapeRequest(e.getActionEscapeRequest()),!1;if(!e.isControlRequest())return!0;switch(e.getControlRequest()){case t.PromotionControlRequest.Continue:return!0;case t.PromotionControlRequest.Skip:return this.completeWithDeclineAssertion(),!1;case t.PromotionControlRequest.Abort:return this.completeAuthenticationWithError(new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.UserCanceled,"User aborted/canceled")),!1;default:return this._sdk.log(t.LogLevel.Warning,function(){return"handlePromotionInputControlRequest() received invalid PromotionInput, unsupported ControlRequest"}),!1}},n.prototype.sendDeclineAssertion=function(){return this.sendAssertionRequest(n.ASSERT_DECLINE)},n.prototype.completeWithDeclineAssertion=function(){var e=this;this.sendDeclineAssertion().then(function(o){e.completeAuthenticationWithAssertionResult(o)}).catch(function(o){e.completeAuthenticationWithError(o)})},n.prototype.completeAuthenticationWithAssertionResult=function(e){this.terminateSession(),s.prototype.completeAuthenticationWithAssertionResult.call(this,e)},n.prototype.completeAuthenticationWithError=function(e){this.terminateSession(),s.prototype.completeAuthenticationWithError.call(this,e)},n.prototype.terminateSession=function(){this._session&&(this._session.endSession(),delete this._session)},Object.defineProperty(n.prototype,"availableAuthenticatorsForSwitching",{get:function(){return this.availableAuthenticators},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"availableAuthenticators",{get:function(){return this._authenticatorList.concat([])},enumerable:!1,configurable:!0}),n.prototype.shouldDisplayPromotion=function(){var e=this.readStrategyState();if(null==e||null==e.lastPromotionDate||null==e.loginsCounter)return this._sdk.log(t.LogLevel.Debug,function(){return"shouldDisplayPromotion() first promotion. Stored data was empty."}),this.updateStrategyState(e={loginsCounter:1,lastPromotionDate:0}),!0;for(var r=!0,h=function(A){if(0==f.checkStrategy(A,e))return f._sdk.log(t.LogLevel.Debug,function(){return"shouldDisplayPromotion() strategy stopped promotion. strategy type: "+A.type}),r=!1,"break"},f=this,g=0,y=this._action.options.strategies;g<y.length&&"break"!==h(y[g]);g++);return e.loginsCounter+=1,this.updateStrategyState(e),r},n.prototype.updateStrategyState=function(e){this._sdk.host.writeStorageKey(this.strategyStatePerUserStorageKey(),e)},n.prototype.readStrategyState=function(){var e=this._sdk.host.readStorageKey(this.strategyStatePerUserStorageKey());return null!=e.lastPromotionDate&&null!=e.loginsCounter?(this._sdk.log(t.LogLevel.Debug,function(){return"Stored state found, "+JSON.stringify(e)}),e):(this._sdk.log(t.LogLevel.Debug,function(){return"No stored state, trying to read legacy format"}),this.readLegacyStrategyStateFormat())},n.prototype.readLegacyStrategyStateFormat=function(){var e=this._sdk.host.readStorageKey(new i.TarsusKeyPath("stragety"));return null!=e.days&&null!=e.logins?(this._sdk.log(t.LogLevel.Debug,function(){return"Reading from legacy format, "+JSON.stringify(e)}),{loginsCounter:e.logins,lastPromotionDate:e.days}):null},n.prototype.checkStrategy=function(e,o){if(e.type==i.Protocol.PromotionStrategyFrequency.LOGINS)return o.loginsCounter%e.value==0;if(e.type==i.Protocol.PromotionStrategyFrequency.DAYS){var r=new Date,h=new Date;h.setTime(o.lastPromotionDate);var f=new Date;return f.setDate(h.getDate()+e.value),f.getTime()<=r.getTime()&&(o.lastPromotionDate=r.getTime(),!0)}return!1},n.ASSERT_DECLINE="decline",n.ACTION_REGISTRATION="registration",n.ACTION_PROMOTION="registration_promotion",n}(u.ActionDriverAuthenticatorOp);u.ActionDriverPromotion=c}(i.actiondrivers||(i.actiondrivers={}))}(t.core||(t.core={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){!function(u){var c=function(s){function n(e,o){return s.call(this,e,o)||this}return V(n,s),n.prototype.doRunAction=function(){var e=this;this._sdk.log(t.LogLevel.Debug,function(){return"Executing provision TOTP action."}),this._cfmAction=this._action;var o=i.totp.TotpPropertiesProcessor.createWithUser(this._controlFlowProcessor._session.user,this._sdk,this._clientContext,this._controlFlowProcessor._session),r=o.createTotpDriver(this._cfmAction.generator,this._cfmAction.otp_type);return r?(o.deleteProvisionForGenerator(this._cfmAction.generator),r.promiseProvisionOutput(this._cfmAction,this.policyAction(),this._clientContext,this._uiHandler).then(function(h){if(h instanceof l.tarsusplugin.TotpProvisionOutput)return e.sendAssertionRequest(null,h.getAssertionData()).then(function(f){return h.finalize(f),o.updateWithProvisionedGenerator(e._cfmAction,h),f});if(h instanceof l.tarsusplugin.TotpProvisionEscapeRequest)return e.processEscapeRequest(h.getEscapeRequest());throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Internal,"Invalid TOTP provision output response")})):(this._sdk.log(t.LogLevel.Error,function(){return"failed to create TOTP driver"}),Promise.reject(new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Internal,"failed to create TOTP driver")))},n}(u.SimpleCancellationActionDriver);u.ActionDriverProvisionTotp=c}(i.actiondrivers||(i.actiondrivers={}))}(t.core||(t.core={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){!function(u){var c=function(s){function n(e,o){return s.call(this,e,o)||this}return V(n,s),n.prototype.toValidVaultPath=function(e){var o=i.TarsusKeyPath.fromString(e);if(!t.UserVault.isValidKeyPathForUserVault(o))throw this._sdk.log(t.LogLevel.Error,function(){return"Invalid user vault path "+o}),new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Internal,"Invalid user vault path "+o);return o},n.prototype.doRunAction=function(){var e=this;this._sdk.log(t.LogLevel.Debug,function(){return"Executing provision TOTP action."}),this._vaultAction=this._action;var o=Promise.resolve();return this._vaultAction.new_vaults.forEach(function(r){o=o.then(function(){var h=e.toValidVaultPath(r.vault.vault_id);e._sdk.log(t.LogLevel.Debug,function(){return"Will provision vault "+h});var f=r.vault.vault_type,g=i.vault.VaultTypes[f];return g?g.createNew(e._controlFlowProcessor._session.user,h,e,e._sdk,e._controlFlowProcessor._uiHandler,!1,r).then(function(){}):(e._sdk.log(t.LogLevel.Error,function(){return"failed to find vault driver for type "+f}),Promise.reject(new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Internal,"failed to create TOTP driver for type "+f)))})}),(o=o.then(function(r){e._vaultAction.deleted_vaults.forEach(function(h){var f=e.toValidVaultPath(h);e._sdk.log(t.LogLevel.Debug,function(){return"Will delete vault "+f}),i.vault.Vault.deleteVaultForUserWithId(e._controlFlowProcessor._session.user,f,e._sdk)})})).then(function(){return e.sendAssertionRequest()})},n.prototype.getValidCancelOptions=function(){return[t.ControlRequestType.SelectMethod,t.ControlRequestType.ChangeMethod,t.ControlRequestType.RetryAuthenticator,t.ControlRequestType.CancelAuthenticator]},n.prototype.getValidErrorRecoveryOptions=function(e){return[t.AuthenticationErrorRecovery.RetryAuthenticator,t.AuthenticationErrorRecovery.ChangeAuthenticator,t.AuthenticationErrorRecovery.SelectAuthenticator,t.AuthenticationErrorRecovery.Fail]},n}(u.SimpleCancellationActionDriver);u.ActionDriverProvisionUserVault=c}(i.actiondrivers||(i.actiondrivers={}))}(t.core||(t.core={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){!function(u){var c=function(s){function n(e,o){return s.call(this,e,o)||this}return V(n,s),n.prototype.runActionWithCompletionFunctions=function(){var e=this,o=this._action;this._sdk.log(t.LogLevel.Debug,function(){return"Loading and validating authenticator description"});for(var r=0;r<o.assertions.length;r++){var h=u.AuthenticationMenuAuthenticator.fromRegistrationAction(o.assertions[r],this);if(h.getSupportedOnDevice()){this._registeredAuthenticator=h,this._silentRegistration=!!o.assertions[r].silent;break}}if(this._registeredAuthenticator){var f=this._registeredAuthenticator.authDriver;this.prepareForRunningAuthenticationDriver(f)&&(this._sdk.log(t.LogLevel.Debug,function(){return"Starting auth registeration"}),f.runRegistration().then(function(g){g instanceof i.authenticationdrivers.AuthenticationDriverSessionResultAuthenticationCompleted?e.completeAuthenticationWithAssertionResult(g.assertionResult):g instanceof i.authenticationdrivers.AuthenticationDriverSessionResultEscapeRequested?e.completeWithEscapeRequest(g.escapeRequest):e.completeAuthenticationWithError(new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Internal,"Unknown authentication driver result type encountered during registration."))},function(g){e._sdk.log(t.LogLevel.Debug,function(){return"Received authentication driver error "+g}),e.completeAuthenticationWithError(g)}))}else this.completeAuthenticationWithError(new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Internal,"No supported authenticator listed in registeration request."))},Object.defineProperty(n.prototype,"availableAuthenticatorsForSwitching",{get:function(){return[]},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"availableAuthenticators",{get:function(){return[this._registeredAuthenticator]},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"isSilentRegistration",{get:function(){return this._silentRegistration},enumerable:!1,configurable:!0}),n}(u.ActionDriverAuthenticatorOp);u.ActionDriverRegistration=c}(i.actiondrivers||(i.actiondrivers={}))}(t.core||(t.core={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){!function(u){var c=function(s){function n(e,o){return s.call(this,e,o)||this}return V(n,s),n.prototype.run=function(){var e=this;return this._sdk.log(t.LogLevel.Debug,function(){return"Executing scan qr action."}),new Promise(function(o,r){var h=e._action,f=t.QrCodeFormat.Alphanumeric;if(h.qr_code_format_type&&(f=t.QrCodeFormatImpl.fromAssertionFormat(h.qr_code_format_type)),e._session=e._uiHandler.createScanQrSession(e._policyAction,e._clientContext),!e._session)throw t.impl.AuthenticationErrorImpl.appImplementationError("Invalid return from createScanQrSession.");e._session.startSession(e._clientContext,e.policyAction()),e._session.getScanQrResponse(h.instructions,f).then(function(g){if(g.isControlRequest())return e.processControlRequest(g.getControlRequest());if(null!=g.getActionEscapeRequest())return e.processEscapeRequest(g.getActionEscapeRequest());var y={qr_content:g.getResponse().getQrCodeResult().getQrCode()};return e._sdk.log(t.LogLevel.Debug,function(){return"Asserting scan qr: "+y.qr_content}),e.sendAssertionRequest(null,y).catch(function(A){throw e._sdk.log(t.LogLevel.Error,function(){return"Scan qr sendAssertionRequest error: "+A}),A})}).catch(function(g){throw e._sdk.log(t.LogLevel.Error,function(){return"Scan qr action error: "+g}),g}).finally(function(){e._session.endSession(),delete e._session}).then(o,r)})},n.prototype.processControlRequest=function(e){var o=this;return new Promise(function(r,h){if(o._sdk.log(t.LogLevel.Debug,function(){return"Processing control request "+e.getRequestType()}),e.getRequestType()!==t.ControlRequestType.CancelAuthenticator)throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.AppImplementation,"Unsupported control request: "+e.getRequestType()+" for scan qr action.");h(new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.UserCanceled,"Scan qr code action canceled by user."))})},n}(u.ActionDriver);u.ActionDriverScanQr=c}(i.actiondrivers||(i.actiondrivers={}))}(t.core||(t.core={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){var t,i,u,c;c=l.sdk||(l.sdk={}),i=function(s){function n(e,o){return s.call(this,e,o)||this}return V(n,s),n.augmentAssertionDataWithSignedContent=function(e,o,r,h){var f=JSON.stringify(o);h.log(c.LogLevel.Debug,function(){return"Signing consent payload: "+f});var g=c.util.asciiToHex(f);return r.signHex(g).then(function(y){var A=c.util.hexToBase64(y);return e.sign_content_data={payload:f,signed_payload:A},e})},n.prototype.run=function(){var e=this;this._sdk.log(c.LogLevel.Debug,function(){return"Executing consent action."});var o=this._controlFlowProcessor.initiatingRequest&&this._controlFlowProcessor.initiatingRequest.body,r={params:o&&o.params||{}};if(this._controlFlowProcessor.requestContext&&this._controlFlowProcessor.requestContext instanceof u.ApprovalControlFlowExecutionContext){var h=this._controlFlowProcessor.requestContext.approval;r.approval={approval_id:h.getApprovalId(),message:{title:h.getTitle(),details:h.getDetails()}}}return n.augmentAssertionDataWithSignedContent({},r,this._controlFlowProcessor._session.deviceSigningKeyPair,this._sdk).then(function(f){return e.sendAssertionRequest(null,f)})},n}((t=(u=c.core||(c.core={})).actiondrivers||(u.actiondrivers={})).ActionDriver),t.ActionDriverSignContent=i}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){!function(u){var c=function(s){function n(e,o){return s.call(this,e,o)||this}return V(n,s),n.prototype.doRunAction=function(){var e=this;return this._sdk.log(t.LogLevel.Debug,function(){return"Executing ticket wait action."}),new Promise(function(o,r){var h=e._action;if(e._session=e._uiHandler.createTicketWaitSession(e._policyAction,e._clientContext),!e._session)throw t.impl.AuthenticationErrorImpl.appImplementationError("Invalid return from createTicketWaitSession.");e._session.setWaitingTicket(new t.impl.TicketWaitingInformationImpl(h)),e._session.startSession(e.policyAction(),e._clientContext),e.pollServer().then(function(f){o(f)}).finally(function(){e._session.endSession(),delete e._session}).catch(function(f){e._sdk.log(t.LogLevel.Error,function(){return"Wait for ticket action error: "+f}),r(f)})})},n.prototype.pollServer=function(){var e=this,o={};return this._sdk.log(t.LogLevel.Debug,function(){return"Asserting ticket wait poll"}),new Promise(function(r,h){var f,g=3;!function y(){0===g?h(f):e.sendAssertionRequest(null,o).then(function(A){r(A.assertion_error_code==i.Protocol.AssertionErrorCode.ExternalProcessPending?e.inputLoop():A)}).catch(function(A){g--,f=A,e._sdk.host.createDelayedPromise(10).then(function(){y()})})}()})},n.prototype.longPoll=function(e){var o=this;return this.sendPollingRequest({type:"ticket",ticket_id:this._action.raw_ticket_id},e).then(function(h){return h.change_detected?o.pollServer():o.inputLoop()})},n.prototype.inputLoop=function(){var e=this;return this._session.promiseInput().then(function(o){if(o.isControlRequest())return e.processControlRequest(o.getControlRequest());if(null!=o.getActionEscapeRequest())return e.processEscapeRequest(o.getActionEscapeRequest());var r=o.getResponse();if(r instanceof t.TicketWaitInputPollRequest){var h=r.getPollingTimeout();return h?e.longPoll(h):e.pollServer()}throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.AppImplementation,"Expected polling request input response but got: "+r)})},n.prototype.processControlRequest=function(e){var o=this;return new Promise(function(r,h){switch(o._sdk.log(t.LogLevel.Debug,function(){return"Processing control request "+e.getRequestType()}),e.getRequestType()){case t.ControlRequestType.CancelAuthenticator:case t.ControlRequestType.AbortAuthentication:h(new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.UserCanceled,"Wait for ticket action canceled by user."));break;default:throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.AppImplementation,"Unsupported control request: "+e.getRequestType()+" for ticket wait action.")}})},n}(u.SimpleCancellationActionDriver);u.ActionDriverTicketWait=c}(i.actiondrivers||(i.actiondrivers={}))}(t.core||(t.core={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){!function(u){var c=function(s){function n(e,o){return s.call(this,e,o)||this}return V(n,s),n.prototype.runActionWithCompletionFunctions=function(){this._action=this._action,this._sdk.log(t.LogLevel.Debug,function(){return"Started unregister action!"}),u.AuthenticationMenuAuthenticator.fromUnregistrationAction(this._action,this).authDriver.runUnregistration().then(this._completionFunction,this._rejectionFunction)},Object.defineProperty(n.prototype,"availableAuthenticators",{get:function(){return this._availableAuthenticators.concat([])},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"isSilentRegistration",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"isPlaceholder",{get:function(){return 0==this._action.method.indexOf("placeholder")},enumerable:!1,configurable:!0}),n.prototype.sendUnregisterAssertion=function(){return this.sendAssertionRequest()},n}(u.ActionDriverAuthenticatorOp);u.ActionDriverUnregistration=c}(i.actiondrivers||(i.actiondrivers={}))}(t.core||(t.core={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){!function(u){var c,s;c=u.dyadic||(u.dyadic={}),s=function(n){function e(){return null!==n&&n.apply(this,arguments)||this}return V(e,n),e.prototype.run=function(){var o=this;return Promise.resolve().then(function(r){return"false"==o._sdk.host.queryHostInfo(l.sdkhost.HostInformationKey.DyadicPresent)?Promise.reject(new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Internal,"Dyadic capability is not present (is Dyadic SDK integrated?)")):o.issueDyadicRequest().then(function(h){return o.sendAssertionRequest(null,o.buildAssertionData(h)).then(function(f){var g=o.dyadicServerResponseFromAssertionResponse(f);return g?h.finalize(g).then(function(y){return f}):Promise.reject(new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Internal,"Dyadic data missing from server response"))})})}).catch(function(r){var h=t.impl.AuthenticationErrorImpl.ensureAuthenticationError(r),f={msg:h.getMessage(),code:h.getErrorCode(),data:h.getData()};return o.sendErrorReportAssertionRequest(f).finally(function(){throw r})})},e.prototype.dyadicServerResponseFromAssertionResponse=function(o){var r=o.data&&o.data.dyadic;return r&&r.server_response},e.prototype.buildAssertionData=function(o){var r={requestData:"request_data",requestPayload:"request_payload",proxyPayload:"proxy_payload"},h=o.getServerRequest();Object.keys(r).forEach(function(g){var y=r[g];h[y]=h[g],delete h[g];var A=h[y];A&&(A.original_data=A.originalData,delete A.originalData)});var f={dyadic:h};return f.dyadic.token_uid=o.getTokenId()||this._controlFlowProcessor._session.deviceId(),f},e}(u.ActionDriver),c.ActionDriverDyadic=s}(i.actiondrivers||(i.actiondrivers={}))}(t.core||(t.core={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){!function(u){!function(c){var s=function(n){function e(){return null!==n&&n.apply(this,arguments)||this}return V(e,n),e.prototype.issueDyadicRequest=function(){var o=this._action,r=this._controlFlowProcessor._session.user.guid.toString();return this._sdk.host.dyadicEnroll(r,o.server_info)},e}(c.ActionDriverDyadic);c.ActionDriverDyadicEnroll=s}(u.dyadic||(u.dyadic={}))}(i.actiondrivers||(i.actiondrivers={}))}(t.core||(t.core={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){!function(u){!function(c){var s=function(){function e(){}return e.prototype.getServerRequest=function(){return this._serverRequest},e.prototype.getTokenId=function(){return this._signHandle.getTokenId()},e.prototype.finalize=function(o){var r=this,h=o,f=this._signHandle.finalize(h.server_response);return h.otp_token_refresh&&Object.keys(h.otp_token_refresh).forEach(function(g){f=f.then(function(y){return r._refreshTokenHandles[g].finalize(h.otp_token_refresh[g])})}),f},e.create=function(o,r,h){var f=new e;return f._refreshTokenHandles=o,f._signHandle=r,f._serverRequest=h,f},e}(),n=function(e){function o(){return null!==e&&e.apply(this,arguments)||this}return V(o,e),o.prototype.issueDyadicRequest=function(){var r=this,h=this._action,f=t.util.asciiToHex(h.assertion_id+this._controlFlowProcessor.challenge),g=this._controlFlowProcessor._session.user.guid.toString();return this._sdk.host.dyadicSign(g,f).then(function(y){var A={},T=y.getServerRequest(),C=Promise.resolve(!0);return h.otp_token_uids&&0<h.otp_token_uids.length&&(T.otp_token_refresh={},h.otp_token_uids.forEach(function(E){C=C.then(function(R){return r._sdk.host.dyadicRefreshToken(E).then(function(O){return A[E]=O,T.otp_token_refresh[E]=O.getServerRequest(),!0})})})),C.then(function(E){return s.create(A,y,T)})})},o.prototype.dyadicServerResponseFromAssertionResponse=function(r){return r.data&&r.data.dyadic},o}(c.ActionDriverDyadic);c.ActionDriverDyadicSign=n}(u.dyadic||(u.dyadic={}))}(i.actiondrivers||(i.actiondrivers={}))}(t.core||(t.core={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){!function(u){!function(c){var s=function(n){function e(){return null!==n&&n.apply(this,arguments)||this}return V(e,n),e.prototype.issueDyadicRequest=function(){var o=this._controlFlowProcessor._session.user.guid.toString();return this._sdk.host.dyadicDelete(o)},e}(c.ActionDriverDyadic);c.ActionDriverDyadicDelete=s}(u.dyadic||(u.dyadic={}))}(i.actiondrivers||(i.actiondrivers={}))}(t.core||(t.core={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){!function(u){u.ActionDrivers={confirmation:u.ActionDriverConfirmation,information:u.ActionDriverInformation,json_data:u.ActionDriverJsonData,authentication:u.ActionDriverAuthentication,registration:u.ActionDriverRegistration,unregistration:u.ActionDriverUnregistration,provision_totp:u.ActionDriverProvisionTotp,disable_totp:u.ActionDriverDisableTotp,sign_content:u.ActionDriverSignContent,form:u.ActionDriverForm,registration_promotion:u.ActionDriverPromotion,scan_qr:u.ActionDriverScanQr,wait_for_ticket:u.ActionDriverTicketWait,dyadic_enroll:u.dyadic.ActionDriverDyadicEnroll,dyadic_sign:u.dyadic.ActionDriverDyadicSign,dyadic_un_enroll:u.dyadic.ActionDriverDyadicDelete,debug_break:u.ActionDriverDebugBreak,invoke_idp:u.ActionDriverInvokeIdp,provision_user_vault:u.ActionDriverProvisionUserVault,kyc:u.ActionDriverKyc,fido2_anonymous_auth:u.ActionDriverAnonymousFido2Authenticate}}(i.actiondrivers||(i.actiondrivers={}))}(t.core||(t.core={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){!function(u){var c=function(){function s(n,e,o){this._externalCancelled=!1,this._actionDriver=n,this._authenticatorConfig=e,this._authenticatorDescription=o,this._sdk=n._sdk,this._uiHandler=n._uiHandler,this._clientContext=n._clientContext}return s.prototype.runAuthentication=function(n){return this._authenticationParameters=n,this.runMode(t.AuthenticatorSessionMode.Authentication)},s.prototype.runRegistration=function(){if(this._actionDriver.isSilentRegistration){var n=this;return u.instanceOfAuthenticationDriverSilentRegistrationSupport(this)?(n._sdk.log(t.LogLevel.Debug,function(){return"Invoking silent registration for "+n._authenticatorDescription.getAuthenticatorId()}),this.runSilentRegistration()):Promise.reject(new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.AuthenticatorError,"Silent registration not supported for this authenticator"))}return this.runMode(t.AuthenticatorSessionMode.Registration)},s.prototype.runUnregistration=function(){var n=this,e=this._actionDriver;return this._sdk.currentUiHandler.handleAuthenticatorUnregistration(this._authenticatorDescription,e.isPlaceholder,e.policyAction(),this._clientContext).then(function(o){if(n._sdk.log(t.LogLevel.Debug,function(){return"handleAuthenticatorUnregistration() result: "+o}),0==o.getUserChoice())return e.sendUnregisterAssertion().then(function(h){return n.handleUnregistrationAssertionResult(h),h});var r=new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.AppImplementation,"Unregistration failed due to app implementation rejecting unregistertion.");return Promise.reject(r)})},s.prototype.onCancelRun=function(){this._externalCancelled=!0},Object.defineProperty(s.prototype,"user",{get:function(){return this._actionDriver._controlFlowProcessor._session.user},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"operationMode",{get:function(){return this._operationMode},enumerable:!1,configurable:!0}),s.prototype.terminateSession=function(){this._inputSession&&(this._inputSession.endSession(),delete this._inputSession)},s.prototype.completeAuthenticatorSessionWithResult=function(n){this.terminateSession(),this._completionFunction(n)},s.prototype.completeAuthenticatorSessionWithError=function(n){try{this.terminateSession()}catch(e){this._sdk.log(t.LogLevel.Warning,function(){return"Can't dismiss authenticator session during error reporting."})}this._rejectionFunction(n)},s.prototype.handleInputOrControlResponse=function(n){try{n.isControlRequest()?this.processControlRequest(n.getControlRequest()):null!=n.getActionEscapeRequest()?this.completeAuthenticatorSessionWithResult(new u.AuthenticationDriverSessionResultEscapeRequested(n.getActionEscapeRequest())):this._operationMode==t.AuthenticatorSessionMode.Authentication?this.handleAuthenticationInputResponse(n.getResponse()):this.handleRegistrationInputResponse(n.getResponse())}catch(e){this.performErrorRecoveryForError(t.impl.AuthenticationErrorImpl.ensureAuthenticationError(e))}},s.prototype.processRegisterAssertion=function(n,e){var o=this;this._actionDriver.sendAuthenticatorAssertionRequest(this._authenticatorDescription,"register",n,e).then(function(r){o.handleRegisterAssertionResult(r)||(o._sdk.log(t.LogLevel.Info,function(){return"Registration session done."}),o.completeAuthenticatorSessionWithResult(new u.AuthenticationDriverSessionResultAuthenticationCompleted(r)))}).catch(function(r){o._sdk.log(t.LogLevel.Error,function(){return"Perform error recovery with server error "+r}),o.performErrorRecoveryForError(r)})},s.prototype.processAuthenticateAssertion=function(n,e){var o=this;this._actionDriver.sendAuthenticatorAssertionRequest(this._authenticatorDescription,"authenticate",n,e).then(function(r){o.handleAuthenticateAssertionResult(r,o._authenticatorDescription,"authenticate",n,e)||(o._sdk.log(t.LogLevel.Info,function(){return"Authenticator session done."}),o.completeAuthenticatorSessionWithResult(new u.AuthenticationDriverSessionResultAuthenticationCompleted(r)))}).catch(function(r){o._sdk.log(t.LogLevel.Error,function(){return"Perform error recovery with server error "+r}),o.performErrorRecoveryForError(r)})},s.prototype.runMode=function(n){var e=this;return new Promise(function(o,r){if(e._completionFunction=o,e._rejectionFunction=r,e._operationMode=n,e._inputSession=e.createAuthenticatorSession(),!e._inputSession)throw t.impl.AuthenticationErrorImpl.appImplementationError("Invalid return from authenticator session creation call.");e._inputSession.startSession(e._authenticatorDescription,e._operationMode,e._actionDriver.policyAction(),e._clientContext),e.authOrRegInStartedSession(!1)}).catch(function(o){throw t.impl.AuthenticationErrorImpl.ensureAuthenticationError(o)})},s.prototype.handleGeneralAssertionResult=function(n){return this._sdk.log(t.LogLevel.Debug,function(){return"Authenticator assertion response "+JSON.stringify(n)}),n.data&&(this._sdk.log(t.LogLevel.Debug,function(){return"Processing authenticator assertion response: updating assertion authenticator description"}),this._authenticatorDescription.updateWithAssertionResult(n.data)),n.state!=i.Protocol.AuthSessionState.Pending&&(this._sdk.log(t.LogLevel.Info,function(){return"Authenticator session complete; status "+n.state}),this.completeAuthenticatorSessionWithResult(new u.AuthenticationDriverSessionResultAuthenticationCompleted(n)),!0)},s.prototype.handleUnregistrationAssertionResult=function(n){},s.prototype.handleRegisterAssertionResult=function(n){return!!this.handleGeneralAssertionResult(n)||!!n.assertion_error_code&&(this._sdk.log(t.LogLevel.Error,function(){return"handleRegisterAssertionResult() Assertion error encoutered. Starting error recovery."}),this.performErrorRecoveryForError(t.impl.AuthenticationErrorImpl.errorForAssertionResponse(n)),!0)},s.prototype.handleAuthenticateAssertionResult=function(n,e,o,r,h){if(this.handleGeneralAssertionResult(n))return!0;if(n.assertion_error_code)switch(n.assertion_error_code){case i.Protocol.AssertionErrorCode.MustRegister:return this._sdk.log(t.LogLevel.Debug,function(){return"handleAuthenticateAssertionResult() Authenticator expired; must register"}),this.handleRegistrationDueToExpiration(),!0;case i.Protocol.AssertionErrorCode.FailOver:return this._sdk.log(t.LogLevel.Debug,function(){return"handleAuthenticateAssertionResult() Failover signalled"}),this.handleFallback(),!0;default:return this._sdk.log(t.LogLevel.Error,function(){return"handleAuthenticateAssertionResult() Assertion error encoutered. Starting error recovery. 2"}),this.performErrorRecoveryForError(t.impl.AuthenticationErrorImpl.errorForAssertionResponse(n)),!0}else if(this._authenticatorDescription.getExpired())return this._sdk.log(t.LogLevel.Info,function(){return"Authenticator expired; must register"}),this.handleRegistrationDueToExpiration(),!0;return!1},s.prototype.processAuthFailureAssertionAndHandleError=function(n,e){var o=this;this._actionDriver.sendAuthenticatorAssertionRequest(this._authenticatorDescription,"auth_failure",{num_of_failures:e}).then(function(h){if(!o.handleGeneralAssertionResult(h)){if(h.assertion_error_code&&h.assertion_error_code===i.Protocol.AssertionErrorCode.FailOver)return o._sdk.log(t.LogLevel.Info,function(){return"Failover signalled during local failure report"}),o.handleFallback(),!0;n=t.impl.AuthenticationErrorImpl.augmentErrorData(n,h.data),o.performErrorRecoveryForError(n)}},function(h){var f=t.impl.AuthenticationErrorImpl.ensureAuthenticationError(h);o._sdk.log(t.LogLevel.Error,function(){return"Error ${authError} signalled during local failure report"}),o.performErrorRecoveryForError(f,!0)})},s.prototype.handleRegistrationDueToExpiration=function(){this._inputSession.changeSessionModeToRegistrationAfterExpiration(),this._operationMode=t.AuthenticatorSessionMode.Registration,this.registerInStartedSession(!1)},s.prototype.authOrRegInStartedSession=function(n){this._operationMode==t.AuthenticatorSessionMode.Authentication?this.authenticateInStartedSession(n):this.registerInStartedSession(n)},s.prototype.processControlRequest=function(n){switch(this._sdk.log(t.LogLevel.Debug,function(){return"Processing control request "+n.getRequestType()}),n.getRequestType()){case t.ControlRequestType.AbortAuthentication:this.completeAuthenticatorSessionWithError(new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.UserCanceled,"Authentication cancelled due to abort control request."));break;case t.ControlRequestType.ChangeMethod:this.completeAuthenticatorSessionWithResult(new u.AuthenticationDriverSessionResultSwitchAuthenticator(null,this.getAuthenticationActionOtherAuthenticators()));break;case t.ControlRequestType.SelectMethod:this.completeAuthenticatorSessionWithResult(new u.AuthenticationDriverSessionResultSwitchAuthenticator);break;case t.ControlRequestType.CancelAuthenticator:this.invokeUiHandlerCancellation();break;case t.ControlRequestType.RetryAuthenticator:this.authOrRegInStartedSession(!0);break;default:this.completeAuthenticatorSessionWithError(new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Internal,"Invalid ControlRequestType value during authentication session."))}},s.prototype.invokeUiHandlerCancellation=function(){var n=this;if(this._externalCancelled)this.processControlRequest(t.ControlRequest.create(t.ControlRequestType.AbortAuthentication));else{var e=[t.ControlRequestType.RetryAuthenticator,t.ControlRequestType.AbortAuthentication];this.getAuthenticationActionOtherAuthenticators().length>0&&e.push(t.ControlRequestType.ChangeMethod),this._actionDriver.availableAuthenticatorsForSwitching.length>0&&e.push(t.ControlRequestType.SelectMethod),this._uiHandler.controlOptionForCancellationRequestInSession(e,this._inputSession).then(function(o){o.getRequestType()!=t.ControlRequestType.CancelAuthenticator?e.indexOf(o.getRequestType())<0?n.completeAuthenticatorSessionWithError(new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.AppImplementation,"controlOptionForCancellationRequestInSession returned an invalid option.")):n.processControlRequest(o):n.completeAuthenticatorSessionWithError(new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.AppImplementation,"controlOptionForCancellationRequestInSession returned CancelAuthenticator which is an invalid option."))})}},s.prototype.getAuthenticationActionOtherAuthenticators=function(){var n=this;return this._actionDriver.availableAuthenticatorsForSwitching.filter(function(e){return e!=n._authenticatorDescription})},s.prototype.handleFallback=function(){var n=this;if(this._authenticatorDescription.fallback){var e=[t.AuthenticatorFallbackAction.Retry,t.AuthenticatorFallbackAction.Cancel],o=null,r=this._authenticatorDescription.fallback.method;r?(o=this._actionDriver.availableAuthenticators.filter(function(h){return h.getAuthenticatorId()==r})[0])&&e.push(t.AuthenticatorFallbackAction.Fallback):this.getAuthenticationActionOtherAuthenticators().length>0&&e.push(t.AuthenticatorFallbackAction.AuthMenu),this._uiHandler.selectAuthenticatorFallbackAction(e,o,this._inputSession,this._actionDriver.policyAction(),this._clientContext).then(function(h){switch(n._sdk.log(t.LogLevel.Debug,function(){return"Fallback action selected "+h}),e.indexOf(h)<0&&(n._sdk.log(t.LogLevel.Error,function(){return"Invalid fallback action selected: "+h+" not in "+e}),n.completeAuthenticatorSessionWithError(new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.AppImplementation,"Invalid fallback action selected by callback."))),h){case t.AuthenticatorFallbackAction.Fallback:case t.AuthenticatorFallbackAction.AuthMenu:n.completeAuthenticatorSessionWithResult(new u.AuthenticationDriverSessionResultSwitchAuthenticator(o));break;case t.AuthenticatorFallbackAction.Retry:n.authOrRegInStartedSession(!0);break;case t.AuthenticatorFallbackAction.Cancel:n.completeAuthenticatorSessionWithError(new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.UserCanceled,"User cancel in response to fallback action."))}})}else this.completeAuthenticatorSessionWithError(new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Internal,"Cannot handle a fallback error without fallback specification in action."))},s.prototype.recoveryOptionsForError=function(n,e){var o=[t.AuthenticationErrorRecovery.Fail];return[t.AuthenticationErrorCode.AllAuthenticatorsLocked,t.AuthenticationErrorCode.AppImplementation,t.AuthenticationErrorCode.ControlFlowExpired,t.AuthenticationErrorCode.SessionRequired,t.AuthenticationErrorCode.InvalidDeviceBinding,t.AuthenticationErrorCode.UserCanceled].indexOf(n.getErrorCode())>=0||(e||!this._authenticatorDescription.getEnabled()||this._operationMode==t.AuthenticatorSessionMode.Authentication&&n.getErrorCode()==t.AuthenticationErrorCode.AuthenticatorExternalConfigError||o.push(t.AuthenticationErrorRecovery.RetryAuthenticator),this.getAuthenticationActionOtherAuthenticators().length>0&&o.push(t.AuthenticationErrorRecovery.ChangeAuthenticator),this._actionDriver.availableAuthenticatorsForSwitching.length>0&&o.push(t.AuthenticationErrorRecovery.SelectAuthenticator)),o},s.prototype.performErrorRecoveryForError=function(n,e){var o=this,r=this.recoveryOptionsForError(n,e),h=this.defaultRecoveryForError(n);r.indexOf(h)<0&&(h=r.indexOf(t.AuthenticationErrorRecovery.SelectAuthenticator)>=0?t.AuthenticationErrorRecovery.SelectAuthenticator:t.AuthenticationErrorRecovery.Fail),this._inputSession.promiseRecoveryForError(n,r,h).then(function(f){o._sdk.log(t.LogLevel.Debug,function(){return"Error recovery selected "+f}),o._sdk.log(t.LogLevel.Debug,function(){return"recover from error: "+n.getErrorCode()}),r.indexOf(f)<0&&(o._sdk.log(t.LogLevel.Error,function(){return"Invalid error recovery option from callback: "+f+" not in "+r}),o.completeAuthenticatorSessionWithError(new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.AppImplementation,"Invalid error recovery action selected by callback."))),o.handleErrorRecoveryAction(f,n)})},s.prototype.handleErrorRecoveryAction=function(n,e){switch(n){case t.AuthenticationErrorRecovery.RetryAuthenticator:this.authOrRegInStartedSession(!0);break;case t.AuthenticationErrorRecovery.ChangeAuthenticator:this.completeAuthenticatorSessionWithResult(new u.AuthenticationDriverSessionResultSwitchAuthenticator(null,this.getAuthenticationActionOtherAuthenticators()));break;case t.AuthenticationErrorRecovery.SelectAuthenticator:this.completeAuthenticatorSessionWithResult(new u.AuthenticationDriverSessionResultSwitchAuthenticator);break;default:this.completeAuthenticatorSessionWithError(e)}},s.prototype.defaultRecoveryForError=function(n){return this._operationMode==t.AuthenticatorSessionMode.Authentication?!this._authenticatorDescription.getLocked()&&this._authenticatorDescription.getRegistered()&&this._authenticatorDescription.getEnabled()&&n.getErrorCode()!=t.AuthenticationErrorCode.AuthenticatorLocked&&n.getErrorCode()!=t.AuthenticationErrorCode.AllAuthenticatorsLocked?t.AuthenticationErrorRecovery.RetryAuthenticator:n.getErrorCode()!=t.AuthenticationErrorCode.AllAuthenticatorsLocked?t.AuthenticationErrorRecovery.ChangeAuthenticator:t.AuthenticationErrorRecovery.Fail:t.AuthenticationErrorRecovery.RetryAuthenticator},s}();u.AuthenticationDriver=c}(i.authenticationdrivers||(i.authenticationdrivers={}))}(t.core||(t.core={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){!function(u){var c=function(s){function n(e,o,r){return s.call(this,e,o,r)||this}return V(n,s),n.prototype.authenticateInStartedSession=function(e){var o=this;this._inputSession.promiseInput().then(function(r){return o.handleInputOrControlResponse(r)},function(r){return o.completeAuthenticatorSessionWithError(t.impl.AuthenticationErrorImpl.ensureAuthenticationError(r))})},n.prototype.registerInStartedSession=function(e){var o=this;this._inputSession.promiseInput().then(function(r){return o.handleInputOrControlResponse(r)},function(r){return o.completeAuthenticatorSessionWithError(t.impl.AuthenticationErrorImpl.ensureAuthenticationError(r))})},n.prototype.handleAuthenticationInputResponse=function(e){var o;try{o=this.generateAssertionDataForInputResponse(e)}catch(r){return void this.performErrorRecoveryForError(t.impl.AuthenticationErrorImpl.ensureAuthenticationError(r))}this.processAuthenticateAssertion(o)},n.prototype.handleRegistrationInputResponse=function(e){try{var o=this.generateAssertionDataForInputResponse(e)}catch(r){return void this.performErrorRecoveryForError(t.impl.AuthenticationErrorImpl.ensureAuthenticationError(r))}this.processRegisterAssertion(o)},n.prototype.generateAssertionDataForInputResponse=function(e){return{secret:this.generateSecretToSignForInputResponse(e)}},n}(u.AuthenticationDriver);u.AuthenticationDriverCentralizedSecretInputBased=c}(i.authenticationdrivers||(i.authenticationdrivers={}))}(t.core||(t.core={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){!function(u){var c=function(){function s(n){this._authenticationDriverCtor=n}return s.prototype.createAuthenticationDriver=function(n,e,o){return new this._authenticationDriverCtor(n,e,o)},s.prototype.evaluateLocalRegistrationStatus=function(n){return t.AuthenticatorRegistrationStatus.Registered},s.prototype.isSupportedOnDevice=function(n){return!0},s.prototype.suggestParameters=function(n,e){return[]},s.refreshInvalidatedAuthenticatorsEnrollments=function(n){return new Promise(function(e,o){var h=new Array;for(var f in n.user.localEnrollments)h.push(u.AuthenticatorDrivers[n.user.localEnrollments[f].authenticatorId].checkAuthenticatorInvalidatedAndNotifyUIHandler(n));Promise.all(h).then(function(y){e(y)}).catch(function(y){o(y)})})},s.prototype.checkAuthenticatorInvalidatedAndNotifyUIHandler=function(n){return Promise.resolve(!0)},s}();u.SimpleAuthenticationDriverDescriptor=c}(i.authenticationdrivers||(i.authenticationdrivers={}))}(t.core||(t.core={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){!function(u){var c=function(n){function e(){return null!==n&&n.apply(this,arguments)||this}return V(e,n),e.prototype.getEnabled=function(){return this.getSupportedOnDevice()},e.getDescription=function(o,r){return new e(o,r,{},{status:i.Protocol.AuthenticationMethodStatus.Unregistered})},e}(u.AuthenticatorDescriptionImpl),s=function(n){function e(o,r){var h=n.call(this,o)||this;return h._authenticatorType=r,h}return V(e,n),e.prototype.evaluateLocalRegistrationStatus=function(o){var r=o.user.localEnrollments[this._authenticatorType];return r?r.validationStatus==i.LocalEnrollmentValidationStatus.Invalidated?t.AuthenticatorRegistrationStatus.LocallyInvalid:t.AuthenticatorRegistrationStatus.Registered:t.AuthenticatorRegistrationStatus.LocallyInvalid},e.prototype.checkAuthenticatorInvalidatedAndNotifyUIHandler=function(o){var r=this;return new Promise(function(h,f){o.sdk.log(t.LogLevel.Info,function(){return"Checking if authenticator "+r._authenticatorType+" has become invalidated."});var g=o.user.localEnrollments[r._authenticatorType];if(g.status==i.LocalEnrollmentStatus.Registered&&g.validationStatus!=i.LocalEnrollmentValidationStatus.Invalidated)if(u.AuthenticatorDrivers[r._authenticatorType].evaluateLocalRegistrationStatus(o)==t.AuthenticatorRegistrationStatus.LocallyInvalid){o.sdk.log(t.LogLevel.Info,function(){return"Authenticator "+r._authenticatorType+" already became invalidated. Invalidating enrollment record and notifying ui handler."});var y=c.getDescription(o,g.authenticatorId);i.LocalEnrollment.invalidateLocalRegistrationStatusAndNotifyUIHandler(o.getCurrentUserInteractionSessionProvider(),y).then(function(A){h(A)}).catch(function(A){f(A)})}else h(!1);else h(!1)})},e}(u.SimpleAuthenticationDriverDescriptor);u.AuthenticationDriverDescriptorLocal=s}(i.authenticationdrivers||(i.authenticationdrivers={}))}(t.core||(t.core={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){!function(u){var c=function(s){function n(){return s.call(this,u.AuthenticationDriverDeviceBiometrics,n.authenticatorName)||this}return V(n,s),n.prototype.evaluateLocalRegistrationStatus=function(e){var o=s.prototype.evaluateLocalRegistrationStatus.call(this,e);if(o!=t.AuthenticatorRegistrationStatus.Registered)return o;var r=e.user.localEnrollments[n.authenticatorName],h=u.AuthenticationDriverDeviceBiometrics.authenticatorKeyTagForUser(e.user,r.version,r.salt),f=e.sdk.host.getKeyPair(h,l.sdkhost.KeyClass.HardwareProtectedSignAndEncryptKey,l.sdkhost.KeyBiometricProtectionMode.BindToEnrollmentDb);return f?(f.closeKeyPair(),t.AuthenticatorRegistrationStatus.Registered):t.AuthenticatorRegistrationStatus.LocallyInvalid},n.prototype.isSupportedOnDevice=function(e){var o=e.sdk.host.queryHostInfo(l.sdkhost.HostInformationKey.DeviceBiometricsSupported);return!!o&&"false"!=o},n.authenticatorName="device_biometrics",n}(u.AuthenticationDriverDescriptorLocal);u.AuthenticationDriverDescriptorDeviceBiometrics=c}(i.authenticationdrivers||(i.authenticationdrivers={}))}(t.core||(t.core={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){!function(u){var c=function(s){function n(){return s.call(this,u.AuthenticationDriverFace)||this}return V(n,s),n.prototype.isSupportedOnDevice=function(e){return"true"==e.sdk.host.queryHostInfo(l.sdkhost.HostInformationKey.ImageAcquitisionSupported)},n}(u.SimpleAuthenticationDriverDescriptor);u.AuthenticationDriverDescriptorFace=c}(i.authenticationdrivers||(i.authenticationdrivers={}))}(t.core||(t.core={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){!function(u){var c=function(s){function n(e){var o=s.call(this,u.AuthenticationDriverFido)||this;return o._fidoPolicy=e,o}return V(n,s),n.prototype.isSupportedOnDevice=function(e){var o=this;e.sdk.log(t.LogLevel.Debug,function(){return"Check FIDO authenticator support for "+JSON.stringify(o._fidoPolicy)});var r=u.AuthenticationDriverFido.hasEligibleClientProvidersForPolicy(e.sdk,this._fidoPolicy);return r||e.sdk.log(t.LogLevel.Info,function(){return"Encountered non-supported FIDO request."}),r},n.prototype.evaluateLocalRegistrationStatus=function(e){return t.AuthenticatorRegistrationStatus.Registered},n}(u.SimpleAuthenticationDriverDescriptor);u.AuthenticationDriverDescriptorFido=c}(i.authenticationdrivers||(i.authenticationdrivers={}))}(t.core||(t.core={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){!function(u){var c=function(s){function n(){return null!==s&&s.apply(this,arguments)||this}return V(n,s),n.prototype.isSupportedOnDevice=function(e){return"true"===e.sdk.host.queryHostInfo(l.sdkhost.HostInformationKey.Fido2ClientPresent)},n}(u.SimpleAuthenticationDriverDescriptor);u.AuthenticationDriverDescriptorFido2=c}(i.authenticationdrivers||(i.authenticationdrivers={}))}(t.core||(t.core={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){!function(u){var c=function(s){function n(){return s.call(this,u.AuthenticationDriverFingerprint,n.authenticatorName)||this}return V(n,s),n.prototype.evaluateLocalRegistrationStatus=function(e){var o=s.prototype.evaluateLocalRegistrationStatus.call(this,e);if(o!=t.AuthenticatorRegistrationStatus.Registered)return o;var r=e.user.localEnrollments[n.authenticatorName],h=u.AuthenticationDriverFingerprint.authenticatorKeyTagForUser(e.user,r.version,r.salt),f=e.sdk.host.getKeyPair(h,l.sdkhost.KeyClass.StdSigningKey,l.sdkhost.KeyBiometricProtectionMode.BindToEnrollmentDb);return f?(f.closeKeyPair(),t.AuthenticatorRegistrationStatus.Registered):t.AuthenticatorRegistrationStatus.LocallyInvalid},n.prototype.isSupportedOnDevice=function(e){return"true"==e.sdk.host.queryHostInfo(l.sdkhost.HostInformationKey.FingerprintSupported)},n.authenticatorName="fingerprint",n}(u.AuthenticationDriverDescriptorLocal);u.AuthenticationDriverDescriptorFingerprint=c}(i.authenticationdrivers||(i.authenticationdrivers={}))}(t.core||(t.core={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){!function(u){var c=function(){function n(e,o){this._targetIdentifier=e,this._description=o.describe(),this._deviceDetails=o}return n.prototype.getDescription=function(){return this._description},n.prototype.getDeviceIdentifier=function(){return this._targetIdentifier},n.prototype.getDeviceDetails=function(){return this._deviceDetails},n.__tarsusInterfaceName="MobileApproveTarget",n}();u.MobileApproveTargetImpl=c;var s=function(){function n(){}return n.prototype.evaluateLocalRegistrationStatus=function(e){return t.AuthenticatorRegistrationStatus.Registered},n.prototype.isSupportedOnDevice=function(e){return!0},n.prototype.suggestParameters=function(e,o){return n.createTargetsFromConfig(e).map(function(r){return t.AuthenticationActionParameterTargetSelection.create(r)})},n.prototype.createAuthenticationDriver=function(e,o,r){return new u.AuthenticationDriverMobileApprove(e,o,r)},n.createTargetsFromConfig=function(e){return e.selectable_devices.map(function(o,r){var h=t.TargetDeviceDetailsImpl.fromServerFormat(o);return new c(o.device_id,h)})},n.prototype.checkAuthenticatorInvalidatedAndNotifyUIHandler=function(e){return Promise.resolve(!0)},n}();u.AuthenticationDriverDescriptorMobileApprove=s}(i.authenticationdrivers||(i.authenticationdrivers={}))}(t.core||(t.core={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){!function(u){var c=function(s){function n(){return s.call(this,u.AuthenticationDriverNativeFace,n.authenticatorName)||this}return V(n,s),n.prototype.evaluateLocalRegistrationStatus=function(e){var o=s.prototype.evaluateLocalRegistrationStatus.call(this,e);if(o!=t.AuthenticatorRegistrationStatus.Registered)return o;var r=e.user.localEnrollments[n.authenticatorName],h=u.AuthenticationDriverNativeFace.authenticatorKeyTagForUser(e.user,r.version,r.salt),f=e.sdk.host.getKeyPair(h,l.sdkhost.KeyClass.StdSigningKey,l.sdkhost.KeyBiometricProtectionMode.BindToEnrollmentDb);return f?(f.closeKeyPair(),t.AuthenticatorRegistrationStatus.Registered):t.AuthenticatorRegistrationStatus.LocallyInvalid},n.prototype.isSupportedOnDevice=function(e){return"true"==e.sdk.host.queryHostInfo(l.sdkhost.HostInformationKey.FaceIdKeyBioProtectionSupported)},n.authenticatorName="face_id",n}(u.AuthenticationDriverDescriptorLocal);u.AuthenticationDriverDescriptorNativeFace=c}(i.authenticationdrivers||(i.authenticationdrivers={}))}(t.core||(t.core={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){!function(u){var c=function(){function n(e,o,r,h,f,g){this._channelIndex=e,this._channelAssertionId=o,this._targetIdentifier=r,this._description=h,this._channel=f,this._deviceDetails=g}return n.prototype.getDescription=function(){return this._description},n.prototype.getChannel=function(){return this._channel},n.prototype.getTargetIdentifier=function(){return this._targetIdentifier},n.prototype.getChannelAssertionId=function(){return this._channelAssertionId},n.prototype.getChannelIndex=function(){return this._channelIndex},n.prototype.getDeviceDetails=function(){return this._deviceDetails},n.__tarsusInterfaceName="OtpTarget",n}();u.OtpTargetImpl=c;var s=function(){function n(){}return n.prototype.evaluateLocalRegistrationStatus=function(e){return t.AuthenticatorRegistrationStatus.Registered},n.prototype.isSupportedOnDevice=function(e){return!0},n.prototype.suggestParameters=function(e,o){return this.createTargetsFromConfig(e).map(function(r){return t.AuthenticationActionParameterTargetSelection.create(r)})},n.prototype.createAuthenticationDriver=function(e,o,r){var h=this.createTargetsFromConfig(o);return new u.AuthenticationDriverOtp(e,o,h,r)},n.prototype.createTargetsFromConfig=function(e){return e.channels.map(function(o){var r;switch(o.type){case i.Protocol.AuthenticationMethodOtpChannelType.Email:r=t.OtpChannel.Email;break;case i.Protocol.AuthenticationMethodOtpChannelType.Sms:r=t.OtpChannel.Sms;break;case i.Protocol.AuthenticationMethodOtpChannelType.Voice:r=t.OtpChannel.VoiceCall;break;case i.Protocol.AuthenticationMethodOtpChannelType.Push:r=t.OtpChannel.PushNotification;break;default:r=t.OtpChannel.Unknown}return!o.targets&&o.target&&(o.targets={},o.targets[0]=o.target),o.targets||(o.targets={}),Object.keys(o.targets).map(function(h,f){var g=o.targets[h];if(r===t.OtpChannel.PushNotification){var A=t.TargetDeviceDetailsImpl.fromServerFormat(g);return new c(f,o.assertion_id,h,A.describe(),r,A)}return new c(f,o.assertion_id,h,g,r,null)})}).reduce(function(o,r){return o.concat(r)},[])},n.prototype.checkAuthenticatorInvalidatedAndNotifyUIHandler=function(e){return Promise.resolve(!0)},n}();u.AuthenticationDriverDescriptorOtp=s}(i.authenticationdrivers||(i.authenticationdrivers={}))}(t.core||(t.core={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){!function(u){var c=function(){function n(e,o){this._targetIdentifier=e,this._description=o.describe(),this._deviceDetails=o}return n.prototype.getDescription=function(){return this._description},n.prototype.getDeviceIdentifier=function(){return this._targetIdentifier},n.prototype.getDeviceDetails=function(){return this._deviceDetails},n.__tarsusInterfaceName="TotpTarget",n}();u.TotpTargetImpl=c;var s=function(){function n(){}return n.prototype.evaluateLocalRegistrationStatus=function(e){return t.AuthenticatorRegistrationStatus.Registered},n.prototype.isSupportedOnDevice=function(e){return!0},n.prototype.suggestParameters=function(e,o){return n.createTargetsFromConfig(e).map(function(r){return t.AuthenticationActionParameterTargetSelection.create(r)})},n.prototype.createAuthenticationDriver=function(e,o,r){return new u.AuthenticationDriverTotp(e,o,r)},n.createTargetsFromConfig=function(e){return e.selectable_devices?e.selectable_devices.map(function(r,h){var f=t.TargetDeviceDetailsImpl.fromServerFormat(r);return new c(r.device_id,f)}):[]},n.prototype.checkAuthenticatorInvalidatedAndNotifyUIHandler=function(e){return Promise.resolve(!0)},n}();u.AuthenticationDriverDescriptorTotp=s}(i.authenticationdrivers||(i.authenticationdrivers={}))}(t.core||(t.core={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){!function(u){var c=function(s){function n(){return s.call(this,u.AuthenticationDriverVoice)||this}return V(n,s),n.prototype.isSupportedOnDevice=function(e){return"true"==e.sdk.host.queryHostInfo(l.sdkhost.HostInformationKey.AudioAcquitisionSupported)},n}(u.SimpleAuthenticationDriverDescriptor);u.AuthenticationDriverDescriptorVoice=c}(i.authenticationdrivers||(i.authenticationdrivers={}))}(t.core||(t.core={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){!function(u){var c=function(s){function n(e,o,r){return s.call(this,e,o,r)||this}return V(n,s),Object.defineProperty(n.prototype,"lastObtainedKeyPair",{get:function(){return this._lastObtainedKeyPair},set:function(e){this._lastObtainedKeyPair&&this._lastObtainedKeyPair!=e&&this._lastObtainedKeyPair.closeKeyPair(),this._lastObtainedKeyPair=e},enumerable:!1,configurable:!0}),n.prototype.completeAuthenticatorSessionWithResult=function(e){this.operationMode===t.AuthenticatorSessionMode.Registration&&e instanceof u.AuthenticationDriverSessionResultAuthenticationCompleted&&(!e.assertionResult.assertion_error_code||e.assertionResult.assertion_error_code===i.Protocol.AssertionErrorCode.AssertionContainerNotComplete)&&(this._enrollmentRecordToCommit?(this._sdk.log(t.LogLevel.Debug,function(){return"Updating local enrollment record on registration"}),this.user.updateEnrollmentRecord(this._enrollmentRecordToCommit)):this._sdk.log(t.LogLevel.Warning,function(){return"No enrollment record to update."})),this._enrollmentRecordToCommit=null,this.lastObtainedKeyPair=null,s.prototype.completeAuthenticatorSessionWithResult.call(this,e)},n.prototype.completeAuthenticatorSessionWithError=function(e){this.lastObtainedKeyPair=null,s.prototype.completeAuthenticatorSessionWithError.call(this,e)},n.prototype.registerInStartedSession=function(e){this._enrollmentRecordToCommit=null},n.prototype.calculateAssertionFieldsWithAuthenticatorKey=function(e){var o=this;return new Promise(function(r,h){var f=t.util.asciiToHex(o.localAuthenticatorChallenge());e.signHex(f).then(function(g){return{fch:t.util.hexToBase64(g)}}).then(r,h)})},n.prototype.handleAuthenticationInputResponse=function(e){var o=this,r=this.user.localEnrollments[this.authenticatorType];r||this.performErrorRecoveryForError(new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.NoRegisteredAuthenticator,"Missing key for "+this.authenticatorType+" authenticator")),this.getKeyForEnrollmentDataAndInput(r,e).then(function(h){return o._sdk.log(t.LogLevel.Debug,function(){return"Local authenticator key obtained; signing challenge"}),o.addRolloverDataIfNeeded(h,r,e).then(function(f){return o._externalCancelled?Promise.reject(o._actionDriver._controlFlowProcessor.createExternalCancellationError()):(o.lastObtainedKeyPair=f.key,o.calculateAssertionFieldsWithAuthenticatorKey(f.key).then(function(g){var y={};if(f.rolloverKeyData){o._sdk.log(t.LogLevel.Info,function(){return"Local authenticator rollover requested"});var A={};f.rolloverKeyData.key&&(A.key=f.rolloverKeyData.key.publicKeyToJson(),A.version=f.rolloverKeyData.schemeVersion),f.rolloverReason&&(A.reason=f.rolloverReason),f.rolloverOldKeyHash&&(A.expired_key={hash:f.rolloverOldKeyHash}),y.rollover=A,o._enrollmentRecordToCommit=r.duplicate(),o._enrollmentRecordToCommit.status=i.LocalEnrollmentStatus.Registered,o._enrollmentRecordToCommit.validationStatus=i.LocalEnrollmentValidationStatus.Validated,o._enrollmentRecordToCommit.salt=f.rolloverKeyData.salt,o._enrollmentRecordToCommit.version=f.rolloverKeyData.schemeVersion,o._enrollmentRecordToCommit.keyMaterial=f.rolloverKeyData.keyMeterial,o._enrollmentRecordToCommit.cryptoSettings=o._sdk.cryptoSettings,o._enrollmentRecordToCommit.authenticatorConfig=f.rolloverKeyData.authenticatorConfig,o._enrollmentRecordToCommit.publicKeyHash=t.util.calcPublicKeyHexStringEncodedSha256Hash(f.rolloverKeyData.key,o._sdk)}o.processAuthenticateAssertion(y,g)},function(g){return Promise.reject(g)}))}).catch(function(f){o.processLocalAuthenticatorError(t.impl.AuthenticationErrorImpl.ensureAuthenticationError(f))})}).catch(function(h){o.processLocalAuthenticatorError(t.impl.AuthenticationErrorImpl.ensureAuthenticationError(h))})},n.prototype.addRolloverDataIfNeeded=function(e,o,r){var h=this;if(this.rolloverNeeded(o)){var f=this.getRolloverReason(o);return this._sdk.log(t.LogLevel.Debug,function(){return"AuthenticatorKeyRoll: "+f}),this.generatePendingEnrollment(r,!0).then(function(g){return e.rolloverKeyData=g,e.rolloverReason=f,e.rolloverOldKeyHash=o.publicKeyHash?o.publicKeyHash:t.util.calcPublicKeyHexStringEncodedSha256Hash(e.key,h._sdk),Promise.resolve(e)})}return Promise.resolve(e)},n.prototype.getNewOrUpdatedEnrollmentRecord=function(e){var o=this;this._sdk.log(t.LogLevel.Debug,function(){return"Register "+o.authenticatorType+": fetching local enrollment record"});var r=this.user.localEnrollments[this.authenticatorType],h=t.util.calcPublicKeyHexStringEncodedSha256Hash(e.key,this._sdk);return r||(this._sdk.log(t.LogLevel.Debug,function(){return"Register "+o.authenticatorType+": Generating new local enrollment record"}),r=this.user.createEnrollmentRecord(this.authenticatorType,e.schemeVersion,e.salt,i.LocalEnrollmentStatus.Unregistered,h)),r.status=i.LocalEnrollmentStatus.Registered,r.validationStatus=i.LocalEnrollmentValidationStatus.Validated,r.salt=e.salt,r.version=e.schemeVersion,r.cryptoSettings=this._sdk.cryptoSettings,r.publicKeyHash=h,r.keyMaterial=e.keyMeterial,r.authenticatorConfig=e.authenticatorConfig,r},n.prototype.handleRegistrationInputResponse=function(e){var o=this;this._sdk.log(t.LogLevel.Debug,function(){return"Register "+o.authenticatorType+": Generating pending enrollment data"}),this.generatePendingEnrollment(e).then(function(r){return o.handleRegisterAssertion(r)}).catch(function(r){o.processLocalAuthenticatorError(t.impl.AuthenticationErrorImpl.ensureAuthenticationError(r))})},n.prototype.handleRegisterAssertion=function(e){var o=this;return this._sdk.log(t.LogLevel.Debug,function(){return"Register "+o.authenticatorType+": Signing registration assertion"}),this.calculateAssertionFieldsWithAuthenticatorKey(e.key).then(function(r){o._sdk.log(t.LogLevel.Debug,function(){return"Register "+o.authenticatorType+": Preparing registration assertion"});var h=o.getNewOrUpdatedEnrollmentRecord(e);if(o._enrollmentRecordToCommit=h,o._externalCancelled)return Promise.reject(o._actionDriver._controlFlowProcessor.createExternalCancellationError());o.lastObtainedKeyPair=e.key;var f=At({public_key:e.key.publicKeyToJson(),version:e.schemeVersion},r);o.processRegisterAssertion(null,f)},function(r){return Promise.reject(r)})},n.prototype.handleRegisterAssertionResult=function(e){return e.data&&e.data.update_vaults&&i.vault.MultiCredsVault.updateVaultsProtectingCreds(this.user,e.data.update_vaults,this._uiHandler,this._sdk),s.prototype.handleRegisterAssertionResult.call(this,e)},n.prototype.handleUnregistrationAssertionResult=function(e){var o=this,r=this.user.localEnrollments[this.authenticatorType];r?(r.status=i.LocalEnrollmentStatus.Unregistered,this.user.updateEnrollmentRecord(r),this.unregisterEnrollmentAssets(r)):this._sdk.log(t.LogLevel.Warning,function(){return"Failed to find enrollment record for "+o.authenticatorType}),e.data&&e.data.update_vaults&&i.vault.MultiCredsVault.updateVaultsProtectingCreds(this.user,e.data.update_vaults,this._uiHandler,this._sdk),s.prototype.handleUnregistrationAssertionResult.call(this,e)},n.prototype.handleAuthenticateAssertionResult=function(e,o,r,h,f){if(this._enrollmentRecordToCommit)if(e.assertion_error_code){if(e.assertion_error_code==i.Protocol.AssertionErrorCode.AckRequired)return this.user.updateEnrollmentRecord(this._enrollmentRecordToCommit),e.data&&e.data.update_vaults&&i.vault.MultiCredsVault.updateVaultsProtectingCreds(this.user,e.data.update_vaults,this._uiHandler,this._sdk),this.processRolloverAckAssertionRequest(this._enrollmentRecordToCommit.publicKeyHash,f),this._enrollmentRecordToCommit=null,!0}else this._sdk.log(t.LogLevel.Debug,function(){return"Pending commit for enrollment; checking rollover status."}),e.data&&e.data.rollover&&0==e.data.rollover.code?(this._sdk.log(t.LogLevel.Info,function(){return"Updating local enrollment record on authentication result"}),this.user.updateEnrollmentRecord(this._enrollmentRecordToCommit)):this._sdk.log(t.LogLevel.Error,function(){return"Received a rollover failure response from the server; aboting rollover."});return this._enrollmentRecordToCommit=null,s.prototype.handleAuthenticateAssertionResult.call(this,e,o,r,h,f)},n.prototype.processRolloverAckAssertionRequest=function(e,o){this._sdk.log(t.LogLevel.Info,function(){return"AuthenticatorKeyRollover: Processing ack assertion request..."}),o&&o.fch?this.processAuthenticateAssertion({rollover_ack:{hash:e}},{fch:o.fch}):this.completeAuthenticatorSessionWithError(new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Internal,"Invalid assertion fields - missing fch"))},n.prototype.processLocalAuthenticatorError=function(e){this.performErrorRecoveryForError(e)},n.prototype.localAuthenticatorChallenge=function(){return this._actionDriver._controlFlowProcessor.challenge+this._authenticatorDescription.assertionId},n.prototype.getAuthenticatorEnrollmentConfig=function(){return null},n.prototype.onCancelRun=function(){s.prototype.onCancelRun.call(this),this.lastObtainedKeyPair&&(this.lastObtainedKeyPair=null)},n.prototype.shouldAllowBiometricFallbackButton=function(e){var o=this;if(!e)return!1;var r=this._actionDriver.availableAuthenticatorsForSwitching.filter(function(y){return y!=o._authenticatorDescription});if(this._actionDriver instanceof i.actiondrivers.ActionDriverRegistration||this._actionDriver instanceof i.actiondrivers.ActionDriverAuthentication&&0==r.length)return!1;var h=e,f=h.getFallbackButtonTitle();if(!(f&&f.length>0))return!1;var g=h.getFallbackControlRequestType();switch(null==g&&(g=t.ControlRequestType.SelectMethod),g){case t.ControlRequestType.ChangeMethod:case t.ControlRequestType.SelectMethod:return this._actionDriver.availableAuthenticators.length>1;default:return!0}},n.prototype.publicKeyExpired=function(e){var o=this;if(!this._authenticatorConfig.public_key_expired)return!1;var r=e===this._authenticatorConfig.public_key_expired.hash;return this._sdk.log(t.LogLevel.Debug,function(){return"AuthenticatorKeyRoll: authenticator "+o.authenticatorType+" \n                                                key hash matching expired key hash received from server: "+r}),r},n.prototype.getRolloverReason=function(e){return this.publicKeyExpired(e.publicKeyHash)?"Rollover of "+this.authenticatorType+" authenticator public key due to expiration":"Upgrading "+this.authenticatorType+" authenticator scheme from "+e.version+" to "+this.currentScheme},n.prototype.rolloverNeeded=function(e){return this.publicKeyExpired(e.publicKeyHash)||this.schemeVersionRequiresRollover(e.version)},n}(u.AuthenticationDriver);u.AuthenticationDriverLocal=c}(i.authenticationdrivers||(i.authenticationdrivers={}))}(t.core||(t.core={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){!function(u){u.instanceOfAuthenticationDriverSilentRegistrationSupport=function(c){return c.runSilentRegistration}}(i.authenticationdrivers||(i.authenticationdrivers={}))}(t.core||(t.core={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){!function(u){var c=function(s){function n(){return null!==s&&s.apply(this,arguments)||this}return V(n,s),n.prototype.unregisterEnrollmentAssets=function(e){var o=this.authenticatorKeyTagForScheme(e.version,e.salt);this._sdk.host.deleteKeyPair(o)},n.prototype.invokeCancellationUiOrEscape=function(){var e=this._actionDriver._policyAction.getEscapeOptions().filter(function(r){return r.getPresentation()==p.ts.mobile.sdk.ActionEscapeOptionPresentation.Cancel})[0];if(e){this._sdk.log(t.LogLevel.Debug,function(){return"Got cancel escape option; responding with that."});var o=new t.ActionEscapeRequest;o._escapeOption=e,o._escapeParameters=null,this.completeAuthenticatorSessionWithResult(new u.AuthenticationDriverSessionResultEscapeRequested(o))}else this._sdk.log(t.LogLevel.Debug,function(){return"Invoking UI cancellation handler."}),this.invokeUiHandlerCancellation()},n}(u.AuthenticationDriverLocal);u.AuthenticationDriverLocalPersistentKeyPairBased=c}(i.authenticationdrivers||(i.authenticationdrivers={}))}(t.core||(t.core={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){!function(u){var c=function(s){function n(){return null!==s&&s.apply(this,arguments)||this}return V(n,s),n.prototype.schemeVersionRequiresRollover=function(e){return"v0"==e||"v1"==e||"v2"==e&&"true"!=this._sdk.host.queryHostInfo(l.sdkhost.HostInformationKey.StdSigningKeyIsHardwareProtectedSignAndEncryptKey)},n}(u.AuthenticationDriverLocalPersistentKeyPairBased);u.AuthenticationDriverLocalPersistentKeyPairBasedPostV2Scheme=c}(i.authenticationdrivers||(i.authenticationdrivers={}))}(t.core||(t.core={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){var u=function(){function c(){}return c.deviceBiometricInput=function(s,n){var e=c.newBiometricPromptInfo();return e.setLocalizedTitle(s.getTitle()),e.setLocalizedSubtitle(s.getSubtitle()),e.setLocalizedPrompt(s.getPrompt()),e.setCancelButtonTitle(s.getCancelButtonTitle()),e.setRequireConfirmation(!n||void 0===n.require_confirmation||n.require_confirmation),e},c.fingerprintInput=function(s){var n=c.newBiometricPromptInfo();n.setLocalizedPrompt(s.getPrompt());var e=s.getCancelButtonTitle();e&&0<e.length&&n.setCancelButtonTitle(e);var o=s.getFallbackButtonTitle();return o&&0<o.length&&n.setFallbackButtonTitle(o),n},c.nativeFaceInput=function(s){var n=c.newBiometricPromptInfo();n.setLocalizedPrompt(s.getPrompt());var e=s.getCancelButtonTitle();e&&0<e.length&&n.setCancelButtonTitle(e);var o=s.getFallbackButtonTitle();return o&&0<o.length&&n.setFallbackButtonTitle(o),n},c.newBiometricPromptInfo=function(){var s=new l.sdkhost.BiometricPromptInfo;return s.setCancelButtonTitle(null),s.setFallbackButtonTitle(null),s.setLocalizedPrompt(null),s.setLocalizedSubtitle(null),s.setLocalizedTitle(null),s},c}();i.BiometricPromptInfoFrom=u}(t.util||(t.util={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){!function(u){var c=function(s){function n(e,o,r){return s.call(this,e,o,r)||this}return V(n,s),n.authenticatorKeySchemeForMigratedEnrollment=function(e){if(0===e.indexOf("v0")){var o=e.split("_");return 1<o.length?o[1]:"v3"}return null},n.authenticatorKeyTagForUserForMigratedEnrollment=function(e,o,r){var h=n.authenticatorKeySchemeForMigratedEnrollment(o);return h?u.AuthenticationDriverFingerprint.authenticatorKeyTagForUser(e,h,r):null},n.authenticatorKeyTagForUser=function(e,o,r){return n.authenticatorKeyTagForUserForMigratedEnrollment(e,o,r)||new i.TarsusKeyPath("per_user",e.guid.toString(),"local_auth_keys",u.AuthenticationDriverDescriptorDeviceBiometrics.authenticatorName,o,r)},n.prototype.schemeVersionRequiresRollover=function(e){var o=n.authenticatorKeySchemeForMigratedEnrollment(e);return!(!o||!s.prototype.schemeVersionRequiresRollover.call(this,o))},Object.defineProperty(n.prototype,"signChallengeMode",{get:function(){var e=this._sdk.host.queryHostInfo(l.sdkhost.HostInformationKey.DeviceBiometricsUsesSign);return!!e&&"true"==e},enumerable:!1,configurable:!0}),n.prototype.runSilentRegistration=function(){var e=this;return this.generateAuthenticatorKey().then(function(o){var r=e.getNewOrUpdatedEnrollmentRecord(o),h={public_key:o.key.publicKeyToJson(),encrypted_challenge_mode:!e.signChallengeMode,version:o.schemeVersion};return e._actionDriver.sendAuthenticatorAssertionRequest(e._authenticatorDescription,"register",null,h).then(function(f){if(f.assertion_error_code)throw t.impl.AuthenticationErrorImpl.errorForAssertionResponse(f);return e.user.updateEnrollmentRecord(r),new u.AuthenticationDriverSessionResultAuthenticationCompleted(f)})})},n.prototype.createAuthenticatorSession=function(){return this._sdk.log(t.LogLevel.Debug,function(){return"Create DSA session."}),this._uiHandler.createDeviceBiometricsAuthSession(u.AuthenticationDriverDescriptorDeviceBiometrics.authenticatorName,this.user.displayName)},n.prototype.authenticateInStartedSession=function(e){var o=this;this._inputSession.promiseInput().then(function(r){return o.handleInputOrControlResponse(r)},function(r){return o.completeAuthenticatorSessionWithError(t.impl.AuthenticationErrorImpl.ensureAuthenticationError(r))})},n.prototype.registerInStartedSession=function(e){var o=this;this._sdk.log(t.LogLevel.Debug,function(){return"Register DSA in started session."}),s.prototype.registerInStartedSession.call(this,e),this._inputSession.promiseInput().then(function(r){return o.handleInputOrControlResponse(r)},function(r){return o.completeAuthenticatorSessionWithError(t.impl.AuthenticationErrorImpl.ensureAuthenticationError(r))})},n.prototype.handleRegistrationInputResponse=function(e){var o=this;this._sdk.log(t.LogLevel.Debug,function(){return"Register "+o.authenticatorType+": Generating pending enrollment data"}),this.getNewPendingEnrollmentOrReuse(e).then(function(r){return o._pendingEnrollmentData=r,o.handleRegisterAssertion(r)}).catch(function(r){o.processLocalAuthenticatorError(t.impl.AuthenticationErrorImpl.ensureAuthenticationError(r))})},Object.defineProperty(n.prototype,"authenticatorType",{get:function(){return u.AuthenticationDriverDescriptorDeviceBiometrics.authenticatorName},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"currentScheme",{get:function(){return"v1"},enumerable:!1,configurable:!0}),n.prototype.processLocalAuthenticatorError=function(e){var o=this,r=e,h=0,f=Promise.resolve();if(r.getErrorCode()==t.AuthenticationErrorCode.Internal&&r.getData()){var g=r.getData();h=g[l.sdkhost.ErrorDataNumFailures]||0,r=t.impl.AuthenticationErrorImpl.errorForHostInternalBiometricErrorData(g,"Biometrics")||r,(g[l.sdkhost.ErrorDataInternalError]==l.sdkhost.InternalErrorBiometricInvalidated||g[l.sdkhost.ErrorDataInternalError]==l.sdkhost.InternalErrorBiometricNotConfigured&&this._authenticatorDescription.getRegistered())&&(this._sdk.log(t.LogLevel.Debug,function(){return"Biometric invalidated "+g[l.sdkhost.ErrorDataInternalError]}),f=i.LocalEnrollment.invalidateLocalRegistrationStatusAndNotifyUIHandler(this._actionDriver._controlFlowProcessor,this._authenticatorDescription))}f.catch(function(y){o._sdk.log(t.LogLevel.Error,y)}),f.finally(function(){if(r.getErrorCode()==t.AuthenticationErrorCode.UserCanceled)return o._sdk.log(t.LogLevel.Debug,function(){return"Device biometrics captured user cancel error code."}),void o.invokeCancellationUiOrEscape();h&&o._operationMode==t.AuthenticatorSessionMode.Authentication?o.processAuthFailureAssertionAndHandleError(r,h):o.performErrorRecoveryForError(r)})},n.prototype.performErrorRecoveryForError=function(e,o){this.recoveryOptionsForError(e,o).indexOf(t.AuthenticationErrorRecovery.RetryAuthenticator)<0&&(this.lastObtainedKeyPair=null),s.prototype.performErrorRecoveryForError.call(this,e,o)},n.prototype.getKeyForEnrollmentDataAndInput=function(e,o){var r=this;return new Promise(function(h,f){var g,y=o,A=r.authenticatorKeyTagForScheme(e.version,e.salt);if(!(g=r.lastObtainedKeyPair&&r.lastObtainedKeyPair.getTag()===A.toString()?r.lastObtainedKeyPair:r._sdk.host.getKeyPair(A,l.sdkhost.KeyClass.StdSigningKey,l.sdkhost.KeyBiometricProtectionMode.BindToEnrollmentDb))){var T={};throw T[l.sdkhost.ErrorDataInternalError]=l.sdkhost.InternalErrorBiometricInvalidated,new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Internal,"Attempt to authenticate with invalidated  biometrics.",T)}g.setBiometricPromptInfo(t.util.BiometricPromptInfoFrom.deviceBiometricInput(y,r._authenticatorConfig),null,null),h({key:g})})},n.prototype.getNewPendingEnrollmentOrReuse=function(e,o){return this._pendingEnrollmentData?Promise.resolve(this._pendingEnrollmentData):this.generatePendingEnrollment(e,o)},n.prototype.generatePendingEnrollment=function(e,o){var r=this;return this.generateAuthenticatorKey().then(function(h){return o||h.key.setBiometricPromptInfo(t.util.BiometricPromptInfoFrom.deviceBiometricInput(e,r._authenticatorConfig),null,null),h})},n.prototype.generateAuthenticatorKey=function(){var e,o=this;e=this._sdk.host.generateRandomHexString(24);var r=this.authenticatorKeyTagForScheme(this.currentScheme,e);return t.util.wrapPromiseWithActivityIndicator(this._uiHandler,this._actionDriver.policyAction(),this._clientContext,this._sdk.host.generateKeyPair(r,l.sdkhost.KeyClass.HardwareProtectedSignAndEncryptKey,l.sdkhost.KeyBiometricProtectionMode.BindToEnrollmentDb,!0).then(function(h){return{key:h,salt:e,schemeVersion:o.currentScheme}},function(h){if(h.getErrorCode()==t.AuthenticationErrorCode.Internal&&h.getData()){var f=h.getData(),g=t.impl.AuthenticationErrorImpl.errorForHostInternalBiometricErrorData(f,"Biometrics");if(g)throw g}throw h}))},n.prototype.calculateAssertionFieldsWithAuthenticatorKey=function(e){var o=this._authenticatorConfig;if(!this.signChallengeMode){if(this.operationMode==t.AuthenticatorSessionMode.Registration)return e.decrypt("").then(function(){return{data:{encrypted_challenge_mode:!0}}});var r=o&&o.encrypted_challenge;return r?new Promise(function(h,f){var g=t.util.base64ToHex(r);e.decrypt(g).then(function(y){return{fch:t.util.hexToBase64(y)}}).then(h,f)}):Promise.reject(new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Internal,"Invalid server response for decrypt-mode authenticator. Missing encrypted challenge."))}return s.prototype.calculateAssertionFieldsWithAuthenticatorKey.call(this,e)},n.prototype.authenticatorKeyTagForScheme=function(e,o){return n.authenticatorKeyTagForUser(this.user,e,o)},n.prototype.completeAuthenticatorSessionWithResult=function(e){this._pendingEnrollmentData=null,s.prototype.completeAuthenticatorSessionWithResult.call(this,e)},n.prototype.completeAuthenticatorSessionWithError=function(e){this._pendingEnrollmentData=null,s.prototype.completeAuthenticatorSessionWithError.call(this,e)},n}(u.AuthenticationDriverLocalPersistentKeyPairBasedPostV2Scheme);u.AuthenticationDriverDeviceBiometrics=c}(i.authenticationdrivers||(i.authenticationdrivers={}))}(t.core||(t.core={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){!function(u){var c=function(s){function n(e,o,r){return s.call(this,e,o,r)||this}return V(n,s),n.prototype.getMaxStep=function(){return-1},n.prototype.authenticateInStartedSession=function(e){e||this.initializeFirstStep(),this.pumpStep()},n.prototype.registerInStartedSession=function(e){e||this.initializeFirstStep(),this.pumpStep()},n.prototype.pumpStep=function(){var e=this,o=this._inputSession;o.setInputStep(this._currentStepIndex,this.getMaxStep(),this._currentStep),o.promiseInput().then(function(r){return e.handleInputOrControlResponse(r)},function(r){return e.completeAuthenticatorSessionWithError(t.impl.AuthenticationErrorImpl.ensureAuthenticationError(r))})},n.prototype.handleAuthenticateAssertionResult=function(e,o,r,h,f){return!!this.handleStepManagementAssertionResult(e)||s.prototype.handleAuthenticateAssertionResult.call(this,e,o,r,h,f)},n.prototype.handleRegisterAssertionResult=function(e){return!!this.handleStepManagementAssertionResult(e)||s.prototype.handleRegisterAssertionResult.call(this,e)},n.prototype.handleStepManagementAssertionResult=function(e){if(e.assertion_error_code==i.Protocol.AssertionErrorCode.NotFinished){var o=this.prepareNextAuthenticationStep(e);return o!=this._currentStep&&(this._currentStep=o,this._currentStepIndex++),this.pumpStep(),!0}return e.assertion_error_code==i.Protocol.AssertionErrorCode.RepeatCurrentStep&&(this._currentStep=this.updateCurrentAuthenticationStep(e,this._currentStep),this.pumpStep(),!0)},n.prototype.initializeFirstStep=function(){this._currentStep=this.createInitialInputStep(),this._currentStepIndex=0},n}(u.AuthenticationDriver);u.AuthenticationDriverMultiStep=c}(i.authenticationdrivers||(i.authenticationdrivers={}))}(t.core||(t.core={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){!function(u){var c=function(s){function n(e,o,r){return s.call(this,e,o,r)||this}return V(n,s),n.prototype.createAuthenticatorSession=function(){return this._uiHandler.createFaceAuthSession("face",this.user.displayName)},n.prototype.createInitialInputStep=function(){return new t.impl.CameraAcquisitionStepDescriptionImpl(this._authenticatorConfig.acquisition_challenges)},n.prototype.prepareNextAuthenticationStep=function(e){return this.createInitialInputStep()},n.prototype.updateCurrentAuthenticationStep=function(e,o){return o},n.prototype.handleAuthenticationInputResponse=function(e){this.processAuthenticateAssertion(e.getAcquisitionResponse())},n.prototype.handleRegistrationInputResponse=function(e){this.processRegisterAssertion(e.getAcquisitionResponse())},n}(u.AuthenticationDriverMultiStep);u.AuthenticationDriverFace=c}(i.authenticationdrivers||(i.authenticationdrivers={}))}(t.core||(t.core={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){var t,i;i=l.sdk||(l.sdk={}),function(u){var c=function(){function h(f,g,y,A,T,C){this._uiHandler=y,this._clientContext=A,this._actionContext=T,this._fidoRequest=C,this._user=g,this._sdk=f}return h.prototype.startSession=function(f,g,y,A){this._authDescription=f},h.prototype.changeSessionModeToRegistrationAfterExpiration=function(){throw new i.impl.AuthenticationErrorImpl(i.AuthenticationErrorCode.Internal,"Can't change FIDO asession mode from authentication to registration.")},h.prototype.promiseRecoveryForError=function(f,g,y){return Promise.resolve(i.AuthenticationErrorRecovery.Fail)},h.prototype.promiseInput=function(){var f=this;return this.fidoClientXact().then(function(g){return i.InputOrControlResponse.createInputResponse(i.FidoInputResponse.createSuccessResponse(g))},function(g){var y=i.impl.AuthenticationErrorImpl.ensureAuthenticationError(g);return f._sdk.log(i.LogLevel.Debug,function(){return"Received FIDO error response from client: "+y}),y.getErrorCode()==i.AuthenticationErrorCode.UserCanceled?i.InputOrControlResponse.createControlResponse(i.impl.ControlRequestImpl.create(i.ControlRequestType.CancelAuthenticator)):i.InputOrControlResponse.createInputResponse(i.FidoInputResponse.createdFailedResponse(f._authDescription,y))})},h.prototype.completeSuccessfulAuthenticatorSession=function(){return this.fidoClientSendCompletion({},1200)},h.prototype.endSession=function(){},h}(),s=function(h){function f(g,y,A,T,C,E){return h.call(this,g,y,A,T,C,E)||this}return V(f,h),f.prototype.fidoClientXact=function(){return this._sdk.host.fidoClientXact(this._uiHandler,this._clientContext,this._actionContext,this._fidoRequest)},f.prototype.fidoClientSendCompletion=function(g,y){return this._sdk.host.fidoClientXact(this._uiHandler,this._clientContext,this._actionContext,{__completion:{responseCode:y,message:g}}).then(function(T){return!0})},f}(c),n=function(){function h(){}return h.prototype.createSession=function(f,g,y,A,T,C){return new s(f,g,y,A,T,C)},h.prototype.canHandlePolicy=function(f,g){return!t.fidoclient.TarsusFidoClient.isPolicyTransmitFidoClientExclusive(g)&&!!this.checkPlatformClientIsPresent(f)},h.prototype.getAvailableAuthenticatorsIds=function(f){var g=this;return new Promise(function(y,A){if(!g.checkPlatformClientIsPresent(f))return f.log(i.LogLevel.Debug,function(){return"No platform FIDO client, therefore no available platform FIDO authenticators"}),y();var T=null;if(f.currentSession){var C=f.currentSession.getCurrentUserInteractionSessionProvider();C&&(T=C._clientContext)}g.requestFidoClientDiscovery(f,f.currentUiHandler,T,i.impl.PolicyActionImpl.createPseudoAction(f,"fido_client_discovery")).then(function(E){for(var R=E.availableAuthenticators,O=new Array,L=0,N=R;L<N.length;L++)O.push(N[L].aaid);y(O)},function(E){f.log(i.LogLevel.Debug,function(){return"Received FIDO discovery error response from client: "+E}),A(E)})})},h.prototype.checkPlatformClientIsPresent=function(f){return null==this._hasPlatformClient&&(this._hasPlatformClient="true"===f.host.queryHostInfo(l.sdkhost.HostInformationKey.FidoClientPresent),this._hasPlatformClient||f.log(i.LogLevel.Info,function(){return"No platform FIDO client."})),this._hasPlatformClient},h.prototype.requestFidoClientDiscovery=function(f,g,y,A){return f.host.fidoClientXact(g,y,A,{discovery:!0})},h}(),e=function(h){function f(g,y,A,T,C,E){return h.call(this,g,y,A,T,C,E)||this}return V(f,h),f.prototype.fidoClientXact=function(){return this._sdk.fidoClient.fidoClientXact(this._authDescription,this._uiHandler,this._user,this._clientContext,this._actionContext,this._fidoRequest)},f.prototype.fidoClientSendCompletion=function(g,y){return Promise.resolve(!0)},f}(c),o=function(){function h(){}return h.prototype.createSession=function(f,g,y,A,T,C){return new e(f,g,y,A,T,C)},h.prototype.canHandlePolicy=function(f,g){return f.fidoClient.canHandlePolicy(g)},h.prototype.getAvailableAuthenticatorsIds=function(f){return new Promise(function(g,y){var A=new Array;Object.keys(t.fidoclient.FidoAuthenticators).forEach(function(T){A.push(T)}),g(A)})},h}();u._fidoClientProviders=[new o,new n];var r=function(h){function f(g,y,A){return h.call(this,g,y,A)||this}return V(f,h),f.getEligibleClientProvidersForPolicy=function(g,y){return u._fidoClientProviders.filter(function(A){return A.canHandlePolicy(g,y)})},f.hasEligibleClientProvidersForPolicy=function(g,y){return this.getEligibleClientProvidersForPolicy(g,y).length>0},f.prototype.runUnregistration=function(){var g=this;return h.prototype.runUnregistration.call(this).finally(function(){var y=g._authenticatorConfig;new Promise(function(A,T){var C=y.fido_policy;if(C.rejected||!C.accepted||1!=C.accepted.length)throw"Invalid fido policy (class 1)";if(1!=C.accepted[0].length||1!=Object.keys(C.accepted[0][0]).length||!C.accepted[0][0].aaid||1!=C.accepted[0][0].aaid.length)throw"Invalid fido policy (class 2)";var E=C.accepted[0][0].aaid[0];g._sdk.log(i.LogLevel.Debug,function(){return"Will unregister AAID "+E+"."});var R=f.getEligibleClientProvidersForPolicy(g._sdk,y.fido_policy);if(0==R.length)g._sdk.log(i.LogLevel.Warning,function(){return"Can't find FIDO client for unregister op: "+JSON.stringify(y.fido_policy)+"."}),A();else{var O=y.fido_request;O.header.appID=y.fido_appid;var L=R[0].createSession(g._sdk,g.user,g._uiHandler,g._clientContext,g._actionDriver.policyAction(),O);L.startSession(g._authenticatorDescription,i.AuthenticatorSessionMode.Registration,g._actionDriver.policyAction(),g._clientContext),L.promiseInput().then(function(N){if(N.isControlRequest())throw new i.impl.AuthenticationErrorImpl(i.AuthenticationErrorCode.AuthenticatorError,"Unexpected control response from FIDO client during unregistration.");var W=N.getResponse();if(W instanceof i.FidoAuthFailureResponse)throw W.getFailureError();return N}).finally(function(){L.endSession()}).then(A,T)}}).then(function(){g._sdk.log(i.LogLevel.Info,function(){return"FIDO authenticator unregistered: "+JSON.stringify(y.fido_policy)+"."})},function(A){var T=i.impl.AuthenticationErrorImpl.ensureAuthenticationError(A);g._sdk.log(i.LogLevel.Error,function(){return"Error during FIDO unregistration: "+T+"."})})})},f.prototype.completeAuthenticatorSessionWithResult=function(g){var y=this;g instanceof u.AuthenticationDriverSessionResultAuthenticationCompleted?this._inputSession.completeSuccessfulAuthenticatorSession().then(function(A){h.prototype.completeAuthenticatorSessionWithResult.call(y,g)},function(A){h.prototype.completeAuthenticatorSessionWithError.call(y,i.impl.AuthenticationErrorImpl.ensureAuthenticationError(A))}):h.prototype.completeAuthenticatorSessionWithResult.call(this,g)},f.prototype.createAuthenticatorSession=function(){var g=this._authenticatorConfig,y=f.getEligibleClientProvidersForPolicy(this._sdk,g.fido_policy);if(g.fido_request.header.appID=g.fido_appid,y.length>0)return y[0].createSession(this._sdk,this.user,this._uiHandler,this._clientContext,this._actionDriver.policyAction(),g.fido_request);throw new i.impl.AuthenticationErrorImpl(i.AuthenticationErrorCode.AuthenticatorExternalConfigError,"Can't find FIDO client to handle FIDO request.",{fidoRequest:g.fido_request})},f.prototype.authenticateInStartedSession=function(g){var y=this;this._inputSession.promiseInput().then(function(A){return y.handleInputOrControlResponse(A)},function(A){return y.completeAuthenticatorSessionWithError(i.impl.AuthenticationErrorImpl.ensureAuthenticationError(A))})},f.prototype.registerInStartedSession=function(g){var y=this;this._inputSession.promiseInput().then(function(A){return y.handleInputOrControlResponse(A)},function(A){return y.completeAuthenticatorSessionWithError(i.impl.AuthenticationErrorImpl.ensureAuthenticationError(A))})},f.prototype.handleAuthenticationInputResponse=function(g){g instanceof i.FidoAuthSuccessResponse?this.handleFidoSuccessAuthResponse(g):this.handleFidoError(g)},f.prototype.handleFidoSuccessAuthResponse=function(g){this.processAuthenticateAssertion({fido_response:g.getFidoResponse()})},f.prototype.handleFidoError=function(g){g instanceof i.FidoAuthFailureResponse?(this._sdk.log(i.LogLevel.Debug,function(){return"FIDO session received FidoAuthFailureResponse."}),this.handleFidoFailureResponse(g)):(this._sdk.log(i.LogLevel.Error,function(){return"FIDO session received unknkown response type."}),this.performErrorRecoveryForError(new i.impl.AuthenticationErrorImpl(i.AuthenticationErrorCode.AppImplementation,"FIDO session received unknkown response type.")))},f.prototype.handleFidoFailureResponse=function(g){var y={status:g.getRegistrationStatus()==i.AuthenticatorRegistrationStatus.Registered?t.Protocol.AuthenticationMethodStatus.Registered:t.Protocol.AuthenticationMethodStatus.Unregistered,expired:g.getExpired(),locked:g.getLocked(),last_used:0};this._authenticatorDescription.updateWithAuthenticatorState(y),this.performErrorRecoveryForError(g.getFailureError())},f.prototype.handleFidoSuccessRegResponse=function(g){this.processRegisterAssertion({fido_response:g.getFidoResponse()})},f.prototype.handleRegistrationInputResponse=function(g){g instanceof i.FidoAuthSuccessResponse?this.handleFidoSuccessRegResponse(g):this.handleFidoError(g)},f.prototype.defaultRecoveryForError=function(g){return this._operationMode==i.AuthenticatorSessionMode.Authentication?i.AuthenticationErrorRecovery.ChangeAuthenticator:i.AuthenticationErrorRecovery.Fail},f}(u.AuthenticationDriver);u.AuthenticationDriverFido=r}((t=i.core||(i.core={})).authenticationdrivers||(t.authenticationdrivers={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){var t,i;i=l.sdk||(l.sdk={}),function(u){var c=function(){function n(e,o,r,h,f,g){this.cancellationDOMErrorNames=["NotAllowedError","AbortError"],this.sdk=e,this.username=o,this.uiHandler=r,this.clientContext=h,this.actionContext=f,this.config=g,this.config.require_display_name_from_user&&(this.hostUiAuthenticatorSession=this.uiHandler.createFido2AuthSession("fido2",o))}return n.prototype.startSession=function(e,o,r,h){this.description=e,this.mode=o,this.actionContext=r,this.clientContext=h,this.hostUiAuthenticatorSession&&(this.mode==i.AuthenticatorSessionMode.Registration?this.hostUiAuthenticatorSession.startSession(e,o,r,h):(this.hostUiAuthenticatorSession.endSession(),delete this.hostUiAuthenticatorSession))},n.prototype.changeSessionModeToRegistrationAfterExpiration=function(){this.mode=p.ts.mobile.sdk.AuthenticatorSessionMode.Registration,this.hostUiAuthenticatorSession&&this.hostUiAuthenticatorSession.changeSessionModeToRegistrationAfterExpiration()},n.prototype.promiseRecoveryForError=function(e,o,r){return this.hostUiAuthenticatorSession?this.hostUiAuthenticatorSession.promiseRecoveryForError(e,o,r):Promise.resolve(i.AuthenticationErrorRecovery.Fail)},n.prototype.promiseInput=function(){return this.hostUiAuthenticatorSession?this.hostUiAuthenticatorSession.promiseInput():this.performFido2CredentialsOp()},n.prototype.endSession=function(){this.hostUiAuthenticatorSession&&(this.hostUiAuthenticatorSession.endSession(),delete this.hostUiAuthenticatorSession)},n.prototype.performFido2CredentialsOp=function(e){var o,r,h=this;return this.mode===p.ts.mobile.sdk.AuthenticatorSessionMode.Authentication?(o=this.config.credentialRequestOptions,r=l.sdkhost.Fido2CredentialsOpType.Get):(o=this.config.credentialCreationOptions,e&&(o=this.enrichOptionsWithDisplayName(o,e)),r=l.sdkhost.Fido2CredentialsOpType.Create),this.sdk.host.fido2CredentialsOp(this.uiHandler,this.clientContext,this.actionContext,r,o).then(function(f){return i.InputOrControlResponse.createInputResponse(t.Fido2InputResponseInternal.createSuccessResponse(f))}).catch(function(f){var g=p.ts.mobile.sdk.impl.AuthenticationErrorImpl.ensureAuthenticationError(f);if(g.getErrorCode()===i.AuthenticationErrorCode.UserCanceled){h.sdk.log(i.LogLevel.Debug,function(){return"Received FIDO2 cancellation request."});var y=h.actionContext.getEscapeOptions().filter(function(A){return A.getPresentation()==p.ts.mobile.sdk.ActionEscapeOptionPresentation.Cancel})[0];return y?(h.sdk.log(i.LogLevel.Debug,function(){return"Got cancel escape option; responding with that."}),i.InputOrControlResponse.createEscapeResponse(y,null)):(h.sdk.log(i.LogLevel.Debug,function(){return"Responding with auth cancel control request."}),i.InputOrControlResponse.createControlResponse(i.ControlRequest.create(i.ControlRequestType.CancelAuthenticator)))}return h.sdk.log(i.LogLevel.Debug,function(){return"Received FIDO2 error response from client: "+g}),i.InputOrControlResponse.createInputResponse(t.Fido2InputResponseInternal.createdFailedResponse(g))})},n.prototype.enrichOptionsWithDisplayName=function(e,o){return e.publicKey.user.displayName=o,e},n}();u.Fido2AuthenticatorSessionInternal=c;var s=function(n){function e(){return null!==n&&n.apply(this,arguments)||this}return V(e,n),e.prototype.createAuthenticatorSession=function(){if("true"===this._sdk.host.queryHostInfo(l.sdkhost.HostInformationKey.Fido2ClientPresent))return new c(this._sdk,this.user.displayName,this._uiHandler,this._clientContext,this._actionDriver.policyAction(),this._authenticatorConfig);throw new i.impl.AuthenticationErrorImpl(i.AuthenticationErrorCode.AuthenticatorExternalConfigError,"Can't find FIDO2 client to handle FIDO2 authentication.")},e.prototype.authenticateInStartedSession=function(o){var r=this;this._inputSession.promiseInput().then(function(h){return r.handleInputOrControlResponse(h)},function(h){return r.completeAuthenticatorSessionWithError(i.impl.AuthenticationErrorImpl.ensureAuthenticationError(h))})},e.prototype.handleAuthenticationInputResponse=function(o){if(o instanceof t.Fido2AuthenticatorSuccessResponse){this._sdk.log(i.LogLevel.Debug,function(){return"Fido2 received Fido2AuthenticatorSuccessResponse."});var r=o.getFido2Response();this.processAuthenticateAssertion({assertion_credential:{id:r.id,response:{authenticatorData:r.response.authenticatorData,clientDataJSON:r.response.clientDataJSON,signature:r.response.signature,userHandle:r.response.userHandle},type:r.type,clientExtensionResults:r.clientExtensionResults}})}else o instanceof t.Fido2AuthenticationFailedResponse?(this._sdk.log(i.LogLevel.Debug,function(){return"Fido2 received Fido2AuthenticationFailedResponse."}),this.handleFido2FailureResponse(o)):(this._sdk.log(i.LogLevel.Error,function(){return"Fido2 received unknkown response type."}),this.performErrorRecoveryForError(new i.impl.AuthenticationErrorImpl(i.AuthenticationErrorCode.AppImplementation,"Fido2 received unknkown response type.")))},e.prototype.registerInStartedSession=function(o){var r=this;this._inputSession.promiseInput().then(function(h){return r.handleInputOrControlResponse(h)},function(h){return r.completeAuthenticatorSessionWithError(i.impl.AuthenticationErrorImpl.ensureAuthenticationError(h))})},e.prototype.handleRegistrationInputResponse=function(o){var r=this;if(o instanceof i.Fido2InputResponse){var h=o.getDisplayName();this._sdk.log(i.LogLevel.Debug,function(){return"Fido2 received authenticator display name: "+h}),this.validateDisplayNameFormat(h)?(this._displayName=h,this._inputSession.performFido2CredentialsOp(h).then(function(g){return r.handleInputOrControlResponse(g)},function(g){return r.completeAuthenticatorSessionWithError(i.impl.AuthenticationErrorImpl.ensureAuthenticationError(g))})):this.performErrorRecoveryForError(new i.impl.AuthenticationErrorImpl(i.AuthenticationErrorCode.InvalidInput,"Display name can't be empty"))}else if(o instanceof t.Fido2AuthenticatorSuccessResponse){this._sdk.log(i.LogLevel.Debug,function(){return"Fido2 received Fido2AuthenticatorSuccessResponse."});var f=o.getFido2Response();(!this._displayName||this._displayName.length<=0)&&(this._displayName=this._authenticatorConfig.credentialCreationOptions.publicKey.user.displayName),this.processRegisterAssertion({attestation_credential:{id:f.id,response:{attestationObject:f.response.attestationObject,clientDataJSON:f.response.clientDataJSON,transports:f.response.transports},type:f.type,clientExtensionResults:f.clientExtensionResults},display_name:this._displayName})}else o instanceof t.Fido2AuthenticationFailedResponse?(this._sdk.log(i.LogLevel.Debug,function(){return"Fido2 received Fido2AuthenticationFailedResponse."}),this.handleFido2FailureResponse(o)):(this._sdk.log(i.LogLevel.Error,function(){return"Fido2 received unknkown response type."}),this.performErrorRecoveryForError(new i.impl.AuthenticationErrorImpl(i.AuthenticationErrorCode.AppImplementation,"Fido2 received unknkown response type.")))},e.prototype.handleFido2FailureResponse=function(o){this._actionDriver.sendAuthenticatorAssertionRequest(this._authenticatorDescription,"auth_failure",{num_of_failures:1}),this.performErrorRecoveryForError(o.getFailureError())},e.prototype.handleAuthenticateAssertionResult=function(o,r,h,f,g){if(o.assertion_error_code&&o.assertion_error_code==t.Protocol.AssertionErrorCode.FailedAssertion&&o.data)switch(o.data.reason){case t.Protocol.ServerResponseDataErrorReasonReasons.ErrorReasonAttestationReverificationFailed:this._sdk.log(i.LogLevel.Debug,function(){return"handleAuthenticateAssertionResult() for FIDO2 that failed attestation reverification"});var y=new i.impl.AuthenticationErrorImpl(i.AuthenticationErrorCode.AuthenticatorError,o.assertion_error_message||"FIDO2 credential failed attestation reverification");return y.setPublicProperty(i.AuthenticationErrorProperty.AuthenticationErrorReason,i.AuthenticationErrorPropertySymbol.AuthenticationErrorReasonAttestationReverificationFailed),this.performErrorRecoveryForError(y),!0;case t.Protocol.ServerResponseDataErrorReasonReasons.ErrorReasonCredentialFiltered:return this._sdk.log(i.LogLevel.Debug,function(){return"handleAuthenticateAssertionResult() for FIDO2 with filtered credential"}),this.handleCredentialFiltered(o)}return n.prototype.handleAuthenticateAssertionResult.call(this,o,r,h,f,g)},e.prototype.handleRegisterAssertionResult=function(o){return o.assertion_error_code&&o.assertion_error_code==t.Protocol.AssertionErrorCode.Internal&&o.data&&o.data.reason===t.Protocol.ServerResponseDataErrorReasonReasons.ErrorReasonCredentialFiltered?(this._sdk.log(i.LogLevel.Debug,function(){return"handleRegisterAssertionResult() for FIDO2 with filtered credential"}),this.handleCredentialFiltered(o)):n.prototype.handleRegisterAssertionResult.call(this,o)},e.prototype.handleCredentialFiltered=function(o){var r=new i.impl.AuthenticationErrorImpl(i.AuthenticationErrorCode.AuthenticatorError,o.assertion_error_message||"FIDO2 with filtered credential");return r.setPublicProperty(i.AuthenticationErrorProperty.AuthenticationErrorReason,i.AuthenticationErrorPropertySymbol.AuthenticationErrorReasonCredentialFiltered),this.performErrorRecoveryForError(r),!0},e.prototype.validateDisplayNameFormat=function(o){return!(!o||o.length<=0)},e}(u.AuthenticationDriver);u.AuthenticationDriverFido2=s}((t=i.core||(i.core={})).authenticationdrivers||(t.authenticationdrivers={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){!function(u){u.AUTHENTICATION_DRIVER_FINGERPRINT_CURRENT_SCHEME="v3";var c=function(s){function n(e,o,r){return s.call(this,e,o,r)||this}return V(n,s),n.prototype.getBiometricPromptFallbackControlType=function(){return null!=this._biometricPromptFallbackControlType?this._biometricPromptFallbackControlType:t.ControlRequestType.SelectMethod},n.authenticatorKeyTagForUser=function(e,o,r){return new i.TarsusKeyPath("per_user",e.guid.toString(),"local_auth_keys",u.AuthenticationDriverDescriptorFingerprint.authenticatorName,o,r)},n.prototype.shouldAllowBiometricFallbackButton=function(e){var o=this;if(!e)return!1;var r=this._actionDriver.availableAuthenticatorsForSwitching.filter(function(y){return y!=o._authenticatorDescription});if(this._actionDriver instanceof i.actiondrivers.ActionDriverRegistration||this._actionDriver instanceof i.actiondrivers.ActionDriverAuthentication&&0==r.length)return!1;var h=e,f=h.getFallbackButtonTitle();if(!(f&&f.length>0))return!1;var g=h.getFallbackControlRequestType();switch(null==g&&(g=t.ControlRequestType.SelectMethod),g){case t.ControlRequestType.ChangeMethod:return this._actionDriver.availableAuthenticatorsForSwitching.filter(function(y){return y!=o._authenticatorDescription}).length>0;case t.ControlRequestType.SelectMethod:return this._actionDriver.availableAuthenticatorsForSwitching.length>0;default:return!0}},n.prototype.runSilentRegistration=function(){var e=this;return this.generateAuthenticatorKey().then(function(o){var r=e.getNewOrUpdatedEnrollmentRecord(o),h={public_key:o.key.publicKeyToJson(),version:o.schemeVersion};return e._actionDriver.sendAuthenticatorAssertionRequest(e._authenticatorDescription,"register",null,h).then(function(f){if(f.assertion_error_code)throw t.impl.AuthenticationErrorImpl.errorForAssertionResponse(f);return e.user.updateEnrollmentRecord(r),new u.AuthenticationDriverSessionResultAuthenticationCompleted(f)})})},n.prototype.createAuthenticatorSession=function(){return this._uiHandler.createFingerprintAuthSession(u.AuthenticationDriverDescriptorFingerprint.authenticatorName,this.user.displayName)},n.prototype.authenticateInStartedSession=function(e){var o=this;this._inputSession.promiseInput().then(function(r){return o.handleInputOrControlResponse(r)},function(r){return o.completeAuthenticatorSessionWithError(t.impl.AuthenticationErrorImpl.ensureAuthenticationError(r))})},n.prototype.registerInStartedSession=function(e){var o=this;s.prototype.registerInStartedSession.call(this,e),this._inputSession.promiseInput().then(function(r){return o.handleInputOrControlResponse(r)},function(r){return o.completeAuthenticatorSessionWithError(t.impl.AuthenticationErrorImpl.ensureAuthenticationError(r))})},Object.defineProperty(n.prototype,"authenticatorType",{get:function(){return u.AuthenticationDriverDescriptorFingerprint.authenticatorName},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"currentScheme",{get:function(){return u.AUTHENTICATION_DRIVER_FINGERPRINT_CURRENT_SCHEME},enumerable:!1,configurable:!0}),n.prototype.processLocalAuthenticatorError=function(e){var o=this,r=e,h=0,f=Promise.resolve();if(r.getErrorCode()==t.AuthenticationErrorCode.Internal&&r.getData()){var g=r.getData();h=g[l.sdkhost.ErrorDataNumFailures]||h,r=t.impl.AuthenticationErrorImpl.errorForHostInternalBiometricErrorData(g,"Fingerprint")||r,(g[l.sdkhost.ErrorDataInternalError]==l.sdkhost.InternalErrorBiometricNotConfigured&&this._authenticatorDescription.getRegistered()||g[l.sdkhost.ErrorDataInternalError]==l.sdkhost.InternalErrorBiometricInvalidated)&&(f=i.LocalEnrollment.invalidateLocalRegistrationStatusAndNotifyUIHandler(this._actionDriver._controlFlowProcessor,this._authenticatorDescription))}f.catch(function(y){o._sdk.log(t.LogLevel.Error,y)}),f.finally(function(){var y=r.getData();if(!h||o._operationMode!=t.AuthenticatorSessionMode.Authentication)return y[l.sdkhost.ErrorDataInternalError]==l.sdkhost.InternalErrorBiometricFallbackPressed?(o._sdk.log(t.LogLevel.Debug,function(){return"Biometric prompt fallback button pressed"}),void o.processControlRequest(t.ControlRequest.create(o.getBiometricPromptFallbackControlType()))):r.getErrorCode()==t.AuthenticationErrorCode.UserCanceled?(o._sdk.log(t.LogLevel.Debug,function(){return"Fingerprint authenticator captured user cancel error code."}),void o.invokeCancellationUiOrEscape()):void o.performErrorRecoveryForError(r);o.processAuthFailureAssertionAndHandleError(r,h)})},n.prototype.getKeyForEnrollmentDataAndInput=function(e,o){var r=this;return new Promise(function(h,f){var g=o;r.shouldAllowBiometricFallbackButton(g)&&(r._biometricPromptFallbackControlType=g.getFallbackControlRequestType());var y=r.authenticatorKeyTagForScheme(e.version,e.salt),A=r._sdk.host.getKeyPair(y,l.sdkhost.KeyClass.StdSigningKey,l.sdkhost.KeyBiometricProtectionMode.BindToEnrollmentDb);if(!A){var T={};throw T[l.sdkhost.ErrorDataInternalError]=l.sdkhost.InternalErrorBiometricInvalidated,new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Internal,"Attempt to authenticate with invalidated Fingerprint.",T)}A.setBiometricPromptInfo(t.util.BiometricPromptInfoFrom.fingerprintInput(g),r._uiHandler,r._inputSession),h({key:A})})},n.prototype.generatePendingEnrollment=function(e,o){var r=this;return this.generateAuthenticatorKey().then(function(h){if(!o){var f=e;r.shouldAllowBiometricFallbackButton(f)&&(r._biometricPromptFallbackControlType=f.getFallbackControlRequestType()),h.key.setBiometricPromptInfo(t.util.BiometricPromptInfoFrom.fingerprintInput(f),r._uiHandler,r._inputSession)}return h})},n.prototype.generateAuthenticatorKey=function(){var e,o=this;e=this._sdk.host.generateRandomHexString(24);var r=this.authenticatorKeyTagForScheme(this.currentScheme,e);return t.util.wrapPromiseWithActivityIndicator(this._uiHandler,this._actionDriver.policyAction(),this._clientContext,this._sdk.host.generateKeyPair(r,l.sdkhost.KeyClass.HardwareProtectedSignAndEncryptKey,l.sdkhost.KeyBiometricProtectionMode.BindToEnrollmentDb,!0).then(function(h){return{key:h,salt:e,schemeVersion:o.currentScheme}},function(h){if(h.getErrorCode()==t.AuthenticationErrorCode.Internal&&h.getData()){var f=h.getData(),g=t.impl.AuthenticationErrorImpl.errorForHostInternalBiometricErrorData(f,"Fingerprint");if(g)throw g}throw h}))},n.prototype.authenticatorKeyTagForScheme=function(e,o){return n.authenticatorKeyTagForUser(this.user,e,o)},n}(u.AuthenticationDriverLocalPersistentKeyPairBasedPostV2Scheme);u.AuthenticationDriverFingerprint=c}(i.authenticationdrivers||(i.authenticationdrivers={}))}(t.core||(t.core={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){var t;!function(i){function u(e){for(var o=[],r=0;r<e.length;r++){var h=e.charCodeAt(r);h<128?o.push(h):h<2048?o.push(192|h>>6,128|63&h):h<55296||h>=57344?o.push(224|h>>12,128|h>>6&63,128|63&h):(r++,h=65536+((1023&h)<<10|1023&e.charCodeAt(r)),o.push(240|h>>18,128|h>>12&63,128|h>>6&63,128|63&h))}return o}function c(e){var o,r="";for(o=0;o<e.length;o++){var h=e[o];if(h<128)r+=String.fromCharCode(h);else if(h>191&&h<224)r+=String.fromCharCode((31&h)<<6|63&e[o+1]),o+=1;else if(h>223&&h<240)r+=String.fromCharCode((15&h)<<12|(63&e[o+1])<<6|63&e[o+2]),o+=2;else{var f=((7&h)<<18|(63&e[o+1])<<12|(63&e[o+2])<<6|63&e[o+3])-65536;r+=String.fromCharCode(f>>10|55296,1023&f|56320),o+=3}}return r}function s(e){for(var o="",r=0;r<e.length;r++){var h=e.charCodeAt(r).toString(16);h.length<2&&(h="0"+h),o+=h}return o}i.numberToHex=function(e,o){var r=e.toString(16);if(r.length>o/4)throw"Number out of range for bitcount.";for(;r.length<o/4;)r="0"+r;return r},i.toUTF8Array=u,i.fromUTF8Array=c,i.hexToAscii=function(e){for(var o=[],r=0;r<e.length;r+=2)o.push(parseInt(e.substr(r,2),16));return c(o)},i.asciiToHex=function(e){return u(e).map(function(o){var r=o.toString(16);return r.length<2&&(r="0"+r),r}).join("")},i.base64ToHex=function(e){return s(atob(e))},i.bytesToHex=s,i.hexToBytes=function(e){for(var o=[],r=0;r<e.length;r+=2)o.push(parseInt(e.substr(r,2),16));return o},i.hexToBase64=function(e){for(var o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r=0,h=0,f="",g=0;g<e.length;g++)r=(r<<4)+parseInt(e[g],16),(h+=4)>=6&&(f+=o[r>>h-6],r&=255>>8-(h-=6));for(h&&(f+=o[r<<6-h]);f.length%4;)f+="=";return f},i.isHexString=function(e){return new RegExp("^([0-9A-Fa-f]{2})+$").test(e)},i.stringToBytes=function(e){for(var o=[],r=0;r<e.length;r++)o.push(e.charCodeAt(r));return o},i.calcPublicKeyHexStringEncodedSha256Hash=function(e,o){var r=e.publicKeyToJson().key;return sha256(i.stringToBytes(atob(r)))},i.nameof=function(e){return e},i.checkedCast=function(e,o){if(o instanceof e)return o;throw Error("Checked cast failed. Expected "+e)},i.wrapPromiseWithActivityIndicator=function(e,o,r,h){return e.startActivityIndicator(o,r),h.then(function(f){return e.endActivityIndicator(o,r),f},function(f){return e.endActivityIndicator(o,r),Promise.reject(f)})};var n=function(){function e(){var o=this;this._cancelPromise=new Promise(function(r,h){o._cancelFn=function(){h(e.CancelRequest)},o._cancelled&&h(e.CancelRequest)})}return Object.defineProperty(e.prototype,"cancellablePromise",{get:function(){return this._cancellablePromise},enumerable:!1,configurable:!0}),e.prototype.resolveWith=function(o){this._cancelled?this._cancellablePromise=this._cancelPromise:(this._underlyingPromise=new Promise(o),this._cancellablePromise=Promise.race([this._cancelPromise,this._underlyingPromise]))},e.prototype.cancel=function(){this._cancelled=!0,this._cancelFn&&this._cancelFn()},e.CancelRequest={},e}();i.CancelablePromiseHolder=n,i.LANGUAGES={"zh-HK":"zh-HK","zh-CN":"zh-Hans","zh-TW":"zh-Hant",zh:"zh-Hans",da:"da-DK",nl:"nl-NL","en-AU":"en-AU","en-GB":"en-GB",en:"en-US","en-IN":"en-IN",fi:"fi-FI",fr:"fr-FR","fr-CA":"fr-CA",de:"de-DE",it:"it-IT",is:"is-IS",ja:"ja-JP",ko:"ko-KR",nb:"nb-NO",pl:"pl-PL","pt-BR":"pt-BR",pt:"pt-PT",ro:"ro-RO",ru:"ru-RU","es-MX":"es-MX",es:"es-ES",ca:"ca-ES","es-US":"es-US",sv:"sv-SE",tr:"tr-TR",vi:"vi-VN",el:"el-GR",id:"id-ID",hu:"hu-HU",th:"th-TH",hi:"hi-IN",cs:"cs-CZ",sk:"sk-SK",uk:"uk-UA",hr:"hr-CS",he:"he-IL",iw:"he-IL",ar:"ar-SA"}}((t=l.sdk||(l.sdk={})).util||(t.util={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){!function(u){var c=function(s){function n(e,o,r){return s.call(this,e,o,r)||this}return V(n,s),n.enrollmentVersion2KeyGenVersion=function(e){return e>="v3"?"s2":"s1"},n.prototype.unregisterEnrollmentAssets=function(e){},Object.defineProperty(n.prototype,"currentScheme",{get:function(){return"v3"},enumerable:!1,configurable:!0}),n.prototype.processLocalAuthenticatorError=function(e){var o=e;e.getErrorCode()==t.AuthenticationErrorCode.InvalidInput&&this._operationMode==t.AuthenticatorSessionMode.Authentication?this.processAuthFailureAssertionAndHandleError(o,1):this.performErrorRecoveryForError(o)},n.prototype.getKeyForEnrollmentDataAndInput=function(e,o){var r=this;return new Promise(function(h,f){e.version>="v2"?r.getKeyForEnrollmentDataAndInputV2(e,o).then(h,f):r.getKeyForEnrollmentDataAndInputPreV2(e,o).then(h,f)}).then(function(h){if(!h)throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.InvalidInput,"Invalid input provided to authenticator.");return{key:h}})},n.prototype.generatePendingEnrollment=function(e){var o=this;return new Promise(function(r,h){var f=o._sdk.host.generateRandomHexString(32),g=o._sdk.host.generateRandomHexString(64),y=o.extractPbkdfInputFromInputResponse(e);return t.util.wrapPromiseWithActivityIndicator(o._uiHandler,o._actionDriver.policyAction(),o._clientContext,o._sdk.host.generateHexSeededKeyPairExternalRepresentation(l.sdkhost.KeyClass.FidoECCSigningKey,g,n.enrollmentVersion2KeyGenVersion(o.currentScheme),null).then(function(A){return i.vault.pbkdfStretchHexSecretIntoAESKey(f,y,o._sdk.cryptoSettings.getLocalEnrollmentKeySizeInBytes(),o._sdk.cryptoSettings.getLocalEnrollmentKeyIterationCount(),!0,o._sdk).then(function(T){return T.encrypt(g).then(function(C){return{key:o._sdk.host.importVolatileKeyPair(l.sdkhost.KeyClass.FidoECCSigningKey,A),salt:f,schemeVersion:o.currentScheme,keyMeterial:C}})})})).then(r,h)})},n.prototype.getKeyForEnrollmentDataAndInputV2=function(e,o){var r=this,h=this.extractPbkdfInputFromInputResponse(o);return i.vault.pbkdfStretchHexSecretIntoAESKey(e.salt,h,e.cryptoSettings.getLocalEnrollmentKeySizeInBytes(),e.cryptoSettings.getLocalEnrollmentKeyIterationCount(),!0,this._sdk).then(function(f){return f.decrypt(e.keyMaterial,null).then(function(g){return r._sdk.host.generateHexSeededKeyPairExternalRepresentation(l.sdkhost.KeyClass.FidoECCSigningKey,g,n.enrollmentVersion2KeyGenVersion(e.version),e.publicKeyHash).then(function(y){return r._sdk.host.importVolatileKeyPair(l.sdkhost.KeyClass.FidoECCSigningKey,y)})})})},n.prototype.getKeyForEnrollmentDataAndInputPreV2=function(e,o){var r=this;return this.authenticatorKeyTagForScheme(e.version,e.salt,e.cryptoSettings,o).then(function(h){return r._sdk.host.getKeyPair(h,l.sdkhost.KeyClass.StdSigningKey,l.sdkhost.KeyBiometricProtectionMode.None)})},n.prototype.schemeVersionRequiresRollover=function(e){return"v0"==e||"v1"==e},n.prototype.authenticatorKeyTagForScheme=function(e,o,r,h){var f=this;return new Promise(function(g,y){var A=f.extractPbkdfInputFromInputResponse(h);if("v0"==e&&(f._sdk.log(t.LogLevel.Debug,function(){return"Using SDK CryptoSettings for migrated enrollment."}),r=f._sdk.cryptoSettings),!r)throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Internal,"Missing crypt settings for local enrollment.");f._sdk.host.generatePbkdf2HmacSha1HexString(o,A,r.getLocalEnrollmentKeySizeInBytes(),r.getLocalEnrollmentKeyIterationCount()).then(function(T){var C=t.util.hexToBase64(T);return new i.TarsusKeyPath("per_user",f.user.guid.toString(),"local_auth_keys",f.authenticatorType,e,C)}).then(g,y)})},n}(u.AuthenticationDriverLocal);u.AuthenticationDriverLocalSecretInputBased=c}(i.authenticationdrivers||(i.authenticationdrivers={}))}(t.core||(t.core={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){!function(u){var c=function(s){function n(e,o,r){return s.call(this,e,o,r)||this}return V(n,s),Object.defineProperty(n.prototype,"authenticatorType",{get:function(){return n.authenticatorName},enumerable:!1,configurable:!0}),n.prototype.handleAuthenticationInputResponse=function(e){t.impl.PatternInputImpl.validateFormat(e)?s.prototype.handleAuthenticationInputResponse.call(this,e):this.processLocalAuthenticatorError(new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.AppImplementation,"Invalid pattern description format."))},n.prototype.handleRegistrationInputResponse=function(e){var o=this._authenticatorConfig,r=e;t.impl.PatternInputImpl.validateFormat(r)?o.min_length&&t.impl.PatternInputImpl.getPatternLength(r)<o.min_length?this.processLocalAuthenticatorError(new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.AppImplementation,"Invalid pattern length.")):s.prototype.handleRegistrationInputResponse.call(this,e):this.processLocalAuthenticatorError(new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.AppImplementation,"Invalid pattern description format."))},n.prototype.extractPbkdfInputFromInputResponse=function(e){return t.util.asciiToHex(e.getPatternDescription())},n.prototype.createAuthenticatorSession=function(){return this._uiHandler.createPatternAuthSession(n.authenticatorName,this.user.displayName,3,4)},n.prototype.authenticateInStartedSession=function(e){var o=this;this._inputSession.promiseInput().then(function(r){return o.handleInputOrControlResponse(r)},function(r){return o.completeAuthenticatorSessionWithError(t.impl.AuthenticationErrorImpl.ensureAuthenticationError(r))})},n.prototype.registerInStartedSession=function(e){var o=this;this._inputSession.promiseInput().then(function(r){return o.handleInputOrControlResponse(r)},function(r){return o.completeAuthenticatorSessionWithError(t.impl.AuthenticationErrorImpl.ensureAuthenticationError(r))})},n.authenticatorName="pattern",n}(u.AuthenticationDriverLocalSecretInputBased);u.AuthenticationDriverLocalPattern=c}(i.authenticationdrivers||(i.authenticationdrivers={}))}(t.core||(t.core={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){!function(u){var c=function(s){function n(e,o,r){return s.call(this,e,o,r)||this}return V(n,s),Object.defineProperty(n.prototype,"authenticatorType",{get:function(){return n.authenticatorName},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"pinLength",{get:function(){return this._authenticatorConfig.length},enumerable:!1,configurable:!0}),n.prototype.handleRegistrationInputResponse=function(e){e.getPin().length!=this.pinLength?this.processLocalAuthenticatorError(new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.InvalidInput,"Expecting an entry of length "+this.pinLength+".")):s.prototype.handleRegistrationInputResponse.call(this,e)},n.prototype.generatePendingEnrollment=function(e){var o=this;return s.prototype.generatePendingEnrollment.call(this,e).then(function(r){return r.authenticatorConfig={length:o.pinLength},r})},n.prototype.extractPbkdfInputFromInputResponse=function(e){return t.util.asciiToHex(e.getPin())},n.prototype.createAuthenticatorSession=function(){return this._uiHandler.createPinAuthSession(n.authenticatorName,this.user.displayName,this.pinLength)},n.prototype.authenticateInStartedSession=function(e){var o=this;this._inputSession.promiseInput().then(function(r){return o.handleInputOrControlResponse(r)},function(r){return o.completeAuthenticatorSessionWithError(t.impl.AuthenticationErrorImpl.ensureAuthenticationError(r))})},n.prototype.registerInStartedSession=function(e){var o=this;this._inputSession.promiseInput().then(function(r){return o.handleInputOrControlResponse(r)},function(r){return o.completeAuthenticatorSessionWithError(t.impl.AuthenticationErrorImpl.ensureAuthenticationError(r))})},n.authenticatorName="pin",n}(u.AuthenticationDriverLocalSecretInputBased);u.AuthenticationDriverLocalPinCode=c}(i.authenticationdrivers||(i.authenticationdrivers={}))}(t.core||(t.core={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){!function(u){var c=function(s){function n(e,o,r){return s.call(this,e,o,r)||this}return V(n,s),n.prototype.poll=function(){var e=this;this._actionDriver.sendAuthenticatorAssertionRequest(this._authenticatorDescription,"authenticate",this.pollingAssertionData(),{}).then(function(o){e.filterAssertionResult(o)&&e.shouldContinuePolling(o)?e.pumpInput():e.handleAuthenticateAssertionResult(o,e._authenticatorDescription,"authenticate",e.pollingAssertionData)||(e._sdk.log(t.LogLevel.Info,function(){return"Authenticator session done."}),e.completeAuthenticatorSessionWithResult(new u.AuthenticationDriverSessionResultAuthenticationCompleted(o)))}).catch(function(o){e.performErrorRecoveryForError(t.impl.AuthenticationErrorImpl.ensureAuthenticationError(o))})},n.prototype.longPoll=function(e,o){var r=this;this._actionDriver.sendPollingRequest(e,o).then(function(h){h.change_detected?r.poll():r.pumpInput()}).catch(function(h){r.performErrorRecoveryForError(t.impl.AuthenticationErrorImpl.ensureAuthenticationError(h))})},n}(u.AuthenticationDriver);u.AuthenticationDriverPolling=c}(i.authenticationdrivers||(i.authenticationdrivers={}))}(t.core||(t.core={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){!function(u){var c=function(s){function n(e,o,r){var h=s.call(this,e,o,r)||this;return h.methodName="mobileApprove",h.setupDataModel(o,r),h}return V(n,s),n.prototype.createAuthenticatorSession=function(){var e=this,o=this._uiHandler.createMobileApproveAuthSession("mobile_approve",this.user.displayName,this._instructions);if(!o)throw t.impl.AuthenticationErrorImpl.appImplementationError("Invalid return from createMobileApproveAuthSession");if(o.setAvailableTargets(this._selectableDevices),this._state==i.Protocol.AuthenticationMethodMobileApproveState.WaitForAuthenticate){this._selectedDevices=this._selectableDevices.map(function(g){return g});var r=null;this._otp&&(r=p.ts.mobile.sdk.impl.MobileApproveOtpImpl.createFromServerFormat(this._otp)),o.setCreatedApprovalInfo(this._selectedDevices,r)}if(this._authenticationParameters){var h=this._authenticationParameters.filter(function(g){});if(0!=h.length){this._sdk.log(t.LogLevel.Debug,function(){return"Target based driver found target selection parameters."});var f=this._selectableDevices.reduce(function(g,y){return g[y.getDeviceIdentifier()]=y,g},{});this._pendingTargetSelection=h.map(function(g){var y=g.getTarget(),A=f[y.getDeviceIdentifier()];if(!A)throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.AppImplementation,"Authentication parameter tried to select a device not presented as a selectable target");return A},{}),this._sdk.log(t.LogLevel.Debug,function(){return"Target based driver will select targets "+e._pendingTargetSelection+" based on selection parameter."})}}return o},n.prototype.authenticateInStartedSession=function(e){this._autoExecuted?this._autoExecuted=!1:this.reset(),this.pumpInput()},n.prototype.pumpInput=function(){if(this._state===i.Protocol.AuthenticationMethodMobileApproveState.WaitForApproval)this.createApproval();else{if(this._state!==i.Protocol.AuthenticationMethodMobileApproveState.WaitForAuthenticate)throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Internal,"Illegal authenticator state encountered: "+this._state);this.requestInputAndHandle()}},n.prototype.registerInStartedSession=function(e){throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Internal,"Cannot register Mobile Approve authenticator.")},n.prototype.createApproval=function(){var e=this;if(this._approvalId=null,this._pendingTargetSelection&&Object.keys(this._pendingTargetSelection).length){this._sdk.log(t.LogLevel.Debug,function(){return"Performing pending target selection "+e._pendingTargetSelection});var o=t.TargetBasedAuthenticatorInput.createTargetsSelectionRequest(this._pendingTargetSelection);this._pendingTargetSelection=null,this.handleAuthenticationInputResponse(o)}else this._strategy.user_selection&&this._selectableDevices&&this._selectableDevices.length?this.requestInputAndHandle():this.handleAuthenticationInputResponse(t.TargetBasedAuthenticatorInput.createTargetsSelectionRequest([]))},n.prototype.requestInputAndHandle=function(){var e=this;this._inputSession.promiseInput().then(function(o){e.handleInputOrControlResponse(o)})},n.prototype.handleAuthenticationInputResponse=function(e){switch(this._state){case i.Protocol.AuthenticationMethodMobileApproveState.WaitForApproval:var o=e.getSelectedTargets();if(o){this.handleTargetSelectionInput(o);break}throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.AppImplementation,"Expected target selection input response but got: "+e);case i.Protocol.AuthenticationMethodMobileApproveState.WaitForAuthenticate:var r=e.getAuthenticatorInput();if(r instanceof t.MobileApproveInputRequestPolling){var h=r.getPollingTimeout();h?this.longPoll({type:"approval",approval_id:this._approvalId||""},h):this.poll();break}throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.AppImplementation,"Expected polling request input response but got: "+e);default:throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Internal,"Illegal state for authenticator: "+this._state)}},n.prototype.handleTargetSelectionInput=function(e){var o=this;this._selectedDevices=e.map(function(r){var h=r;if(o._selectableDevices.indexOf(h)<0)throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.AppImplementation,"Attempt to select a Mobile Approve target not originally listed in the session.");return h}),this.createForSelectedTargets()},n.prototype.createForSelectedTargets=function(){var e,o=this;e=this._selectedDevices&&this._selectedDevices.length?{device_ids:this._selectedDevices.map(function(r){return r.getDeviceIdentifier()})}:{},this._actionDriver.sendAuthenticatorAssertionRequest(this._authenticatorDescription,"approval",e,{}).then(function(r){if(!o.handleGeneralAssertionResult(r))if(r.assertion_error_code)o._sdk.log(t.LogLevel.Error,function(){return"Assertion error encoutered. Starting error recovery."}),o.performErrorRecoveryForError(t.impl.AuthenticationErrorImpl.errorForAssertionResponse(r));else{var h=null,f=r.data;f.otp&&(h=p.ts.mobile.sdk.impl.MobileApproveOtpImpl.createFromServerFormat(f.otp)),o._approvalId=f.approval_id||null,o._state=f.state,o._inputSession.setCreatedApprovalInfo(o._selectedDevices,h),o._sdk.log(t.LogLevel.Debug,function(){return"Restarting auth or reg."}),o.pumpInput()}}).catch(function(r){o.completeAuthenticatorSessionWithError(r)})},n.prototype.handleRegistrationInputResponse=function(e){throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Internal,"Cannot register Mobile Approve authenticator.")},n.prototype.processControlRequest=function(e){e.getRequestType()===t.ControlRequestType.RetryAuthenticator&&this.reset(),s.prototype.processControlRequest.call(this,e)},n.prototype.filterAssertionResult=function(e){if(5==e.assertion_error_code)throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.ApprovalDenied,"Approval was denied");if(21==e.assertion_error_code)throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.ApprovalExpired,"Approval has expired");return!0},n.prototype.shouldContinuePolling=function(e){return e.assertion_error_code==i.Protocol.AssertionErrorCode.ExternalProcessPending},n.prototype.pollingAssertionData=function(){return{approval_id:this._approvalId}},n.prototype.reset=function(){this._state=i.Protocol.AuthenticationMethodMobileApproveState.WaitForApproval,this._approvalId=null,this._selectedDevices=null,this._inputSession.setCreatedApprovalInfo(null,null)},n.prototype.setupDataModel=function(e,o){this._state=e.state,this._otp=e.otp||null,this._strategy=e.strategy,this._selectableDevices=u.AuthenticationDriverDescriptorMobileApprove.createTargetsFromConfig(e),this._instructions=e.instructions,this._approvalId=e.approval_id||null,this._approvalId&&(this._autoExecuted=!0)},n}(u.AuthenticationDriverPolling);u.AuthenticationDriverMobileApprove=c}(i.authenticationdrivers||(i.authenticationdrivers={}))}(t.core||(t.core={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){!function(u){var c=function(s){function n(e,o,r){return s.call(this,e,o,r)||this}return V(n,s),n.prototype.getBiometricPromptFallbackControlType=function(){return null!=this._biometricPromptFallbackControlType?this._biometricPromptFallbackControlType:t.ControlRequestType.SelectMethod},n.authenticatorKeyTagForUser=function(e,o,r){return new i.TarsusKeyPath("per_user",e.guid.toString(),"local_auth_keys","native_face",o,r)},n.prototype.shouldAllowBiometricFallbackButton=function(e){var o=this;if(!e)return!1;var r=this._actionDriver.availableAuthenticatorsForSwitching.filter(function(y){return y!=o._authenticatorDescription});if(this._actionDriver instanceof i.actiondrivers.ActionDriverRegistration||this._actionDriver instanceof i.actiondrivers.ActionDriverAuthentication&&0==r.length)return!1;var h=e,f=h.getFallbackButtonTitle();if(!(f&&f.length>0))return!1;var g=h.getFallbackControlRequestType();switch(null==g&&(g=t.ControlRequestType.SelectMethod),g){case t.ControlRequestType.ChangeMethod:return this._actionDriver.availableAuthenticatorsForSwitching.filter(function(y){return y!=o._authenticatorDescription}).length>0;case t.ControlRequestType.SelectMethod:return this._actionDriver.availableAuthenticatorsForSwitching.length>0;default:return!0}},n.prototype.runSilentRegistration=function(){var e=this;return this.generateFaceNativeKeyForScheme(this.currentScheme).then(function(o){var r=e.getNewOrUpdatedEnrollmentRecord(o),h={public_key:o.key.publicKeyToJson(),version:o.schemeVersion};return e._actionDriver.sendAuthenticatorAssertionRequest(e._authenticatorDescription,"register",null,h).then(function(f){if(f.assertion_error_code)throw t.impl.AuthenticationErrorImpl.errorForAssertionResponse(f);return e.user.updateEnrollmentRecord(r),new u.AuthenticationDriverSessionResultAuthenticationCompleted(f)})})},n.prototype.createAuthenticatorSession=function(){return this._uiHandler.createNativeFaceAuthSession(u.AuthenticationDriverDescriptorNativeFace.authenticatorName,this.user.displayName)},n.prototype.authenticateInStartedSession=function(e){var o=this;this._inputSession.promiseInput().then(function(r){return o.handleInputOrControlResponse(r)},function(r){return o.completeAuthenticatorSessionWithError(t.impl.AuthenticationErrorImpl.ensureAuthenticationError(r))})},n.prototype.registerInStartedSession=function(e){var o=this;s.prototype.registerInStartedSession.call(this,e),this._inputSession.promiseInput().then(function(r){return o.handleInputOrControlResponse(r)},function(r){return o.completeAuthenticatorSessionWithError(t.impl.AuthenticationErrorImpl.ensureAuthenticationError(r))})},Object.defineProperty(n.prototype,"authenticatorType",{get:function(){return u.AuthenticationDriverDescriptorNativeFace.authenticatorName},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"currentScheme",{get:function(){return"v2"},enumerable:!1,configurable:!0}),n.prototype.processLocalAuthenticatorError=function(e){var o=this,r=e,h=0,f=Promise.resolve();if(r.getErrorCode()==t.AuthenticationErrorCode.Internal&&r.getData()){var g=r.getData();h=g[l.sdkhost.ErrorDataNumFailures]||h,r=t.impl.AuthenticationErrorImpl.errorForHostInternalBiometricErrorData(g,"Native Face")||r,(g[l.sdkhost.ErrorDataInternalError]==l.sdkhost.InternalErrorBiometricNotConfigured&&this._authenticatorDescription.getRegistered()||g[l.sdkhost.ErrorDataInternalError]==l.sdkhost.InternalErrorBiometricInvalidated)&&(f=i.LocalEnrollment.invalidateLocalRegistrationStatusAndNotifyUIHandler(this._actionDriver._controlFlowProcessor,this._authenticatorDescription))}f.catch(function(y){o._sdk.log(t.LogLevel.Error,y)}),f.finally(function(){var y=r.getData();if(!h||o._operationMode!=t.AuthenticatorSessionMode.Authentication)return y[l.sdkhost.ErrorDataInternalError]==l.sdkhost.InternalErrorBiometricFallbackPressed?(o._sdk.log(t.LogLevel.Debug,function(){return"Biometric prompt fallback button pressed"}),void o.processControlRequest(t.ControlRequest.create(o.getBiometricPromptFallbackControlType()))):r.getErrorCode()==t.AuthenticationErrorCode.UserCanceled?(o._sdk.log(t.LogLevel.Debug,function(){return"Native face authenticator captured user cancel error code."}),void o.invokeCancellationUiOrEscape()):void o.performErrorRecoveryForError(r);o.processAuthFailureAssertionAndHandleError(r,h)})},n.prototype.getKeyForEnrollmentDataAndInput=function(e,o){var r=this;return new Promise(function(h,f){var g=o;r.shouldAllowBiometricFallbackButton(g)&&(r._biometricPromptFallbackControlType=g.getFallbackControlRequestType());var y=r.authenticatorKeyTagForScheme(e.version,e.salt),A=r._sdk.host.getKeyPair(y,l.sdkhost.KeyClass.StdSigningKey,l.sdkhost.KeyBiometricProtectionMode.BindToEnrollmentDb);if(!A){var T={};throw T[l.sdkhost.ErrorDataInternalError]=l.sdkhost.InternalErrorBiometricInvalidated,new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Internal,"Attempt to authenticate with invalidated FaceID.",T)}A.setBiometricPromptInfo(t.util.BiometricPromptInfoFrom.nativeFaceInput(g),null,null),h({key:A})})},n.prototype.generatePendingEnrollment=function(e,o){if(!o){var r=e;this.shouldAllowBiometricFallbackButton(r)&&(this._biometricPromptFallbackControlType=r.getFallbackControlRequestType())}return this.generateKeyForScheme(e,this.currentScheme).then(function(h){return o||h.key.setBiometricPromptInfo(t.util.BiometricPromptInfoFrom.nativeFaceInput(r),null,null),h})},n.prototype.generateKeyForScheme=function(e,o){return this.generateFaceNativeKeyForScheme(o)},n.prototype.schemeVersionRequiresRollover=function(e){return"v0"==e||"v1"==e},n.prototype.generateFaceNativeKeyForScheme=function(e){var o;o="v1"==e||"v2"==e?this._sdk.host.generateRandomHexString(24):"";var r=this.authenticatorKeyTagForScheme(e,o);return t.util.wrapPromiseWithActivityIndicator(this._uiHandler,this._actionDriver.policyAction(),this._clientContext,this._sdk.host.generateKeyPair(r,l.sdkhost.KeyClass.StdSigningKey,l.sdkhost.KeyBiometricProtectionMode.BindToEnrollmentDb,!0).then(function(h){return{key:h,salt:o,schemeVersion:e}},function(h){if(h.getErrorCode()==t.AuthenticationErrorCode.Internal&&h.getData()){var f=h.getData(),g=t.impl.AuthenticationErrorImpl.errorForHostInternalBiometricErrorData(f,"Native Face");if(g)throw g}throw h}))},n.prototype.authenticatorKeyTagForScheme=function(e,o){return n.authenticatorKeyTagForUser(this.user,e,o)},n}(u.AuthenticationDriverLocalPersistentKeyPairBased);u.AuthenticationDriverNativeFace=c}(i.authenticationdrivers||(i.authenticationdrivers={}))}(t.core||(t.core={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){!function(u){var c=function(s){function n(e,o,r,h){var f=s.call(this,e,o,h)||this;return f._possibleTargets=r,f.setupDataModel(o),f}return V(n,s),n.prototype.getPossibleTargets=function(){return this._possibleTargets},n.prototype.createAuthenticatorSession=function(){var e,o=this;if(0!=(e=this._authenticationParameters?this._authenticationParameters.filter(function(g){return g instanceof t.AuthenticationActionParameterTargetSelection}):[]).length){this._sdk.log(t.LogLevel.Debug,function(){return"Target based driver found target selection parameters."});var r=e[0].getTarget().getChannelAssertionId(),h=this._possibleTargets.filter(function(g){return g.getChannelAssertionId()==r});h.length?(this._pendingTargetSelection=h[0],this._sdk.log(t.LogLevel.Debug,function(){return"Target based driver will select target "+o._pendingTargetSelection+" based on selection parameter."}),this._lastSelectedTarget=this._pendingTargetSelection):this._sdk.log(t.LogLevel.Warning,function(){return"Target selection parameter for target based auth driver specified invalid target assertiong id "+r+"."})}var f=this._uiHandler.createOtpAuthSession("otp",this.user.displayName,this._possibleTargets,this._autoExecTarget);if(!f)throw t.impl.AuthenticationErrorImpl.appImplementationError("Invalid return from createOtpAuthSession");return f.setAvailableTargets(this._possibleTargets),f},n.prototype.authenticateInStartedSession=function(e){var o=this;if(0==this._possibleTargets.length)return this._sdk.log(t.LogLevel.Warning,function(){return"No authentication target available for OTP. Doing error recovery."}),void this.performErrorRecoveryForError(new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.AuthenticatorExternalConfigError,"No targets available for OTP."),!0);if(this._sdk.log(t.LogLevel.Debug,function(){return"Notifying current session of generated OTP format and target"}),this._inputSession.setGeneratedOtp(this._format,this._lastSelectedTarget),this._pendingTargetSelection){this._sdk.log(t.LogLevel.Debug,function(){return"Performing pending target selection "+o._pendingTargetSelection});var r=t.TargetBasedAuthenticatorInput.createTargetsSelectionRequest([this._pendingTargetSelection]);this._pendingTargetSelection=null,this.handleInputOrControlResponse(t.InputOrControlResponse.createInputResponse(r))}else this._inputSession.promiseInput().then(function(h){o.handleInputOrControlResponse(h)}).catch(function(h){o.completeAuthenticatorSessionWithError(t.impl.AuthenticationErrorImpl.ensureAuthenticationError(h))})},n.prototype.registerInStartedSession=function(e){throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Internal,"Cannot register OTP authenticator.")},n.prototype.handleTargetBasedAuthenticatorConcreteInput=function(e){if(e instanceof t.OtpInputOtpSubmission)this.processAuthenticateAssertion({otp:e.getOtp()},{assertion_id:this._possibleTargets[0].getChannelAssertionId()});else{if(!(e instanceof t.OtpInputRequestResend))throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.AppImplementation,"Unknown OTP response type received from application callback.");this.triggerForSelectedTarget()}},n.prototype.handleAuthenticateAssertionResult=function(e,o,r,h,f){return e.data&&e.data.additional_error_code&&1==e.data.additional_error_code&&(this._sdk.log(t.LogLevel.Debug,function(){return"Reached max number of attempts - invalidating current target."}),this._lastSelectedTarget=null,this._format=null),s.prototype.handleAuthenticateAssertionResult.call(this,e,o,r,h,f)},n.prototype.handleAuthenticationInputResponse=function(e){if(e.getAuthenticatorInput())this.handleTargetBasedAuthenticatorConcreteInput(e.getAuthenticatorInput());else{if(!e.getSelectedTargets()[0])throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.AppImplementation,"Invalid target-based authetnicator response type received from application callback. Target-based authenticator inputs must be created by calling TargetBasedAuthenticatorInput.createAuthenticatorInput.");var o=e.getSelectedTargets();if(o.length>1)throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.AppImplementation,"Attempt to select multiple OTP targets while OTP supports only a single target.");var r=o[0];if(this._possibleTargets.indexOf(r)<0)throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.AppImplementation,"Attempt to select an OTP target not originally listed in the session.");this._lastSelectedTarget=r,this.triggerForSelectedTarget()}},n.prototype.triggerForSelectedTarget=function(){var e=this;if(!this._lastSelectedTarget)throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Internal,"Attempt to trigger OTP generation without a selected target.");var o={target_id:this._lastSelectedTarget.getTargetIdentifier(),channel_index:this._lastSelectedTarget.getChannelIndex()},r={assertion_id:this._lastSelectedTarget.getChannelAssertionId()};this._actionDriver.sendAuthenticatorAssertionRequest(this._authenticatorDescription,"otp",o,r).then(function(h){h.assertion_error_code&&h.assertion_error_code!=i.Protocol.AssertionErrorCode.FailOver&&(e._sdk.log(t.LogLevel.Error,function(){return"Assertion error encoutered. Clearing last selected target."}),e._lastSelectedTarget=null),e.handleAuthenticateAssertionResult(h,e._authenticatorDescription,"otp",r,r)||(h.data&&h.data.otp_format&&(e._sdk.log(t.LogLevel.Debug,function(){return"Received updated OTP and format."}),e._format=t.OtpFormatImpl.fromAssertionFormat(h.data.otp_format)),e._sdk.log(t.LogLevel.Debug,function(){return"Restarting auth or reg."}),e.authOrRegInStartedSession(!0))}).catch(function(h){e.completeAuthenticatorSessionWithError(h)})},n.prototype.handleRegistrationInputResponse=function(e){throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Internal,"Cannot register OTP authenticator.")},n.prototype.setupDataModel=function(e){this._otpInitialState=e.state,this._otpInitialState==i.Protocol.AuthenticationMethodOtpState.Validate&&(this._lastSelectedTarget=this._possibleTargets[0],this._autoExecTarget=this._lastSelectedTarget);var o=e.format||e.otp_format;this._format=o&&t.OtpFormatImpl.fromAssertionFormat(o)||null},n}(u.AuthenticationDriver);u.AuthenticationDriverOtp=c}(i.authenticationdrivers||(i.authenticationdrivers={}))}(t.core||(t.core={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){!function(u){var c=function(s){function n(e,o,r){return s.call(this,e,o,r)||this}return V(n,s),n.prototype.createAuthenticatorSession=function(){return this._uiHandler.createPasswordAuthSession("password",this.user.displayName)},n.prototype.authenticateInStartedSession=function(e){var o=this;this._inputSession.promiseInput().then(function(r){return o.handleInputOrControlResponse(r)},function(r){return o.completeAuthenticatorSessionWithError(t.impl.AuthenticationErrorImpl.ensureAuthenticationError(r))})},n.prototype.registerInStartedSession=function(e){var o=this;this._inputSession.promiseInput().then(function(r){return o.handleInputOrControlResponse(r)},function(r){return o.completeAuthenticatorSessionWithError(t.impl.AuthenticationErrorImpl.ensureAuthenticationError(r))})},n.prototype.handleAuthenticationInputResponse=function(e){var o=e.getPassword();o&&o.length>0?this.processAuthenticateAssertion({password:o}):this.performErrorRecoveryForError(new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.InvalidInput,"Password can't be empty"))},n.prototype.handleRegistrationInputResponse=function(e){var o=e.getPassword();o&&o.length>0?this.processRegisterAssertion({password:o}):this.performErrorRecoveryForError(new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.InvalidInput,"Password can't be empty"))},n}(u.AuthenticationDriver);u.AuthenticationDriverPassword=c}(i.authenticationdrivers||(i.authenticationdrivers={}))}(t.core||(t.core={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){!function(u){var c=function(s){function n(e,o,r){return s.call(this,e,o,r)||this}return V(n,s),n.prototype.createAuthenticatorSession=function(){return this._uiHandler.createPatternAuthSession("pattern_centralized",this.user.displayName,3,4)},n.prototype.handleAuthenticationInputResponse=function(e){t.impl.PatternInputImpl.validateFormat(e)?s.prototype.handleAuthenticationInputResponse.call(this,e):this.performErrorRecoveryForError(new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.AppImplementation,"Invalid pattern description format."))},n.prototype.handleRegistrationInputResponse=function(e){var o=e,r=this._authenticatorConfig;t.impl.PatternInputImpl.validateFormat(o)?r.min_length&&t.impl.PatternInputImpl.getPatternLength(o)<r.min_length?this.performErrorRecoveryForError(new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.AppImplementation,"Invalid pattern length.")):s.prototype.handleRegistrationInputResponse.call(this,e):this.performErrorRecoveryForError(new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.AppImplementation,"Invalid pattern description format."))},n.prototype.generateSecretToSignForInputResponse=function(e){return e.getPatternDescription()},n}(u.AuthenticationDriverCentralizedSecretInputBased);u.AuthenticationDriverPattern=c}(i.authenticationdrivers||(i.authenticationdrivers={}))}(t.core||(t.core={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){!function(u){var c=function(s){function n(e,o,r){return s.call(this,e,o,r)||this}return V(n,s),Object.defineProperty(n.prototype,"pinLength",{get:function(){return this._authenticatorConfig.length},enumerable:!1,configurable:!0}),n.prototype.createAuthenticatorSession=function(){return this._uiHandler.createPinAuthSession("pin_centralized",this.user.displayName,this.pinLength)},n.prototype.handleRegistrationInputResponse=function(e){e.getPin().length==this.pinLength?s.prototype.handleRegistrationInputResponse.call(this,e):this.performErrorRecoveryForError(new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.InvalidInput,"Invalid PIN length provided.",{expected_length:this.pinLength}))},n.prototype.generateSecretToSignForInputResponse=function(e){return e.getPin()},n}(u.AuthenticationDriverCentralizedSecretInputBased);u.AuthenticationDriverPinCode=c}(i.authenticationdrivers||(i.authenticationdrivers={}))}(t.core||(t.core={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){!function(u){var c=function(s){function n(e,o,r){return s.call(this,e,o,r)||this}return V(n,s),n.prototype.createAuthenticatorSession=function(){var e=this,o=this.generatePlaceholderServerTokenGenerationPayload();return n.placeholderExtensionPoint.firstNonNull(function(h){return h.createPlaceholderAuthSession(e._authenticatorDescription.getPlaceholderId(),e._authenticatorConfig.placeholder_type||"",e._authenticatorDescription.getName()||"",e.user.displayName,e._authenticatorConfig.data||"",o)})||this._uiHandler.createPlaceholderAuthSession(this._authenticatorDescription.getPlaceholderId(),this._authenticatorConfig.placeholder_type||"",this._authenticatorDescription.getName()||"",this.user.displayName,this._authenticatorConfig.data||"",o)},n.prototype.authenticateOrRegisterInStratedSession=function(e){var o=this;this._inputSession.promiseInput().then(function(r){return o.handleInputOrControlResponse(r)},function(r){return o.completeAuthenticatorSessionWithError(t.impl.AuthenticationErrorImpl.ensureAuthenticationError(r))})},n.prototype.authenticateInStartedSession=function(e){this.authenticateOrRegisterInStratedSession(e)},n.prototype.registerInStartedSession=function(e){this.authenticateOrRegisterInStratedSession(e)},n.prototype.handleAuthenticationInputResponse=function(e){this.handleAuthenticationOrRegistrationInputResponse(e)},n.prototype.handleRegistrationInputResponse=function(e){this.handleAuthenticationOrRegistrationInputResponse(e)},n.prototype.handleAuthenticationOrRegistrationInputResponse=function(e){e instanceof t.PlaceholderAuthSuccessResponse?(this._sdk.log(t.LogLevel.Debug,function(){return"Placeholder received PlaceholderAuthSuccessResponse."}),this.handlePlaceholderSuccessResponse(e)):e instanceof t.PlaceholderAuthFailureResponse?(this._sdk.log(t.LogLevel.Debug,function(){return"Placeholder received PlaceholderAuthFailureResponse."}),this.handlePlaceholderFailureResponse(e)):e instanceof t.PlaceholderAuthFailureWithServerProvidedStatusResponse?(this._sdk.log(t.LogLevel.Debug,function(){return"Placehoder received PlaceholderAuthFailureWithServerProvidedStatusResponse"}),this.processAuthFailureAssertionAndHandleError(e.getFailureError(),1)):(this._sdk.log(t.LogLevel.Error,function(){return"Placeholder received unknkown response type."}),this.performErrorRecoveryForError(new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.AppImplementation,"Placeholder received unknkown response type.")))},n.prototype.handlePlaceholderSuccessResponse=function(e){var o={token:e.getPlaceholderToken()};this._operationMode==t.AuthenticatorSessionMode.Authentication?this.processAuthenticateAssertion(o):this.processRegisterAssertion(o)},n.prototype.handlePlaceholderFailureResponse=function(e){this._actionDriver.sendAuthenticatorAssertionRequest(this._authenticatorDescription,"auth_failure",{num_of_failures:1});var o={status:e.getRegistrationStatus()==t.AuthenticatorRegistrationStatus.Registered?i.Protocol.AuthenticationMethodStatus.Registered:i.Protocol.AuthenticationMethodStatus.Unregistered,expired:e.getExpired(),locked:e.getLocked(),last_used:0};this._authenticatorDescription.updateWithAuthenticatorState(o),this.performErrorRecoveryForError(e.getFailureError())},n.prototype.generatePlaceholderServerTokenGenerationPayload=function(){var e=this.user.deviceId||this._actionDriver._controlFlowProcessor._session.deviceId(),o={assertion_id:this._authenticatorDescription.assertionId,challenge:this._actionDriver._controlFlowProcessor.challenge,device_id:e,auth_type:this._authenticatorDescription.getAuthenticatorId()};return btoa(JSON.stringify(o))},n.placeholderExtensionPoint=new i.ExtensionPoint(l.tarsusplugin.TARSUS_EXTENSION_POINT_NAME_PLACEHOLDER_EXTENSION),n}(u.AuthenticationDriver);u.AuthenticationDriverPlaceholder=c}(i.authenticationdrivers||(i.authenticationdrivers={}))}(t.core||(t.core={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){!function(u){var c=function(s){function n(e,o,r){var h=s.call(this,e,o,r)||this;return h._pendingRestartRequest=!1,h}return V(n,s),Object.defineProperty(n.prototype,"currentQuestionsStep",{get:function(){return this._currentStep},enumerable:!1,configurable:!0}),n.prototype.createAuthenticatorSession=function(){return this._pendingRestartRequest=!1,this._uiHandler.createSecurityQuestionAuthSession("question",this.user.displayName)},n.prototype.authenticateInStartedSession=function(e){var o=this,r=Promise.resolve(null);this._pendingRestartRequest&&(this._pendingRestartRequest=!1,r=this._actionDriver.sendAuthenticatorAssertionRequest(this._authenticatorDescription,"restart",{}).then(function(h){h.data&&h.data.question?o._currentStep=o.loadStepFromQuestionDict(h.data.question):o.completeAuthenticatorSessionWithError(new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Internal,"Unexpected response to question restart request."))})),r.then(function(h){s.prototype.authenticateInStartedSession.call(o,e)})},n.prototype.loadStepFromQuestionDict=function(e){var o=Object.keys(e);if(1!=o.length)throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Internal,"Expecting a single authentication question.");return t.impl.SecurityQuestionStepDescriptionImpl.createForAuthQuestion(new t.impl.SecurityQuestionImpl(o[0],e[o[0]],!0))},n.prototype.createInitialInputStep=function(){var e=this._authenticatorConfig;switch(this._operationMode){case t.AuthenticatorSessionMode.Authentication:if(!e.question)throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Internal,"Expecting authentication question dictionary.");return this.loadStepFromQuestionDict(e.question);case t.AuthenticatorSessionMode.Registration:if(!e.questions)throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Internal,"Expecting registration question dictionary.");if(!e.reg_min_questions)throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Internal,"Expecting minimum registered questions field");if(e.max_answer_length||(e.max_answer_length=-1),!e.min_answer_length)throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Internal,"Expecting minimum answer length");var o=e.questions,r=Object.keys(o).map(function(h){return new t.impl.SecurityQuestionImpl(h,o[h].text,o[h].registered)});return t.impl.SecurityQuestionStepDescriptionImpl.createForRegistrationQuestions(r,e.reg_min_questions,e.max_answer_length,e.min_answer_length)}},n.prototype.prepareNextAuthenticationStep=function(e){return this.loadStepFromQuestionDict(e.data.question)},n.prototype.updateCurrentAuthenticationStep=function(e,o){return o},n.prototype.handleAuthenticationInputResponse=function(e){var o=e;if(this.sortValidAnswers(o),1!=o.getAnswers().length)throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.AppImplementation,"Expecting exactly one answer on secuirty question authentication.");var r=this.securityQuestionAnswersResposneToAnswerMap(o);this.processAuthenticateAssertion({answer:r})},n.prototype.handleRegistrationInputResponse=function(e){var o=e,r=this.currentSecurityQuestionsStep().getMinAnswersNeeded();if(0==r)throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.AppImplementation,"No answers were provided");this.sortValidAnswers(o);var h=0;this.currentQuestionsStep.getSecurityQuestions().forEach(function(y){y.getAnswered()&&h++});var f=this.securityQuestionAnswersResposneToJson(o),g=f.answers.length+h-f.deleted_answers.length;if(this._sdk.log(t.LogLevel.Debug,function(){return"handleRegistrationInputResponse: alreadyAnswered:"+h+" with sent list of "+f.answers.length+" and deleted of "+f.deleted_answers.length}),r>g)throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.AppImplementation,"Only "+g+" answers were provided to security questions registration process. "+g+" answers out of required minimum of "+r+".");this.processRegisterAssertion(this.securityQuestionAnswersResposneToJson(o))},n.prototype.handleErrorRecoveryAction=function(e,o){o.getErrorCode()==t.AuthenticationErrorCode.InvalidInput&&(this._pendingRestartRequest=!0),s.prototype.handleErrorRecoveryAction.call(this,e,o)},n.prototype.sortValidAnswers=function(e){for(var o=Array(),r=0,h=e.getAnswers();r<h.length;r++){var f=h[r];if(!f.getIsRemoved()){if(!f.getAnswer()||!f.getAnswer().getAnswerText()||f.getAnswer().getAnswerText().length<this.currentQuestionsStep.getMinAnswerLength())throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.AppImplementation,"Answer too short. Answer must be at least "+this.currentQuestionsStep.getMinAnswerLength()+" characters.");if(this.currentQuestionsStep.getMaxAnswerLength()>0&&f.getAnswer().getAnswerText().length>this.currentQuestionsStep.getMaxAnswerLength())throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.AppImplementation,"Answer too long. Answer must be maximum "+this.currentQuestionsStep.getMaxAnswerLength()+" characters.");o.push(f)}}return o},n.prototype.securityQuestionAnswersResposneToJson=function(e){var o=this,r={},h=Array();return e.getAnswers().forEach(function(f){if(o.currentSecurityQuestionsStep().getSecurityQuestions().indexOf(f.getQuestion())<0)throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.AppImplementation,"Answer provided to a question not included in this step.");if(f.getIsRemoved())h.push(f.getQuestion().getSecurityQuestionId());else{var g=f.getAnswer().getAnswerText().toLocaleLowerCase();r[f.getQuestion().getSecurityQuestionId()]=g}}),{answers:r,deleted_answers:h}},n.prototype.securityQuestionAnswersResposneToAnswerMap=function(e){var o=this,r={};return e.getAnswers().forEach(function(h){if(o.currentSecurityQuestionsStep().getSecurityQuestions().indexOf(h.getQuestion())<0)throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.AppImplementation,"Answer provided to a question not included in this step.");var f=h.getAnswer().getAnswerText().toLocaleLowerCase();r[h.getQuestion().getSecurityQuestionId()]=f}),r},n.prototype.currentSecurityQuestionsStep=function(){return this._currentStep},n}(u.AuthenticationDriverMultiStep);u.AuthenticationDriverSecurityQuestions=c}(i.authenticationdrivers||(i.authenticationdrivers={}))}(t.core||(t.core={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){!function(u){var c=function(){};u.AuthenticationDriverSessionResult=c;var s=function(o){function r(h,f){var g=o.call(this)||this;return g.requiredAuthenticator=h||null,g.allowedAuthenticators=f||null,g}return V(r,o),r}(c);u.AuthenticationDriverSessionResultSwitchAuthenticator=s;var n=function(o){function r(h){var f=o.call(this)||this;return f.assertionResult=h,f}return V(r,o),r}(c);u.AuthenticationDriverSessionResultAuthenticationCompleted=n;var e=function(o){function r(h){var f=o.call(this)||this;return f.escapeRequest=h,f}return V(r,o),r}(c);u.AuthenticationDriverSessionResultEscapeRequested=e}(i.authenticationdrivers||(i.authenticationdrivers={}))}(t.core||(t.core={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){!function(u){var c=function(s){function n(e,o,r){var h=s.call(this,e,o,r)||this;return h._previousSelectedDevices=[],h.methodName="totp",h.setupDataModel(o,r),h}return V(n,s),n.prototype.setupDataModel=function(e,o){this._state=e.state,this._requiresChallengeGeneration=e.state!=i.Protocol.AuthenticationMethodTotpState.Validate,this._selectedDevices=null,this._state==i.Protocol.AuthenticationMethodTotpState.Validate&&e.challenge&&(this._challenge=this.createTotpChallenge(e.challenge)),this._selectableDevices=e.selectable_devices?u.AuthenticationDriverDescriptorTotp.createTargetsFromConfig(e):null},n.prototype.createAuthenticatorSession=function(){var e=this;if(this._authenticationParameters){var o=this._authenticationParameters.filter(function(f){});if(this._selectableDevices&&0!=o.length){this._sdk.log(t.LogLevel.Debug,function(){return"Target based driver found target selection parameters."});var r=this._selectableDevices.reduce(function(f,g){return f[g.getDeviceIdentifier()]=g,f},{});this._pendingTargetSelection=o.map(function(f){var g=f.getTarget(),y=r[g.getDeviceIdentifier()];if(!y)throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.AppImplementation,"Authentication parameter tried to select a device not presented as a selectable target");return y},{}),this._sdk.log(t.LogLevel.Debug,function(){return"Target based driver will select targets "+e._pendingTargetSelection+" based on selection parameter."})}}var h=this._uiHandler.createTotpAuthSession("totp",this.user.displayName);if(!h)throw t.impl.AuthenticationErrorImpl.appImplementationError("Invalid return from createTotpAuthSession");return h.setAvailableTargets(this._selectableDevices),h},n.prototype.handleRegistrationInputResponse=function(e){throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Internal,"Cannot register TOTP authenticator.")},n.prototype.registerInStartedSession=function(e){throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Internal,"Cannot register TOTP authenticator.")},n.prototype.authenticateInStartedSession=function(e){var o=this;!this._selectedDevices&&this._pendingTargetSelection&&this._pendingTargetSelection.length&&(this._sdk.log(t.LogLevel.Debug,function(){return"TOTP authentication driver has "+o._pendingTargetSelection.length+" pending targets."}),this._selectedDevices=this._pendingTargetSelection),this.requestInput()},n.prototype.requestInput=function(){var e=this;this._inputSession.setTargetDevices(this._selectedDevices),this._inputSession.setChallenge(this._challenge),this.pendingChallengeGeneration()?this.sendGenerateTotpAssertion():this._inputSession.promiseInput().then(function(o){e.handleInputOrControlResponse(o)}).catch(function(o){e.performErrorRecoveryForError(t.impl.AuthenticationErrorImpl.ensureAuthenticationError(o))})},n.prototype.handleAuthenticationInputResponse=function(e){var o=e.getAuthenticatorInput(),r=e.getSelectedTargets();if(o){this._sdk.log(t.LogLevel.Debug,function(){return"Handling OTP code Input."});var h={totp:o.getCode()};this._selectedDevices&&(h.device_ids=this._selectedDevices.map(function(g){return g.getDeviceIdentifier()})),this.processAuthenticateAssertion(h)}else{if(!r||!this._selectableDevices)throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.AppImplementation,"Invalid target-based authenticator response type received from application callback. Target-based authenticator inputs must be created by calling TargetBasedAuthenticatorInput.createAuthenticatorInput.");var f=this._selectableDevices;if(this._sdk.log(t.LogLevel.Debug,function(){return"Handling target selection Input."}),this._selectedDevices=r.map(function(g){var y=g;if(f.indexOf(y)<0)throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.AppImplementation,"Attempt to select a Totp target not originally listed in the session.");return y}),0===this._selectedDevices.length)throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.InvalidInput,"No targets selected for TOTP.");this.requestInput()}},n.prototype.sendGenerateTotpAssertion=function(){var e=this,o={};this._selectedDevices&&(o.device_ids=this._selectedDevices.map(function(r){return r.getDeviceIdentifier()})),this._sdk.log(t.LogLevel.Debug,function(){return"Requesting TOTP generation"}),this._actionDriver.sendAuthenticatorAssertionRequest(this._authenticatorDescription,"generate",o,{}).then(function(r){e._previousSelectedDevices=e._selectedDevices||[],r.assertion_error_code&&r.assertion_error_code!=i.Protocol.AssertionErrorCode.FailOver&&(e._sdk.log(t.LogLevel.Error,function(){return"Assertion error encountered."}),e._selectedDevices=null),!e.handleAuthenticateAssertionResult(r,e._authenticatorDescription,"generate",o)&&r.data&&(e._state=r.data.state,r.data.challenge&&(e._challenge=e.createTotpChallenge(r.data.challenge)),e.requestInput())}).catch(function(r){e.performErrorRecoveryForError(t.impl.AuthenticationErrorImpl.ensureAuthenticationError(r))})},n.prototype.pendingChallengeGeneration=function(){var e=this._selectedDevices&&(this._previousSelectedDevices.length!==this._selectedDevices.length||this._previousSelectedDevices.some(function(r,h){return r!==this._selectedDevices[h]},this));return this._requiresChallengeGeneration&&(e||!this._selectableDevices&&this._state==i.Protocol.AuthenticationMethodTotpState.Generate)},n.prototype.createTotpChallenge=function(e){var o=new t.TotpChallenge;return o.setValue(e.value),o.setFormat(t.TotpChallengeFormatImpl.fromAssertionFormat(e.format)),o},n.prototype.handleAuthenticateAssertionResult=function(e,o,r,h,f){if(e.assertion_error_code&&e.assertion_error_code==i.Protocol.AssertionErrorCode.RepeatCurrentStep&&e.data&&"check_digit"==e.data.reason){this._sdk.log(t.LogLevel.Debug,function(){return"handleAuthenticateAssertionResult() for Totp code with incorrect check digit"});var g=new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.InvalidInput,e.assertion_error_message||"Totp code with incorrect check digit");return g.setPublicProperty(t.AuthenticationErrorProperty.AuthenticatorInvalidInputErrorDescription,t.AuthenticationErrorPropertySymbol.AuthenticatorInvalidInputErrorDescriptionTotpIncorrectCheckDigit),this.performErrorRecoveryForError(g),!0}return s.prototype.handleAuthenticateAssertionResult.call(this,e,o,r,h,f)},n}(u.AuthenticationDriver);u.AuthenticationDriverTotp=c}(i.authenticationdrivers||(i.authenticationdrivers={}))}(t.core||(t.core={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){!function(u){var c,n;(n=c||(c={})).LONG="tooLong",n.SHORT="tooShort",n.LOUD="tooLoud",n.SOFT="tooSoft",n.NOISY="tooNoisy",n.WRONG_PASSPHRASE="wrongPassphrase",n.VALID_PASSPHRASE="000";var s=function(n){function e(o,r,h){return n.call(this,o,r,h)||this}return V(e,n),e.prototype.createAuthenticatorSession=function(){return this._uiHandler.createVoiceAuthSession("voice",this.user.displayName)},e.prototype.updatePassphraseFromAssertionResultIfNeeded=function(o){var r=o.data;if(r){var h=r.passphrase_text;h&&(this._sdk.log(t.LogLevel.Debug,function(){return"handleAuthenticateAssertionResult() received updated passphrase"}),this._authenticatorConfig.passphrase_text=h)}},e.prototype.handleRegisterAssertionResult=function(o){return this.updatePassphraseFromAssertionResultIfNeeded(o),n.prototype.handleRegisterAssertionResult.call(this,o)},e.prototype.handleAuthenticateAssertionResult=function(o,r,h,f,g){return this.updatePassphraseFromAssertionResultIfNeeded(o),n.prototype.handleAuthenticateAssertionResult.call(this,o,r,h,f,g)},e.prototype.createInitialInputStep=function(){var o=this._authenticatorConfig;return new t.impl.AudioAcquisitionStepDescriptionImpl(this.createStepTag(),o.passphrase_text)},e.prototype.prepareNextAuthenticationStep=function(o){var r=this._authenticatorConfig;return new t.impl.AudioAcquisitionStepDescriptionImpl(this.createStepTag(o.data&&o.data.additional_error_code),r.passphrase_text)},e.prototype.updateCurrentAuthenticationStep=function(o,r){return this.prepareNextAuthenticationStep(o)},e.prototype.handleAuthenticationInputResponse=function(o){this.processAuthenticateAssertion(o.getAcquisitionResponse())},e.prototype.handleRegistrationInputResponse=function(o){this.processRegisterAssertion(o.getAcquisitionResponse())},e.prototype.createStepTag=function(o){return"voice_"+(o?this.mapHintToVoiceError(o):c.VALID_PASSPHRASE)},e.prototype.mapHintToVoiceError=function(o){switch(o){case 101:return c.LONG;case 102:return c.SHORT;case 103:return c.LOUD;case 104:return c.SOFT;case 105:return c.NOISY;case 106:return c.WRONG_PASSPHRASE;default:throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Internal,"Voice error code "+o+" is unknown/unhandled")}},e}(u.AuthenticationDriverMultiStep);u.AuthenticationDriverVoice=s}(i.authenticationdrivers||(i.authenticationdrivers={}))}(t.core||(t.core={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){!function(u){u.AuthenticatorDrivers={password:new u.SimpleAuthenticationDriverDescriptor(u.AuthenticationDriverPassword),pin_centralized:new u.SimpleAuthenticationDriverDescriptor(u.AuthenticationDriverPinCode),pin:new u.AuthenticationDriverDescriptorLocal(u.AuthenticationDriverLocalPinCode,u.AuthenticationDriverLocalPinCode.authenticatorName),pattern:new u.AuthenticationDriverDescriptorLocal(u.AuthenticationDriverLocalPattern,u.AuthenticationDriverLocalPattern.authenticatorName),pattern_centralized:new u.SimpleAuthenticationDriverDescriptor(u.AuthenticationDriverPattern),fingerprint:new u.AuthenticationDriverDescriptorFingerprint,face_id:new u.AuthenticationDriverDescriptorNativeFace,otp:new u.AuthenticationDriverDescriptorOtp,face_server:new u.AuthenticationDriverDescriptorFace,voice_server:new u.AuthenticationDriverDescriptorVoice,mobile_approve:new u.AuthenticationDriverDescriptorMobileApprove,totp:new u.AuthenticationDriverDescriptorTotp,question:new u.SimpleAuthenticationDriverDescriptor(u.AuthenticationDriverSecurityQuestions),fido2:new u.AuthenticationDriverDescriptorFido2(u.AuthenticationDriverFido2),device_biometrics:new u.AuthenticationDriverDescriptorDeviceBiometrics,__placeholder:new u.SimpleAuthenticationDriverDescriptor(u.AuthenticationDriverPlaceholder)}}(i.authenticationdrivers||(i.authenticationdrivers={}))}(t.core||(t.core={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){var t,i,u,c;t=(u=(c=l.sdk||(l.sdk={})).core||(c.core={})).collectors||(u.collectors={}),i=function(){function s(n){this.enabledCollectors=n}return s.prototype.isEnabled=function(){var n=this.getAssociatedCollectorType();return null==n||-1!=this.enabledCollectors.indexOf(n)},s}(),t.Collector=i}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){var t,i,u,c;i=function(s){function n(e,o){var r=s.call(this,e)||this;return r.cacheValidityPeriod=o,r}return V(n,s),n.prototype.provide=function(e){var o=this;return new Promise(function(r,h){var f=o.getCachedData(e);f?r(f):o.provideNewData(e).then(function(g){o.saveCollectionResultToLocalStorage(e,g),r(g)},h)})},n.prototype.saveCollectionResultToLocalStorage=function(e,o){var r=e.host,h=this.getSchemeVersionTarsusKeyPath(),f=new Object;f.timeStamp=Date.now(),f.collectionResult=o,r.writeStorageKey(h,f)},n.prototype.getCachedData=function(e){var o=e.host,r=this.getSchemeVersionTarsusKeyPath(),h=o.readStorageKey(r);if(!h.collectionResult||!h.timeStamp)return e.log(c.LogLevel.Debug,function(){return"No collected data found in cache."}),null;var f=h.timeStamp;return Date.now()-f>this.cacheValidityPeriod?(e.log(c.LogLevel.Debug,function(){return"Cached collected data invalidated."}),null):(e.log(c.LogLevel.Debug,function(){return"Loaded cached collector data: "+JSON.stringify(h.collectionResult)}),h.collectionResult)},n}((t=(u=(c=l.sdk||(l.sdk={})).core||(c.core={})).collectors||(u.collectors={})).Collector),t.CacheableCollector=i}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){var t,i,u,c;i=function(s){function n(){return null!==s&&s.apply(this,arguments)||this}return V(n,s),n.prototype.provide=function(e){return It(this,void 0,void 0,function(){var o,r;return zt(this,function(h){switch(h.label){case 0:return o=new Object,r=o,[4,e.host.queryAsyncHostInfo(l.sdkhost.AsyncHostInformationKey.Fido2UserVerifyingPlatformAuthenticatorAvailable)];case 1:return r.fido2_user_verifying_platform_authenticator_available="true"==h.sent(),o.audio_acquisition_supported="true"==e.host.queryHostInfo(l.sdkhost.HostInformationKey.AudioAcquitisionSupported),o.finger_print_supported="true"==e.host.queryHostInfo(l.sdkhost.HostInformationKey.FingerprintSupported),o.image_acquisition_supported="true"==e.host.queryHostInfo(l.sdkhost.HostInformationKey.ImageAcquitisionSupported),o.persistent_keys_supported="true"==e.host.queryHostInfo(l.sdkhost.HostInformationKey.PersistentKeysSupported),o.face_id_key_bio_protection_supported="true"==e.host.queryHostInfo(l.sdkhost.HostInformationKey.FaceIdKeyBioProtectionSupported),o.fido_client_present="true"==e.host.queryHostInfo(l.sdkhost.HostInformationKey.FidoClientPresent),o.fido2_client_present="true"==e.host.queryHostInfo(l.sdkhost.HostInformationKey.Fido2ClientPresent),o.dyadic_present="true"==e.host.queryHostInfo(l.sdkhost.HostInformationKey.DyadicPresent),o.installed_plugins=e.pluginManager.getInitializedPlugins().map(function(f){return{plugin_name:f.getPluginInfo().getPluginName(),plugin_version:l.tarsusplugin.impl.PluginInfoImpl.versionToString(f.getPluginInfo())}}),""!=e.host.queryHostInfo(l.sdkhost.HostInformationKey.HostProvidedFeatures)&&(o.host_provided_features=e.host.queryHostInfo(l.sdkhost.HostInformationKey.HostProvidedFeatures)),[2,o]}})})},n.prototype.getAssociatedCollectorType=function(){return c.CollectorType.Capabilities},n}((t=(u=(c=l.sdk||(l.sdk={})).core||(c.core={})).collectors||(u.collectors={})).Collector),t.CapabilitiesCollector=i}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){var t,i,u,c;c=l.sdk||(l.sdk={}),u=function(s){function n(){return null!==s&&s.apply(this,arguments)||this}return V(n,s),n.prototype.provide=function(e){var o=new Object;for(var r in c.CollectorType)o[r]=t.Protocol.CollectorState.Disabled;for(var h=0,f=this.enabledCollectors;h<f.length;h++)o[f[h]]=t.Protocol.CollectorState.Active;var g=new Object;for(var y in c.CollectorType)this.isNumeric(y)&&(g[c.CollectorType[y].toLowerCase()]=o[y]);return Promise.resolve(g)},n.prototype.getAssociatedCollectorType=function(){return null},n.prototype.isNumeric=function(e){return parseInt(e,10)>=0},n}((i=(t=c.core||(c.core={})).collectors||(t.collectors={})).Collector),i.CollectorsStateCollector=u}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){var t,i,u,c;c=l.sdk||(l.sdk={}),i=function(s){function n(){return null!==s&&s.apply(this,arguments)||this}return V(n,s),n.prototype.provide=function(e){var o=e.host,r=new Object;r.logged_users=0,u.User.iterateUsers(e,function(f){f.deviceBound&&++r.logged_users});var h=o.queryHostInfo(l.sdkhost.HostInformationKey.DevicePersistenceMode);return"string"==typeof h&&(r.persistence_mode=h),Promise.resolve(r)},n.prototype.getAssociatedCollectorType=function(){return c.CollectorType.DeviceDetails},n}((t=(u=c.core||(c.core={})).collectors||(u.collectors={})).Collector),t.DeviceDetailsCollector=i}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){var t,i,u,c;c=l.sdk||(l.sdk={}),i=function(s){function n(e){return s.call(this,e,n.cacheValidityPeriod)||this}return V(n,s),n.prototype.provideNewData=function(e){var o=this;return new Promise(function(r,h){if(!e.currentSession)throw"No valid session.";var f=new Object;e.log(c.LogLevel.Debug,function(){return"Refreshing fido authenticators data"});for(var g=new Array,y=0,A=u.authenticationdrivers._fidoClientProviders;y<A.length;y++)g.push(A[y].getAvailableAuthenticatorsIds(e));Promise.all(g.map(function(C){return C.catch(function(E){return new Error(E)})})).then(function(C){var E=o.getCollectedAaids(C,e);f.fido=E,r(f)}).catch(function(C){e.log(c.LogLevel.Error,function(){return"Error parsing fido authenticators collection results"+C}),r({})})})},n.prototype.getAssociatedCollectorType=function(){return c.CollectorType.FidoAuthenticators},n.prototype.getSchemeVersionTarsusKeyPath=function(){return new u.TarsusKeyPath("fido_collection_result")},n.prototype.getCollectedAaids=function(e,o){for(var r=new Array,h=function(y){if(y instanceof Error)o.log(c.LogLevel.Error,function(){return"Error collecting fido authenticators details "+y});else if(y&&y.length>0)for(var A=0,T=y;A<T.length;A++){var C=T[A];if(C){var E=new Object;E.aaid=C,r.push(E)}}},f=0,g=e;f<g.length;f++)h(g[f]);return r},n.cacheValidityPeriod=6048e5,n}((t=(u=c.core||(c.core={})).collectors||(u.collectors={})).CacheableCollector),t.FidoAuthenticatorsCollector=i}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){var t,i,u,c;c=l.sdk||(l.sdk={}),i=function(s){function n(){return null!==s&&s.apply(this,arguments)||this}return V(n,s),n.prototype.provide=function(e){for(var o=new Object,r=0,h=n.authenticatorDriversLocal;r<h.length;r++){var f=h[r],g=this.provideLocalEnrollmentData(e,f);g&&(o[f]=g)}return Promise.resolve(o)},n.prototype.getAssociatedCollectorType=function(){return c.CollectorType.LocalEnrollments},n.prototype.provideLocalEnrollmentData=function(e,o){var r=null;if(e.currentSession){var h=e.currentSession.user.localEnrollments[o];h&&((r=new Object).registration_status=h.status,r.validation_status=h.validationStatus)}return r},n.authenticatorDriversLocal=[u.authenticationdrivers.AuthenticationDriverLocalPinCode.authenticatorName,u.authenticationdrivers.AuthenticationDriverLocalPattern.authenticatorName,u.authenticationdrivers.AuthenticationDriverDescriptorFingerprint.authenticatorName,u.authenticationdrivers.AuthenticationDriverDescriptorNativeFace.authenticatorName],n}((t=(u=c.core||(c.core={})).collectors||(u.collectors={})).Collector),t.LocalEnrollmentsCollector=i}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){!function(u){u.TarsusCollectors={capabilities:{createCollector:u.CapabilitiesCollector},collector_state:{createCollector:u.CollectorsStateCollector},device_details:{createCollector:u.DeviceDetailsCollector},hw_authenticators:{createCollector:u.FidoAuthenticatorsCollector},local_enrollments:{createCollector:u.LocalEnrollmentsCollector}}}(i.collectors||(i.collectors={}))}(t.core||(t.core={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){!function(u){u.PKCredentialException=function(){};var s=function(){function n(e,o){this._credentialId=e,this._userInteractionSessionProvider=o}return Object.defineProperty(n.prototype,"credentialId",{get:function(){return this._credentialId},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"user",{get:function(){return this._userInteractionSessionProvider._session.user},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"sdk",{get:function(){return this._userInteractionSessionProvider._sdk},enumerable:!1,configurable:!0}),n.prototype.getClientContext=function(){return this._userInteractionSessionProvider._clientContext},n}();u.PKCredential=s}(i.credential||(i.credential={}))}(t.core||(t.core={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){!function(u){var c=function(s){function n(e,o,r){var h=s.call(this,e,r)||this;return h._host=o,h._externalCancelled=!1,h}return V(n,s),Object.defineProperty(n.prototype,"uiHandler",{get:function(){return this._userInteractionSessionProvider._uiHandler},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"authenticatorDescription",{get:function(){return this._authenticatorDescription},enumerable:!1,configurable:!0}),n.prototype.onCancelRun=function(){this._externalCancelled=!0,this.lastObtainedKeyPair&&(this.lastObtainedKeyPair=null)},n.prototype.startCredentialSession=function(e){if(this._authenticatorConfig=this._host.getAuthenticatorConfig(this),this._inputSession=this.createAuthenticatorSession(),!this._inputSession)throw t.impl.AuthenticationErrorImpl.appImplementationError("Invalid return from authenticator session creation call.");this._authenticatorDescription=this._host.getAuthenticatorDescription(this),this._inputSession.startSession(this._authenticatorDescription,t.AuthenticatorSessionMode.Authentication,this._host.getPolicyAction(this),e)},n.prototype.endCredentialSession=function(){this.lastObtainedKeyPair&&(this.lastObtainedKeyPair=null),this._inputSession&&(this._inputSession.endSession(),delete this._inputSession)},n.prototype.signHex=function(e){var o=this;return this.doSafeCredentialOperation(function(){return o.lastObtainedKeyPair.signHex(e)})},n.prototype.unwrapAsymmetricKeyPairFromPrivateHex=function(e,o){var r=this;return this.doSafeCredentialOperation(function(){return r.lastObtainedKeyPair.unwrapAsymmetricKeyPairFromPrivateKeyHex(e,o)})},n.prototype.doSafeCredentialOperation=function(e){var o=this;return new Promise(function(r,h){o._rejectionFunction||o._completionFunction?h(new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Internal,"Illegal credential state")):(o._rejectionFunction=h,o._completionFunction=function(f){o.lastObtainedKeyPair=f;try{e().then(r,function(g){return o.processLocalAuthenticatorError(t.impl.AuthenticationErrorImpl.ensureAuthenticationError(g))})}catch(g){h(t.impl.AuthenticationErrorImpl.ensureAuthenticationError(g))}},o.authenticateInStartedSession(!1))}).finally(function(){o._rejectionFunction=null,o._completionFunction=null})},n.prototype.promiseRecoveryForError=function(e,o,r){var h=this;return o.indexOf(r)<0&&(r=o.indexOf(t.AuthenticationErrorRecovery.SelectAuthenticator)>=0?t.AuthenticationErrorRecovery.SelectAuthenticator:t.AuthenticationErrorRecovery.Fail),this._inputSession.promiseRecoveryForError(e,o,r).then(function(f){return h.sdk.log(t.LogLevel.Debug,function(){return"Error recovery selected "+f}),h.sdk.log(t.LogLevel.Debug,function(){return"recover from error: "+e.getErrorCode()}),o.indexOf(f)<0?(h.sdk.log(t.LogLevel.Error,function(){return"Invalid error recovery option from callback: "+f+" not in "+o}),Promise.reject(new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.AppImplementation,"Invalid error recovery action selected by callback."))):Promise.resolve(f)})},n.prototype.evaluateLocalRegistrationStatus=function(){var e=this.user.localEnrollments[this.credentialId];return e?e.validationStatus==i.LocalEnrollmentValidationStatus.Invalidated?t.AuthenticatorRegistrationStatus.LocallyInvalid:e.status!=i.LocalEnrollmentStatus.Registered?t.AuthenticatorRegistrationStatus.Unregistered:t.AuthenticatorRegistrationStatus.Registered:t.AuthenticatorRegistrationStatus.LocallyInvalid},Object.defineProperty(n.prototype,"lastObtainedKeyPair",{get:function(){return this._lastObtainedKeyPair},set:function(e){this._lastObtainedKeyPair&&this._lastObtainedKeyPair!=e&&(e&&this._lastObtainedKeyPair.getTag()===e.getTag()||this._lastObtainedKeyPair.closeKeyPair()),this._lastObtainedKeyPair=e},enumerable:!1,configurable:!0}),n.prototype.authenticateInStartedSession=function(e){var o=this;this._inputSession.promiseInput().then(function(r){return o.handleInputOrControlResponse(r)},function(r){return o.completeCredentialOperationWithError(t.impl.AuthenticationErrorImpl.ensureAuthenticationError(r))})},n.prototype.handleAuthenticationInputResponse=function(e){var o=this,r=this.user.localEnrollments[this.credentialId];r?this.getKeyForEnrollmentDataAndInput(r,e).then(function(h){o.sdk.log(t.LogLevel.Debug,function(){return"Local authenticator key obtained; signing challenge"}),o.completeCredentialOperationWithResult(h)}).catch(function(h){o.processLocalAuthenticatorError(t.impl.AuthenticationErrorImpl.ensureAuthenticationError(h))}):this.completeCredentialOperationWithError(new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.NoRegisteredAuthenticator,"Missing key for fingerprint authenticator"))},n.prototype.processLocalAuthenticatorError=function(e){var o=this,r=this._host.getCredentialValidErrorRecoveryOptions(this,e),h=r.indexOf(t.AuthenticationErrorRecovery.RetryAuthenticator)>=0?t.AuthenticationErrorRecovery.RetryAuthenticator:t.AuthenticationErrorRecovery.Fail;this.promiseRecoveryForError(e,r,h).then(function(f){o.handleErrorRecoveryAction(f,e)})},n.prototype.completeCredentialOperationWithResult=function(e){this._completionFunction(e)},n.prototype.completeCredentialOperationWithError=function(e){this._rejectionFunction(e)},n.prototype.handleInputOrControlResponse=function(e){try{e.isControlRequest()&&(e.getControlRequest().getRequestType()==t.ControlRequestType.CancelAuthenticator?this.invokeUiHandlerCancellation():this.signalControlRequest(e.getControlRequest())),e.getActionEscapeRequest()?this.signalEscapeRequest(e.getActionEscapeRequest()):this.handleAuthenticationInputResponse(e.getResponse())}catch(o){this.completeCredentialOperationWithError(t.impl.AuthenticationErrorImpl.ensureAuthenticationError(o))}},n.prototype.signalControlRequest=function(e){this._externalCancelled&&e.getRequestType()==t.ControlRequestType.CancelAuthenticator&&(e=t.ControlRequest.create(t.ControlRequestType.AbortAuthentication)),this._rejectionFunction(e)},n.prototype.signalEscapeRequest=function(e){this._rejectionFunction(e)},n.prototype.invokeUiHandlerCancellation=function(){var e=this,o=this._host.getCredentialAvailableCancellationOptions(this);this.uiHandler.controlOptionForCancellationRequestInSession(o,this._inputSession).then(function(r){r.getRequestType()==t.ControlRequestType.CancelAuthenticator&&e.completeCredentialOperationWithError(new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.AppImplementation,"controlOptionForCancellationRequestInSession returned CancelAuthenticator which is an invalid option.")),o.indexOf(r.getRequestType())<0&&e.completeCredentialOperationWithError(new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.AppImplementation,"controlOptionForCancellationRequestInSession returned an invalid option.")),e.signalControlRequest(r)})},n.prototype.handleErrorRecoveryAction=function(e,o){switch(e){case t.AuthenticationErrorRecovery.RetryAuthenticator:this.signalControlRequest(t.ControlRequest.create(t.ControlRequestType.RetryAuthenticator));break;case t.AuthenticationErrorRecovery.ChangeAuthenticator:this.signalControlRequest(t.ControlRequest.create(t.ControlRequestType.ChangeMethod));break;case t.AuthenticationErrorRecovery.SelectAuthenticator:this.signalControlRequest(t.ControlRequest.create(t.ControlRequestType.SelectMethod));break;default:this.completeCredentialOperationWithError(o)}},n}(u.PKCredential);u.PKCredentialAuthLocal=c}(i.credential||(i.credential={}))}(t.core||(t.core={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){!function(u){var c=function(s){function n(e,o,r){return s.call(this,e,o,r)||this}return V(n,s),n.prototype.getKeyForEnrollmentDataAndInput=function(e,o){var r=this;return new Promise(function(h,f){e.version>="v2"?r.getKeyForEnrollmentDataAndInputV2(e,o).then(h,f):r.getKeyForEnrollmentDataAndInputPreV2(e,o).then(h,f)}).then(function(h){if(!h)throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.InvalidInput,"Invalid input provided to credential.");return h})},n.prototype.getKeyForEnrollmentDataAndInputV2=function(e,o){var r=this,h=this.extractPbkdfInputFromInputResponse(o);return i.vault.pbkdfStretchHexSecretIntoAESKey(e.salt,h,e.cryptoSettings.getLocalEnrollmentKeySizeInBytes(),e.cryptoSettings.getLocalEnrollmentKeyIterationCount(),!0,this.sdk).then(function(f){return f.decrypt(e.keyMaterial,null).then(function(g){return r.sdk.host.generateHexSeededKeyPairExternalRepresentation(l.sdkhost.KeyClass.FidoECCSigningKey,g,i.authenticationdrivers.AuthenticationDriverLocalSecretInputBased.enrollmentVersion2KeyGenVersion(e.version),e.publicKeyHash).then(function(y){return r.sdk.host.importVolatileKeyPair(l.sdkhost.KeyClass.FidoECCSigningKey,y)})})})},n.prototype.getKeyForEnrollmentDataAndInputPreV2=function(e,o){var r=this;return this.authenticatorKeyTagForScheme(e.version,e.salt,e.cryptoSettings,o).then(function(h){return r.sdk.host.getKeyPair(h,l.sdkhost.KeyClass.StdSigningKey,l.sdkhost.KeyBiometricProtectionMode.None)})},n.prototype.authenticatorKeyTagForScheme=function(e,o,r,h){var f=this;return new Promise(function(g,y){var A=f.extractPbkdfInputFromInputResponse(h);if("v0"==e&&(f.sdk.log(t.LogLevel.Debug,function(){return"Using SDK CryptoSettings for migrated enrollment."}),r=f.sdk.cryptoSettings),!r)throw new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Internal,"Missing crypto settings for local enrollment.");f.sdk.host.generatePbkdf2HmacSha1HexString(o,A,r.getLocalEnrollmentKeySizeInBytes(),r.getLocalEnrollmentKeyIterationCount()).then(function(T){var C=t.util.hexToBase64(T);return new i.TarsusKeyPath("per_user",f.user.guid.toString(),"local_auth_keys",f.credentialId,e,C)}).then(g,y)})},n}(u.PKCredentialAuthLocal);u.PKCredentialLocalSecretInputBased=c}(i.credential||(i.credential={}))}(t.core||(t.core={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){!function(u){u.CredentialAuthPinCodeConfig=function(){};var s=function(n){function e(o,r,h){return n.call(this,o,r,h)||this}return V(e,n),Object.defineProperty(e.prototype,"pinLength",{get:function(){return this._authenticatorConfig.length},enumerable:!1,configurable:!0}),e.prototype.extractPbkdfInputFromInputResponse=function(o){return t.util.asciiToHex(o.getPin())},e.prototype.createAuthenticatorSession=function(){return this.uiHandler.createPinAuthSession(this.credentialId,this.user.displayName,this.pinLength)},e.create=function(o,r,h){return new e(o,r,h)},e}(u.PKCredentialLocalSecretInputBased);u.PKCredentialLocalPinCode=s}(i.credential||(i.credential={}))}(t.core||(t.core={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){!function(u){var c=function(s){function n(e,o,r){return s.call(this,e,o,r)||this}return V(n,s),n.prototype.handleAuthenticationInputResponse=function(e){t.impl.PatternInputImpl.validateFormat(e)?s.prototype.handleAuthenticationInputResponse.call(this,e):this.processLocalAuthenticatorError(new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.AppImplementation,"Invalid pattern description format."))},n.prototype.extractPbkdfInputFromInputResponse=function(e){return t.util.asciiToHex(e.getPatternDescription())},n.prototype.createAuthenticatorSession=function(){return this.uiHandler.createPatternAuthSession(this.credentialId,this.user.displayName,3,4)},n.create=function(e,o,r){return new n(e,o,r)},n}(u.PKCredentialLocalSecretInputBased);u.PKCredentialLocalPattern=c}(i.credential||(i.credential={}))}(t.core||(t.core={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){!function(u){var c=function(s){function n(){return null!==s&&s.apply(this,arguments)||this}return V(n,s),n.prototype.authenticatorKeyTagForScheme=function(e,o){return new i.TarsusKeyPath("per_user",this.user.guid.toString(),"local_auth_keys",this.credentialId,e,o)},n.prototype.getKeyForEnrollmentDataAndInput=function(e,o){var r=this;return new Promise(function(h,f){var g=r.authenticatorKeyTagForScheme(e.version,e.salt),y=r.sdk.host.getKeyPair(g,l.sdkhost.KeyClass.HardwareProtectedSignAndEncryptKey,l.sdkhost.KeyBiometricProtectionMode.BindToEnrollmentDb);if(!y){var A={};throw A[l.sdkhost.ErrorDataInternalError]=l.sdkhost.InternalErrorBiometricInvalidated,new t.impl.AuthenticationErrorImpl(t.AuthenticationErrorCode.Internal,"Attempt to authenticate with invalidated biometric authenticator.",A)}r.updateKeyPairWithAuthenticationInput(y,r._inputSession,o),h(y)})},n.prototype.processLocalAuthenticatorError=function(e){var o=this,r=e,h=Promise.resolve();if(r.getErrorCode()==t.AuthenticationErrorCode.Internal&&r.getData()){var f=r.getData();r=t.impl.AuthenticationErrorImpl.errorForHostInternalBiometricErrorData(f,this.credentialId)||r,(f[l.sdkhost.ErrorDataInternalError]==l.sdkhost.InternalErrorBiometricNotConfigured&&this._authenticatorDescription.getRegistered()||f[l.sdkhost.ErrorDataInternalError]==l.sdkhost.InternalErrorBiometricInvalidated)&&(h=i.LocalEnrollment.invalidateLocalRegistrationStatusAndNotifyUIHandler(this._userInteractionSessionProvider,this._authenticatorDescription))}h.catch(function(g){o.sdk.log(t.LogLevel.Error,g)}),h.finally(function(){if(r.getErrorCode()==t.AuthenticationErrorCode.UserCanceled)return o.sdk.log(t.LogLevel.Debug,function(){return"${this.credentialId} authenticator captured user cancel error code."}),void o.invokeUiHandlerCancellation();o.completeCredentialOperationWithError(r)})},n.prototype.evaluateLocalRegistrationStatus=function(){var e=s.prototype.evaluateLocalRegistrationStatus.call(this);if(e!=t.AuthenticatorRegistrationStatus.Registered)return e;var o=this.user.localEnrollments[this.credentialId],r=this.authenticatorKeyTagForScheme(o.version,o.salt),h=this.sdk.host.getKeyPair(r,l.sdkhost.KeyClass.HardwareProtectedSignAndEncryptKey,l.sdkhost.KeyBiometricProtectionMode.BindToEnrollmentDb);return h?(h.closeKeyPair(),t.AuthenticatorRegistrationStatus.Registered):t.AuthenticatorRegistrationStatus.LocallyInvalid},n}(u.PKCredentialAuthLocal);u.PKCredentialBiometric=c}(i.credential||(i.credential={}))}(t.core||(t.core={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){!function(u){var c=function(s){function n(e,o,r){return s.call(this,e,o,r)||this}return V(n,s),n.prototype.updateKeyPairWithAuthenticationInput=function(e,o,r){e.setBiometricPromptInfo(t.util.BiometricPromptInfoFrom.fingerprintInput(r),this.uiHandler,o)},n.prototype.authenticatorKeyTagForScheme=function(e,o){return i.authenticationdrivers.AuthenticationDriverFingerprint.authenticatorKeyTagForUser(this.user,e,o)},n.prototype.createAuthenticatorSession=function(){return this.uiHandler.createFingerprintAuthSession(this.credentialId,this.user.displayName)},n.prototype.shouldAllowBiometricFallbackButton=function(e){if(!e)return!1;var o=e.getFallbackButtonTitle();return!!(o&&o.length>0)},n.create=function(e,o,r){return new n(e,o,r)},n}(u.PKCredentialBiometric);u.PKCredentialFingerprint=c}(i.credential||(i.credential={}))}(t.core||(t.core={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){!function(u){var c=function(s){function n(e,o,r){return s.call(this,e,o,r)||this}return V(n,s),n.prototype.updateKeyPairWithAuthenticationInput=function(e,o,r){e.setBiometricPromptInfo(t.util.BiometricPromptInfoFrom.nativeFaceInput(r),null,null)},n.prototype.authenticatorKeyTagForScheme=function(e,o){return i.authenticationdrivers.AuthenticationDriverNativeFace.authenticatorKeyTagForUser(this.user,e,o)},n.prototype.createAuthenticatorSession=function(){return this.uiHandler.createNativeFaceAuthSession(this.credentialId,this.user.displayName)},n.prototype.shouldAllowBiometricFallbackButton=function(e){if(!e)return!1;var o=e.getFallbackButtonTitle();return!!(o&&o.length>0)},n.create=function(e,o,r){return new n(e,o,r)},n}(u.PKCredentialBiometric);u.PKCredentialNativeFace=c}(i.credential||(i.credential={}))}(t.core||(t.core={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){!function(u){var c=function(s){function n(e,o,r){return s.call(this,e,o,r)||this}return V(n,s),n.prototype.updateKeyPairWithAuthenticationInput=function(e,o,r){e.setBiometricPromptInfo(t.util.BiometricPromptInfoFrom.deviceBiometricInput(r,this._authenticatorConfig),null,null)},n.prototype.authenticatorKeyTagForScheme=function(e,o){return i.authenticationdrivers.AuthenticationDriverDeviceBiometrics.authenticatorKeyTagForUserForMigratedEnrollment(this.user,e,o)||s.prototype.authenticatorKeyTagForScheme.call(this,e,o)},n.prototype.createAuthenticatorSession=function(){return this.uiHandler.createDeviceBiometricsAuthSession(this.credentialId,this.user.displayName)},n.create=function(e,o,r){return new n(e,o,r)},n}(u.PKCredentialBiometric);u.PKCredentialDeviceBiometrics=c}(i.credential||(i.credential={}))}(t.core||(t.core={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){!function(u){u.CredentialTypes={pin:u.PKCredentialLocalPinCode,pattern:u.PKCredentialLocalPattern,fingerprint:u.PKCredentialFingerprint,face_id:u.PKCredentialNativeFace,device_biometrics:u.PKCredentialDeviceBiometrics}}(i.credential||(i.credential={}))}(t.core||(t.core={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){var i=function(){function u(){}return u.prototype.getEscapeOption=function(){return this._escapeOption},u.prototype.setEscapeOption=function(c){this._escapeOption=c},u.prototype.getEscapeParameters=function(){return this._escapeParameters},u.prototype.setEscapeParameters=function(c){this._escapeParameters=c},u.__tarsusInterfaceName="ActionEscapeRequest",u}();t.ActionEscapeRequest=i}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){var i=function(u){function c(){return null!==u&&u.apply(this,arguments)||this}return V(c,u),c.__tarsusInterfaceName="AnonymousPolicyInvocationOptions",c}(t.JourneyInvocationOptions);t.AnonymousPolicyInvocationOptions=i}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){var i=function(u){function c(){return null!==u&&u.apply(this,arguments)||this}return V(c,u),c.__tarsusInterfaceName="ApprovalPolicyInvocationOptions",c}(t.JourneyInvocationOptions);t.ApprovalPolicyInvocationOptions=i}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){var i=function(u){function c(){return null!==u&&u.apply(this,arguments)||this}return V(c,u),c.prototype.getAcquisitionResponse=function(){return this._acquisitionResponse},c.prototype.setAcquisitionResponse=function(s){this._acquisitionResponse=s},c.__tarsusInterfaceName="AudioInputResponse",c}(t.InputResponseType);t.AudioInputResponse=i}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){var i=function(u){function c(){return null!==u&&u.apply(this,arguments)||this}return V(c,u),c.__tarsusInterfaceName="AuthenticateInvocationOptions",c}(t.JourneyInvocationOptions);t.AuthenticateInvocationOptions=i}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){i[i.Internal=0]="Internal",i[i.InvalidInput=1]="InvalidInput",i[i.AuthenticatorLocked=2]="AuthenticatorLocked",i[i.AllAuthenticatorsLocked=3]="AllAuthenticatorsLocked",i[i.NoRegisteredAuthenticator=4]="NoRegisteredAuthenticator",i[i.RegisteredSecretAlreadyInHistory=5]="RegisteredSecretAlreadyInHistory",i[i.Communication=6]="Communication",i[i.UserCanceled=7]="UserCanceled",i[i.AppImplementation=8]="AppImplementation",i[i.PolicyRejection=9]="PolicyRejection",i[i.AuthenticatorInvalidated=10]="AuthenticatorInvalidated",i[i.ControlFlowExpired=11]="ControlFlowExpired",i[i.SessionRequired=12]="SessionRequired",i[i.AuthenticatorError=13]="AuthenticatorError",i[i.ApprovalWrongState=14]="ApprovalWrongState",i[i.TotpNotProvisioned=15]="TotpNotProvisioned",i[i.AuthenticatorExternalConfigError=16]="AuthenticatorExternalConfigError",i[i.InvalidDeviceBinding=17]="InvalidDeviceBinding",i[i.InvalidIdToken=18]="InvalidIdToken",i[i.DeviceNotFound=19]="DeviceNotFound",i[i.ApprovalDenied=20]="ApprovalDenied",i[i.ApprovalExpired=21]="ApprovalExpired",i[i.ApplicationGeneratedRecoverableError=22]="ApplicationGeneratedRecoverableError",i[i.UserNotFound=23]="UserNotFound"}(t.AuthenticationErrorCode||(t.AuthenticationErrorCode={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){i[i.AuthenticatorExternalConfigErrorReason=0]="AuthenticatorExternalConfigErrorReason",i[i.AuthenticatorInvalidInputErrorDescription=1]="AuthenticatorInvalidInputErrorDescription",i[i.InvalidIdTokenErrorReason=2]="InvalidIdTokenErrorReason",i[i.UserRecordDeleted=3]="UserRecordDeleted",i[i.AuthenticationErrorFailingActionType=4]="AuthenticationErrorFailingActionType",i[i.AuthenticationErrorReason=5]="AuthenticationErrorReason"}(t.AuthenticationErrorProperty||(t.AuthenticationErrorProperty={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){i[i.AuthenticatorExternalConfigErrorReasonBiometricsNotEnrolled=0]="AuthenticatorExternalConfigErrorReasonBiometricsNotEnrolled",i[i.AuthenticatorExternalConfigErrorReasonBiometricsOsLockTemporary=1]="AuthenticatorExternalConfigErrorReasonBiometricsOsLockTemporary",i[i.AuthenticatorExternalConfigErrorReasonBiometricsOsLockPermanent=2]="AuthenticatorExternalConfigErrorReasonBiometricsOsLockPermanent",i[i.AuthenticatorInvalidInputErrorDescriptionTotpIncorrectCheckDigit=3]="AuthenticatorInvalidInputErrorDescriptionTotpIncorrectCheckDigit",i[i.InvalidIdTokenErrorReasonExpiredToken=4]="InvalidIdTokenErrorReasonExpiredToken",i[i.InvalidIdTokenErrorReasonBadToken=5]="InvalidIdTokenErrorReasonBadToken",i[i.AuthenticationErrorReasonAttestationReverificationFailed=6]="AuthenticationErrorReasonAttestationReverificationFailed",i[i.AuthenticationErrorReasonCredentialFiltered=7]="AuthenticationErrorReasonCredentialFiltered",i[i.AuthenticatorExternalConfigErrorReasonGeneratedKeyIsNotSecure=8]="AuthenticatorExternalConfigErrorReasonGeneratedKeyIsNotSecure"}(t.AuthenticationErrorPropertySymbol||(t.AuthenticationErrorPropertySymbol={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){i[i.RetryAuthenticator=0]="RetryAuthenticator",i[i.ChangeAuthenticator=1]="ChangeAuthenticator",i[i.SelectAuthenticator=2]="SelectAuthenticator",i[i.Fail=3]="Fail"}(t.AuthenticationErrorRecovery||(t.AuthenticationErrorRecovery={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){i[i.Register=0]="Register",i[i.Unregister=1]="Unregister",i[i.Reregister=2]="Reregister"}(t.AuthenticatorConfigurationAction||(t.AuthenticatorConfigurationAction={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){i[i.Fallback=0]="Fallback",i[i.AuthMenu=1]="AuthMenu",i[i.Retry=2]="Retry",i[i.Cancel=3]="Cancel"}(t.AuthenticatorFallbackAction||(t.AuthenticatorFallbackAction={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){i[i.Registered=0]="Registered",i[i.Unregistered=1]="Unregistered",i[i.LocallyInvalid=2]="LocallyInvalid"}(t.AuthenticatorRegistrationStatus||(t.AuthenticatorRegistrationStatus={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){i[i.SelectAuthenticator=0]="SelectAuthenticator",i[i.Abort=1]="Abort",i[i.Escape=2]="Escape"}(t.AuthenticatorSelectionResultType||(t.AuthenticatorSelectionResultType={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){i[i.Authentication=0]="Authentication",i[i.Registration=1]="Registration"}(t.AuthenticatorSessionMode||(t.AuthenticatorSessionMode={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){var i=function(u){function c(){return null!==u&&u.apply(this,arguments)||this}return V(c,u),c.__tarsusInterfaceName="BindInvocationOptions",c}(t.JourneyInvocationOptions);t.BindInvocationOptions=i}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){var i=function(u){function c(){return null!==u&&u.apply(this,arguments)||this}return V(c,u),c.prototype.getAcquisitionResponse=function(){return this._acquisitionResponse},c.prototype.setAcquisitionResponse=function(s){this._acquisitionResponse=s},c.__tarsusInterfaceName="CameraInputResponse",c}(t.InputResponseType);t.CameraInputResponse=i}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){i[i.Accounts=0]="Accounts",i[i.DeviceDetails=1]="DeviceDetails",i[i.Contacts=2]="Contacts",i[i.Owner=3]="Owner",i[i.Software=4]="Software",i[i.Location=5]="Location",i[i.LocationCountry=6]="LocationCountry",i[i.Bluetooth=7]="Bluetooth",i[i.ExternalSDKDetails=8]="ExternalSDKDetails",i[i.HWAuthenticators=9]="HWAuthenticators",i[i.Capabilities=10]="Capabilities",i[i.FidoAuthenticators=11]="FidoAuthenticators",i[i.LargeData=12]="LargeData",i[i.LocalEnrollments=13]="LocalEnrollments",i[i.DeviceFingerprint=14]="DeviceFingerprint",i[i.AppPermissions=15]="AppPermissions"}(t.CollectorType||(t.CollectorType={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){i[i.None=0]="None",i[i.Credentials=1]="Credentials",i[i.Full=2]="Full"}(t.ConnectionCryptoMode||(t.ConnectionCryptoMode={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){i[i.CancelAuthenticator=0]="CancelAuthenticator",i[i.RetryAuthenticator=1]="RetryAuthenticator",i[i.ChangeMethod=2]="ChangeMethod",i[i.SelectMethod=3]="SelectMethod",i[i.AbortAuthentication=4]="AbortAuthentication"}(t.ControlRequestType||(t.ControlRequestType={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){i[i.Remove=0]="Remove",i[i.Rename=1]="Rename"}(t.DeviceManagementAction||(t.DeviceManagementAction={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){i[i.RecentlyUsed=0]="RecentlyUsed",i[i.NoRecentActivity=1]="NoRecentActivity",i[i.LongInactivity=2]="LongInactivity",i[i.Disabled=3]="Disabled",i[i.Removed=4]="Removed"}(t.DeviceStatus||(t.DeviceStatus={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){var i=function(u){function c(){return null!==u&&u.apply(this,arguments)||this}return V(c,u),c.prototype.getFailureError=function(){return this._failureError},c.prototype.setFailureError=function(s){this._failureError=s},c.prototype.getExpired=function(){return this._expired},c.prototype.setExpired=function(s){this._expired=s},c.prototype.getRegistered=function(){return this._registered},c.prototype.setRegistered=function(s){this._registered=s},c.prototype.getRegistrationStatus=function(){return this._registrationStatus},c.prototype.setRegistrationStatus=function(s){this._registrationStatus=s},c.prototype.getLocked=function(){return this._locked},c.prototype.setLocked=function(s){this._locked=s},c.__tarsusInterfaceName="FidoAuthFailureResponse",c}(t.FidoInputResponse);t.FidoAuthFailureResponse=i}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){var i=function(u){function c(){return null!==u&&u.apply(this,arguments)||this}return V(c,u),c.prototype.getFidoResponse=function(){return this._fidoResponse},c.prototype.setFidoResponse=function(s){this._fidoResponse=s},c.__tarsusInterfaceName="FidoAuthSuccessResponse",c}(t.FidoInputResponse);t.FidoAuthSuccessResponse=i}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){i[i.Submit=0]="Submit",i[i.Abort=1]="Abort",i[i.Escape=2]="Escape"}(t.FormControlRequest||(t.FormControlRequest={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){i[i.Disable=0]="Disable",i[i.RecoverDeviceAndBindingOnAuthenticate=1]="RecoverDeviceAndBindingOnAuthenticate"}(t.InvalidUserRecordRecoveryMode||(t.InvalidUserRecordRecoveryMode={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){i[i.Off=0]="Off",i[i.Critical=1]="Critical",i[i.Error=2]="Error",i[i.Warning=3]="Warning",i[i.Info=4]="Info",i[i.Debug=5]="Debug"}(t.LogLevel||(t.LogLevel={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){i[i.Approve=0]="Approve",i[i.Deny=1]="Deny"}(t.MobileApprovalAction||(t.MobileApprovalAction={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){i[i.Pending=0]="Pending",i[i.Approved=1]="Approved",i[i.Denied=2]="Denied",i[i.Expired=3]="Expired"}(t.MobileApprovalStatus||(t.MobileApprovalStatus={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){i[i.Unknown=0]="Unknown",i[i.Sms=1]="Sms",i[i.Email=2]="Email",i[i.PushNotification=3]="PushNotification",i[i.VoiceCall=4]="VoiceCall"}(t.OtpChannel||(t.OtpChannel={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){var i=function(u){function c(){return null!==u&&u.apply(this,arguments)||this}return V(c,u),c.prototype.getFailureError=function(){return this._failureError},c.prototype.setFailureError=function(s){this._failureError=s},c.prototype.getExpired=function(){return this._expired},c.prototype.setExpired=function(s){this._expired=s},c.prototype.getRegistered=function(){return this._registered},c.prototype.setRegistered=function(s){this._registered=s},c.prototype.getRegistrationStatus=function(){return this._registrationStatus},c.prototype.setRegistrationStatus=function(s){this._registrationStatus=s},c.prototype.getLocked=function(){return this._locked},c.prototype.setLocked=function(s){this._locked=s},c.__tarsusInterfaceName="PlaceholderAuthFailureResponse",c}(t.PlaceholderInputResponse);t.PlaceholderAuthFailureResponse=i}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){var i=function(u){function c(){return null!==u&&u.apply(this,arguments)||this}return V(c,u),c.prototype.getFailureError=function(){return this._failureError},c.prototype.setFailureError=function(s){this._failureError=s},c.__tarsusInterfaceName="PlaceholderAuthFailureWithServerProvidedStatusResponse",c}(t.PlaceholderInputResponse);t.PlaceholderAuthFailureWithServerProvidedStatusResponse=i}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){var i=function(u){function c(){return null!==u&&u.apply(this,arguments)||this}return V(c,u),c.prototype.getPlaceholderToken=function(){return this._placeholderToken},c.prototype.setPlaceholderToken=function(s){this._placeholderToken=s},c.__tarsusInterfaceName="PlaceholderAuthSuccessResponse",c}(t.PlaceholderInputResponse);t.PlaceholderAuthSuccessResponse=i}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){var i=function(u){function c(){return null!==u&&u.apply(this,arguments)||this}return V(c,u),c.__tarsusInterfaceName="PolicyInvocationOptions",c}(t.JourneyInvocationOptions);t.PolicyInvocationOptions=i}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){i[i.Skip=0]="Skip",i[i.Abort=1]="Abort",i[i.Continue=2]="Continue"}(t.PromotionControlRequest||(t.PromotionControlRequest={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){i[i.Numeric=0]="Numeric",i[i.Alphanumeric=1]="Alphanumeric",i[i.Binary=2]="Binary"}(t.QrCodeFormat||(t.QrCodeFormat={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){i[i.RedirectToPolicy=0]="RedirectToPolicy",i[i.CancelRedirect=1]="CancelRedirect"}(t.RedirectResponseType||(t.RedirectResponseType={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){var i=function(u){function c(){return null!==u&&u.apply(this,arguments)||this}return V(c,u),c.prototype.getAnswers=function(){return this._answers},c.__tarsusInterfaceName="SecurityQuestionAnswersInputResponse",c}(t.SecurityQuestionInputResponse);t.SecurityQuestionAnswersInputResponse=i}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){var i=function(){function u(){}return u.__tarsusInterfaceName="SuspensionContext",u}();t.SuspensionContext=i}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){var i=function(){function u(){}return u.prototype.getValue=function(){return this._value},u.prototype.setValue=function(c){this._value=c},u.prototype.getFormat=function(){return this._format},u.prototype.setFormat=function(c){this._format=c},u.__tarsusInterfaceName="TotpChallenge",u}();t.TotpChallenge=i}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){var i=function(){function u(){}return u.prototype.getName=function(){return this._name},u.prototype.setName=function(c){this._name=c},u.prototype.getValue=function(){return this._value},u.prototype.setValue=function(c){this._value=c},u.__tarsusInterfaceName="TransportHeader",u}();t.TransportHeader=i}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){var i=function(){function u(){}return u.prototype.getStatus=function(){return this._status},u.prototype.setStatus=function(c){this._status=c},u.prototype.getMethod=function(){return this._method},u.prototype.setMethod=function(c){this._method=c},u.prototype.getHeaders=function(){return this._headers},u.prototype.setHeaders=function(c){this._headers=c},u.prototype.getBodyJson=function(){return this._bodyJson},u.prototype.setBodyJson=function(c){this._bodyJson=c},u.__tarsusInterfaceName="TransportResponse",u}();t.TransportResponse=i}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){i[i.Disable=0]="Disable",i[i.DownloadOnInit=1]="DownloadOnInit"}(t.UIAssetsDownloadMode||(t.UIAssetsDownloadMode={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){i[i.UserId=0]="UserId",i[i.IdToken=1]="IdToken"}(t.UserHandleType||(t.UserHandleType={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){i[i.Fido2UserVerifyingPlatformAuthenticatorAvailable=0]="Fido2UserVerifyingPlatformAuthenticatorAvailable"}(t.AsyncHostInformationKey||(t.AsyncHostInformationKey={}))}(l.sdkhost||(l.sdkhost={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){var i=function(){function u(){}return u.prototype.getLocalizedTitle=function(){return this._localizedTitle},u.prototype.setLocalizedTitle=function(c){this._localizedTitle=c},u.prototype.getLocalizedSubtitle=function(){return this._localizedSubtitle},u.prototype.setLocalizedSubtitle=function(c){this._localizedSubtitle=c},u.prototype.getLocalizedPrompt=function(){return this._localizedPrompt},u.prototype.setLocalizedPrompt=function(c){this._localizedPrompt=c},u.prototype.getFallbackButtonTitle=function(){return this._fallbackButtonTitle},u.prototype.setFallbackButtonTitle=function(c){this._fallbackButtonTitle=c},u.prototype.getCancelButtonTitle=function(){return this._cancelButtonTitle},u.prototype.setCancelButtonTitle=function(c){this._cancelButtonTitle=c},u.prototype.getRequireConfirmation=function(){return this._requireConfirmation},u.prototype.setRequireConfirmation=function(c){this._requireConfirmation=c},u.__tarsusInterfaceName="BiometricPromptInfo",u}();t.BiometricPromptInfo=i}(l.sdkhost||(l.sdkhost={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){i[i.Create=0]="Create",i[i.Get=1]="Get"}(t.Fido2CredentialsOpType||(t.Fido2CredentialsOpType={}))}(l.sdkhost||(l.sdkhost={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){i[i.Version=0]="Version",i[i.Platform=1]="Platform",i[i.FingerprintSupported=2]="FingerprintSupported",i[i.HostProvidedFeatures=3]="HostProvidedFeatures",i[i.FaceIdKeyBioProtectionSupported=4]="FaceIdKeyBioProtectionSupported",i[i.ImageAcquitisionSupported=5]="ImageAcquitisionSupported",i[i.AudioAcquitisionSupported=6]="AudioAcquitisionSupported",i[i.PersistentKeysSupported=7]="PersistentKeysSupported",i[i.FidoClientPresent=8]="FidoClientPresent",i[i.DyadicPresent=9]="DyadicPresent",i[i.StdSigningKeyIsHardwareProtectedSignAndEncryptKey=10]="StdSigningKeyIsHardwareProtectedSignAndEncryptKey",i[i.Fido2ClientPresent=11]="Fido2ClientPresent",i[i.DeviceBiometricsSupported=12]="DeviceBiometricsSupported",i[i.DeviceBiometricsFPContinuation=13]="DeviceBiometricsFPContinuation",i[i.DeviceBiometricsUsesSign=14]="DeviceBiometricsUsesSign",i[i.DevicePersistenceMode=15]="DevicePersistenceMode",i[i.Fido2RelyingParty=16]="Fido2RelyingParty"}(t.HostInformationKey||(t.HostInformationKey={}))}(l.sdkhost||(l.sdkhost={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){i[i.None=0]="None",i[i.NormalProtection=1]="NormalProtection",i[i.BindToEnrollmentDb=2]="BindToEnrollmentDb"}(t.KeyBiometricProtectionMode||(t.KeyBiometricProtectionMode={}))}(l.sdkhost||(l.sdkhost={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){i[i.StdSigningKey=0]="StdSigningKey",i[i.StdEncryptionKey=1]="StdEncryptionKey",i[i.GeneralPurposeAES=2]="GeneralPurposeAES",i[i.NoIntegrityAES=3]="NoIntegrityAES",i[i.FidoECCSigningKey=4]="FidoECCSigningKey",i[i.HardwareProtectedSignAndEncryptKey=5]="HardwareProtectedSignAndEncryptKey"}(t.KeyClass||(t.KeyClass={}))}(l.sdkhost||(l.sdkhost={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){var i=function(){function u(){}return u.prototype.getResultPayload=function(){return this._resultPayload},u.create=function(c){return p.ts.mobile.tarsusplugin.impl.IdpInvocationResultImpl.create(c)},u.__tarsusInterfaceName="IdpInvocationResult",u}();t.IdpInvocationResult=i}(l.tarsusplugin||(l.tarsusplugin={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){var i=function(u){function c(){return null!==u&&u.apply(this,arguments)||this}return V(c,u),c.prototype.getPayload=function(){return this._payload},c.create=function(s){return p.ts.mobile.tarsusplugin.impl.KycDataCollectionResultImpl.create(s)},c.__tarsusInterfaceName="KycDataCollectionResult",c}(l.sdk.InputResponseType);t.KycDataCollectionResult=i}(l.tarsusplugin||(l.tarsusplugin={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){var i=function(){function u(){}return u.prototype.getPluginName=function(){return this._pluginName},u.prototype.setPluginName=function(c){this._pluginName=c},u.prototype.getVersionMajor=function(){return this._versionMajor},u.prototype.setVersionMajor=function(c){this._versionMajor=c},u.prototype.getVersionMinor=function(){return this._versionMinor},u.prototype.setVersionMinor=function(c){this._versionMinor=c},u.prototype.getVersionPatch=function(){return this._versionPatch},u.prototype.setVersionPatch=function(c){this._versionPatch=c},u.prototype.getRequiredPluginApiLevel=function(){return this._requiredPluginApiLevel},u.prototype.setRequiredPluginApiLevel=function(c){this._requiredPluginApiLevel=c},u.create=function(){return p.ts.mobile.tarsusplugin.impl.PluginInfoImpl.create()},u.__tarsusInterfaceName="PluginInfo",u}();t.PluginInfo=i}(l.tarsusplugin||(l.tarsusplugin={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){var i=function(){function u(){}return u.prototype.getCode=function(){return this._code},u.prototype.getTimeStepSeconds=function(){return this._timeStepSeconds},u.prototype.getExpiresInSeconds=function(){return this._expiresInSeconds},u.prototype.getSecondsTillNextInvocation=function(){return this._secondsTillNextInvocation},u.prototype.getShouldUpdateSpecificProperties=function(){return this._shouldUpdateSpecificProperties},u.prototype.getGeneratorSpecificDataToStore=function(){return this._generatorSpecificDataToStore},u.prototype.getMessage=function(){return this._message},u.create=function(c,s,n,e,o,r,h){return p.ts.mobile.tarsusplugin.impl.TotpCodeGenerationOutputImpl.create(c,s,n,e,o,r,h)},u.__tarsusInterfaceName="TotpCodeGenerationOutput",u}();t.TotpCodeGenerationOutput=i}(l.tarsusplugin||(l.tarsusplugin={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){var i=function(u){function c(){return null!==u&&u.apply(this,arguments)||this}return V(c,u),c.prototype.getEscapeRequest=function(){return this._escapeRequest},c.prototype.setEscapeRequest=function(s){this._escapeRequest=s},c.__tarsusInterfaceName="TotpProvisionEscapeRequest",c}(t.TotpProvisionResult);t.TotpProvisionEscapeRequest=i}(l.tarsusplugin||(l.tarsusplugin={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){var i=function(){function u(){}return u.prototype.getUnprotectedProvisionOutput=function(){return this._unprotectedProvisionOutput},u.prototype.getSecretToLock=function(){return this._secretToLock},u.create=function(c,s){return p.ts.mobile.tarsusplugin.impl.VaultBasedTotpProvisionOutputImpl.create(c,s)},u.__tarsusInterfaceName="VaultBasedTotpProvisionOutput",u}();t.VaultBasedTotpProvisionOutput=i}(l.tarsusplugin||(l.tarsusplugin={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){var u=function(c){function s(){return null!==c&&c.apply(this,arguments)||this}return V(s,c),s.prototype.getResultPayload=function(){return this._resultPayload},s.create=function(n){var e=new s;return e._resultPayload=n,e},s.__tarsusInterfaceName="IdpInvocationResult",s}(t.IdpInvocationResult);i.IdpInvocationResultImpl=u}(t.impl||(t.impl={}))}(l.tarsusplugin||(l.tarsusplugin={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){var u=function(c){function s(){return null!==c&&c.apply(this,arguments)||this}return V(s,c),s.prototype.getPayload=function(){return this._payload},s.create=function(n){var e=new s;return e._payload=n,e},s.__tarsusInterfaceName="KycDataCollectionResult",s}(t.KycDataCollectionResult);i.KycDataCollectionResultImpl=u}(t.impl||(t.impl={}))}(l.tarsusplugin||(l.tarsusplugin={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){var u=function(c){function s(){var n=c.call(this)||this;return n._versionMajor=0,n._versionMinor=0,n._versionPatch=0,n}return V(s,c),s.create=function(){return new p.ts.mobile.tarsusplugin.impl.PluginInfoImpl},s.versionToString=function(n){return n.getVersionMajor()+"."+n.getVersionMinor()+"."+n.getVersionPatch()},s.toString=function(n){return n.getPluginName()+" v"+this.versionToString(n)},s}(t.PluginInfo);i.PluginInfoImpl=u}(t.impl||(t.impl={}))}(l.tarsusplugin||(l.tarsusplugin={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){var u=function(c){function s(){return null!==c&&c.apply(this,arguments)||this}return V(s,c),s.create=function(n,e,o,r,h,f,g){var y=new s;return y._code=n,e&&(y._message=e),y._timeStepSeconds=o,y._expiresInSeconds=r,y._secondsTillNextInvocation=h,y._shouldUpdateSpecificProperties=f,g&&(y._generatorSpecificDataToStore=g),y},s}(t.TotpCodeGenerationOutput);i.TotpCodeGenerationOutputImpl=u}(t.impl||(t.impl={}))}(l.tarsusplugin||(l.tarsusplugin={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){var u=function(c){function s(){return null!==c&&c.apply(this,arguments)||this}return V(s,c),s.create=function(n,e){var o=new s;return o._secretToLock=n,o._unprotectedProvisionOutput=e,o},s}(t.VaultBasedTotpProvisionOutput);i.VaultBasedTotpProvisionOutputImpl=u}(t.impl||(t.impl={}))}(l.tarsusplugin||(l.tarsusplugin={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={})),function(p){!function(d){!function(l){!function(t){!function(i){function u(s){return!!s.tlvSerializable}function c(s,n){var e=[];return Object.keys(n).forEach(function(o){var r=s[o];if(!r)throw"TLV encoding error: Unknown tag "+o;var h=n[o];h instanceof Array||(h=[h]),h.forEach(function(f){var g=f.__type||r.tagType||u(f)&&i.TlvTypes.Serializable;if(!g)throw"Unknown type for tag "+o;f.__type&&(f=f.__value);var y=g(f,s);e.push(i.TlvTypes.UInt16(r.id)),e.push(i.TlvTypes.UInt16(y.length/2)),e.push(y)})}),e.join("")}i.instanceOfTlvSerializable=u,i.TlvTypes={UInt8:function(s){return i.numberToHex(s,8)},UInt16:function(s){return i.numberToHex(s>>8&255|(255&s)<<8,16)},UInt32:function(s){return i.numberToHex((255&s)<<24|(s>>8&255)<<16|(s>>16&255)<<8|s>>24&255,32)},Object:function(s,n){return c(n,s)},Serializable:function(s,n){return s.tlvSerialize(n)},String:function(s,n){return i.asciiToHex(s)},HexBinary:function(s,n){return s},Struct:function(s){return function(n,e){var o=[];return Object.keys(s).forEach(function(r){r in n&&o.push((0,s[r])(n[r],e))}),o.join("")}}},i.tlvEncodeHex=c}(t.util||(t.util={}))}(l.sdk||(l.sdk={}))}(d.mobile||(d.mobile={}))}(p.ts||(p.ts={}))}(S||(S={}));var xt=com.ts.mobile.sdk.createSdk(),Yt=new bt;xt.setTarsusHost(Yt),xt.setTransportProvider(new le(Yt)),xt.setEnabledCollectors([com.ts.mobile.sdk.CollectorType.DeviceDetails,com.ts.mobile.sdk.CollectorType.LargeData,com.ts.mobile.sdk.CollectorType.Capabilities]),xt.setEnabledCollectorsForAnonymousJourneys([com.ts.mobile.sdk.CollectorType.DeviceDetails,com.ts.mobile.sdk.CollectorType.Capabilities]),xt.setLogLevel(com.ts.mobile.sdk.LogLevel.Error),window.xmui&&xt.setUiHandler(new window.xmui.XmUIHandler),Ct.XmSdk=function(){return xt},Object.defineProperty(Ct,"__esModule",{value:!0})}),function(Ct,De){"object"==typeof exports&&"undefined"!=typeof module?De(exports):"function"==typeof define&&define.amd?define(["exports"],De):De((Ct=Ct||self).xmui={})}(this,function(Ct){"use strict";function De(w){return(De="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(m){return typeof m}:function(m){return m&&"function"==typeof Symbol&&m.constructor===Symbol&&m!==Symbol.prototype?"symbol":typeof m})(w)}function ee(w,m){if(!(w instanceof m))throw new TypeError("Cannot call a class as a function")}function rn(w,m){for(var a=0;a<m.length;a++){var _=m[a];_.enumerable=_.enumerable||!1,_.configurable=!0,"value"in _&&(_.writable=!0),Object.defineProperty(w,_.key,_)}}function re(w,m,a){return m&&rn(w.prototype,m),a&&rn(w,a),w}function ge(w,m,a){return m in w?Object.defineProperty(w,m,{value:a,enumerable:!0,configurable:!0,writable:!0}):w[m]=a,w}function le(w,m){if("function"!=typeof m&&null!==m)throw new TypeError("Super expression must either be null or a function");w.prototype=Object.create(m&&m.prototype,{constructor:{value:w,writable:!0,configurable:!0}}),m&&Rn(w,m)}function oe(w){return(oe=Object.setPrototypeOf?Object.getPrototypeOf:function(m){return m.__proto__||Object.getPrototypeOf(m)})(w)}function Rn(w,m){return(Rn=Object.setPrototypeOf||function(a,_){return a.__proto__=_,a})(w,m)}function Ee(w){if(void 0===w)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return w}function ce(w,m){return!m||"object"!=typeof m&&"function"!=typeof m?Ee(w):m}function Pn(w,m){for(;!Object.prototype.hasOwnProperty.call(w,m)&&null!==(w=oe(w)););return w}function dt(w,m,a){return(dt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(_,v,k){var M=Pn(_,v);if(M){var q=Object.getOwnPropertyDescriptor(M,v);return q.get?q.get.call(k):q.value}})(w,m,a||w)}function sn(w,m,a,_){return(sn="undefined"!=typeof Reflect&&Reflect.set?Reflect.set:function(v,k,M,q){var B,J=Pn(v,k);if(J){if((B=Object.getOwnPropertyDescriptor(J,k)).set)return B.set.call(q,M),!0;if(!B.writable)return!1}if(B=Object.getOwnPropertyDescriptor(q,k)){if(!B.writable)return!1;B.value=M,Object.defineProperty(q,k,B)}else ge(q,k,M);return!0})(w,m,a,_)}function Ne(w,m,a,_,v){if(!sn(w,m,a,_||w)&&v)throw new Error("failed to set property");return a}function Ut(w){return function(m){if(Array.isArray(m)){for(var a=0,_=new Array(m.length);a<m.length;a++)_[a]=m[a];return _}}(w)||function(m){if(Symbol.iterator in Object(m)||"[object Arguments]"===Object.prototype.toString.call(m))return Array.from(m)}(w)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var Pt,Kt,gt,w,Dn=/^\s*<[\S\s]*$/,Jt=function(){function w(){ee(this,w),this._elements=new Array}return re(w,[{key:"append",value:function(m){var a=Lt(m);return this._elements.forEach(function(_,v){a.forEach(function(k){var M=0!==v?k.cloneNode():k;_.appendChild(M)})}),this}},{key:"remove",value:function(){this._elements.forEach(function(m){m.parentNode.removeChild(m)})}},{key:"prepend",value:function(m){var a=Lt(m);return this._elements.forEach(function(_,v){var k=_.firstChild;a.forEach(function(M){var q=0!==v?M.cloneNode():M;_.insertBefore(q,k)})}),this}},{key:"content",value:function(m){return this.empty().append(m)}},{key:"disable",value:function(){return this.disabled(!0)}},{key:"enable",value:function(){return this.disabled(!1)}},{key:"attr",value:function(m){return this._elements.forEach(function(a){var _,v;_=a,v=m,Object.keys(v).forEach(function(k){v.hasOwnProperty(k)&&_.setAttribute(k,v[k])})}),this}},{key:"focus",value:function(){return this._elements.forEach(function(m){m.focus()}),this}},{key:"addClass",value:function(m){return this._elements.forEach(function(a){var _,v;kt(_=a,v=m)||(_.className+=" "+v,_.className=_.className.replace(/  +/g," "))}),this}},{key:"removeClass",value:function(m){return this._elements.forEach(function(a){!function(_,v){if(kt(_,v)){var k=new RegExp("(\\s|^)"+v+"(\\s|$)");_.className=_.className.replace(k," ").replace(/  +/g," ")}}(a,m)}),this}},{key:"setClass",value:function(m){return this._elements.forEach(function(a){a.className=m}),this}},{key:"find",value:function(m){var a=new w;return this._elements.forEach(function(_){Tn(_,m).forEach(function(v){a.push(v)})}),a}},{key:"hide",value:function(){return this._elements.forEach(function(m){m.style.display="none"}),this}},{key:"show",value:function(){return this._elements.forEach(function(m){m.style.display=""}),this}},{key:"empty",value:function(){return this._elements.forEach(function(m){m.innerHTML=""}),this}},{key:"text",value:function(m){return this._elements.forEach(function(a){a.textContent=m}),this}},{key:"on",value:function(m,a){var _=this;return m.trim().split(" ").forEach(function(v){_._elements.forEach(function(k){k.addEventListener(v,a)})}),this}},{key:"hover",value:function(m,a){return this._elements.forEach(function(_){_.addEventListener("mouseover",m),_.addEventListener("mouseout",a)}),this}},{key:"first",value:function(){var m=new w;return this._elements.length?m.push(this._elements[0]):m}},{key:"get",value:function(m){return this._elements[m]}},{key:"disabled",value:function(m){return this._elements.forEach(function(a){a.disabled!=m&&(a.disabled=m)}),this}},{key:"blockInteraction",value:function(){var m=this;return this._elements.forEach(function(a){a.style.pointerEvents="none",a.addEventListener("keydown",m.keydownBlockEventHandler)}),this}},{key:"unblockInteraction",value:function(){var m=this;return this._elements.forEach(function(a){a.style.pointerEvents="auto",a.removeEventListener("keydown",m.keydownBlockEventHandler)}),this}},{key:"push",value:function(){var m;return(m=this._elements).push.apply(m,arguments),this}},{key:"keydownBlockEventHandler",value:function(m){m.preventDefault()}},{key:"length",get:function(){return this._elements.length}},{key:"elements",get:function(){return Ut(this._elements)}}],[{key:"createTSQueryElement",value:function(m){var a=Lt(m),_=new w;return _.push.apply(_,Ut(a)),_}}]),w}();function Lt(w){var m,a;return w instanceof Jt?w.elements:w instanceof Array?w:w instanceof HTMLElement?[w]:Dn.test(w)?(m=w,(a=document.createElement("div")).innerHTML=m,Ht(a.childNodes)):Tn(document,w)}function Ht(w){var m=[];return[].forEach.call(w,function(a){a instanceof HTMLElement&&m.push(a)}),m}function Tn(w,m){return Ht(w.querySelectorAll(m))}function kt(w,m){return!!w.className.match(new RegExp("(\\s|^)"+m+"(\\s|$)"))}function ft(w){return Jt.createTSQueryElement(w)}(w=Pt||(Pt={})).Mousedown="mousedown",w.Mouseup="mouseup",w.Mouseenter="mouseenter",w.Mouseleave="mouseleave",w.Click="click",function(w){w.Keydown="keydown",w.Keypress="keypress"}(Kt||(Kt={})),function(w){w.Selected="xmui--selected",w.Disabled="xmui--disabled",w.Active="xmui--active",w.Error="xmui--error"}(gt||(gt={}));var fe,tt=function(){function w(){ee(this,w),this._active=!1,this._selected=!1,this._disabled=!1,this._error=!1,this._key="",this.element=this.buildElement()}return re(w,[{key:"appendInto",value:function(m){m.append(this.element)}},{key:"prependInto",value:function(m){m.prepend(this.element)}},{key:"remove",value:function(){this.element.remove()}},{key:"onClick",value:function(m){this.onMouseEvent(Pt.Click,m)}},{key:"onMousedown",value:function(m){this.onMouseEvent(Pt.Mousedown,m)}},{key:"onMouseup",value:function(m){this.onMouseEvent(Pt.Mouseup,m)}},{key:"onMouseenter",value:function(m){this.onMouseEvent(Pt.Mouseenter,m)}},{key:"onMouseleave",value:function(m){this.onMouseEvent(Pt.Mouseleave,m)}},{key:"onMouseEvent",value:function(m,a){var _=this;this.element.on(m,function(v){a(_,v)})}},{key:"onKeydown",value:function(m){this.onKeyboardEvent(Kt.Keydown,m)}},{key:"onKeypress",value:function(m){this.onKeyboardEvent(Kt.Keypress,m)}},{key:"onKeyboardEvent",value:function(m,a){var _=this;this.element.on(m,function(v){a(_,v)})}},{key:"onPaste",value:function(m){this.element.on("paste",m)}},{key:"onCut",value:function(m){this.element.on("cut",m)}},{key:"onBlur",value:function(m){this.element.on("blur",m)}},{key:"onFocus",value:function(m){this.element.on("focus",m)}},{key:"onFocusIn",value:function(m){this.element.on("focusin",m)}},{key:"onFocusOut",value:function(m){this.element.on("focusout",m)}},{key:"onHover",value:function(m,a){this.element.hover(m,a)}},{key:"addClass",value:function(m){this.element.addClass(m)}},{key:"removeClass",value:function(m){this.element.removeClass(m)}},{key:"focus",value:function(){var m=this;setTimeout(function(){m.element.focus()})}},{key:"scrollIntoView",value:function(){var m=this;setTimeout(function(){m.htmlElement.scrollIntoView()})}},{key:"show",set:function(m){m?this.element.show():this.element.hide()}},{key:"id",set:function(m){this.htmlElement.id=m},get:function(){return this.htmlElement.id}},{key:"value",set:function(m){this._value=m},get:function(){return this._value}},{key:"className",set:function(m){this.element.setClass(m)}},{key:"ariaRole",set:function(m){this.attr={"aria-role":m}}},{key:"role",set:function(m){this.attr={role:m}}},{key:"ariaLabel",set:function(m){this.attr={"aria-label":m}}},{key:"ariaLabeledBy",set:function(m){this.attr={"aria-labelledby":m}}},{key:"ariaDescribedBy",set:function(m){this.attr={"aria-describedby":m}}},{key:"ariaMultiselectable",set:function(m){this.attr={"aria-multiselectable":m.toString()}}},{key:"ariaActiveDescendant",set:function(m){this.attr={"aria-activedescendant":m}}},{key:"ariaLive",set:function(m){this.attr={"aria-live":m}}},{key:"ariaSelected",set:function(m){this.attr={"aria-selected":m.toString()}}},{key:"ariaDisabled",set:function(m){this.attr={"aria-disabled":m.toString()}}},{key:"automationId",set:function(m){this.attr={"tsc-name":m}}},{key:"tabindex",set:function(m){this.attr={tabindex:m.toString()}}},{key:"spellcheck",set:function(m){this.attr={spellcheck:m?"true":"false"}}},{key:"attr",set:function(m){this.element.attr(m)}},{key:"htmlElement",get:function(){return this.element.get(0)}},{key:"active",set:function(m){m!==this._active&&m?this.addClass(gt.Active):this.removeClass(gt.Active),this._active=m},get:function(){return this._active}},{key:"selected",set:function(m){m!==this._selected&&m?this.addClass(gt.Selected):this.removeClass(gt.Selected),this._selected=m,this.ariaSelected=m},get:function(){return this._selected}},{key:"disabled",set:function(m){m!==this._disabled&&m?this.addClass(gt.Disabled):this.removeClass(gt.Disabled),this._disabled=m,this.ariaDisabled=m},get:function(){return this._disabled}},{key:"key",get:function(){return this._key},set:function(m){this._key=m}},{key:"error",set:function(m){this._error=m,m?this.addClass(gt.Error):this.removeClass(gt.Error)},get:function(){return this._error}}]),w}(),ve=function(w){function m(){var a,_=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return ee(this,m),(a=ce(this,oe(m).call(this))).setText(_),a}return le(m,w),re(m,[{key:"buildElement",value:function(){return ft("<span></span>")}},{key:"setText",value:function(a){this.element.text(null==a?"":a)}}]),m}(tt),lt=function(w){function m(){var a;return ee(this,m),(a=ce(this,oe(m).apply(this,arguments))).children=[],a}return le(m,w),re(m,[{key:"prependChild",value:function(a){a.prependInto(this.element),this.children.push(a)}},{key:"prependChildren",value:function(){for(var a=this,_=arguments.length,v=new Array(_),k=0;k<_;k++)v[k]=arguments[k];v.forEach(function(M){a.prependChild(M)})}},{key:"appendChild",value:function(a){a.appendInto(this.element),this.children.push(a)}},{key:"appendChildren",value:function(){for(var a=this,_=arguments.length,v=new Array(_),k=0;k<_;k++)v[k]=arguments[k];v.forEach(function(M){a.appendChild(M)})}},{key:"removeChild",value:function(a){this.children=this.children.filter(function(_){return _!==a}),a.remove()}},{key:"setContent",value:function(a){this.empty(),this.appendChild(a)}},{key:"empty",value:function(){this.element.empty(),this.children=[]}},{key:"getNextChild",value:function(a){var _=this.getChildren().length,v=(this.getChildIndex(a)+1)%_;return this.getChildByIndex(v)}},{key:"getPrevChild",value:function(a){var _=this.getChildren().length,v=(this.getChildIndex(a)+_-1)%_;return this.getChildByIndex(v)}},{key:"getChildByIndex",value:function(a){return this.children[a]}},{key:"getChildren",value:function(){return this.children}},{key:"getChildIndex",value:function(a){return this.children.indexOf(a)}}]),m}(tt),se=function(w){function m(){return ee(this,m),ce(this,oe(m).apply(this,arguments))}return le(m,w),re(m,[{key:"buildElement",value:function(){return ft("<div></div>")}}]),m}(lt),jt="xmui-info-panel",cn=function(w){function m(){var a;ee(this,m),(a=ce(this,oe(m).call(this))).className=jt,a.titleComponent=new ve,a.titleComponent.className="".concat(jt,"_title"),a.titleComponent.automationId="xmui-info-panel-title",a.instructionsComponent=new ve,a.instructionsComponent.className="".concat(jt,"_instructions"),a.instructionsComponent.automationId="xmui-info-panel-instructions",a.instructionsComponent.show=!1;var _=new se;return _.className="".concat(jt,"_container"),_.appendChildren(a.titleComponent,a.instructionsComponent),a.appendChild(_),a}return le(m,w),re(m,[{key:"setTitle",value:function(a){this.titleComponent.setText(a)}},{key:"setInstructions",value:function(a){var _=a?a.trim():"";this.instructionsComponent.setText(_),this.instructionsComponent.show=!!_}}]),m}(se),qt="xmui-header-panel",un=function(w){function m(){var a,_=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return ee(this,m),(a=ce(this,oe(m).call(this))).className=qt,a.addClass("".concat(qt,_?"--short":"--normal")),a.iconComp=new se,a.iconComp.className="".concat(qt,"_icon"),a.iconComp.show=!1,a.textComp=new ve,a.textComp.className="".concat(qt,"_text"),a.appendChildren(a.iconComp,a.textComp),a}return le(m,w),re(m,[{key:"setText",value:function(a){this.textComp.setText(a)}},{key:"setIcon",value:function(a){this.iconComp.className="".concat(qt,"_icon ").concat(a),this.iconComp.show=!0}}]),m}(se),Xt="xmui-action-panel",Fn=function(w){function m(){var a,_=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return ee(this,m),(a=ce(this,oe(m).call(this))).className=Xt,a.addClass("".concat(Xt,_?"--short":"--normal")),a.leftButtonsContainer=new se,a.leftButtonsContainer.className="".concat(Xt,"_left"),a.rightButtonsContainer=new se,a.rightButtonsContainer.className="".concat(Xt,"_right"),a.appendChildren(a.leftButtonsContainer,a.rightButtonsContainer),a}return le(m,w),re(m,[{key:"addLeftButton",value:function(a){this.leftButtonsContainer.appendChild(a)}},{key:"addRightButton",value:function(a){this.rightButtonsContainer.appendChildren(a)}}]),m}(se),Mn="xmui-busy-indicator",Kn=function(w){function m(){var a;ee(this,m),(a=ce(this,oe(m).call(this))).className=Mn;var _=new se;return _.className="".concat(Mn,"_animation"),a.appendChild(_),a}return le(m,w),m}(se);!function(w){w.User="xmui-icon-user",w.Remove="xmui-icon-remove",w.Rename="xmui-icon-rename",w.More="xmui-icon-more",w.CircledMore="xmui-icon-circled-more",w.PasswordVisible="xmui-icon-password-input-visible",w.PasswordHidden="xmui-icon-password-input-hidden",w.Device="xmui-icon-device",w.Registered="xmui-icon-registered",w.WebBrowser="xmui-icon-web-browser",w.Expand="xmui-icon-expand",w.LockedState="xmui-icon-locked-state",w.MobileApproveWaiting="xmui-icon-mobile-approve-waiting",w.WaitForTicket="xmui-icon-wait-for-ticket",w.Checked="xmui-icon-checked",w.Unchecked="xmui-icon-unchecked",w.Checkmark="xmui-icon-checkmark",w.Cancellation="xmui-icon-cancellation",w.Expiration="xmui-icon-expired",w.Information="xmui-icon-information",w.Confirmation="xmui-icon-confirmation",w.Rejection="xmui-icon-rejection",w.AuthLocked="xmui-icon-locked",w.Error="xmui-icon-error",w.Unregister="xmui-icon-unregister",w.Fallback="xmui-icon-fallback",w.Promotion="xmui-icon-promotion",w.PasswordAuth="xmui-icon-password-auth",w.PincodeAuth="xmui-icon-pincode-auth",w.PatternAuth="xmui-icon-pattern-auth",w.OtpAuth="xmui-icon-otp-auth",w.VoiceAuth="xmui-icon-voice-auth",w.QuestionsAuth="xmui-icon-questions-auth",w.TotpAuth="xmui-icon-totp-auth",w.MobileApproveAuth="xmui-icon-mobile-approve-auth",w.GenericAuth="xmui-icon-generic-auth",w.SmsChannel="xmui-icon-sms-channel",w.EmailChannel="xmui-icon-email-channel",w.PushChannel="xmui-icon-push-channel",w.VoiceChannel="xmui-icon-voice-channel"}(fe||(fe={}));var ln="xmui-page",Ot=function(w){function m(a,_){var v,k=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return ee(this,m),(v=ce(this,oe(m).call(this))).forceShowHeader=k,v.className=ln,v.role="dialog",v.headerPanel=new un,v.headerPanel.show=v.forceShowHeader||!1,v.infoPanel=new cn,v.infoPanel.show=!1,v.contentContainer=new se,v.contentContainer.className="".concat(ln,"_content"),v.busyIndicator=new Kn,v.contentContainer.appendChild(v.busyIndicator),v.busy=!1,v.actionPanel=new Fn,v.appendChildren(v.headerPanel,v.infoPanel,v.contentContainer,v.actionPanel),v.automationId=a,v.addClass(_),v}return le(m,w),re(m,[{key:"setInstructions",value:function(a){this.infoPanel.setInstructions(a),this.infoPanel.show=!0}},{key:"setUserName",value:function(a){a?(this.headerPanel.setText(a),this.headerPanel.setIcon(fe.User),this.headerPanel.show=!0):this.headerPanel.show=this.forceShowHeader||!1}},{key:"blockInteraction",value:function(){this.element.blockInteraction()}},{key:"unblockInteraction",value:function(){this.element.unblockInteraction()}},{key:"setContent",value:function(a){this.contentContainer.appendChild(a)}},{key:"setTitle",value:function(a){this.infoPanel.setTitle(a),this.infoPanel.show=!0}},{key:"addLeftButton",value:function(a){this.actionPanel.addLeftButton(a)}},{key:"addRightButton",value:function(a){this.actionPanel.addRightButton(a)}},{key:"busy",set:function(a){this.busyIndicator.show=a}},{key:"error",set:function(a){this.infoPanel.error=a}}]),m}(se),X=function w(){ee(this,w)};X.button_cancel="xmui-button-cancel",X.button_back="xmui-button-back",X.button_abort="xmui-button-abort",X.button_retry="xmui-button-retry",X.button_continue="xmui-button-continue",X.button_reset="xmui-button-reset",X.button_change_method="xmui-button-change-method",X.button_select_method="xmui-button-select-method",X.button_send_to_all="xmui-button-send-to-all",X.button_actions_list="xmui-button-actions-list",X.button_skip="xmui-button-skip",X.button_rename="xmui-button-rename",X.button_identify="xmui-button-identify",X.button_remove="xmui-button-remove",X.button_escape="xmui-button-escape",X.button_recovery="xmui-button-recovery",X.button_dynamic="xmui-button-dynamic",X.button_add_question="xmui-button-add-question",X.list_actions="xmui-list-actions",X.list_item_text_state="xmui-list-item-text-state",X.list_item_icon_state="xmui-list-item-icon-state",X.dialog_recovery="xmui-dialog-recovery",X.dialog_cancellation="xmui-dialog-cancellation",X.dialog_confirm="xmui-dialog-confirm",X.dialog_information="xmui-dialog-information",X.dialog_title="xmui-dialog-title",X.dialog_message="xmui-dialog-message",X.dialog_fallback="xmui-dialog-fallback",X.dialog_registration_promotion_intro="xmui-dialog-registration-promotion-intro",X.popup_dialog_confirm="xmui-popup-dialog-confirm",X.popup_dialog_input="xmui-popup-dialog-input",X.input_password="xmui-input-password",X.input_repeat_password="xmui-input-repeat-password",X.input_fido2="xmui-input-fido2",X.input_repeat_fido2="xmui-input-repeat-fido2",X.input_pin_code="xmui-input-pin-code",X.input_pattern_lock="xmui-input-pattern-lock",X.input_otp_code="xmui-input-otp-code",X.input_totp_code="xmui-input-totp-code",X.input_text="xmui-input-text",X.input_email="xmui-input-email",X.input_security_question="xmui-input-security-question",X.input_mobile_phone_number="xmui-input-mobile-phone-number",X.input_mobile_phone_coutry_code="xmui-input-mobile-phone-country-code",X.page_password_auth="xmui-page-password-auth",X.page_password_reg="xmui-page-password-reg",X.page_fido2_auth="xmui-page-fido2-auth",X.page_fido2_reg="xmui-page-fido2-reg",X.page_pin_auth="xmui-page-pin-auth",X.page_pin_reg="xmui-page-pin-reg",X.page_pattern_auth="xmui-page-pattern-auth",X.page_pattern_reg="xmui-page-pattern-reg",X.page_otp_auth="xmui-page-otp-auth",X.page_totp_auth="xmui-page-totp-auth",X.page_ticket_wait="xmui-page-ticket-wait",X.page_mobile_approve="xmui-page-mobile-approve",X.page_select_device="xmui-page-select-device",X.page_otp_select_channel="xmui-page_otp_select_channel",X.page_configure_authenticators="xmui-page-configure-authenticators",X.page_manage_devices="xmui-page-manage-devices",X.page_select_device_to_manage="xmui-page-select-managed-device",X.page_select_authenticator="xmui-page-select-authenticator",X.page_manage_user_details="xmui-page-manage-user-details",X.page_dynamic_form="xmui-page-dynamic-form",X.page_security_questions_auth="xmui-page-security-questions-auth",X.page_security_questions_reg="xmui-page-security-questions-reg";var bt,wt="xmui-dialog-content",V=function(w){function m(){var a;return ee(this,m),(a=ce(this,oe(m).call(this))).className=wt,a.ariaRole="dialog",a.ariaLabeledBy="".concat(wt,"_title"),a.ariaDescribedBy="".concat(wt,"_message"),a.createContent(),a}return le(m,w),re(m,[{key:"setDialogTitle",value:function(a){this.titleComp.setText(a)}},{key:"setDialogMessage",value:function(a){this.messageComp.setText(a)}},{key:"setDialogIconClass",value:function(a){this.iconComp.className="".concat(wt,"_icon ").concat(a)}},{key:"createContent",value:function(){this.iconComp=new se,this.iconComp.className="".concat(wt,"_icon"),this.titleComp=new ve,this.titleComp.className="".concat(wt,"_title"),this.titleComp.automationId=X.dialog_title,this.messageComp=new ve,this.messageComp.className="".concat(wt,"_message"),this.messageComp.automationId=X.dialog_message,this.appendChildren(this.iconComp,this.titleComp,this.messageComp)}}]),m}(se),At=function(w){function m(a,_){var v;return ee(this,m),(v=ce(this,oe(m).call(this,a,_))).handleClick=v.handleClick.bind(Ee(v)),v.dialogContent=new V,v.setContent(v.dialogContent),v}return le(m,w),re(m,[{key:"addLeftButton",value:function(a){a.onClick(this.handleClick),dt(oe(m.prototype),"addLeftButton",this).call(this,a)}},{key:"addRightButton",value:function(a){a.onClick(this.handleClick),dt(oe(m.prototype),"addRightButton",this).call(this,a)}},{key:"setDialogTitle",value:function(a){this.dialogContent.setDialogTitle(a)}},{key:"setDialogMessage",value:function(a){this.dialogContent.setDialogMessage(a)}},{key:"setDialogIconClass",value:function(a){this.dialogContent.setDialogIconClass(a)}},{key:"onSelect",value:function(a){this.onSelectCB=a}},{key:"handleClick",value:function(a){this.onSelectCB(a.value)}}]),m}(Ot),$t=0,Wt_generate=function(){return"".concat("xmui-id-").concat((new Date).getTime().toString(),"-").concat(++$t)},It="xmui-list-item",zt=function(w){function m(a,_){var v,k=arguments.length>2&&void 0!==arguments[2]&&arguments[2];ee(this,m),(v=ce(this,oe(m).call(this))).key=a,v.id=Wt_generate(),v.className=It,k&&v.addClass("".concat(It,"--section-start"));var M=new se;return M.className="".concat(It,"_hover-indicator"),v.contentContainer=new se,v.contentContainer.className="".concat(It,"_content-container"),v.appendChildren(M,v.contentContainer),_&&v.addCheckbox(),v.role="option",v}return le(m,w),re(m,[{key:"setContent",value:function(a){this.contentContainer.setContent(a)}},{key:"addCheckbox",value:function(){var a=new se;a.className="".concat(It,"_checkbox"),this.appendChild(a)}}]),m}(se);!function(w){w[w.Backspace=8]="Backspace",w[w.Tab=9]="Tab",w[w.Enter=13]="Enter",w[w.Shift=16]="Shift",w[w.Ctrl=17]="Ctrl",w[w.Alt=18]="Alt",w[w.Escape=27]="Escape",w[w.Space=32]="Space",w[w.PageUp=33]="PageUp",w[w.PageDown=34]="PageDown",w[w.End=35]="End",w[w.Home=36]="Home",w[w.LeftArrow=37]="LeftArrow",w[w.UpArrow=38]="UpArrow",w[w.RightArrow=39]="RightArrow",w[w.DownArrow=40]="DownArrow",w[w.Zero=48]="Zero",w[w.One=49]="One",w[w.Two=50]="Two",w[w.Three=51]="Three",w[w.Four=52]="Four",w[w.Five=53]="Five",w[w.Six=54]="Six",w[w.Seven=55]="Seven",w[w.Eight=56]="Eight",w[w.Nine=57]="Nine"}(bt||(bt={}));var S,xt=function(){function w(m){ee(this,w),this.container=m,this.container.ariaActiveDescendant="",this.container.onKeydown(this.handleNavigation.bind(this))}return re(w,[{key:"onSelect",value:function(m){this.selectCB=m}},{key:"activateItem",value:function(m){m&&m!==this.activeItem&&(this.deactivateItem(),this.activeItem=m,m.active=!0,this.container.ariaActiveDescendant=m.id,this.scrollToItem(m))}},{key:"deactivateItem",value:function(m){var a=null==m||m===this.activeItem?this.activeItem:null;a&&(this.activeItem=null,a.active=!1,this.container.ariaActiveDescendant="")}},{key:"handleNavigation",value:function(m,a){switch(a.keyCode){case bt.DownArrow:this.handleDownArrow(),a.preventDefault(),a.stopPropagation();break;case bt.UpArrow:this.handleUpArrow(),a.preventDefault(),a.stopPropagation();break;case bt.Enter:case bt.Space:this.handleEnter(),a.stopPropagation()}}},{key:"handleDownArrow",value:function(){var m=this.container.getNextChild(this.activeItem);this.activateItem(m)}},{key:"handleUpArrow",value:function(){var m=this.container.getPrevChild(this.activeItem);this.activateItem(m)}},{key:"handleEnter",value:function(){this.activeItem&&this.selectCB&&this.selectCB(this.activeItem)}},{key:"scrollToItem",value:function(m){var a=this.container.htmlElement,_=m.htmlElement;if(a.scrollHeight>a.clientHeight){var k=_.offsetTop+_.offsetHeight;k>a.clientHeight+a.scrollTop?a.scrollTop=k-a.clientHeight:_.offsetTop<a.scrollTop&&(a.scrollTop=_.offsetTop)}}}]),w}();!function(w){w[w.None=0]="None",w[w.Single=1]="Single",w[w.SingleMouseup=2]="SingleMouseup",w[w.Multiple=3]="Multiple"}(S||(S={}));var Yt,p,d,l,t=function(w){function m(){var a,_=arguments.length>0&&void 0!==arguments[0]?arguments[0]:S.Single,v=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return ee(this,m),(a=ce(this,oe(m).call(this))).listSelectionMode=_,a.activateOnHover=v,a.selectionChangedCB=[],a.itemClickedCB=[],a.selectedItems=[],a.ariaMultiselectable=_===S.Multiple,a.handleItemClicked=a.handleItemClicked.bind(Ee(a)),a.handleMouseEvents=a.handleMouseEvents.bind(Ee(a)),a.handleItemMouseenter=a.handleItemMouseenter.bind(Ee(a)),a.handleItemMouseleave=a.handleItemMouseleave.bind(Ee(a)),a.keyboardNav=new xt(Ee(a)),a.keyboardNav.onSelect(function(k){k&&!k.disabled&&a.handleSelectionChanged(k)}),a.onMouseup(a.handleMouseEvents),a.onMousedown(a.handleMouseEvents),a.onClick(a.handleMouseEvents),a}return le(m,w),re(m,[{key:"onSelectionChanged",value:function(a){this.selectionChangedCB.push(a)}},{key:"onItemClicked",value:function(a){this.itemClickedCB.push(a)}},{key:"clearSelection",value:function(){this.selectedItems.forEach(function(a){a.selected=!1}),this.selectedItems=[]}},{key:"clearActive",value:function(){this.deactivateItem()}},{key:"activateItem",value:function(a){this.keyboardNav.activateItem(a)}},{key:"deactivateItem",value:function(a){this.keyboardNav.deactivateItem(a)}},{key:"addItem",value:function(a){this.selectionMode===S.SingleMouseup?a.onMouseup(this.handleItemClicked):a.onClick(this.handleItemClicked),this.activateOnHover&&this.activateItemOnHover(a),this.appendChild(a)}},{key:"activateItemOnHover",value:function(a){a.onMouseenter(this.handleItemMouseenter),a.onMouseleave(this.handleItemMouseenter)}},{key:"handleItemMouseenter",value:function(a){this.activateItem(a)}},{key:"handleItemMouseleave",value:function(a){this.deactivateItem(a)}},{key:"addToSelection",value:function(a){a.selected=!0,-1===this.selectedItems.indexOf(a)&&(this.selectedItems.push(a),this.notifySelectionChanged())}},{key:"removeFromSelection",value:function(a){a.selected=!1;var _=this.selectedItems.indexOf(a);_>-1&&(this.selectedItems.splice(_,1),this.notifySelectionChanged())}},{key:"handleMouseEvents",value:function(){event.stopPropagation()}},{key:"handleItemClicked",value:function(a){!a.disabled&&this.handleSelectionChanged(a),this.activateItem(a)}},{key:"handleSelectionChanged",value:function(a){switch(this.listSelectionMode){case S.Multiple:this.handleMultipleSelectionChanged(a);break;case S.Single:case S.SingleMouseup:this.handleSingleSelectionChanged(a);break;case S.None:this.itemClickedCB.forEach(function(_){_(a.key)})}}},{key:"handleMultipleSelectionChanged",value:function(a){a.selected?this.removeFromSelection(a):this.addToSelection(a)}},{key:"handleSingleSelectionChanged",value:function(a){a.selected=!a.selected,this.clearSelection(),this.addToSelection(a)}},{key:"notifySelectionChanged",value:function(){var a=this.selectedItems.map(function(_){return _.key});this.selectionChangedCB.forEach(function(_){_(a)})}},{key:"selectionMode",get:function(){return this.listSelectionMode}}]),m}(se),i="xmui-list",u=function(w){function m(){var a,_=arguments.length>0&&void 0!==arguments[0]?arguments[0]:S.Single;return ee(this,m),(a=ce(this,oe(m).call(this,_))).shouldStartSection=!1,a.className=i,a.role="listbox",a.tabindex=0,a}return le(m,w),re(m,[{key:"addListItem",value:function(a,_,v){var k=new zt(a,this.selectionMode===S.Multiple,this.shouldStartSection);k.setContent(v),k.disabled=_,k.selected=!1,this.shouldStartSection=!1,this.addItem(k)}},{key:"startSection",value:function(){this.shouldStartSection=!0}}]),m}(t),c="xmui-list-item-content",s=function(w){function m(a){var _,v=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,k=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,M=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,q=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,B=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;if(ee(this,m),(_=ce(this,oe(m).call(this))).className=c,k){var J=new se;J.className="".concat(c,"_icon ").concat(k),_.appendChild(J)}var Y=new se;if(Y.className="".concat(c,"_text-container"),a){var he=new ve;he.setText(a),he.className="".concat(c,"_title");var pe=new se;pe.className="".concat(c,"_title-container"),pe.appendChild(he),B&&B.forEach(function(Ye){var Tt=new se;Tt.className="".concat(c,"_icon-state ").concat(Ye),Tt.automationId=X.list_item_icon_state,pe.appendChild(Tt)}),q&&q.forEach(function(Ye){pe.appendChild(Ye)}),Y.appendChild(pe)}if(v){var xe=new ve;xe.setText(v),xe.className="".concat(c,"_info"),Y.appendChild(xe)}if(_.appendChild(Y),M){var ht=new se;ht.className="".concat(c,"_space"),_.appendChild(ht),_.appendChild(M)}return _}return le(m,w),m}(se),n=function(){function w(){ee(this,w)}return re(w,null,[{key:"getAuthenticatorIcon",value:function(m){if(!Yt){var a,_=com.ts.mobile.sdk.AuthenticatorType;ge(a={},_.Password,fe.PasswordAuth),ge(a,_.Pincode,fe.PincodeAuth),ge(a,_.Pattern,fe.PatternAuth),ge(a,_.Otp,fe.OtpAuth),ge(a,_.Voice,fe.VoiceAuth),ge(a,_.Questions,fe.QuestionsAuth),ge(a,_.Totp,fe.TotpAuth),ge(a,_.MobileApprove,fe.MobileApproveAuth),ge(a,_.Generic,fe.GenericAuth),Yt=a}return Yt[m]}},{key:"getChannelIcon",value:function(m){if(!p){var a,_=com.ts.mobile.sdk.OtpChannel;ge(a={},_.Sms,fe.SmsChannel),ge(a,_.Email,fe.EmailChannel),ge(a,_.PushNotification,fe.PushChannel),ge(a,_.VoiceCall,fe.VoiceChannel),p=a}return p[m]}}]),w}();(function(w){w.Button="button",w.Submit="submit"})(d||(d={})),function(w){w.Normal="normal",w.Alert="alert",w.Recovery="recovery"}(l||(l={}));var e,o="".concat("xmui-button","--"),r=function(w){function m(a){var _,v=arguments.length>1&&void 0!==arguments[1]?arguments[1]:l.Normal;ee(this,m),(_=ce(this,oe(m).call(this))).buttonMode=v,_.automationId=a;var k=o+v;return _.addClass(k),_}return le(m,w),re(m,[{key:"buildElement",value:function(){return ft('<button class="'.concat("xmui-button",'"></button>'))}},{key:"label",set:function(a){this.element.text(a)},get:function(){return this.htmlElement.innerText}},{key:"form",set:function(a){this.attr={form:a}}},{key:"type",set:function(a){this.attr={type:a}}},{key:"disabled",set:function(a){Ne(oe(m.prototype),"disabled",a,this,!0),this.htmlElement.disabled=a}}]),m}(tt),h=function(w){function m(a,_,v){var k,M=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return ee(this,m),(k=ce(this,oe(m).call(this,a,_))).actionContext=v,k.uiContext=v.getUiContext(),M&&(k._cancelButton=new r(X.button_cancel),k._cancelButton.label=k.uiContext.getString("ts_gen_cancel"),k._cancelButton.onClick(function(){return k.handleCancelButtonClicked()}),k.addLeftButton(k.cancelButton)),k.addEscapeOptionButtons(v.getEscapeOptions()),k}return le(m,w),re(m,[{key:"addEscapeOptionButtons",value:function(a){var _=this;a.filter(function(v){return v.getPresentation()===com.ts.mobile.sdk.ActionEscapeOptionPresentation.Action}).forEach(function(v){var k=new r(X.button_escape);k.label=v.getDisplayName(),k.onClick(function(){return _.handleEscapeButtonClicked(v)}),_.addLeftButton(k)})}},{key:"handleEscapeButtonClicked",value:function(a){this.onEscapeCB&&this.onEscapeCB(a)}},{key:"onCancel",value:function(a){this.onCancelCB=a}},{key:"onEscape",value:function(a){this.onEscapeCB=a}},{key:"handleCancelButtonClicked",value:function(){var a=this.actionContext.getEscapeOptions().filter(function(_){return _.getPresentation()===com.ts.mobile.sdk.ActionEscapeOptionPresentation.Cancel});a.length?this.onEscapeCB&&this.onEscapeCB(a[0]):this.onCancelCB&&this.onCancelCB()}},{key:"cancelButton",get:function(){return this._cancelButton}}]),m}(Ot),g=function(w){function m(a){var _;ee(this,m);var v=(_=ce(this,oe(m).call(this,X.page_select_authenticator,"xmui-select-authenticator",a))).createContent();return _.setContent(v),_}return le(m,w),re(m,[{key:"createContent",value:function(){var a=this;return this.authList=new u,this.authList.onSelectionChanged(function(_){_.length&&a.onSubmitCB&&a.onSubmitCB(_[0])}),this.authList.focus(),this.authList}},{key:"addAuthenticator",value:function(a,_,v,k){var M=n.getAuthenticatorIcon(v)||n.getAuthenticatorIcon(com.ts.mobile.sdk.AuthenticatorType.Generic),q=new s(_,null,M,null,null,k?[fe.LockedState]:null);this.authList.addListItem(a,k,q)}},{key:"onSubmit",value:function(a){this.onSubmitCB=a}}]),m}(h);!function(w){w[w.Resume=-1]="Resume",w[w.Continue=0]="Continue",w[w.Cancel=1]="Cancel"}(e||(e={}));var y,A,T,C,E=function(){function w(){ee(this,w)}return re(w,null,[{key:"createContinueConfirmationInput",value:function(){return com.ts.mobile.sdk.ConfirmationInput.create(0)}},{key:"createCancelConfirmationInput",value:function(){return com.ts.mobile.sdk.ConfirmationInput.create(1)}},{key:"createResumeConfirmationInput",value:function(){return com.ts.mobile.sdk.ConfirmationInput.create(-1)}},{key:"createCancelAuthenticatorRequest",value:function(){var m=com.ts.mobile.sdk.ControlRequest.create(com.ts.mobile.sdk.ControlRequestType.CancelAuthenticator);return com.ts.mobile.sdk.InputOrControlResponse.createControlResponse(m)}},{key:"isContinueConfirmationInput",value:function(m){return 0===m}},{key:"isResumeConfirmationInput",value:function(m){return-1===m}},{key:"createTargetsSelectionResponse",value:function(m){var a=com.ts.mobile.sdk.TargetBasedAuthenticatorInput.createTargetsSelectionRequest(m);return com.ts.mobile.sdk.InputOrControlResponse.createInputResponse(a)}},{key:"createAbortControlResponse",value:function(){var m=com.ts.mobile.sdk.ControlRequest.create(com.ts.mobile.sdk.ControlRequestType.AbortAuthentication);return com.ts.mobile.sdk.InputOrControlResponse.createControlResponse(m)}},{key:"getDeviceNameFromDeviceDetails",value:function(m){var a=m.getAlias();return w.getDeviceName(a,m)}},{key:"getLastAccessedFromDeviceDetails",value:function(m,a){var _=new Date(a.getLastAccessed()).toLocaleString();return m.formatString("ts_authenticator_mobile_approve_targets_recently_used",[_])}},{key:"getDeviceName",value:function(m,a){var _=a.getModel(),v=a.getOsType(),k=a.getOsVersion();return m||"".concat(_," ").concat(v," ").concat(k)}}]),w}(),O=function(w){function m(a,_){var v;ee(this,m),(v=ce(this,oe(m).call(this,X.dialog_information,"xmui-information-dialog-page"))).automationId=X.dialog_information;var k=new r(X.button_continue);return k.label=_||a.getString("ts_authenticator_password_cta_positive"),k.value=!0,v.addRightButton(k),k.focus(),v}return le(m,w),m}(At),L=function(){function w(){ee(this,w)}return re(w,null,[{key:"getAuthenticatorNameKey",value:function(m){return"".concat("ts_authenticator_").concat(m)}},{key:"getAuthenticatorDescriptionKey",value:function(m){return"question"==m&&(m="questions"),"".concat("ts_authenticator_").concat(m,"_description")}}]),w}(),N=new(function(){function w(){ee(this,w),this._isLogEnabled=!0}return re(w,[{key:"init",value:function(){this.lastPage=null,this.isBusy=!1,this.isLogEnabled=!0}},{key:"lastPage",set:function(m){this._lastPage=m},get:function(){return this._lastPage}},{key:"isBusy",set:function(m){this._isBusy=m},get:function(){return this._isBusy}},{key:"isLogEnabled",set:function(m){this._isLogEnabled=m},get:function(){return this._isLogEnabled}}]),w}()),W=function(w){function m(){var a;ee(this,m),(a=ce(this,oe(m).call(this))).className="xmui-busy-overlay";var _=new se;return _.className="xmui-busy-overlay_icon",a.appendChild(_),a}return le(m,w),m}(se),j=function(){function w(){ee(this,w)}return re(w,null,[{key:"getContainer",value:function(m){var a;m&&m.uiContainer&&(a=ft(m.uiContainer)),null!=a&&0!==a.length||0===(a=ft("#transmitContainer")).length&&(a=ft('<div                                             id="transmitContainer"                                             style="position: relative; width: 100%; height: 100%">'),ft(document.documentElement).append(a));var _=a.find("#xmui-main-container");return 0===_.length&&(_=ft('<div                                      id="xmui-main-container"                                      style="position:relative; width:100%; height:100%">'),a.content(_)),_}},{key:"clearContainer",value:function(m){N.lastPage=null,w.getContainer(m).empty()}},{key:"getUsernameFromClientContext",value:function(m){return m&&m.username}},{key:"activityStarted",value:function(m){if(N.lastPage)N.lastPage.busy=!0;else{w.clearContainer(m);var a=w.getContainer(m);(new W).appendInto(a)}}},{key:"activityEnded",value:function(m){N.lastPage?N.lastPage.busy=!1:w.clearContainer(m)}},{key:"setLogEnabled",value:function(m){N.isLogEnabled=m}},{key:"log",value:function(m){N.isLogEnabled&&console.log(m)}},{key:"renderPage",value:function(m,a){this.clearContainer(a),m.appendInto(w.getContainer(a)),N.lastPage=m}},{key:"presentUI",value:function(m,a){this.clearContainer(a),w.getContainer(a).append(m),N.lastPage=null}},{key:"renderModal",value:function(m,a){m.appendInto(w.getContainer(a))}},{key:"getControlActionButtonsInfo",value:function(){var m;return y||(ge(m={},com.ts.mobile.sdk.ControlRequestType.ChangeMethod,{automationId:X.button_change_method,label:"ts_promise_co_change",positionLeft:!1}),ge(m,com.ts.mobile.sdk.ControlRequestType.AbortAuthentication,{automationId:X.button_abort,label:"ts_promise_co_abort",positionLeft:!0,isDefault:!0}),ge(m,com.ts.mobile.sdk.ControlRequestType.RetryAuthenticator,{automationId:X.button_retry,label:"ts_promise_co_retry",positionLeft:!1}),ge(m,com.ts.mobile.sdk.ControlRequestType.SelectMethod,{automationId:X.button_select_method,label:"ts_promise_co_select",positionLeft:!1}),ge(m,com.ts.mobile.sdk.ControlRequestType.CancelAuthenticator,{automationId:X.button_cancel,label:"ts_gen_cancel",positionLeft:!1,isDefault:!0}),y=m),y}},{key:"getRecoveryActionButtonsInfo",value:function(){var m;return A||(ge(m={},com.ts.mobile.sdk.AuthenticationErrorRecovery.ChangeAuthenticator,{automationId:X.button_change_method,label:"ts_promise_co_change",positionLeft:!1}),ge(m,com.ts.mobile.sdk.AuthenticationErrorRecovery.Fail,{automationId:X.button_abort,label:"ts_promise_co_abort",positionLeft:!0,isDefault:!0}),ge(m,com.ts.mobile.sdk.AuthenticationErrorRecovery.RetryAuthenticator,{automationId:X.button_retry,label:"ts_promise_co_retry",positionLeft:!1}),ge(m,com.ts.mobile.sdk.AuthenticationErrorRecovery.SelectAuthenticator,{automationId:X.button_select_method,label:"ts_promise_co_select",positionLeft:!1}),A=m),A}},{key:"getFallbackActionButtonsInfo",value:function(){var m;return T||(ge(m={},com.ts.mobile.sdk.AuthenticatorFallbackAction.Fallback,{automationId:X.button_change_method,label:"ts_promise_co_change",positionLeft:!1}),ge(m,com.ts.mobile.sdk.AuthenticatorFallbackAction.Cancel,{automationId:X.button_abort,label:"ts_promise_co_abort",positionLeft:!0,isDefault:!0}),ge(m,com.ts.mobile.sdk.AuthenticatorFallbackAction.Retry,{automationId:X.button_retry,label:"ts_promise_co_retry",positionLeft:!1}),ge(m,com.ts.mobile.sdk.AuthenticatorFallbackAction.AuthMenu,{automationId:X.button_select_method,label:"ts_promise_co_select",positionLeft:!1}),T=m),T}},{key:"buildDialogButtons",value:function(m,a,_,v){_.forEach(function(k){var M=v[k];if(M){var q=new r(M.automationId);q.value=k.toString(),q.label=a.getString(M.label),M.positionLeft?m.addLeftButton(q):m.addRightButton(q)}})}},{key:"failureDataToPolicyRejectionDialogParams",value:function(m,a){var _,v=null,k=a.getUiContext();if(m&&m.reason){var M=m.reason;switch(M.type){case"policy":v={title:"ts_promise_rejection_policy_title",text:"ts_promise_rejection_policy_content",buttonText:"ts_promise_rejection_policy_cta"};break;case"approval_expired":v={title:"ts_promise_rejection_approval_expired_title",text:"ts_promise_rejection_approval_expired_content",buttonText:"ts_promise_rejection_approval_expired_cta"};break;case"feature_not_supported":v={title:"ts_promise_rejection_feature_not_supported_title",text:"ts_promise_rejection_feature_not_supported_content",buttonText:"ts_promise_rejection_feature_not_supported_cta"};break;case"cannot_consume_ticket":v={title:"ts_promise_rejection_cannot_consume_ticket_title",text:"ts_promise_rejection_cannot_consume_ticket_content",buttonText:"ts_promise_rejection_cannot_consume_ticket_cta"};break;case"username_already_exists":_=[M.data&&M.data.username],v={title:"ts_promise_rejection_username_already_exists_title",text:"ts_promise_rejection_username_already_exists_content",buttonText:"ts_promise_rejection_username_already_exists_cta"};break;case"locked":switch(M.data&&M.data.lock_type){case"user":v={title:"ts_promise_rejection_locked_user_title",text:"ts_promise_rejection_locked_user_content",buttonText:"ts_promise_rejection_locked_user_cta"};break;case"device":v={title:"ts_promise_rejection_locked_device_title",text:"ts_promise_rejection_locked_device_content",buttonText:"ts_promise_rejection_locked_device_cta"};break;case"application":v={title:"ts_promise_rejection_locked_application_title",text:"ts_promise_rejection_locked_application_content",buttonText:"ts_promise_rejection_locked_application_cta"}}}}return v&&(v.title=k.getString(v.title),v.text=_?k.formatString(v.text,_):k.getString(v.text),v.buttonText=k.getString(v.buttonText)),v}}]),w}(),te=function(w){function m(a,_,v,k,M,q,B){var J;return ee(this,m),(J=ce(this,oe(m).call(this,a,_,v,k))).dialogContent=new V,J.dialogContent.setDialogTitle(M),J.dialogContent.setDialogMessage(q),J.dialogContent.setDialogIconClass(B),J.setContent(J.dialogContent),J}return le(m,w),m}(h),D=function(w){function m(a,_,v,k,M,q){var B;return ee(this,m),(B=ce(this,oe(m).call(this,X.dialog_confirm,"xmui-confirmation-action-dialog-page",a,null!=q,_,v,k))).continueButton=new r(X.button_continue),B.continueButton.label=M,B.continueButton.onClick(function(){return B.onContinueCB&&B.onContinueCB()}),B.addRightButton(B.continueButton),q&&(B.cancelButton.label=q),B}return le(m,w),re(m,[{key:"onContinue",value:function(a){this.onContinueCB=a}}]),m}(te),x=function(){function w(){ee(this,w)}return re(w,null,[{key:"promiseCancelAction",value:function(m,a,_,v,k){var M,B;return M=1==_.overrideAuthenticatorCancelBehavior||v==com.ts.mobile.sdk.AuthenticatorSessionMode.Authentication?(B=m).indexOf(com.ts.mobile.sdk.ControlRequestType.SelectMethod)>-1?com.ts.mobile.sdk.ControlRequestType.SelectMethod:B.indexOf(com.ts.mobile.sdk.ControlRequestType.ChangeMethod)>-1?com.ts.mobile.sdk.ControlRequestType.ChangeMethod:com.ts.mobile.sdk.ControlRequestType.AbortAuthentication:com.ts.mobile.sdk.ControlRequestType.AbortAuthentication,new Promise(function(B,J){B(com.ts.mobile.sdk.ControlRequest.create(M))})}},{key:"promiseCancelActionForNonBaseAuthenticatorSession",value:function(m){var a=com.ts.mobile.sdk.ControlRequestType.AbortAuthentication;return Promise.resolve(com.ts.mobile.sdk.ControlRequest.create(a))}},{key:"promiseRecoveryForError",value:function(m,a,_,v,k,M,q){var B=!1,J=m.getData();J&&J.additional_data&&J.additional_data.locked&&(B=!0);var Y,he,pe=a;return a.indexOf(com.ts.mobile.sdk.AuthenticationErrorRecovery.ChangeAuthenticator)>=0&&a.indexOf(com.ts.mobile.sdk.AuthenticationErrorRecovery.SelectAuthenticator)>=0&&(pe=a.filter(function(xe){return xe!=com.ts.mobile.sdk.AuthenticationErrorRecovery.ChangeAuthenticator})),B?(Y="ts_promise_error_lock_title",he=v.getString("ts_promise_error_lock_content")):M===com.ts.mobile.sdk.AuthenticatorSessionMode.Authentication?(Y="ts_promise_error_default_title_auth",he=v.formatString("ts_promise_error_default_content_auth",[m.getMessage()])):(Y="ts_promise_error_default_title_reg",he=v.formatString("ts_promise_error_default_content_reg",[m.getMessage()])),this.createRecoveryFromErrorDialog(q,v.getString(Y),he,B?fe.AuthLocked:fe.Error,v,k,pe)}},{key:"createRecoveryFromErrorDialog",value:function(m,a,_,v,k,M,q){return new Promise(function(B,J){var Y=new At(X.dialog_recovery,"xmui-error-recovery-dialog-page");Y.setUserName(m),Y.setDialogTitle(a),Y.setDialogMessage(k.getString("ts_promise_co_content")),Y.setDialogIconClass(v),Y.onSelect(function(pe){Y.blockInteraction(),B(parseInt(pe))});var he=j.getRecoveryActionButtonsInfo();j.buildDialogButtons(Y,k,q,he),j.renderPage(Y,M)})}},{key:"promiseAuthenticator",value:function(m,a,_){var v=a.getUiContext();return new Promise(function(k,M){var q={},B=new g(a),J=j.getUsernameFromClientContext(_);J&&B.setUserName(J),B.setTitle(v.getString("ts_promise_sa_title")),B.setInstructions(v.getString("ts_promise_sa_content")),m.forEach(function(Y){var he=Y.getAuthenticator();if(he.getEnabled()&&!he.getLocked()&&he.getRegistered()){var pe=he.getAuthenticatorId(),xe=he.getType();q[pe]=he;var ht=v.getString(L.getAuthenticatorNameKey(pe));B.addAuthenticator(pe,ht,xe,!1)}}),B.onSubmit(function(Y){B.blockInteraction(),k(com.ts.mobile.sdk.AuthenticatorSelectionResult.createSelectionRequest(q[Y]))}),B.onCancel(function(){B.blockInteraction(),k(com.ts.mobile.sdk.AuthenticatorSelectionResult.createAbortRequest())}),B.onEscape(function(Y){B.blockInteraction(),k(com.ts.mobile.sdk.AuthenticatorSelectionResult.createEscapeRequest(Y,{}))}),j.renderPage(B,_)})}},{key:"promiseInformationInput",value:function(m,a,_,v,k,M,q){return new Promise(function(B,J){var Y=new O(M,k);m&&Y.setUserName(m),Y.setDialogTitle(_),Y.setDialogMessage(v),Y.setDialogIconClass(a),Y.onSelect(function(){Y.blockInteraction(),B()}),j.renderPage(Y,q)})}},{key:"internalPromiseConfirmationOrInformationActionInput",value:function(m,a,_,v,k,M,q,B,J){return new Promise(function(Y,he){var pe=new D(B,_,v,a,k,q);m&&pe.setUserName(m),pe.onContinue(function(){Y(com.ts.mobile.sdk.ConfirmationInput.create(M))}),pe.onCancel(function(){Y(E.createCancelConfirmationInput())}),pe.onEscape(function(xe){Y(com.ts.mobile.sdk.ConfirmationInput.createEscapeRequest(xe,{}))}),j.renderPage(pe,J)})}},{key:"promiseInformationActionInput",value:function(m,a,_,v,k,M,q){return this.internalPromiseConfirmationOrInformationActionInput(m,a,_,v,k,-1,null,M,q)}},{key:"promiseConfirmationActionInput",value:function(m,a,_,v,k,M,q,B){return this.internalPromiseConfirmationOrInformationActionInput(m,a,_,v,k,0,M,q,B)}},{key:"promiseAuthenticatorFallbackAction",value:function(m,a,_,v,k,M){return new Promise(function(q,B){var J=k.getUiContext(),Y=v.description.getAuthenticatorId(),he=J.getString(L.getAuthenticatorNameKey(Y)),pe=new At(X.dialog_fallback,"xmui-auth-fallback-dialog-page");m&&pe.setUserName(m),pe.setDialogTitle(J.formatString("ts_promise_fallback_title",[he])),pe.setDialogMessage(J.getString("ts_promise_fallback_content")),pe.setDialogIconClass(fe.Fallback),pe.onSelect(function(ht){pe.blockInteraction(),q(parseInt(ht))});var xe=j.getFallbackActionButtonsInfo();j.buildDialogButtons(pe,J,a,xe),j.renderPage(pe,M)})}},{key:"promisePolicyRejectionInput",value:function(m,a,_,v,k,M){var q={title:m,text:a,buttonText:_};if(!(m&&a&&_||(q=j.failureDataToPolicyRejectionDialogParams(v,k))))return Promise.resolve(E.createResumeConfirmationInput());var J=v&&v.reason&&v.reason.data&&v.reason.data.username||j.getUsernameFromClientContext(M);return w.promiseInformationInput(J,fe.Rejection,q.title,q.text,q.buttonText,k.getUiContext(),M).then(function(){return E.createResumeConfirmationInput()})}}]),w}(),P="xmui-confirmation-dialog-page",I=function(w){function m(a,_,v){var k,M=arguments.length>3&&void 0!==arguments[3]&&arguments[3];ee(this,m),(k=ce(this,oe(m).call(this,X.dialog_confirm,P))).automationId=X.dialog_confirm;var q=new r(X.button_cancel);q.label=v||a.getString("ts_gen_cancel"),q.value=!1,k.addLeftButton(q);var B=new r(X.button_continue);return B.label=_||a.getString("ts_authenticator_password_cta_positive"),B.value=!0,k.addRightButton(B),M?B.focus():q.focus(),k}return le(m,w),m}(At),F=function(){function w(m,a){ee(this,w),this.showExpirationDialog=!1,this.supportsInlineError=!1,this.title=m,this.username=a,this.authId=m}return re(w,[{key:"startSession",value:function(m,a,_,v){this.description=m,this.mode=a,this.actionContext=_,this.clientContext=v,this.uiContext=_.getUiContext(),this.username=j.getUsernameFromClientContext(v)||this.username,j.log("Starting session; session mode: [".concat(this.mode,"], authenticator: [").concat(this.title,"]"))}},{key:"changeSessionModeToRegistrationAfterExpiration",value:function(){j.log("Changing session mode to registration after expiration; authenticator: [".concat(this.title,"]")),this.mode=com.ts.mobile.sdk.AuthenticatorSessionMode.Registration,this.clearError(),this.showExpirationDialog=!0}},{key:"promiseRecoveryForError",value:function(m,a,_){return j.log("Starting error recovery; session mode: [".concat(this.mode,"], authenticator: [").concat(this.title,"], error: [").concat(m,"]")),this.supportsInlineError&&_===com.ts.mobile.sdk.AuthenticationErrorRecovery.RetryAuthenticator?(this.setError(m),Promise.resolve(_)):_===com.ts.mobile.sdk.AuthenticationErrorRecovery.Fail?Promise.resolve(_):x.promiseRecoveryForError(m,a,_,this.uiContext,this.clientContext,this.mode,this.username)}},{key:"endSession",value:function(){j.log("Ending session; session mode: [".concat(this.mode,"], authenticator: [").concat(this.title,"]"))}},{key:"promiseInput",value:function(){var m=this;return new Promise(function(a,_){switch(m.setInputResolver(a),m.mode){case com.ts.mobile.sdk.AuthenticatorSessionMode.Authentication:j.log("Fetching authentication input; authenticator: [".concat(m.title,"]")),m.showAuthUi();break;case com.ts.mobile.sdk.AuthenticatorSessionMode.Registration:j.log("Fetching registration input; authenticator: [".concat(m.title,"]")),m.showExpirationDialog?(m.showExpirationDialog=!1,m.showRegUiAfterExpiration()):m.showRegUi()}}).then(function(a){return m.clearError(),a})}},{key:"promiseCancelAction",value:function(m){return x.promiseCancelAction(m,this.actionContext,this.clientContext,this.mode,this.username)}},{key:"showRegUiAfterExpiration",value:function(){var m=this,a=this.uiContext,_=a.getString(L.getAuthenticatorNameKey(this.title)),v=new I(this.uiContext);v.setUserName(this.username),v.setDialogTitle(a.formatString("ts_session_authenticator_expired_title",[_])),v.setDialogIconClass(fe.Expiration),v.setDialogMessage(a.getString("ts_session_authenticator_expired_content")),v.onSelect(function(k){v.blockInteraction(),k?m.showRegUi():m.onCancel()}),j.renderPage(v,this.clientContext)}},{key:"setInputResolver",value:function(m){this.currentInputResolveFn=m}},{key:"onCancel",value:function(){this.resolveInputPromise(E.createCancelAuthenticatorRequest())}},{key:"onEscape",value:function(m){var a=com.ts.mobile.sdk.InputOrControlResponse.createEscapeResponse(m,{});this.resolveInputPromise(a)}},{key:"resolveInputPromise",value:function(m){if(this.currentInputResolveFn){var a=this.currentInputResolveFn;this.currentInputResolveFn=null,a(m)}}},{key:"showAuthenticatorPage",value:function(m){var a=this;m.setUserName(this.username),m.onCancel(function(){m.blockInteraction(),a.onCancel()}),m.onEscape(function(_){m.blockInteraction(),a.onEscape(_)}),j.renderPage(m,this.clientContext)}},{key:"setError",value:function(m){if(m){this.authError=m;var a=m.getMessage();this.authErrorMessage=this.mode===com.ts.mobile.sdk.AuthenticatorSessionMode.Authentication?this.uiContext.formatString("ts_promise_error_default_content_auth",[a]):this.uiContext.formatString("ts_promise_error_default_content_reg",[a])}else this.clearError()}},{key:"clearError",value:function(){this.authError=null,this.authErrorMessage=""}}]),w}(),G=function(w){function m(a,_){var v;return ee(this,m),(v=ce(this,oe(m).call(this))).stateOnIcon=a,v.stateOffIcon=_,v.isOn=!1,v.setIconsClass(),v.onClick(function(){v.isOn=!v.isOn,v.setIconsClass(),v.onChangeCB&&v.onChangeCB(v.isOn)}),v}return le(m,w),re(m,[{key:"onChange",value:function(a){this.onChangeCB=a}},{key:"setIsOn",value:function(a){this.isOn=a,this.setIconsClass()}},{key:"setIconsClass",value:function(){var a;a=this.isOn?this.stateOnIcon:this.stateOffIcon,this.element.setClass("".concat("xmui-toggle-icon"," ").concat(a))}}]),m}(se);function U(w,m,a){var _;return function(){var v=this,k=arguments,M=function(){_=null,a||w.apply(v,k)},q=a&&!_;clearTimeout(_),_=setTimeout(M,m),q&&w.apply(v,k)}}!function(w){w.Numeric="numeric"}(C||(C={}));var K,H=function(w){function m(a){var _;return ee(this,m),(_=ce(this,oe(m).call(this))).automationId=a,_.inputHtmlElement=_.htmlElement,_}return le(m,w),re(m,[{key:"buildElement",value:function(){return ft("<input>")}},{key:"onChange",value:function(a){this.element.on("input",this.createCB(a))}},{key:"createCB",value:function(a){return U(a,100,!1)}},{key:"name",set:function(a){this.inputHtmlElement.name=a},get:function(){return this.inputHtmlElement.name}},{key:"type",set:function(a){this.attr={type:a}}},{key:"inputmode",set:function(a){this.attr={inputmode:a,"x-inputmode":a}}},{key:"placeholder",set:function(a){this.inputHtmlElement.placeholder=a}},{key:"minlength",set:function(a){this.attr={minlength:a.toString()}}},{key:"maxlength",set:function(a){this.attr={maxlength:a.toString()}}},{key:"autocomplete",set:function(a){this.attr={autocomplete:a}}},{key:"autocorrect",set:function(a){this.attr={autocorrect:a?"on":"off"}}},{key:"autocapitalize",set:function(a){this.attr={autocapitalize:a?"on":"off"}}},{key:"value",set:function(a){this.inputHtmlElement.value=a},get:function(){return this.inputHtmlElement.value}},{key:"disabled",set:function(a){Ne(oe(m.prototype),"disabled",a,this,!0),this.inputHtmlElement.disabled=a}},{key:"required",set:function(a){this.inputHtmlElement.required=a},get:function(){return this.inputHtmlElement.required}}]),m}(tt),Q="xmui-form-field-message",$="".concat(Q,"--center"),ue="".concat(Q,"--error"),ae=function(w){function m(){var a,_=arguments.length>0&&void 0!==arguments[0]&&arguments[0],v=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return ee(this,m),(a=ce(this,oe(m).call(this))).id=Wt_generate(),a.className=Q,_&&a.addClass(ue),v&&a.addClass($),a}return le(m,w),m}(ve),me=/^[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,be=function(){function w(){ee(this,w)}return re(w,null,[{key:"email",value:function(m){return me.test(m)?void 0:"Invalid Email"}},{key:"required",value:function(m){return m?void 0:"Required"}},{key:"mobileNumber",value:function(m){var a=m.match(/^([0-9]{1,3})-([1-9][0-9]+)$/);return a?a[1].length+a[2].length>15?"Mobile Number exceeded 15 digits":void 0:"Invalid Mobile Number"}}]),w}(),Xe=function(){function w(){ee(this,w)}return re(w,null,[{key:"positiveInteger",value:function(m){var a=m.keyCode;(a!==bt.Enter&&a<bt.Zero||a>bt.Nine)&&m.preventDefault()}}]),w}(),Se=function(w){function m(){return ee(this,m),ce(this,oe(m).apply(this,arguments))}return le(m,w),m}(se),Ce="xmui-input-field",Zt=/^[0-9]+$/,Le="".concat(Ce,"--has-value"),Je="".concat(Ce,"--has-focus");!function(w){w[w.Password=0]="Password",w[w.Text=1]="Text",w[w.Email=2]="Email",w[w.PositiveInteger=3]="PositiveInteger"}(K||(K={}));var vt,Te=function(w){function m(a,_){var v;ee(this,m),(v=ce(this,oe(m).call(this))).inputType=a,v.hasValue=!1,v.validators=[],v.icons=new Map,v.className=Ce,v.inputComponent=new H(_),v.inputComponent.value="",v.inputComponent.autocapitalize=!1,v.inputComponent.autocorrect=!1,v.inputComponent.spellcheck=!1,v.inputComponent.onPaste(v.handlePaste.bind(Ee(v))),v.inputComponent.onChange(v.handleChange.bind(Ee(v)));var k=new se;k.className="".concat(Ce,"_row");var M=new se;M.className="".concat(Ce,"_container");var q=new se;q.className="".concat(Ce,"_input-and-label");var B=new se;B.className="".concat(Ce,"_label-container");var J=new ve;switch(J.className="".concat(Ce,"_label"),v.inputLabel=J,B.appendChild(v.inputLabel),q.appendChildren(v.inputComponent,B),M.appendChild(q),k.appendChildren(M),k.onFocusIn(function(){v.addClass(Je)}),k.onFocusOut(function(){v.removeClass(Je)}),a){case K.Password:v.setupPasswordInput(M);break;case K.Text:v.inputComponent.type="text";break;case K.Email:v.setupEmailInput();break;case K.PositiveInteger:v.setupPositiveIntegerInput()}return v.messageComp=new ae(!1),v.messageComp.show=!1,v.errorMessageComp=new ae(!0),v.appendChildren(k,v.messageComp,v.errorMessageComp),v.inputComponent.ariaDescribedBy=v.messageComp.id,v.labelContainer=B,v.container=M,v.inputRow=k,v}return le(m,w),re(m,[{key:"addRightButton",value:function(a,_){var v=new ve;return v.className="".concat(Ce,"_label_cta"),v.setText(a),v.onClick(_),this.container.appendChild(v),v}},{key:"addValidators",value:function(a){this.validators=this.validators.concat(a)}},{key:"addValidator",value:function(a){this.validators.push(a)}},{key:"focus",value:function(){this.inputComponent.focus()}},{key:"onBlur",value:function(a){this.inputComponent.onBlur(a)}},{key:"onFocus",value:function(a){this.inputComponent.onFocus(a)}},{key:"onChange",value:function(a){this.inputComponent.onChange(a)}},{key:"validateAndSetErrorMessage",value:function(){var a=this,_=!0,v=this.value.trim();return this.inputComponent.required&&[this.getRequiredValidator()].concat(Ut(this.validators)),!this.inputComponent.required&&this.isEmpty||(_=!this.validators.some(function(k){var M=k(v);return M&&a.setError(M),!!M})),_&&this.clearError(),_}},{key:"setError",value:function(a){var _=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.error=!0,this.errorMessage=a||"",_&&(this.value="")}},{key:"clearError",value:function(){this.error=!1,this.errorMessage=""}},{key:"getRequiredValidator",value:function(){return be.required}},{key:"addIcon",value:function(a){var _=new se;_.className="".concat(Ce,"_icon ").concat(a),this.container.appendChild(_),this.icons.set(a,_)}},{key:"removeIcon",value:function(a){var _=this.icons.get(a);_&&(this.container.removeChild(_),this.icons.delete(a))}},{key:"prependToInputRow",value:function(a){this.inputRow.prependChild(a)}},{key:"setupPasswordInput",value:function(a){var _=this;this.inputComponent.type="password";var v=new G(fe.PasswordVisible,fe.PasswordHidden);v.setIsOn(!1),v.onChange(function(k){_.inputComponent.type=k?"text":"password"}),a.appendChild(v)}},{key:"setupPositiveIntegerInput",value:function(){this.inputComponent.type="text",this.inputComponent.onKeypress(function(a,_){return Xe.positiveInteger(_)})}},{key:"setupEmailInput",value:function(){this.inputComponent.type="email",this.addValidator(be.email)}},{key:"handlePaste",value:function(a){var _;this.inputType==K.PositiveInteger&&(_=a.clipboardData&&a.clipboardData.getData?a.clipboardData.getData("text/plain"):window.clipboardData.getData("Text"))&&!Zt.test(_)&&a.preventDefault()}},{key:"updateHasValue",value:function(a){a?this.addClass(Le):this.removeClass(Le),this.hasValue=a}},{key:"handleChange",value:function(){var a=this.checkHasValue();this.hasValue!==a&&this.updateHasValue(a)}},{key:"checkHasValue",value:function(){return!!this.value.length}},{key:"name",set:function(a){this.inputComponent.name=a},get:function(){return this.inputComponent.name}},{key:"disabled",set:function(a){this.inputComponent.disabled=a}},{key:"message",set:function(a){this.messageComp.setText(a),this.messageComp.show=!!a.length}},{key:"value",set:function(a){this.inputComponent.value=a,this.handleChange()},get:function(){return this.inputComponent.value}},{key:"type",get:function(){return this.inputType}},{key:"ariaRole",set:function(a){this.inputComponent.ariaRole=a}},{key:"ariaLabel",set:function(a){this.inputComponent.ariaLabel=a}},{key:"automationId",set:function(a){this.inputComponent.automationId=a}},{key:"autocomplete",set:function(a){this.inputComponent.autocomplete=a}},{key:"placeholder",set:function(a){this.placeholderText=a,this.inputLabel.setText(a)},get:function(){return this.placeholderText}},{key:"minlength",set:function(a){this.inputComponent.minlength=a}},{key:"maxlength",set:function(a){this.inputComponent.maxlength=a}},{key:"required",set:function(a){this.inputComponent.required=a},get:function(){return this.inputComponent.required}},{key:"isEmpty",get:function(){return!this.value.trim().length}},{key:"errorMessage",set:function(a){this.errorMessageComp.setText(a)}}]),m}(Se),ne="xmui-form",de="".concat(ne,"_hidden-submit-button"),Z=function(w){function m(a){var _;if(ee(this,m),(_=ce(this,oe(m).call(this))).submitButton=a,_.externalValidations=function(){return!0},_.className=ne,_.submitButton){var v=new r("");v.addClass(de),v.type=d.Submit,v.disabled=!0,v.onClick(function(){return _.handleSubmit()}),_.appendChild(v),_.hiddenSubmitButton=v,_.submitButton&&_.submitButton.onClick(function(){return _.handleSubmit()})}return _.element.on("submit",function(){return event.preventDefault()}),_.element.on("input",U(_.handleInputEvent.bind(Ee(_)),100,!1)),_}return le(m,w),re(m,[{key:"buildElement",value:function(){return ft("<form novalidate></form>")}},{key:"start",value:function(){this.updateSubmitButton()}},{key:"onSubmit",value:function(a){this.onSubmitCB=a}},{key:"onUserInput",value:function(a){this.onUserInputCB=a}},{key:"handleSubmit",value:function(){this.validate()&&this.onSubmitCB&&this.onSubmitCB(this.buildFormResult()),this.updateSubmitButton()}},{key:"updateSubmitButton",value:function(){if(this.submitButton){var a=this.isMandatoryEmpty();this.submitButton.disabled=this.hiddenSubmitButton.disabled=a}}},{key:"isMandatoryEmpty",value:function(){return this.getFormFields(this).some(function(a){return a.required&&a.isEmpty})}},{key:"getFormFields",value:function(a){var _=this,v=[];return a.getChildren().forEach(function(k){k instanceof Se?v.push(k):k instanceof lt&&(v=v.concat(_.getFormFields(k)))}),v}},{key:"validate",value:function(){var a=this.getFormFields(this).reduce(function(v,k){return k.validateAndSetErrorMessage()&&v},!0),_=this.externalValidations();return a&&_}},{key:"buildFormResult",value:function(){return this.getFormFields(this).reduce(function(a,_){return a[_.name]="string"==typeof _.value?_.value.trim():_.value,a},{})}},{key:"handleInputEvent",value:function(){this.updateSubmitButton(),this.onUserInputCB&&this.onUserInputCB()}},{key:"name",set:function(a){this.attr={name:a}}}]),m}(lt);!function(w){w.Off="off",w.Username="username",w.NewPassword="new-password",w.CurrentPassword="current-password"}(vt||(vt={}));var ie,Ae=function(w){function m(a,_,v,k,M){var q;return ee(this,m),(q=ce(this,oe(m).call(this,a,_,v))).recoveryAction=k,q.authenticatorId=M,q}return le(m,w),re(m,[{key:"addRecoveryButtonToForm",value:function(a){var _=this;if(this.recoveryAction&&this.authenticatorId){var v=new r(X.button_recovery,l.Recovery);v.label=this.uiContext.formatString("ts_gen_recovery",[this.uiContext.getString(L.getAuthenticatorNameKey(this.authenticatorId))]),v.onClick(function(){return _.handleEscapeButtonClicked(_.recoveryAction)}),a.appendChild(v)}}}]),m}(h),ye="xmui-password-authentication",_e="xmui-password-registration",ct=function(w){function m(a,_,v,k){var M,q=arguments.length>4&&void 0!==arguments[4]&&arguments[4];ee(this,m),(M=ce(this,oe(m).call(this,_?X.page_password_reg:X.page_password_auth,_?_e:ye,a,v,k))).isRegistrationMode=_,M.disableAutocomplete=q,M.passwordInputRegex=/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)[a-zA-Z\d]{6,}$/,M.setTitle(M.getTitle()),M.setInstructions(M.getInstructions());var B=new r(X.button_continue);B.label=M.uiContext.getString("ts_authenticator_password_cta_positive"),M.addRightButton(B),M.continueButton=B;var J=M.createForm();return M.setContent(J),M}return le(m,w),re(m,[{key:"setError",value:function(a){this.error=!0,this.passwordInput.setError(a)}},{key:"clearError",value:function(){this.error=!1,this.passwordInput.clearError()}},{key:"reset",value:function(){this.unblockInteraction(),this.passwordInput.value="",this.passwordInput.focus(),this.repeatPasswordInput&&(this.repeatPasswordInput.value="")}},{key:"onSubmit",value:function(a){this.onSubmitCB=a}},{key:"getTitle",value:function(){return this.uiContext.getString(this.isRegistrationMode?"ts_authenticator_password_title_reg":"ts_authenticator_password_title_auth")}},{key:"getInstructions",value:function(){return this.uiContext.getString(this.isRegistrationMode?"ts_authenticator_password_intro_reg":"ts_authenticator_password_intro_auth")}},{key:"createForm",value:function(){var a=this,_=this.uiContext,v=new Z(this.continueButton);v.addClass("xmui-password-page-form"),v.id="xmui-password-form";var k=new Te(K.Password,X.input_password),M=this.getAutocompleteValue();if(k.name="password",k.placeholder=_.getString("ts_authenticator_password_field_hint"),k.disabled=!1,k.value="",k.required=!0,k.autocomplete=M,k.ariaLabel=_.getString("ts_accessibility_password_enter_password"),k.focus(),this.passwordInput=k,v.appendChild(k),this.isRegistrationMode){var q=new se;q.className="".concat("xmui-password-page-form","_spacer"),v.appendChild(q);var B=new Te(K.Password,X.input_repeat_password);B.name="repeat-password",B.placeholder=_.getString("ts_authenticator_password_reg_field_hint"),B.disabled=!1,B.value="",B.required=!0,k.autocomplete=M,B.ariaLabel=_.getString("ts_accessibility_password_enter_password_again"),this.repeatPasswordInput=B,v.appendChild(B)}return this.addRecoveryButtonToForm(v),v.externalValidations=function(){var J=!0;return a.isRegistrationMode&&(a.validatePasswordsMatch()||(a.repeatPasswordInput.setError(a.uiContext.getString("ts_authenticator_password_error_reg_no_match"),!1),a.passwordInput.focus(),J=!1),a.isPasswordValid()||(a.passwordInput.setError(a.uiContext.getString("ts_authenticator_password_error_reg_strength_validation_failed"),!1),a.repeatPasswordInput.setError(null,!0),a.passwordInput.focus(),J=!1),0==J&&(a.passwordInput.value="",a.repeatPasswordInput.value="")),J},v.onUserInput(this.handlePasswordChanged.bind(this)),v.onSubmit(function(J){a.blockInteraction(),a.onSubmitCB&&a.onSubmitCB(J.password)}),v.start(),v}},{key:"validatePasswordsMatch",value:function(){return this.passwordInput.value===this.repeatPasswordInput.value}},{key:"isPasswordValid",value:function(){return this.passwordInputRegex.test(this.passwordInput.value)}},{key:"getAutocompleteValue",value:function(){return this.disableAutocomplete?vt.Off:this.isRegistrationMode?vt.NewPassword:vt.CurrentPassword}},{key:"handlePasswordChanged",value:function(){this.passwordInput.error&&this.passwordInput.clearError(),this.repeatPasswordInput&&this.repeatPasswordInput.error&&this.repeatPasswordInput.clearError()}}]),m}(Ae),ke=function(w){function m(a,_){var v;return ee(this,m),(v=ce(this,oe(m).call(this,a,_))).supportsInlineError=!0,v}return le(m,w),re(m,[{key:"showAuthUi",value:function(){this.showPasswordPage(!1)}},{key:"showRegUi",value:function(){this.showPasswordPage(!0)}},{key:"showPasswordPage",value:function(a){var _=this;if(this.authError&&this.passwordPage)this.passwordPage.reset(),this.passwordPage.setError(this.authErrorMessage);else{var v=!0===this.clientContext.disablePasswordAutocomplete,k=new ct(this.actionContext,a,this.description.getCredentialRecoveryEscapeOption(),this.description.getAuthenticatorId(),v);this.showAuthenticatorPage(k),this.passwordPage=k}this.passwordPage.onSubmit(function(M){var q=com.ts.mobile.sdk.PasswordInput.create(M);_.resolveInputPromise(com.ts.mobile.sdk.InputOrControlResponse.createInputResponse(q))})}}]),m}(F),ut=function(w){function m(a){var _;ee(this,m),(_=ce(this,oe(m).call(this,X.page_select_device,"xmui-select-device-page",a))).selectedDevices=[],_.deviceKeys=[];var v=new r(X.button_send_to_all);v.label=_.uiContext.getString("ts_authenticator_mobile_approve_send_to_all"),v.onClick(function(){_.onSubmitCB&&_.onSubmitCB(_.deviceKeys)}),_.addRightButton(v);var k=new r(X.button_continue);k.label=_.uiContext.getString("ts_authenticator_password_cta_positive"),k.disabled=!0,k.onClick(function(){_.onSubmitCB&&_.onSubmitCB(_.selectedDevices)}),_.addRightButton(k),_.confirmButton=k;var M=_.createContent();return _.setContent(M),_}return le(m,w),re(m,[{key:"createContent",value:function(){var a=this;return this.deviceList=new u(S.Multiple),this.deviceList.onSelectionChanged(function(_){a.selectedDevices=_,a.confirmButton.disabled=0===_.length}),this.deviceList.focus(),this.deviceList}},{key:"addDevice",value:function(a,_,v,k){var M=new s(_,v,fe.Device);this.deviceList.addListItem(a,k,M),this.deviceKeys.push(a)}},{key:"onSubmit",value:function(a){this.onSubmitCB=a}}]),m}(Ae),Re=function(w){function m(){return ee(this,m),ce(this,oe(m).apply(this,arguments))}return le(m,w),re(m,[{key:"buildElement",value:function(){return ft("<img></img>")}},{key:"src",set:function(a){this.attr={src:a}}}]),m}(tt),we="xmui-mobile-approve-pending",Et=function(w){function m(a,_,v,k){var M;ee(this,m);var q=(M=ce(this,oe(m).call(this,X.page_mobile_approve,we,a))).createContent(_,v,k);return M.setContent(q),Ne(oe(m.prototype),"busy",!0,Ee(M),!0),M}return le(m,w),re(m,[{key:"createContent",value:function(a,_,v){var k=new se;return k.className="".concat(we,"_container"),k.appendChild(this.createSpacer()),null==_?this.createNoCodeContent(a,k):_===com.ts.mobile.sdk.OtpFormatType.Numeric?this.createNumericCodeContent(v,a,k):_===com.ts.mobile.sdk.OtpFormatType.QrCode&&this.createQRCodeContent(v,a,k),k}},{key:"createMessage",value:function(a){var _=new ve;return _.setText(a),_.className="".concat(we,"_message"),_}},{key:"createSpacer",value:function(){var a=new se;return a.className="".concat(we,"_spacer"),a}},{key:"createNoCodeContent",value:function(a,_){var v=new se;v.className="".concat(we,"_icon ").concat(fe.MobileApproveWaiting);var k=this.createMessage(a);_.appendChildren(v,this.createSpacer(),k,this.createSpacer())}},{key:"createNumericCodeContent",value:function(a,_,v){var k=this.createMessage(_),M=new ve;return M.className="".concat(we,"_numeric-code"),M.setText(a),v.appendChildren(k,this.createSpacer(),M,this.createSpacer()),v}},{key:"createQRCodeContent",value:function(a,_,v){var k=this.createMessage(_),M=new se;M.className="".concat(we,"_qr-code-container");var q=new Re;return q.className="".concat(we,"_qr-code"),q.src=a,M.appendChild(q),v.appendChildren(k,this.createSpacer(),M),v}},{key:"busy",set:function(a){}}]),m}(Ae);!function(w){w[w.TargetSelection=0]="TargetSelection",w[w.PollingRequested=1]="PollingRequested",w[w.PollingStarted=2]="PollingStarted"}(ie||(ie={}));var Fe,je=function(w){function m(a,_,v){var k;return ee(this,m),(k=ce(this,oe(m).call(this,a,_))).state=ie.TargetSelection,k.pollingIntervalMillis=3e3,k.instructions=v,k}return le(m,w),re(m,[{key:"setPollingIntervalInMillis",value:function(a){this.pollingIntervalMillis=a}},{key:"setCreatedApprovalInfo",value:function(a,_){null!=a?(this.setupOtp(_),this.state=ie.PollingRequested):(this.setupOtp(null),this.state=ie.TargetSelection,clearTimeout(this.pollingTimer))}},{key:"setAvailableTargets",value:function(a){this.availableTargets=a}},{key:"endSession",value:function(){dt(oe(m.prototype),"endSession",this).call(this),clearTimeout(this.pollingTimer)}},{key:"promiseInput",value:function(){var a,_=this;switch(this.mode){case com.ts.mobile.sdk.AuthenticatorSessionMode.Authentication:switch(j.log("Fetching Mobile Approve authentication input;"),this.state){case ie.TargetSelection:a=this.promiseTargetSelectionInput();break;case ie.PollingRequested:this.state=ie.PollingStarted,this.showPendingUI(),a=this.startPolling();break;case ie.PollingStarted:a=this.startPolling()}case com.ts.mobile.sdk.AuthenticatorSessionMode.Registration:}return(a=a||Promise.reject("Illegal state")).then(function(v){return _.clearError(),v})}},{key:"promiseTargetSelectionInput",value:function(){var a=this;return new Promise(function(_,v){a.setInputResolver(_);var k=new ut(a.actionContext);k.setTitle(a.uiContext.getString("ts_authenticator_mobile_approve")),k.setInstructions(a.uiContext.getString("ts_authenticator_mobile_approve_targets_intro"));var M={};a.availableTargets.forEach(function(q){var B=q.getDeviceDetails(),J=B.getDeviceId(),Y=E.getDeviceNameFromDeviceDetails(B),he=E.getLastAccessedFromDeviceDetails(a.uiContext,B);M[J]=q,k.addDevice(J,Y,he,!1)}),k.onSubmit(function(q){k.blockInteraction();var B=q.map(function(Y){return M[Y]}),J=E.createTargetsSelectionResponse(B);a.resolveInputPromise(J)}),a.showAuthenticatorPage(k)})}},{key:"showPendingUI",value:function(){var a=new Et(this.actionContext,this.instructions,this.otpType,this.otpCode);a.setTitle(this.uiContext.getString("ts_authenticator_mobile_approve")),this.showAuthenticatorPage(a)}},{key:"onCancel",value:function(){this.currentInputResolveFn?(clearTimeout(this.pollingTimer),dt(oe(m.prototype),"onCancel",this).call(this)):this.pendingRequest=E.createCancelAuthenticatorRequest()}},{key:"onEscape",value:function(a){clearTimeout(this.pollingTimer),dt(oe(m.prototype),"onEscape",this).call(this,a)}},{key:"setupOtp",value:function(a){if(a){var _=a.getFormat().getType();switch(this.otpType=_,_){case com.ts.mobile.sdk.OtpFormatType.Numeric:this.otpCode=a.getValue();break;case com.ts.mobile.sdk.OtpFormatType.QrCode:this.otpCode="data:image/jpeg;base64,"+a.getValue();break;default:throw j.log("Unsupported otp format"),new Error("Unsupported otp format")}}else this.otpType=null,this.otpCode=null}},{key:"startPolling",value:function(){var a=this;return new Promise(function(_,v){a.setInputResolver(_),a.pollingTimer=setTimeout(function(){if(a.pendingRequest)a.resolveInputPromise(a.pendingRequest),a.pendingRequest=null;else{var k=com.ts.mobile.sdk.MobileApproveInputRequestPolling.createRequestPollingInput(),M=com.ts.mobile.sdk.TargetBasedAuthenticatorInput.createAuthenticatorInput(k),q=com.ts.mobile.sdk.InputOrControlResponse.createInputResponse(M);a.resolveInputPromise(q)}},a.pollingIntervalMillis)})}},{key:"showAuthUi",value:function(){throw new Error("Method not implemented")}},{key:"showRegUi",value:function(){throw new Error("Method not implemented")}}]),m}(F),yt="xmui-pin-code",We=function(w){function m(a,_){var v;ee(this,m),(v=ce(this,oe(m).call(this))).digits=[],v.className=yt,v.mainInput=new H(a),v.mainInput.className="".concat(yt,"_input");var k=new se;k.className="".concat(yt,"_container"),v.messageComp=new ae(!0,!0),v.changeHandler=v.changeHandler.bind(Ee(v));for(var M=0;M<_;M++){var q=new H(a+"_digit_"+M);q.className="".concat(yt,"_digit"),q.type="text",q.maxlength=1,q.autocomplete=vt.Off,q.inputmode=C.Numeric,q.ariaLabel="pin code digit ".concat(M+1),q.onKeydown(v.keydownHandler),q.onFocus(v.focusHandler),q.onChange(v.changeHandler),0===M?(q.tabindex=0,q.ariaDescribedBy=v.messageComp.id):q.tabindex=-1,v.digits.push(q),k.appendChild(q)}return v.appendChildren(v.mainInput,k,v.messageComp),v}return le(m,w),re(m,[{key:"focus",value:function(){var a=this.digits[0];a&&a.focus()}},{key:"onChange",value:function(a){this.changeCB=a}},{key:"setError",value:function(a){this.error=!0,this.errorMessage=a||""}},{key:"clearError",value:function(){this.error=!1,this.errorMessage=""}},{key:"keydownHandler",value:function(a,_){var v=_.target;"Backspace"===_.key&&0===v.selectionStart&&0===v.selectionEnd&&v.previousElementSibling instanceof HTMLInputElement&&v.previousElementSibling.className==="".concat(yt,"_digit")&&(v.previousElementSibling.value="",v.previousElementSibling.focus())}},{key:"focusHandler",value:function(a){var _=a.target;_.value.length&&(_.selectionStart=0,_.selectionEnd=_.value.length)}},{key:"changeHandler",value:function(a){var _=a.target;if(_.value=_.value.replace(/[^\d]/g,""),1===_.value.length&&_.nextElementSibling instanceof HTMLInputElement&&_.nextElementSibling.className==="".concat(yt,"_digit")){var v=_.nextElementSibling;v.focus(),v.selectionStart=0,v.selectionEnd=1}var k="";this.digits.forEach(function(M){k+=M.value}),this.mainInput.value=k,this.changeCB&&this.changeCB()}},{key:"name",set:function(a){this.mainInput.name=a}},{key:"value",set:function(a){this.mainInput.value=a,this.digits.forEach(function(_,v){_.value=a[v]||""})},get:function(){return this.mainInput.value}},{key:"errorMessage",set:function(a){this.messageComp.setText(a)}}]),m}(se);!function(w){w[w.Enter=0]="Enter",w[w.Repeat=1]="Repeat"}(Fe||(Fe={}));var Ke=function(w){function m(a,_,v,k,M){var q;ee(this,m),(q=ce(this,oe(m).call(this,v?X.page_pin_reg:X.page_pin_auth,v?"xmui-pin-code-registration":"xmui-pin-code-authentication",a,k,M))).numDigits=_,q.isRegistrationMode=v,q.mode=Fe.Enter,q.setTitle(q.getTitle()),q.setInstructions(q.getInstructions());var B=q.createForm();if(q.setContent(B),q.isRegistrationMode){var J=new r(X.button_reset);J.label=q.uiContext.getString("ts_gen_restart"),J.disabled=!0,J.onClick(q.handleReset.bind(Ee(q))),q.resetButton=J,q.addRightButton(J)}return q}return le(m,w),re(m,[{key:"onSubmit",value:function(a){this.onSubmitCB=a}},{key:"setError",value:function(a){this.error=!0,this.pinCode.setError(a)}},{key:"clearError",value:function(){this.pinCode.clearError(),this.error=!1}},{key:"getTitle",value:function(){return this.uiContext.getString(this.isRegistrationMode?"ts_authenticator_pin_title_reg":"ts_authenticator_pin_title_auth")}},{key:"getRegModeInstructions",value:function(){return this.uiContext.getString(this.mode===Fe.Enter?"ts_authenticator_pin_intro_reg":"ts_authenticator_pin_intro_repeat")}},{key:"getInstructions",value:function(){return this.isRegistrationMode?this.getRegModeInstructions():this.uiContext.getString("ts_authenticator_pin_intro_auth")}},{key:"handleReset",value:function(){this.mode=Fe.Enter,this.pinCode.value="",this.pinCode.focus(),this.enteredPinCode=null,this.resetButton.disabled=!0,this.setInstructions(this.getInstructions())}},{key:"handleNoMatch",value:function(){this.pinCode.value="",this.pinCode.setError(this.uiContext.getString("ts_authenticator_pin_error_reg_no_match")),this.pinCode.focus()}},{key:"submitPinCode",value:function(a){this.onSubmitCB&&this.onSubmitCB(a)}},{key:"repeat",value:function(){this.mode=Fe.Repeat,this.pinCode.value="",this.pinCode.focus(),this.resetButton.disabled=!1,this.setInstructions(this.getInstructions())}},{key:"handleRegPinCodeChanged",value:function(a){this.mode===Fe.Enter?(this.enteredPinCode=a,this.repeat()):this.enteredPinCode===a?this.submitPinCode(a):this.handleNoMatch()}},{key:"handlePinCodeChanged",value:function(){this.clearError();var a=this.pinCode.value;a.length===this.numDigits&&(this.isRegistrationMode?this.handleRegPinCodeChanged(a):this.submitPinCode(a))}},{key:"createForm",value:function(){var a=new Z;a.addClass("xmui-pin-code-form");var _=new We(X.input_pin_code,this.numDigits);return _.name="pin-code",_.value="",_.onChange(this.handlePinCodeChanged.bind(this)),_.focus(),this.pinCode=_,a.appendChild(_),this.addRecoveryButtonToForm(a),a}}]),m}(Ae),He=function(w){function m(a,_,v){var k;return ee(this,m),(k=ce(this,oe(m).call(this,a,_))).supportsInlineError=!0,k.pinLength=v,k}return le(m,w),re(m,[{key:"showAuthUi",value:function(){this.showPinCodePage(!1)}},{key:"showRegUi",value:function(){this.showPinCodePage(!0)}},{key:"showPinCodePage",value:function(a){var _=this,v=new Ke(this.actionContext,this.pinLength,a,this.description.getCredentialRecoveryEscapeOption(),this.description.getAuthenticatorId());this.authError&&v.setError(this.authErrorMessage),v.onSubmit(function(k){v.blockInteraction();var M=com.ts.mobile.sdk.PinInput.create(k);_.resolveInputPromise(com.ts.mobile.sdk.InputOrControlResponse.createInputResponse(M))}),this.showAuthenticatorPage(v)}}]),m}(F);function pt(){}function Be(w){return w instanceof NodeList||w instanceof HTMLCollection?Array.prototype.slice.call(w):[w]}function qe(w,m){if("string"==typeof m)return window.getComputedStyle(w)[m];Object.keys(m).forEach(function(a){w.style[a]=m[a]})}function St(w,m){var a=m.split(" ");a.length>1?a.forEach(function(_){return St(w,_)}):w.classList?w.classList.add(m):w.className+=" ".concat(m)}function Ue(w,m){var a=m.split(" ");a.length>1?a.forEach(function(_){return Ue(w,_)}):w.classList?w.classList.remove(m):w.className=w.className.replace(new RegExp("(^|\\b)".concat(m.split(" ").join("|"),"(\\b|$)"),"gi")," ")}function Qe(w){Be(w).forEach(function(m){m.parentNode.removeChild(m)})}function Nt(w,m,a,_){var v=m-w,k=_-a;return{length:Math.ceil(Math.sqrt(v*v+k*k)),angle:Math.round(180*Math.atan2(k,v)/Math.PI)}}var Ie=new WeakMap,ze=function(){function w(){ee(this,w),this.holder=null,this.option=null,this.mapperFunc=pt,this.holderLeft=0,this.holderTop=0,this.disabled=!1,this.patternAry=[],this.lastPosObj=[],this.rightPattern=null,this.onSuccess=pt,this.onError=pt,this.pattCircle=null,this.lineX1=0,this.lineY1=0,this.line=null,this.lastPosObj=null,this.dotYOffest=null}return re(w,[{key:"getElementsFromPoint",value:function(m,a){if(document.elementsFromPoint)return document.elementsFromPoint(m,a);for(var _=[],v=document.msElementsFromPoint(m,a),k=v.length,M=0;M<k;M++)_.push(v.item(M));return _}},{key:"getIdxFromPoint",value:function(m,a){var _,v,k,M,q=m-this.holderLeft,B=a-this.holderTop;if(this.getElementsFromPoint(m,a).some(function(he){return-1!=he.className.indexOf("patt-circ")&&(_=he.firstElementChild,!0)}),_){var J=this.option.matrix,Y=parseInt(_.getAttribute("patt-dots-index"));M=Y+1,v=Y%J[1]+1,k=Math.floor(Y/J[1])+1}return{idx:M,i:v,j:k,x:q,y:B}}},{key:"markPoint",value:function(m,a){St(m,"hovered"),this.patternAry.push(a),this.lastElm=m}},{key:"addLine",value:function(m){var a=this.dotYOffest,v=this.patternAry,k=this.holderLeft,M=this.holderTop,q=this.holder,B=this.option.lineOnMove,J=this.pattCircle[m.idx-1].firstElementChild.getBoundingClientRect(),Y=J.left+J.width/2-k,he=J.top+J.height/2-M;if(v.length>1){var pe=Nt(this.lineX1,Y,this.lineY1,he),ht=pe.angle;qe(this.line,{width:"".concat(pe.length,"px"),transform:"rotate(".concat(ht,"deg)")}),B||qe(this.line,{display:"block"})}if(null==a){var Ye=document.createElement("div");Ye.className="patt-lines",Ye.style.width="0px",Ye.style.visibility="hidden",Ye.style.position="absolute",Ye.style.top="0px",Ye.style.left="0px",q.appendChild(Ye);var Tt=Ye.getBoundingClientRect();this.dotYOffest=Tt.height/2,q.removeChild(Ye)}var Bt,_t,mt=(Bt='<div class="patt-lines" style="top:'.concat(he-this.dotYOffest,"px; left: ").concat(Y,'px;"></div>'),(_t=document.createElement("div")).innerHTML=Bt,_t.children[0]);this.line=mt,this.lineX1=Y,this.lineY1=he,this.holder.appendChild(mt),B||qe(this.line,{display:"none"})}},{key:"addDirectionClass",value:function(m){var a=this.lastElm,_=this.line,v=this.lastPosObj,k=[];if(m.j-v.j>0?k.push("s"):m.j-v.j<0&&k.push("n"),m.i-v.i>0?k.push("e"):m.i-v.i<0&&k.push("w"),k=k.join("-")){var M="".concat(k," dir");St(a,M),St(_,M)}}}]),w}(),Dt=function(){function w(m){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};ee(this,w),this._onStart=this._onStart.bind(this),this._onMove=this._onMove.bind(this),this._onEnd=this._onEnd.bind(this),this._renderCircle=this._renderCircle.bind(this);var _=new ze,v=m;if(v&&0!==v.length){var k={onDraw:pt,onStart:pt},M=a.matrix;M&&M[0]*M[1]>9&&(k.delimiter=","),_.option=function(B){for(var J=arguments.length,Y=new Array(J>1?J-1:0),he=1;he<J;he++)Y[he-1]=arguments[he];return Y.forEach(function(pe){Object.keys(pe).forEach(function(xe){B[xe]=pe[xe]})}),B}({},w.defaults,k,a),_.circContainerWidth=100/_.option.matrix[1],_.circContainerHeight=100/_.option.matrix[0];var q=_.option.mapper;_.mapperFunc="object"===De(q)?function(B){return q[B]}:"function"==typeof q?q:pt,_.option.mapper=null,_.holder=v,Ie.set(this,_),this._render(),St(v,"patt-holder"),"static"===qe(v,"position")&&qe(v,{position:"relative"}),v.addEventListener("touchstart",this._onStart),v.addEventListener("mousedown",this._onStart)}}return re(w,[{key:"getPattern",value:function(){var m=Ie.get(this);return(m.patternAry||[]).join(m.option.delimiter)}},{key:"setPattern",value:function(m){var a=Ie.get(this),_=a.option,v=_.matrix,k=_.margin,M=_.radius;if(_.enableSetPattern){var J="string"==typeof m?m.split(_.delimiter):m;this.reset(),a.holderLeft=0,a.holderTop=0;for(var Y=0;Y<J.length;Y+=1){var he=J[Y]-1,pe=he%v[1]*(2*k+2*M)+2*k+M,xe=Math.floor(he/v[1])*(2*k+2*M)+2*k+M;this._onMove.call(null,{clientX:pe,clientY:xe,preventDefault:pt},this)}}}},{key:"enable",value:function(){Ie.get(this).disabled=!1}},{key:"disable",value:function(){Ie.get(this).disabled=!0}},{key:"reset",value:function(){var m=Ie.get(this);Be(m.pattCircle).forEach(function(a){return Ue(a,"hovered dir s n w e s-w s-e n-w n-e")}),Qe(m.holder.querySelectorAll(".patt-lines")),m.patternAry=[],m.lastPosObj=null,Ue(m.holder,"patt-error")}},{key:"setError",value:function(){St(Ie.get(this).holder,"patt-error")}},{key:"clearError",value:function(){Ue(Ie.get(this).holder,"patt-error")}},{key:"checkForPattern",value:function(m,a,_){var v=Ie.get(this);v.rightPattern=m,v.onSuccess=a||pt,v.onError=_||pt}},{key:"_onStart",value:function(m){var a=Ie.get(this),_=a.holder,v=a.option;if(m.preventDefault(),!a.disabled){a.option.patternVisible||St(a.holder,"patt-hidden"),this.moveEvent="touchstart"===m.type?"touchmove":"mousemove",this.endEvent="touchstart"===m.type?"touchend":"mouseup",_.addEventListener(this.moveEvent,this._onMove),document.addEventListener(this.endEvent,this._onEnd);var k=a.holder.getBoundingClientRect();a.holderTop=k.top,a.holderLeft=k.left,this.reset(),v.onStart()}}},{key:"_onMove",value:function(m){m.preventDefault();var a=Ie.get(this),_=a.option,v=a.patternAry,q=a.pattCircle,B=a.getIdxFromPoint(m.clientX||m.touches[0].clientX,m.clientY||m.touches[0].clientY),J=B.idx,Y=a.mapperFunc(J)||J;if(v.length>0){var he=Nt(a.lineX1,B.x,a.lineY1,B.y),xe=he.angle;qe(a.line,{width:"".concat(he.length+2,"px"),transform:"rotate(".concat(xe,"deg)")})}if(J&&(_.allowRepeat&&v[v.length-1]!==Y||-1===v.indexOf(Y))){var ht=q[J-1];if(a.lastPosObj)for(var Ye=a.lastPosObj,Tt=B.i-Ye.i>0?1:-1,Bt=B.j-Ye.j>0?1:-1,_t=Ye.i,mt=Ye.j,En=Math.abs(B.i-_t),on=Math.abs(B.j-mt);0===En&&on>1||0===on&&En>1||on===En&&on>1;){_t=En?_t+Tt:_t,mt=on?mt+Bt:mt,En=Math.abs(B.i-_t),on=Math.abs(B.j-mt);var ho=(mt-1)*_.matrix[1]+_t,Jn=a.mapperFunc(ho)||ho;(_.allowRepeat||-1===v.indexOf(Jn))&&(a.addDirectionClass({i:_t,j:mt}),a.markPoint(q[Jn-1],Jn),a.addLine({idx:J,i:_t,j:mt}))}a.lastPosObj&&a.addDirectionClass(B),a.markPoint(ht,Y),a.addLine(B),a.lastPosObj=B}}},{key:"_onEnd",value:function(m){m.preventDefault();var a=Ie.get(this),_=a.option,v=a.patternAry.join(_.delimiter);a.holder.removeEventListener(this.moveEvent,this._onMove),document.removeEventListener(this.endEvent,this._onEnd),Ue(a.holder,"patt-hidden"),v&&(Qe(a.line),_.onDraw(v),a.rightPattern&&(v===a.rightPattern?a.onSuccess():(a.onError(),this.error())))}},{key:"_renderCircle",value:function(m,a){var _=Ie.get(this),v=_.circContainerHeight,k=_.circContainerWidth;return'<div class="patt-circ-container" style="width: '.concat(k,"%; height: ").concat(v,"%; flex-basis: ").concat(k,'%;">\n                <div class="patt-circ">\n                  <div patt-dots-index=').concat(a,' class="patt-dots"></div>\n                </div>\n            </div>')}},{key:"_render",value:function(){var m=Ie.get(this),_=m.holder,v=m.option.matrix,k='<div class="patt-wrap">\n                    '.concat(function(M,q){for(var B=new Array(M),J=0;J<M;J++)B[J]=void 0;return B}(v[0]*v[1]).map(this._renderCircle).join(""),"\n                  </div>");_.innerHTML=k,m.pattCircle=m.holder.querySelectorAll(".patt-circ")}},{key:"option",value:function(m,a){var _=Ie.get(this).option;return void 0===a?_[m]:(_[m]=a,"margin"!==m&&"matrix"!==m&&"radius"!==m||this._render(),this)}}]),w}();Dt.defaults={matrix:[3,3],margin:20,radius:25,patternVisible:!0,lineOnMove:!0,delimiter:"",enableSetPattern:!1,allowRepeat:!0};var Me,Ve="xmui-pattern-lock",Ln="".concat(Ve,"_pattern"),nt=function(w){function m(a,_,v){var k;ee(this,m),(k=ce(this,oe(m).call(this))).className=Ve,k.tabindex=0,k.mainInput=new H(a),k.mainInput.className="".concat(Ve,"_input"),k.appendChild(k.mainInput),k.handleSelectedPattern=k.handleSelectedPattern.bind(Ee(k)),k.handlePatternStarted=k.handlePatternStarted.bind(Ee(k));var M=new se;return M.className=Ln,k.patternLockExt=new Dt(M.htmlElement,{matrix:[v,_],onDraw:k.handleSelectedPattern,onStart:k.handlePatternStarted}),k.messageComp=new ae(!0,!0),k.ariaDescribedBy=k.messageComp.id,k.appendChildren(M,k.messageComp),k}return le(m,w),re(m,[{key:"setError",value:function(a){this.error=!0,this.errorMessage=a||"",this.patternLockExt.setError()}},{key:"clearError",value:function(){this.error=!1,this.errorMessage="",this.patternLockExt.clearError()}},{key:"reset",value:function(){this.patternLockExt.reset()}},{key:"onChange",value:function(a){this.changeCB=a}},{key:"onStart",value:function(a){this.startCB=a}},{key:"handleSelectedPattern",value:function(a){this.mainInput.value=a,this.changeCB&&this.changeCB()}},{key:"handlePatternStarted",value:function(){this.startCB&&this.startCB()}},{key:"name",set:function(a){this.mainInput.name=a}},{key:"value",set:function(a){},get:function(){return this.mainInput.value}},{key:"errorMessage",set:function(a){this.messageComp.setText(a)}}]),m}(se);!function(w){w[w.Enter=0]="Enter",w[w.Repeat=1]="Repeat"}(Me||(Me={}));var Oe,it=function(w){function m(a,_,v,k,M,q){var B;ee(this,m),(B=ce(this,oe(m).call(this,k?X.page_pattern_reg:X.page_pattern_auth,k?"xmui-pattern-registration":"xmui-pattern-authentication",a,M,q))).isRegistrationMode=k,B.mode=Me.Enter,B._minPoints=4,B.setTitle(B.getTitle()),B.setInstructions(B.getInstructions());var J=B.createForm(_,v);if(B.setContent(J),B.isRegistrationMode){var Y=new r(X.button_reset);Y.label=B.uiContext.getString("ts_authenticator_pattern_cta_reset"),Y.disabled=!0,Y.onClick(B.handleReset.bind(Ee(B))),B.resetButton=Y,B.addRightButton(Y)}return B}return le(m,w),re(m,[{key:"onSubmit",value:function(a){this.onSubmitCB=a}},{key:"setError",value:function(a){this.error=!0,this.patternLock.setError(a)}},{key:"clearError",value:function(){this.error=!1,this.patternLock.clearError()}},{key:"handleReset",value:function(){this.mode=Me.Enter,this.patternLock.reset(),this.enteredPattern=null,this.resetButton.disabled=!0,this.setInstructions(this.getInstructions()),this.clearError()}},{key:"getTitle",value:function(){return this.uiContext.getString(this.isRegistrationMode?"ts_authenticator_pattern_title_reg":"ts_authenticator_pattern_title_auth")}},{key:"getRegModeInstructions",value:function(){return this.uiContext.getString(this.mode===Me.Enter?"ts_authenticator_pattern_intro_reg":"ts_authenticator_pattern_intro_repeat")}},{key:"getInstructions",value:function(){return this.isRegistrationMode?this.getRegModeInstructions():this.uiContext.getString("ts_authenticator_pattern_intro_auth")}},{key:"handleNoMatch",value:function(){this.patternLock.setError(this.uiContext.getString("ts_authenticator_pattern_mismatch"))}},{key:"submitPattern",value:function(a){this.onSubmitCB&&this.onSubmitCB(a)}},{key:"repeat",value:function(){this.patternLock.reset(),this.mode=Me.Repeat,this.resetButton.disabled=!1,this.setInstructions(this.getInstructions())}},{key:"validateLength",value:function(a){return JSON.parse("["+a+"]").length>=this._minPoints}},{key:"handleRegPatternChangedEnterMode",value:function(a){this.validateLength(a)?(this.enteredPattern=a,this.repeat()):this.notifyShortPattern()}},{key:"notifyShortPattern",value:function(){this.patternLock.setError(this.uiContext.getString("ts_authenticator_pattern_error_min_points"))}},{key:"handleRegPattrenChanged",value:function(a){this.mode===Me.Enter?this.handleRegPatternChangedEnterMode(a):this.enteredPattern===a?this.submitPattern(a):this.handleNoMatch()}},{key:"handlePattrenChanged",value:function(){var a=this.patternLock.value;this.isRegistrationMode?this.handleRegPattrenChanged(a):this.submitPattern(a)}},{key:"handlePatternStarted",value:function(){this.clearError()}},{key:"createForm",value:function(a,_){var v=new Z;v.addClass("xmui-pattern-form");var k=new nt(X.input_pattern_lock,a,_);return k.name="pattern",k.onChange(this.handlePattrenChanged.bind(this)),k.onStart(this.handlePatternStarted.bind(this)),k.focus(),this.patternLock=k,v.appendChild(k),this.addRecoveryButtonToForm(v),v}},{key:"minPoints",set:function(a){a>2&&(this._minPoints=a)}}]),m}(Ae),On=function(w){function m(a,_,v,k){var M;return ee(this,m),(M=ce(this,oe(m).call(this,a,_))).gridWidth=v,M.gridHeight=k,M.supportsInlineError=!0,M}return le(m,w),re(m,[{key:"showAuthUi",value:function(){this.showPatternPage(!1)}},{key:"showRegUi",value:function(){this.showPatternPage(!0)}},{key:"showPatternPage",value:function(a){var _=this,v=new it(this.actionContext,this.gridWidth,this.gridHeight,a,this.description.getCredentialRecoveryEscapeOption(),this.description.getAuthenticatorId());this.authError&&v.setError(this.authErrorMessage),v.onSubmit(function(k){v.blockInteraction();var M=com.ts.mobile.sdk.PatternInput.create(_.createPatternInputString(k));_.resolveInputPromise(com.ts.mobile.sdk.InputOrControlResponse.createInputResponse(M))}),this.showAuthenticatorPage(v)}},{key:"pointsIndexToCoorinate",value:function(a){var _=this;return a.map(function(v){return{y:Math.floor((v-1)/_.gridWidth),x:(v-1)%_.gridWidth}})}},{key:"createPatternInputString",value:function(a){var _=JSON.parse("[".concat(a,"]"));return this.pointsIndexToCoorinate(_).map(function(v){return"r:".concat(v.y,",c:").concat(v.x)}).join("")}}]),m}(F),Ze="xmui-tabs",rt=function(w){function m(){var a;return ee(this,m),(a=ce(this,oe(m).call(this))).tabs=new Map,a.className=Ze,a}return le(m,w),re(m,[{key:"addTab",value:function(a,_){var v=this,k=new se;k.className="".concat(Ze,"_tab"),k.appendChild(_),this.tabs.set(a,k),this.appendChild(k),k.onClick(function(){k!==v.selectedTab&&(v.selectTab(k),v.selectionChangedCB&&v.selectionChangedCB(a))})}},{key:"selectTabByKey",value:function(a){var _=this.tabs.get(a);this.selectTab(_)}},{key:"onSelectionChanged",value:function(a){this.selectionChangedCB=a}},{key:"selectTab",value:function(a){a&&(this.unselectCurrentTab(),a.selected=!0,this.selectedTab=a)}},{key:"unselectCurrentTab",value:function(){this.selectedTab&&(this.selectedTab.selected=!1,this.selectedTab=null)}}]),m}(se),hn="xmui-tabbed-panels",st=function(w){function m(){var a;return ee(this,m),(a=ce(this,oe(m).call(this))).keyToPanel=new Map,a.curKey=0,a.className=hn,a.tabs=new rt,a.tabs.onSelectionChanged(a.selectPanel.bind(Ee(a))),a.container=new se,a.container.className="".concat(hn,"_container"),a.appendChildren(a.tabs,a.container),a}return le(m,w),re(m,[{key:"addPanel",value:function(a,_){var v=this.generateKey();this.tabs.addTab(v,a),_.show=!1,this.container.appendChild(_),this.keyToPanel.set(v,_),1===this.keyToPanel.size&&(this.tabs.selectTabByKey(v),this.selectPanel(v))}},{key:"generateKey",value:function(){return(++this.curKey).toString()}},{key:"selectPanel",value:function(a){var _=this.keyToPanel.get(a);_!==this.selectedPanel&&(_.show=!0,this.selectedPanel&&(this.selectedPanel.show=!1),this.selectedPanel=_)}}]),m}(se),$e="xmui-tab-content",dn="".concat($e,"_title"),en="".concat($e,"_icon"),pn=function(w){function m(){var a;return ee(this,m),(a=ce(this,oe(m).call(this))).className=$e,a.iconComp=new se,a.iconComp.className=en,a.titleComp=new ve,a.titleComp.className=dn,a.appendChildren(a.iconComp,a.titleComp),a}return le(m,w),re(m,[{key:"title",set:function(a){this.titleComp.setText(a)}},{key:"icon",set:function(a){this.iconComp.className="".concat(en," ").concat(a)}}]),m}(se),mn=function(w){function m(a){var _,v;ee(this,m),(v=ce(this,oe(m).call(this,X.page_otp_select_channel,"xmui-select-channel-page",a))).typeToList=new Map,v.channelTypeToLocalizationKey=(ge(_={},com.ts.mobile.sdk.OtpChannel.Sms,"ts_authenticator_otp_sms_title"),ge(_,com.ts.mobile.sdk.OtpChannel.Email,"ts_authenticator_otp_email_title"),ge(_,com.ts.mobile.sdk.OtpChannel.PushNotification,"ts_authenticator_otp_push_title"),ge(_,com.ts.mobile.sdk.OtpChannel.VoiceCall,"ts_authenticator_otp_voice_title"),_);var k=v.createContent();return v.setContent(k),v.handleSelectionChanged=v.handleSelectionChanged.bind(Ee(v)),v}return le(m,w),re(m,[{key:"createContent",value:function(){return this.tabbedPanels=new st,this.tabbedPanels}},{key:"addChannelTarget",value:function(a){var _=this.typeToList.get(a.channel)||this.createTabbedList(a),v=new s(a.targetName,a.targetInfo);_.addListItem(a.targetId,!1,v)}},{key:"onSubmit",value:function(a){this.onSubmitCB=a}},{key:"handleSelectionChanged",value:function(a){this.onSubmitCB&&this.onSubmitCB(a[0])}},{key:"createList",value:function(a){var _=new u;return this.typeToList.set(a,_),_.onSelectionChanged(this.handleSelectionChanged),_}},{key:"createTabbedList",value:function(a){var _=new pn;_.title=this.uiContext.getString(this.channelTypeToLocalizationKey[a.channel]||"UNKNOWN"),_.icon=n.getChannelIcon(a.channel);var k=this.createList(a.channel);return this.tabbedPanels.addPanel(_,k),k}}]),m}(Ae),Vt="xmui-message-with-action",_n=function(w){function m(){var a;return ee(this,m),(a=ce(this,oe(m).call(this))).className=Vt,a.message=new ve,a.message.className="".concat(Vt,"_message"),a.action=new ve,a.action.className="".concat(Vt,"_action"),a.appendChildren(a.message,a.action),a}return le(m,w),re(m,[{key:"setMessage",value:function(a){this.message.setText(a)}},{key:"setAction",value:function(a,_){this.action.setText(a),this.onClick(_)}}]),m}(se),Gt="xmui-otp-page",gn="".concat(Gt,"_content"),vn="".concat(Gt,"_message-container"),bn=function(w){function m(a,_,v){var k;ee(this,m),(k=ce(this,oe(m).call(this,X.page_otp_auth,Gt,a))).numDigits=_,k.useBackButton=v,k.useNormalInput=k.numDigits>7,k.setTitle(k.uiContext.getString("ts_authenticator_otp_title_auth"));var M=k.createContent();if(k.setContent(M),v&&(k.cancelButton.automationId=X.button_back,k.cancelButton.label=k.uiContext.getString("ts_gen_back")),k.useNormalInput){var q=new r(X.button_continue);q.label=k.uiContext.getString("ts_gen_continue"),q.disabled=!0,q.onClick(function(){k.submitOtpCode(k.otpCodeComp.value)}),k.continueButton=q,k.addRightButton(q)}return k}return le(m,w),re(m,[{key:"handleCancelButtonClicked",value:function(){this.useBackButton?this.onBackCB&&this.onBackCB():dt(oe(m.prototype),"handleCancelButtonClicked",this).call(this)}},{key:"onBack",value:function(a){this.onBackCB=a}},{key:"onSubmit",value:function(a){this.onSubmitCB=a}},{key:"onResend",value:function(a){this.onResendCB=a}},{key:"setError",value:function(a){this.error=!0,this.otpCodeComp.setError(a)}},{key:"clearError",value:function(){this.otpCodeComp.clearError(),this.error=!1}},{key:"submitOtpCode",value:function(a){this.onSubmitCB&&this.onSubmitCB(a)}},{key:"handleOtpCodeChanged",value:function(){this.clearError();var a=this.otpCodeComp.value;this.useNormalInput?this.continueButton.disabled=null==a||0===a.length:null!=a&&a.length===this.numDigits&&this.submitOtpCode(a)}},{key:"createForm",value:function(){var a=new Z;return this.useNormalInput?(this.otpCodeComp=new Te(K.PositiveInteger,X.input_otp_code),this.otpCodeComp.autocomplete=vt.Off):this.otpCodeComp=new We(X.input_otp_code,this.numDigits),this.otpCodeComp.name="otp-code",this.otpCodeComp.value="",this.otpCodeComp.focus(),this.otpCodeComp.onChange(this.handleOtpCodeChanged.bind(this)),a.appendChild(this.otpCodeComp),a}},{key:"createContent",value:function(){var a=this,_=new se;_.className=gn;var v=this.createForm(),k=new se;k.className=vn;var M=new _n;return M.setMessage(this.uiContext.getString("ts_authenticator_otp_resend_message")),M.setAction(this.uiContext.getString("ts_authenticator_otp_resend"),function(){a.onResendCB&&a.onResendCB()}),k.appendChild(M),_.appendChildren(v,k),_}}]),m}(Ae);!function(w){w[w.TargetSelection=0]="TargetSelection",w[w.Input=1]="Input"}(Oe||(Oe={}));var Ft,Mt,et,An=function(w){function m(a,_,v,k){var M,q;return ee(this,m),(q=ce(this,oe(m).call(this,a,_))).autoExecedTarget=k,q.supportsInlineError=!0,q.channelTypeToInstruction=(ge(M={},com.ts.mobile.sdk.OtpChannel.Sms,"ts_authenticator_otp_sms_sent"),ge(M,com.ts.mobile.sdk.OtpChannel.Email,"ts_authenticator_otp_email_sent"),ge(M,com.ts.mobile.sdk.OtpChannel.PushNotification,"ts_authenticator_otp_push_sent"),ge(M,com.ts.mobile.sdk.OtpChannel.VoiceCall,"ts_authenticator_otp_voice_sent"),ge(M,com.ts.mobile.sdk.OtpChannel.Unknown,"ts_authenticator_otp_external_numeric_sent"),M),q.possibleTargets=v,q.state=k?Oe.Input:Oe.TargetSelection,q.target=k,q}return le(m,w),re(m,[{key:"setAvailableTargets",value:function(a){this.possibleTargets=a}},{key:"setGeneratedOtp",value:function(a,_){_?(this.state=Oe.Input,a instanceof com.ts.mobile.sdk.OtpFormatNumericImpl?(this.codeLength=a.getOtpLength(),this.isSupportedFormat=!0):this.isSupportedFormat=!1):this.state=Oe.TargetSelection,this.target=_}},{key:"showOtpInput",value:function(){var a=this,_=new bn(this.actionContext,this.codeLength,this.possibleTargets.length>1);_.setTitle(this.uiContext.getString("ts_authenticator_otp_title_auth")),_.setInstructions(this.uiContext.getString(this.channelTypeToInstruction[this.target.getChannel()])),this.authError&&_.setError(this.authErrorMessage),_.onSubmit(function(v){a.clearError(),_.blockInteraction();var k=com.ts.mobile.sdk.OtpInputOtpSubmission.createOtpSubmission(v),M=com.ts.mobile.sdk.TargetBasedAuthenticatorInput.createAuthenticatorInput(k);a.resolveInputPromise(com.ts.mobile.sdk.InputOrControlResponse.createInputResponse(M))}),_.onBack(function(){a.clearError(),_.blockInteraction(),a.state=Oe.TargetSelection,a.showAuthUi()}),_.onResend(function(){a.clearError(),_.blockInteraction();var v=com.ts.mobile.sdk.OtpInputRequestResend.createOtpResendRequest(),k=com.ts.mobile.sdk.TargetBasedAuthenticatorInput.createAuthenticatorInput(v);a.resolveInputPromise(com.ts.mobile.sdk.InputOrControlResponse.createInputResponse(k))}),this.showAuthenticatorPage(_)}},{key:"showTargetSelectionInput",value:function(){var a=this,_=0,v={},k=new mn(this.actionContext);k.error=!!this.authError,k.setTitle(this.uiContext.getString("ts_authenticator_otp_title_auth")),k.setInstructions(this.getTargetSelectionInstruction()),k.onSubmit(function(M){a.clearError(),k.blockInteraction();var q=com.ts.mobile.sdk.TargetBasedAuthenticatorInput.createTargetSelectionRequest(v[M]);a.resolveInputPromise(com.ts.mobile.sdk.InputOrControlResponse.createInputResponse(q))}),this.possibleTargets.forEach(function(M){var q=M.getDeviceDetails(),B=(++_).toString();v[B]=M,k.addChannelTarget({channel:M.getChannel(),targetId:B,targetName:q?E.getDeviceNameFromDeviceDetails(q):M.getDescription(),targetInfo:q?E.getLastAccessedFromDeviceDetails(a.uiContext,q):null})}),this.showAuthenticatorPage(k)}},{key:"onCancel",value:function(){this.clearError(),dt(oe(m.prototype),"onCancel",this).call(this)}},{key:"showAuthUi",value:function(){switch(this.state){case Oe.TargetSelection:this.showTargetSelectionInput();break;case Oe.Input:this.isSupportedFormat?this.showOtpInput():Promise.reject("Unsupported Otp code format")}}},{key:"showRegUi",value:function(){throw new Error("Otp registration unsupported")}},{key:"getTargetSelectionInstruction",value:function(){var a;return a=this.authError&&this.authError.getErrorCode()===com.ts.mobile.sdk.AuthenticationErrorCode.InvalidInput?"ts_authenticator_otp_error_code_expired":"ts_authenticator_otp_targets_intro",this.uiContext.getString(a)}}]),m}(F),tn="xmui-totp-form",Cn=function(w){function m(a,_,v){var k,M;ee(this,m),(M=ce(this,oe(m).call(this,X.page_totp_auth,"xmui-totp-page",a))).challengeType=_,M.challenge=v,M.channelTypeLocalizationKeys=(ge(k={},com.ts.mobile.sdk.TotpChallengeFormatType.Numeric,"ts_authenticator_totp_input_with_challenge_intro"),ge(k,com.ts.mobile.sdk.TotpChallengeFormatType.AlphaNumeric,"ts_authenticator_totp_input_with_challenge_intro"),ge(k,com.ts.mobile.sdk.TotpChallengeFormatType.QrCode,"ts_authenticator_totp_input_with_qr_challenge_intro"),k),M.setTitle(M.uiContext.getString("ts_authenticator_totp_title")),M.setInstructions(M.uiContext.getString(M.channelTypeLocalizationKeys[M.challengeType]||"ts_authenticator_totp_input_intro"));var q=M.createForm();M.setContent(q);var B=new r(X.button_continue);return B.label=M.uiContext.getString("ts_authenticator_password_cta_positive"),B.disabled=!0,B.type=d.Submit,B.form=tn,B.onClick(M.handleSend.bind(Ee(M))),M.sendButton=B,M.addRightButton(B),M}return le(m,w),re(m,[{key:"onSubmit",value:function(a){this.onSubmitCB=a}},{key:"setError",value:function(a){this.error=!0,this.totpCodeInput.setError(a)}},{key:"clearError",value:function(){this.error=!1,this.totpCodeInput.clearError()}},{key:"handleSend",value:function(){this.onSubmitCB&&this.onSubmitCB(this.totpCodeInput.value)}},{key:"handleTotpCodeChanged",value:function(){var a=this.totpCodeInput.value;this.sendButton.disabled=null==a||0===a.length}},{key:"createSpacer",value:function(){var a=new se;return a.className="".concat("xmui-totp-form","_spacer"),a}},{key:"createChallenge",value:function(){var a;switch(this.challengeType){case com.ts.mobile.sdk.TotpChallengeFormatType.QrCode:var _=new se;_.className="".concat("xmui-totp-form","_qr-code-container");var v=new Re;v.className="".concat("xmui-totp-form","_qr-code"),v.src=this.challenge,_.appendChild(v),a=_;break;case com.ts.mobile.sdk.TotpChallengeFormatType.Numeric:case com.ts.mobile.sdk.TotpChallengeFormatType.AlphaNumeric:var k=new ve;k.className="".concat("xmui-totp-form","_alphanumeric-code"),k.setText(this.challenge),a=k}return a}},{key:"createStep1Title",value:function(){var a=new ve;a.className="".concat("xmui-totp-form","_step");var _=this.challengeType===com.ts.mobile.sdk.TotpChallengeFormatType.QrCode?"ts_authenticator_totp_qrcode_challenge_step1_message":"ts_authenticator_totp_code_challenge_step1_message";return a.setText(this.uiContext.getString(_)),a}},{key:"createStep2Title",value:function(){var a=new ve;a.className="".concat("xmui-totp-form","_step");var _=this.challengeType===com.ts.mobile.sdk.TotpChallengeFormatType.QrCode?"ts_authenticator_totp_qrcode_challenge_step2_message":"ts_authenticator_totp_code_challenge_step2_message";return a.setText(this.uiContext.getString(_)),a}},{key:"createForm",value:function(){var a=new Z;if(a.addClass("xmui-totp-form"),a.id=tn,a.appendChild(this.createSpacer()),null!=this.challengeType){var _=this.createStep1Title(),v=this.createChallenge(),k=this.createStep2Title();a.appendChildren(_,this.createSpacer(),v,this.createSpacer(),k,this.createSpacer())}var M=new se;M.className="".concat("xmui-totp-form","_input");var q=new Te(K.Text,X.input_totp_code);return q.name="totp-code",q.value="",q.placeholder=this.uiContext.getString("ts_authenticator_totp_input_hint"),q.onChange(this.handleTotpCodeChanged.bind(this)),q.focus(),M.appendChild(q),this.totpCodeInput=q,a.appendChild(M),a.appendChild(this.createSpacer()),a}}]),m}(Ae),po=function(w){function m(a,_){return ee(this,m),ce(this,oe(m).call(this,a,_))}return le(m,w),re(m,[{key:"setAvailableTargets",value:function(a){this.availableTargets=a}},{key:"setTargetDevices",value:function(a){this.targetDevices=a}},{key:"setChallenge",value:function(a){this.challenge=this.getChallenge(a)}},{key:"showAuthUi",value:function(){this.availableTargets&&!this.targetDevices?this.showTargetSelectionUi():this.showCodeInputUi()}},{key:"promiseRecoveryForError",value:function(a,_,v){return a.getErrorCode()==com.ts.mobile.sdk.AuthenticationErrorCode.InvalidInput&&_.indexOf(com.ts.mobile.sdk.AuthenticationErrorRecovery.RetryAuthenticator)>-1&&a.getPublicSymbolicProperty(com.ts.mobile.sdk.AuthenticationErrorProperty.AuthenticatorInvalidInputErrorDescription)==com.ts.mobile.sdk.AuthenticationErrorPropertySymbol.AuthenticatorInvalidInputErrorDescriptionTotpIncorrectCheckDigit?(j.log("Totp authentication failed due to invalid check-digit, starting recovery"),this.inputError="Typing error detected - retype code",Promise.resolve(com.ts.mobile.sdk.AuthenticationErrorRecovery.RetryAuthenticator)):dt(oe(m.prototype),"promiseRecoveryForError",this).call(this,a,_,v)}},{key:"showTargetSelectionUi",value:function(){var a=this,_=this.uiContext,v=new ut(this.actionContext);v.setTitle(_.getString("ts_authenticator_totp_title")),v.setInstructions(_.getString("ts_authenticator_totp_targets_intro"));var k={};this.availableTargets.forEach(function(M){var q=M.getDeviceDetails(),B=q.getDeviceId(),J=E.getDeviceNameFromDeviceDetails(q),Y=E.getLastAccessedFromDeviceDetails(a.uiContext,q);k[B]=M,v.addDevice(B,J,Y,!1)}),v.onSubmit(function(M){v.blockInteraction();var q=M.map(function(J){return k[J]}),B=E.createTargetsSelectionResponse(q);a.resolveInputPromise(B)}),this.showAuthenticatorPage(v)}},{key:"showCodeInputUi",value:function(){var a=this,_=new Cn(this.actionContext,this.challenge.type,this.challenge.value);this.inputError&&_.setError(this.inputError),_.onSubmit(function(v){_.blockInteraction();var k=com.ts.mobile.sdk.impl.TotpInputCodeSubmissionImpl.createTotpCodeSubmission(v),M=com.ts.mobile.sdk.TargetBasedAuthenticatorInput.createAuthenticatorInput(k);a.resolveInputPromise(com.ts.mobile.sdk.InputOrControlResponse.createInputResponse(M))}),this.showAuthenticatorPage(_)}},{key:"showRegUi",value:function(){throw new Error("Method not implemented.")}},{key:"getChallenge",value:function(a){var _={type:null,value:null};if(a)switch(_.type=a.getFormat().getType(),_.type){case com.ts.mobile.sdk.TotpChallengeFormatType.AlphaNumeric:case com.ts.mobile.sdk.TotpChallengeFormatType.Numeric:_.value=a.getValue();break;case com.ts.mobile.sdk.TotpChallengeFormatType.QrCode:_.value="data:image/jpeg;base64,"+a.getValue()}return _}}]),m}(F),fo="xmui-fido2-authentication",mo="xmui-fido2-registration",_o=function(w){function m(a,_,v,k){var M,q=arguments.length>4&&void 0!==arguments[4]&&arguments[4];ee(this,m),(M=ce(this,oe(m).call(this,_?X.page_fido2_reg:X.page_fido2_auth,_?mo:fo,a,v,k))).isRegistrationMode=_,M.disableAutocomplete=q,M.displayNameInputRegex=/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)[a-zA-Z\d]{6,}$/,M.setTitle(M.getTitle()),M.setInstructions(M.getInstructions());var B=new r(X.button_continue);B.label=M.uiContext.getString("ts_authenticator_password_cta_positive"),M.addRightButton(B),M.continueButton=B;var J=M.createForm();return M.setContent(J),M}return le(m,w),re(m,[{key:"setError",value:function(a){this.error=!0,this.displayNameInput.setError(a)}},{key:"clearError",value:function(){this.error=!1,this.displayNameInput.clearError()}},{key:"reset",value:function(){this.unblockInteraction(),this.displayNameInput.value="",this.displayNameInput.focus(),this.repeatDisplayNameInput&&(this.repeatDisplayNameInput.value="")}},{key:"onSubmit",value:function(a){this.onSubmitCB=a}},{key:"getTitle",value:function(){return this.uiContext.getString(this.isRegistrationMode?"ts_authenticator_fido2_title_reg":"ts_authenticator_fido2_title_auth")}},{key:"getInstructions",value:function(){return this.uiContext.getString(this.isRegistrationMode?"ts_authenticator_fido2_intro_reg":"ts_authenticator_fido2_intro_auth")}},{key:"createForm",value:function(){var a=this,_=this.uiContext,v=new Z(this.continueButton);v.addClass("xmui-fido2-page-form"),v.id="xmui-fido2-form";var k=new Te(K.Text,X.input_text),M=this.getAutocompleteValue();if(k.name="displayName",k.placeholder=_.getString("ts_authenticator_fido2_field_hint"),k.disabled=!1,k.value="",k.required=!0,k.autocomplete=M,k.ariaLabel=_.getString("ts_accessibility_fido2_enter_name"),k.focus(),this.displayNameInput=k,v.appendChild(k),this.isRegistrationMode){var q=new se;q.className="".concat("xmui-fido2-page-form","_spacer"),v.appendChild(q);var B=new Te(K.Text,X.input_repeat_fido2);B.name="repeat-displayName",B.placeholder=_.getString("ts_authenticator_fido2_reg_field_hint"),B.disabled=!1,B.value="",B.required=!0,k.autocomplete=M,B.ariaLabel=_.getString("ts_accessibility_fido2_enter_name_again"),this.repeatDisplayNameInput=B,v.appendChild(B)}return this.addRecoveryButtonToForm(v),v.externalValidations=function(){var J=!0;return a.isRegistrationMode&&(a.validateDisplayNameMatch()||(a.repeatDisplayNameInput.setError(a.uiContext.getString("ts_authenticator_fido2_error_reg_no_match"),!1),a.displayNameInput.focus(),J=!1),a.isDisplayNameValid()||(a.displayNameInput.setError(a.uiContext.getString("ts_authenticator_fido2_error_reg_strength_validation_failed"),!1),a.repeatDisplayNameInput.setError(null,!0),a.displayNameInput.focus(),J=!1),0==J&&(a.displayNameInput.value="",a.repeatDisplayNameInput.value="")),J},v.onUserInput(this.handleDisplayNameChanged.bind(this)),v.onSubmit(function(J){a.blockInteraction(),a.onSubmitCB&&a.onSubmitCB(J.displayName)}),v.start(),v}},{key:"validateDisplayNameMatch",value:function(){return this.displayNameInput.value===this.repeatDisplayNameInput.value}},{key:"isDisplayNameValid",value:function(){return!0}},{key:"getAutocompleteValue",value:function(){return this.disableAutocomplete?vt.Off:vt.Username}},{key:"handleDisplayNameChanged",value:function(){this.displayNameInput.error&&this.displayNameInput.clearError(),this.repeatDisplayNameInput&&this.repeatDisplayNameInput.error&&this.repeatDisplayNameInput.clearError()}}]),m}(Ae),go=function(w){function m(a,_){var v;return ee(this,m),(v=ce(this,oe(m).call(this,a,_))).supportsInlineError=!0,v}return le(m,w),re(m,[{key:"showAuthUi",value:function(){this.showFido2Page(!1)}},{key:"showRegUi",value:function(){this.showFido2Page(!0)}},{key:"showFido2Page",value:function(a){var _=this;if(this.authError&&this.fido2Page)this.fido2Page.reset(),this.fido2Page.setError(this.authErrorMessage);else{var v=!0===this.clientContext.disableFido2Autocomplete,k=new _o(this.actionContext,a,this.description.getCredentialRecoveryEscapeOption(),this.description.getAuthenticatorId(),v);this.showAuthenticatorPage(k),this.fido2Page=k}this.fido2Page.onSubmit(function(M){var q=com.ts.mobile.sdk.Fido2InputResponse.create(M);_.resolveInputPromise(com.ts.mobile.sdk.InputOrControlResponse.createInputResponse(q))})}}]),m}(F),yo=function(w){function m(a,_,v,k){var M;ee(this,m),M=ce(this,oe(m).call(this,X.page_ticket_wait,"xmui-ticket-wait-page",a)),Ne(oe(m.prototype),"busy",!0,Ee(M),!0);var q=M.createContent(_,v,k);return M.setContent(q),M}return le(m,w),re(m,[{key:"createSpacer",value:function(){var a=new se;return a.className="".concat("xmui-ticket-wait","_spacer"),a}},{key:"createMessage",value:function(a){var _=new ve;return _.setText(a),_.className="".concat("xmui-ticket-wait","_message"),_}},{key:"createContent",value:function(a,_,v){var k=new se;if(k.className="xmui-ticket-wait",k.appendChild(this.createSpacer()),_===com.ts.mobile.sdk.TicketIdFormat.Qr){var M=this.createMessage(a),q=new se;q.className="".concat("xmui-ticket-wait","_qr-code-container");var B=new Re;B.src=v,B.className="".concat("xmui-ticket-wait","_qr-code"),q.appendChild(B),k.appendChildren(M,this.createSpacer(),q)}else{var J=new se;J.className="".concat("xmui-ticket-wait","_icon ").concat(fe.WaitForTicket);var Y=this.createMessage(a);k.appendChildren(J,this.createSpacer(),Y,this.createSpacer())}return k}},{key:"busy",set:function(a){}}]),m}(h),bo=function w(){ee(this,w)},Ao=function(){function w(){ee(this,w),this.pollingIntervalMillis=3e3}return re(w,[{key:"setWaitingTicket",value:function(m){this.ticket=this.getTicket(m)}},{key:"startSession",value:function(m,a){this.username=j.getUsernameFromClientContext(a),this.clientContext=a,this.actionContext=m}},{key:"endSession",value:function(){this.abortPolling()}},{key:"promiseInput",value:function(){var m=this;return this.ticket?new Promise(function(a,_){m.currentPromiseResolve=a,m.ticketWaitPage||m.createTicketWaitPage(),m.startPolling()}):Promise.reject("TicketWaitSession: Failed build ticket info")}},{key:"createTicketWaitPage",value:function(){var m=this,a=new yo(this.actionContext,this.ticket.instructions,this.ticket.format,this.ticket.value);this.username&&a.setUserName(this.username),a.setTitle(this.ticket.title),a.onCancel(function(){m.resolve(E.createCancelAuthenticatorRequest()),m.abortPolling()}),a.onEscape(function(_){m.resolve(com.ts.mobile.sdk.InputOrControlResponse.createEscapeResponse(_,{})),m.abortPolling()}),j.renderPage(a,this.clientContext),this.ticketWaitPage=a}},{key:"startPolling",value:function(){var m=this;this.pollingTimer=setTimeout(function(){m.resolve(com.ts.mobile.sdk.InputOrControlResponse.createInputResponse(com.ts.mobile.sdk.TicketWaitInput.createPollRequest())),m.pollingTimer=null},this.pollingIntervalMillis)}},{key:"abortPolling",value:function(){this.pollingTimer&&(clearTimeout(this.pollingTimer),this.pollingTimer=null)}},{key:"resolve",value:function(m){this.currentPromiseResolve&&this.currentPromiseResolve(m),this.currentPromiseResolve=null}},{key:"getTicket",value:function(m){var a=new bo;if(m){a.title=m.getTitle(),a.instructions=m.getText();var _=m.getTicketId();if(_){if(a.format=_.getFormat(),a.format!==com.ts.mobile.sdk.TicketIdFormat.Qr)throw a=null,j.log("Unsupported ticket ID format"),new Error("Unsupported ticket ID format");a.value="data:image/jpeg;base64,"+_.getValue()}}return a}}]),w}(),Nn="xmui-actions-menu-button",So="".concat(Nn,"_menu-container"),Co=function(w){function m(a){var _;return ee(this,m),(_=ce(this,oe(m).call(this))).actionsMenu=a,_.isOpen=!1,_.className="".concat(Nn," ").concat(fe.More),_.automationId=X.button_actions_list,_.menuContainer=new se,_.menuContainer.className=So,_.menuContainer.appendChild(a),_.appendChild(_.menuContainer),_.onMousedown(function(){_.openMenu()}),_.handleMousedownEvent=_.handleMousedownEvent.bind(Ee(_)),_.handleWheelEvent=_.handleWheelEvent.bind(Ee(_)),_.handleActionSelection=_.handleActionSelection.bind(Ee(_)),_.handleResize=U(_.handleResize.bind(Ee(_)),10,!1),a.onSelectionChanged(_.handleActionSelection),_.actionsMenu.onFocus(_.handleFocusEvent.bind(Ee(_))),_.actionsMenu.onBlur(_.handleBlurEvent.bind(Ee(_))),_.actionsMenu.onKeydown(_.handleKeydownEvent.bind(Ee(_))),_}return le(m,w),re(m,[{key:"openMenu",value:function(){this.isOpen||(this.previousFocusedElement=document.activeElement,this.addClass("".concat(Nn,"--open")),this.actionsMenu.clearSelection(),this.actionsMenu.clearActive(),this.actionsMenu.focus(),this.updateMenuPosition(),this.isOpen=!0)}},{key:"updateMenuPosition",value:function(){var a=this.htmlElement.getBoundingClientRect(),_=a.left+a.width/2,v=a.top+a.height/2,k=this.menuContainer.htmlElement,M=window.getComputedStyle(k),q=parseInt(M.width),B=parseInt(M.height),J=window.innerHeight-v-B,Y=J<0?J:0;k.style.left=_-q+"px",k.style.top=v+Y+"px"}},{key:"closeMenu",value:function(){this.isOpen&&(this.previousFocusedElement&&this.previousFocusedElement.focus&&this.previousFocusedElement.focus(),this.removeClass("".concat(Nn,"--open")),window.removeEventListener("resize",this.handleResize),document.removeEventListener("mousedown",this.handleMousedownEvent),document.removeEventListener("wheel",this.handleWheelEvent),this.isOpen=!1)}},{key:"handleFocusEvent",value:function(a){window.addEventListener("resize",this.handleResize),document.addEventListener("mousedown",this.handleMousedownEvent),document.addEventListener("wheel",this.handleWheelEvent)}},{key:"handleBlurEvent",value:function(a){this.actionsMenu.htmlElement.contains(document.activeElement)||(this.previousFocusedElement=null,this.closeMenu())}},{key:"handleKeydownEvent",value:function(a,_){_.keyCode===bt.Escape&&this.closeMenu()}},{key:"handleMousedownEvent",value:function(a){this.closeMenu()}},{key:"handleResize",value:function(){this.closeMenu()}},{key:"handleWheelEvent",value:function(){this.closeMenu()}},{key:"handleActionSelection",value:function(){this.closeMenu()}}]),m}(se),Hn=function(w){function m(){var a;return ee(this,m),(a=ce(this,oe(m).call(this))).className="xmui-text-state",a}return le(m,w),m}(ve),Io=function(w){function m(a){var _;ee(this,m),(_=ce(this,oe(m).call(this,X.page_configure_authenticators,"xmui-authenticator-configuration-page"))).uiContext=a,_.keyToActionMenuButton={},_.setTitle(a.getString("ts_session_config_title"));var v=new r(X.button_cancel);v.label=a.getString("ts_gen_cancel"),v.onClick(function(){_.onCancelCB&&_.onCancelCB()}),_.addLeftButton(v);var k=_.createContent();return _.setContent(k),_}return le(m,w),re(m,[{key:"createContent",value:function(){var a=this;return this.authList=new u(S.None),this.authList.onItemClicked(function(_){var v=a.keyToActionMenuButton[_];v&&v.openMenu()}),this.authList.focus(),this.authList}},{key:"getDefaultState",value:function(){var a=new Hn;return a.setText(this.uiContext.getString("ts_gen_default")),a}},{key:"addAuthenticator",value:function(a,_,v,k,M,q,B){var J=n.getAuthenticatorIcon(k)||n.getAuthenticatorIcon(com.ts.mobile.sdk.AuthenticatorType.Generic),Y=q?[this.getDefaultState()]:null,he=B?[fe.Registered]:null,pe=new Co(M);this.keyToActionMenuButton[a]=pe;var xe=new s(_,v,J,pe,Y,he);this.authList.addListItem(a,!1,xe)}},{key:"onCancel",value:function(a){this.onCancelCB=a}}]),m}(Ot),Xn="xmui-actions-menu",Eo=function(w){function m(){var a;return ee(this,m),(a=ce(this,oe(m).call(this,S.SingleMouseup,!0))).className=Xn,a.automationId=X.list_actions,a.tabindex=-1,a.role="menu",a}return le(m,w),re(m,[{key:"addAction",value:function(a){var _=new ve;_.id=Wt_generate(),_.className="".concat(Xn,"_action"),_.key=a.key,_.setText(a.label),this.addItem(_),this.role="menuitem",this.selected=!1,this.disabled=!1}}]),m}(t);!function(w){w[w.Register=0]="Register",w[w.Unregister=1]="Unregister",w[w.Reregister=2]="Reregister",w[w.SetDefault=3]="SetDefault"}(et||(et={}));var $n=(ge(Ft={},et.Register,"ts_session_config_item_action_register"),ge(Ft,et.Unregister,"ts_session_config_item_action_unregister"),ge(Ft,et.Reregister,"ts_session_config_item_action_reregister"),ge(Ft,et.SetDefault,"ts_session_config_item_action_set_as_default"),Ft),Ro=(ge(Mt={},et.Register,"ts_session_config_item_register_failed"),ge(Mt,et.Unregister,"ts_session_config_item_unregister_failed"),ge(Mt,et.Reregister,"ts_session_config_item_reregister_failed"),ge(Mt,et.SetDefault,"ts_session_config_item_default_failed"),Mt),Po=function(){function w(m){var a;ee(this,w),this.username=m,this.actionTypeToEMenuAction=(ge(a={},com.ts.mobile.sdk.AuthenticatorConfigurationAction.Register,et.Register),ge(a,com.ts.mobile.sdk.AuthenticatorConfigurationAction.Unregister,et.Unregister),ge(a,com.ts.mobile.sdk.AuthenticatorConfigurationAction.Reregister,et.Reregister),a)}return re(w,[{key:"setAuthenticatorsList",value:function(m){var a=this,_=this.uiContext,v=new Io(_);v.setInstructions(this.instructions||_.getString("ts_session_config_intro")),v.setUserName(this.username),m.forEach(function(k){var M=k.getDescription(),q=M.getAuthenticatorId(),B=_.getString(L.getAuthenticatorNameKey(q)),J=_.getString(L.getAuthenticatorDescriptionKey(q)),Y=M.getType(),he=k.getAvailableActions(),pe=M.getDefaultAuthenticator(),xe=M.getRegistered(),ht=a.buildActionsMenu(he,pe);ht.onSelectionChanged(a.handleAction.bind(a,k)),v.addAuthenticator(q,B,J,Y,ht,pe,xe)}),v.onCancel(function(){a.configServices.finishSession()}),j.renderPage(v,this.clientContext)}},{key:"startSession",value:function(m,a,_){this.username=j.getUsernameFromClientContext(_)||this.username,this.configServices=m,this.actionContext=a,this.clientContext=_,this.uiContext=m.getUiContext(),this.instructions=null,j.log("Starting configuration session")}},{key:"endSession",value:function(){j.log("Ending configuration session")}},{key:"buildActionsMenu",value:function(m,a){var _=this,v=new Eo;return m.forEach(function(k){v.addAction({key:_.actionTypeToEMenuAction[k].toString(),label:_.uiContext.getString($n[_.actionTypeToEMenuAction[k]])})}),a||v.addAction({key:et.SetDefault.toString(),label:this.uiContext.getString($n[et.SetDefault])}),v}},{key:"handleAction",value:function(m,a){var _,v=this,k=parseInt(a);switch(k){case et.SetDefault:_=this.handleSetDefault(m);break;case et.Register:_=this.handleRegister(m);break;case et.Reregister:_=this.handleReregister(m);break;case et.Unregister:_=this.handleUnregister(m)}_.then(function(){return v.configServices.requestRefreshAuthenticators()}).catch(function(M){if(M&&M.getErrorCode&&M.getErrorCode()===com.ts.mobile.sdk.AuthenticationErrorCode.UserCanceled)v.configServices.requestRefreshAuthenticators();else{var q=m.getDescription().getAuthenticatorId(),B=v.uiContext.getString(L.getAuthenticatorNameKey(q)),J="fido2"!==q&&M.getMessage?M.getMessage():"",Y=v.uiContext.formatString(Ro[k],[B,J]);v.presentError(M,Y)}})}},{key:"setSuccessMessage",value:function(m,a){var _=this.uiContext,v=m.getDescription().getAuthenticatorId(),k=_.getString(L.getAuthenticatorNameKey(v));this.instructions=_.formatString(a,[k])}},{key:"handleSetDefault",value:function(m){var a=this;return this.configServices.setDefaultAuthenticator(m).then(function(_){return a.setSuccessMessage(m,a.uiContext.getString("ts_session_config_item_default_result")),_})}},{key:"handleReregister",value:function(m){var a=this;return this.configServices.reregisterAuthenticator(m,this.clientContext).then(function(){return a.configServices.setDefaultAuthenticator(m).then(function(_){return a.setSuccessMessage(m,a.uiContext.getString("ts_session_config_item_reregister_result")),_})})}},{key:"handleRegister",value:function(m){var a=this;return this.configServices.registerAuthenticator(m,this.clientContext).then(function(){return a.configServices.setDefaultAuthenticator(m).then(function(_){return a.setSuccessMessage(m,a.uiContext.getString("ts_session_config_item_register_result")),_})})}},{key:"handleUnregister",value:function(m){var a=this;return new Promise(function(_,v){var k=a.uiContext;a.setSuccessMessage(m,k.getString("ts_session_config_item_unregister_result"));var M=m.getDescription().getAuthenticatorId(),q=k.getString(L.getAuthenticatorNameKey(M)),B=k.getString("ts_session_config_item_unregister_dialog_cta"),J=k.getString("ts_gen_cancel"),Y=new I(k,B,J);a.username&&Y.setUserName(a.username),Y.setDialogTitle(k.getString("ts_session_config_item_unregister_dialog_title")),Y.setDialogMessage(k.formatString("ts_session_config_item_unregister_dialog_message",[q])),Y.setDialogIconClass(fe.Unregister),Y.onSelect(function(he){Y.blockInteraction(),he?a.configServices.unregisterAuthenticator(m,a.clientContext).then(_,v):_(!0)}),j.renderPage(Y,a.clientContext)})}},{key:"presentError",value:function(m,a){var _=this;this.instructions=null,x.promiseInformationInput(this.username,fe.Information,this.uiContext.getString("ts_session_config_error_dialog_title"),a,this.uiContext.getString("ts_gen_continue"),this.uiContext,this.clientContext).then(function(){m.getErrorCode()==com.ts.mobile.sdk.AuthenticationErrorCode.PolicyRejection?_.configServices.finishSession():_.configServices.requestRefreshAuthenticators()})}}]),w}(),To=function(w){function m(a,_,v,k,M){var q;ee(this,m),(q=ce(this,oe(m).call(this,X.dialog_registration_promotion_intro,"xmui-registration-promotion-introduction-page",a,!0,_,v,fe.Promotion))).cancelButton.label=M,q.cancelButton.automationId=X.button_abort;var B=new r(X.button_skip);B.label=a.getUiContext().getString("ts_session_promotion_skip"),B.onClick(function(){return q.onSkipCB&&q.onSkipCB()}),q.addRightButton(B);var J=new r(X.button_continue);return J.label=k,J.onClick(function(){return q.onContinueCB&&q.onContinueCB()}),q.addRightButton(J),q}return le(m,w),re(m,[{key:"onContinue",value:function(a){this.onContinueCB=a}},{key:"onSkip",value:function(a){this.onSkipCB=a}}]),m}(te),xo=function(){function w(m,a){ee(this,w),this.username=m,this.actionContext=a}return re(w,[{key:"startSession",value:function(m,a){this.username=j.getUsernameFromClientContext(m)||this.username,this.clientContext=m,this.uiContext=a.getUiContext(),j.log("Starting registration promotion action session")}},{key:"endSession",value:function(){this.clientContext.overrideAuthenticatorCancelBehavior=!1,j.log("Ending registration promotion action session")}},{key:"promptIntroduction",value:function(m,a,_,v){var k=this;return new Promise(function(M,q){var B=new To(k.actionContext,m,a,_,v);B.setUserName(k.username);var J=com.ts.mobile.sdk.PromotionControlRequest;B.onContinue(function(){M(com.ts.mobile.sdk.PromotionInput.createControlResponse(J.Continue))}),B.onSkip(function(){M(com.ts.mobile.sdk.PromotionInput.createControlResponse(J.Skip))}),B.onCancel(function(){M(com.ts.mobile.sdk.PromotionInput.createControlResponse(J.Abort))}),B.onEscape(function(Y){M(com.ts.mobile.sdk.PromotionInput.createEscapeRequest(Y,{}))}),j.renderPage(B,k.clientContext)})}},{key:"setPromotedAuthenticators",value:function(m){var a=this,_=this.uiContext,v=com.ts.mobile.sdk.PromotionControlRequest;return new Promise(function(k,M){var q={},B=new g(a.actionContext);B.setUserName(a.username),B.setTitle(_.getString("ts_session_promotion_title")),B.setInstructions(_.getString("ts_session_promotion_intro")),m.forEach(function(Y){var he=Y.getAuthenticatorId(),pe=Y.getType();q[he]=Y;var xe=_.getString(L.getAuthenticatorNameKey(he));B.addAuthenticator(he,xe,pe,!1)}),B.onSubmit(function(Y){B.blockInteraction(),a.clientContext.overrideAuthenticatorCancelBehavior=!0,k(com.ts.mobile.sdk.PromotionInput.createAuthenticatorDescription(q[Y]))}),B.onEscape(function(Y){B.blockInteraction(),k(com.ts.mobile.sdk.PromotionInput.createEscapeRequest(Y,{}))}),B.cancelButton.label=_.getString("ts_session_promotion_abort"),B.automationId=X.button_abort,B.onCancel(function(){B.blockInteraction(),k(com.ts.mobile.sdk.PromotionInput.createControlResponse(v.Abort))});var J=new r(X.button_skip);J.label=_.getString("ts_session_promotion_skip"),J.onClick(function(){B.blockInteraction(),k(com.ts.mobile.sdk.PromotionInput.createControlResponse(v.Skip))}),B.addRightButton(J),j.renderPage(B,a.clientContext)})}}]),w}(),Yn="xmui-select-device-to-manage",Fo=function(w){function m(a){var _;ee(this,m),(_=ce(this,oe(m).call(this,X.page_select_device_to_manage,Yn))).uiContext=a,_.setTitle(a.getString("ts_session_dm_title")),_.setInstructions(a.getString("ts_session_dm_details_subtitle"));var v=new r(X.button_back);v.label=a.getString("ts_gen_close"),v.onClick(function(){_.onBackCB&&_.onBackCB()}),_.addLeftButton(v);var k=_.createContent();return _.setContent(k),_}return le(m,w),re(m,[{key:"createContent",value:function(){var a=this;return this.deviceList=new u(S.Single),this.deviceList.onSelectionChanged(function(_){_.length&&a.onSelectCB&&a.onSelectCB(_[0])}),this.deviceList.focus(),this.deviceList}},{key:"getCurrentDeviceState",value:function(){var a=new Hn;return a.setText(this.uiContext.getString("ts_session_dm_details_current_device")),a}},{key:"addDevice",value:function(a,_,v,k,M){var q=new se;q.className="".concat(Yn,"_expand-icon ").concat(fe.Expand);var B=k?[this.getCurrentDeviceState()]:null,J=new s(_,v,M,q,B);this.deviceList.addListItem(a,!1,J)}},{key:"onSelect",value:function(a){this.onSelectCB=a}},{key:"onBack",value:function(a){this.onBackCB=a}}]),m}(Ot),jn="".concat("xmui-manage-device","_row"),Zn="".concat("xmui-manage-device","_info"),eo="".concat("xmui-manage-device","_separator"),Mo="".concat("xmui-manage-device","_name"),Lo="".concat("xmui-manage-device","_spacer"),Oo=function(w){function m(a){var _;ee(this,m),(_=ce(this,oe(m).call(this,X.page_manage_devices,"xmui-device-management-page"))).uiContext=a,_.setTitle(a.getString("ts_session_dm_details_title")),_.setInstructions(a.getString("ts_session_dm_details_subtitle"));var v=new r(X.button_cancel);return v.label=a.getString("ts_gen_back"),v.onClick(function(){_.onCancelCB&&_.onCancelCB()}),v.focus(),_.addLeftButton(v),_.handleAction=_.handleAction.bind(Ee(_)),_}return le(m,w),re(m,[{key:"setDevice",value:function(a,_,v,k,M){var q=this.uiContext,B=new se;B.className="xmui-manage-device";var J=new se;J.className=jn;var Y=new ve;if(Y.setText(a),Y.className=Mo,J.appendChild(Y),k){var he=new Hn;he.setText(this.uiContext.getString("ts_session_dm_section_current")),J.appendChild(he)}if(M.indexOf(com.ts.mobile.sdk.DeviceManagementAction.Rename)>-1){var pe=new se;pe.className=Lo;var xe=new r(X.button_rename);xe.label=q.getString("ts_session_dm_details_rename_action"),xe.value=com.ts.mobile.sdk.DeviceManagementAction.Rename,xe.onClick(this.handleAction),J.appendChildren(pe,xe)}var ht=new ve;ht.setText(_+"\n"+v),ht.className=Zn;var Ye=new se;if(Ye.className=jn,Ye.appendChildren(ht),B.appendChildren(J,Ye),(new se).className=eo,k||M.indexOf(com.ts.mobile.sdk.DeviceManagementAction.Remove)>-1){var Tt=new se;Tt.className=eo,B.appendChild(Tt);var Bt=new se;Bt.className=jn;var _t=new ve;_t.setText(q.getString("ts_session_dm_details_remove_subtitle")),_t.className=Zn;var mt=new r(X.button_remove,l.Alert);mt.label=q.getString("ts_session_dm_details_remove_action"),mt.value=com.ts.mobile.sdk.DeviceManagementAction.Remove,mt.onClick(this.handleAction),Bt.appendChildren(_t,mt),B.appendChild(Bt)}this.setContent(B)}},{key:"onAction",value:function(a){this.onActionCB=a}},{key:"onCancel",value:function(a){this.onCancelCB=a}},{key:"handleAction",value:function(a){this.onActionCB&&this.onActionCB(a.value)}}]),m}(Ot),No=["input","select","textarea","a[href]","button","[tabindex]","audio[controls]","video[controls]",'[contenteditable]:not([contenteditable="false"])'];function Bo(w){return null===w.offsetParent||"hidden"===getComputedStyle(w).visibility}function to(w){for(var m=w.querySelectorAll(No.join(",")),a=[],_=0;_<m.length;_++){var v=m[_];Uo(v)>-1&&!v.disabled&&!Bo(v)&&a.push(v)}return a}function Uo(w){var m=parseInt(w.getAttribute("tabindex"),10);return isNaN(m)?"true"===w.contentEditable?0:w.tabIndex:m}var kn,Wn="xmui-popup-dialog",no=function(w){function m(){var a;ee(this,m),(a=ce(this,oe(m).call(this))).className=Wn;var _=new se;return _.className="".concat(Wn,"_overlay"),a.panel=new se,a.panel.className="".concat(Wn,"_panel"),a.appendChildren(_,a.panel),a.handleKeydownEvent=a.handleKeydownEvent.bind(Ee(a)),a}return le(m,w),re(m,[{key:"overlayAddClassName",value:function(a){this.panel.addClass(a)}},{key:"addToPanel",value:function(a){this.panel.appendChild(a)}},{key:"appendInto",value:function(a){dt(oe(m.prototype),"appendInto",this).call(this,a),document.addEventListener("keydown",this.handleKeydownEvent)}},{key:"close",value:function(){document.removeEventListener("keydown",this.handleKeydownEvent),this.remove()}},{key:"handleKeydownEvent",value:function(a){var _,v,k,M,q;_=a,M=(k=to(v=this.panel.htmlElement))[0],q=k[k.length-1],"Tab"===_.key?v.contains(_.target)?_.shiftKey&&_.target===M?(q.focus(),_.preventDefault()):_.shiftKey||_.target!==q||(M.focus(),_.preventDefault()):((M=(k=to(v))[0]).focus(),_.preventDefault()):v.contains(_.target)||_.preventDefault()}}]),m}(se),zn=function(w){function m(){var a;return ee(this,m),(a=ce(this,oe(m).call(this))).headerPanel=new un(!0),a.headerPanel.show=!1,a.addToPanel(a.headerPanel),a.contentContainer=new se,a.contentContainer.className="".concat("xmui-action-popup-dialog","_content"),a.actionPanel=new Fn(!0),a.addToPanel(a.contentContainer),a.addToPanel(a.actionPanel),a}return le(m,w),re(m,[{key:"setTitle",value:function(a){this.headerPanel.show=!0,this.headerPanel.setText(a)}},{key:"setIcon",value:function(a){this.headerPanel.show=!0,this.headerPanel.setIcon(a)}},{key:"setContent",value:function(a){this.contentContainer.appendChild(a)}},{key:"addLeftButton",value:function(a){this.actionPanel.addLeftButton(a)}},{key:"addRightButton",value:function(a){this.actionPanel.addRightButton(a)}}]),m}(no),oo="xmui-confirm-popup-dialog",Ho=function(w){function m(a,_,v){var k,M=arguments.length>3&&void 0!==arguments[3]&&arguments[3];ee(this,m),(k=ce(this,oe(m).call(this))).automationId=X.popup_dialog_confirm,k.handleClick=k.handleClick.bind(Ee(k));var q=new r(X.button_cancel);q.label=v||a.getString("ts_gen_cancel"),q.value=!1,q.onClick(k.handleClick),k.addLeftButton(q);var B=new r(X.button_continue);B.label=_||a.getString("ts_authenticator_password_cta_positive"),B.value=!0,B.onClick(k.handleClick),k.addRightButton(B);var J=new se;return J.className="".concat(oo,"_container"),k.messageComp=new ve,k.messageComp.className="".concat(oo,"_message"),J.appendChild(k.messageComp),k.setContent(J),M?B.focus():q.focus(),k}return le(m,w),re(m,[{key:"setMessage",value:function(a){this.messageComp.setText(a)}},{key:"onSelect",value:function(a){this.onSelectCB=a}},{key:"handleClick",value:function(a){this.onSelectCB(a.value)}}]),m}(zn),io="xmui-text-input-form",Wo=function(w){function m(a,_,v){var k;ee(this,m),(k=ce(this,oe(m).call(this))).addClass("xmui-input-popup-dialog"),k.automationId=X.popup_dialog_confirm;var M=new r(X.button_cancel);M.label=v||a.getString("ts_gen_cancel"),M.value=!1,M.onClick(function(){k.onCancelCB&&k.onCancelCB()}),k.addLeftButton(M);var q=new r(X.button_continue);q.label=_||a.getString("ts_authenticator_password_cta_positive"),q.value=!0,q.type=d.Submit,q.disabled=!0,q.onClick(function(){k.onSubmitCB&&k.onSubmitCB(k.inputField.value)}),q.form=io,k.addRightButton(q),k.confirmButton=q;var B=k.buildContent();return k.setContent(B),k}return le(m,w),re(m,[{key:"setPlacehoder",value:function(a){this.inputField.placeholder=a}},{key:"onSubmit",value:function(a){this.onSubmitCB=a}},{key:"onCancel",value:function(a){this.onCancelCB=a}},{key:"buildContent",value:function(){var a=this,_=new Z;_.id=io;var v=new Te(K.Text,X.input_text);return v.disabled=!1,v.value="",v.onChange(function(){a.confirmButton.disabled=null==a.inputField.value||0===a.inputField.value.length}),v.focus(),this.inputField=v,_.appendChild(v),_}}]),m}(zn),zo=function(){function w(m){var a;ee(this,w),this.username=m,this.actionToError=(ge(a={},com.ts.mobile.sdk.DeviceManagementAction.Remove,"ts_session_dm_item_action_remove_result_negative"),ge(a,com.ts.mobile.sdk.DeviceManagementAction.Rename,"ts_session_dm_item_action_rename_result_negative"),a)}return re(w,[{key:"setSessionDevicesList",value:function(m){var a=this;this.devices=m,this.deviceManagementSessionService&&(this.currentSelectedDevice=this.currentSelectedDevice?this.devices.find(function(_){return _.getInfo().getDeviceHwId()===a.currentSelectedDevice.getInfo().getDeviceHwId()}):null,this.currentSelectedDevice?this.openManageDevice(this.currentSelectedDevice):this.devices&&this.openSelectDeviceToManage())}},{key:"startSession",value:function(m,a,_){this.username=j.getUsernameFromClientContext(_)||this.username,this.deviceManagementSessionService=m,this.actionContext=a,this.clientContext=_,this.uiContext=m.getUiContext(),this.instructions=null,j.log("Starting device management session"),this.openSelectDeviceToManage()}},{key:"endSession",value:function(){j.log("Ending device management session")}},{key:"handleRemove",value:function(m){var a=this,_=this.uiContext;return new Promise(function(v,k){var M=a.getDeviceName(m),q=new Ho(_,_.getString("ts_session_dm_item_action_dialog_remove_cta"));q.setTitle(_.formatString("ts_session_dm_item_action_dialog_remove_title",[M])),q.setIcon(fe.Remove),q.setMessage(_.getString("ts_session_dm_item_action_dialog_remove_message")),q.onSelect(function(B){if(q.close(),B)if(m.getInfo().getIsCurrent()){var J=a.deviceManagementSessionService.removeCurrentDeviceAndFinishSession(a.clientContext).then(function(Y){return Y&&a.setSuccessMessage("ts_session_dm_item_action_remove_result_positive",M),Y});v(J)}else v(a.deviceManagementSessionService.removeDevice(m,a.clientContext));else v(!1)}),j.renderModal(q,a.clientContext)})}},{key:"handleRename",value:function(m){var a=this,_=this.uiContext;return new Promise(function(v,k){var M=a.getDeviceName(m),q=new Wo(_,_.getString("ts_session_dm_item_action_dialog_rename_cta"));q.setTitle(_.formatString("ts_session_dm_item_action_dialog_rename_title",[M])),q.setIcon(fe.Rename),q.setPlacehoder(_.getString("ts_session_dm_details_rename_input_hint")),q.onCancel(function(){q.close(),v(!1)}),q.onSubmit(function(B){q.close();var J=a.deviceManagementSessionService.renameDevice(m,B,a.clientContext).then(function(Y){return Y&&a.setSuccessMessage("ts_session_dm_item_action_rename_result_positive",M,B),Y});v(J)}),j.renderModal(q,a.clientContext)})}},{key:"handleAction",value:function(m,a){var _,v=this;switch(a){case com.ts.mobile.sdk.DeviceManagementAction.Remove:_=this.handleRemove(m);break;case com.ts.mobile.sdk.DeviceManagementAction.Rename:_=this.handleRename(m)}_&&_.then(function(){}).catch(function(k){var M=v.getDeviceName(m),q=v.uiContext.formatString(v.actionToError[a],[M,k.getMessage()]);v.handleError(k,q)})}},{key:"setSuccessMessage",value:function(m,a,_){this.instructions=this.uiContext.formatString(m,[a,_])}},{key:"handleError",value:function(m,a){var _=this;this.instructions=null,x.promiseInformationInput(this.username,fe.Information,this.uiContext.getString("ts_session_dm_error_dialog_title"),a,this.uiContext.getString("ts_gen_continue"),this.uiContext,this.clientContext).then(function(){_.openManageDevice(_.currentSelectedDevice)})}},{key:"handleCancel",value:function(){this.openSelectDeviceToManage()}},{key:"openManageDevice",value:function(m){var a=m.getInfo(),_=m.getAvailableActions(),v=this.getDeviceName(m),k=this.getDeviceOS(m),M=this.getLastAccessed(m),q=a.getIsCurrent(),B=new Oo(this.uiContext);B.setUserName(this.username),B.setDevice(v,k,M,q,_),B.onAction(this.handleAction.bind(this,m)),B.onCancel(this.handleCancel.bind(this)),j.renderPage(B,this.clientContext)}},{key:"openSelectDeviceToManage",value:function(){var m=this;this.currentSelectedDevice=null;var a={},_=new Fo(this.uiContext);_.setUserName(this.username),this.instructions&&_.setInstructions(this.instructions),this.devices.forEach(function(v){var k=v.getInfo(),M=k.getDeviceHwId(),q=m.getDeviceName(v),B=m.getLastAccessed(v),J=k.getIsCurrent();a[M]=v,_.addDevice(M,q,B,J,fe.WebBrowser)}),_.onSelect(function(v){m.instructions=null,m.currentSelectedDevice=a[v],m.openManageDevice(a[v])}),_.onBack(function(){m.instructions=null,m.deviceManagementSessionService.finishSession()}),j.renderPage(_,this.clientContext)}},{key:"getDeviceName",value:function(m){var a=m.getInfo(),_=a.getName();return E.getDeviceName(_,a)}},{key:"getDeviceOS",value:function(m){var a=m.getInfo();return"".concat(a.getOsType(),"  ").concat(a.getOsVersion())}},{key:"getLastAccessed",value:function(m){null==m.getInfo()._lastAccessLocationAttributes&&(m.getInfo()._lastAccessLocationAttributes={city:"sin informacion",state:""});var a=new Date(m.getInfo().getLastAccess()).toLocaleString();return this.uiContext.formatString("ts_session_dm_last_used_date",[a]).concat(" en ",m.getInfo()._lastAccessLocationAttributes.city,", ",m.getInfo()._lastAccessLocationAttributes.state)}}]),w}();!function(w){w.Text="text",w.Email="email",w.MobileNumber="phone"}(kn||(kn={}));var wn,Vo=/^[a-z]{2}$/i,Go=function(){function w(){ee(this,w)}return re(w,null,[{key:"getFlagEmoji",value:function(m){return m.name_code?w.countryCodeEmoji(m.name_code):null}},{key:"countryCodeEmoji",value:function(m){if(!Vo.test(m)){var a=De(m);throw new TypeError("cc argument must be an ISO 3166-1 alpha-2 string, but got '".concat("string"===a?m:a,"' instead."))}return String.fromCodePoint(m.codePointAt(0)+127365)+String.fromCodePoint(m.codePointAt(1)+127365)}}]),w}(),nn="xmui-country-item-content",Qo=function(w){function m(a){var _,v=arguments.length>1&&void 0!==arguments[1]&&arguments[1];ee(this,m),(_=ce(this,oe(m).call(this))).className=nn;var k=new ve;k.className="".concat(nn,"_flag");var M=new ve;M.className="".concat(nn,"_title");var q=new ve;q.className="".concat(nn,"_phone_code"),null!=a&&(k.setText(Go.countryCodeEmoji(a.name_code.toLowerCase())),M.setText(a.name),q.setText("+".concat(a.phone_code)));var B=new se;return B.className="".concat(nn,"_space"),v&&_.addClass("".concat(nn,"--selected")),_.appendChildren(k,M,B,q),_}return le(m,w),m}(se),ro="xmui-countries-popup-dialog",Jo=function(w){function m(){var a;return ee(this,m),(a=ce(this,oe(m).call(this))).search="",a.className=ro,a.container=new se,a.container.addClass("".concat(ro,"_container")),a.addToPanel(a.container),a.onClick(a.onDismiss.bind(Ee(a))),a.onKeypress(U(a.onKeyPressEvent.bind(Ee(a)),100,!1)),a.onKeydown(U(a.onKeyDownEvent.bind(Ee(a)),100,!1)),a}return le(m,w),re(m,[{key:"onKeyDownEvent",value:function(a,_){_.keyCode===bt.Backspace&&(this.search=this.search.slice(0,-1),this.filter())}},{key:"onKeyPressEvent",value:function(a,_){this.search=this.search+_.key,this.filter()}},{key:"filter",value:function(){this.countries&&this.createList(this.search&&this.search.length>0?this.filteredCountries(this.search):this.countries)}},{key:"filteredCountries",value:function(a){var _=this,v=this.countries.filter(function(k,M,q){return k.name.toLowerCase().startsWith(_.search.toLowerCase())||k.phone_code===_.search.toLowerCase()||k.name_code===_.search.toLowerCase()});if(v&&v.length>0)return v;this.createList(this.countries)}},{key:"setCountries",value:function(a,_){this.countries=a,this.selectedCountryCode=_,this.createList(a),this.selectedCountryItem&&this.selectedCountryItem.scrollIntoView()}},{key:"createList",value:function(a){var _=this;null!=a&&(this.countriesList=new u(S.None),this.countriesList.focus(),this.container.setContent(this.countriesList),a.forEach(function(v){var k=new Qo(v,v.name_code===_.selectedCountryCode);v.name_code===_.selectedCountryCode&&(_.selectedCountryItem=k),_.countriesList.addListItem(v.name_code,!1,k)}),this.countriesList.onItemClicked(function(v){_.onSelectCB&&(_.onSelectCB(v),_.close())}))}},{key:"onSelect",value:function(a){this.onSelectCB=a}},{key:"onDismiss",value:function(a,_){this.close()}}]),m}(no),Xo=[{name_code:"ad",name:"Andorra",phone_code:"376"},{name_code:"ae",name:"United Arab Emirates (UAE)",phone_code:"971"},{name_code:"af",name:"Afghanistan",phone_code:"93"},{name_code:"ag",name:"Antigua and Barbuda",phone_code:"1"},{name_code:"ai",name:"Anguilla",phone_code:"1"},{name_code:"al",name:"Albania",phone_code:"355"},{name_code:"am",name:"Armenia",phone_code:"374"},{name_code:"ao",name:"Angola",phone_code:"244"},{name_code:"aq",name:"Antarctica",phone_code:"672"},{name_code:"ar",name:"Argentina",phone_code:"54"},{name_code:"as",name:"American Samoa",phone_code:"1"},{name_code:"at",name:"Austria",phone_code:"43"},{name_code:"au",name:"Australia",phone_code:"61"},{name_code:"aw",name:"Aruba",phone_code:"297"},{name_code:"ax",name:"\xc5land Islands",phone_code:"358"},{name_code:"az",name:"Azerbaijan",phone_code:"994"},{name_code:"ba",name:"Bosnia And Herzegovina",phone_code:"387"},{name_code:"bb",name:"Barbados",phone_code:"1"},{name_code:"bd",name:"Bangladesh",phone_code:"880"},{name_code:"be",name:"Belgium",phone_code:"32"},{name_code:"bf",name:"Burkina Faso",phone_code:"226"},{name_code:"bg",name:"Bulgaria",phone_code:"359"},{name_code:"bh",name:"Bahrain",phone_code:"973"},{name_code:"bi",name:"Burundi",phone_code:"257"},{name_code:"bj",name:"Benin",phone_code:"229"},{name_code:"bl",name:"Saint Barth\xe9lemy",phone_code:"590"},{name_code:"bm",name:"Bermuda",phone_code:"1"},{name_code:"bn",name:"Brunei Darussalam",phone_code:"673"},{name_code:"bo",name:"Bolivia, Plurinational State Of",phone_code:"591"},{name_code:"br",name:"Brazil",phone_code:"55"},{name_code:"bs",name:"Bahamas",phone_code:"1"},{name_code:"bt",name:"Bhutan",phone_code:"975"},{name_code:"bw",name:"Botswana",phone_code:"267"},{name_code:"by",name:"Belarus",phone_code:"375"},{name_code:"bz",name:"Belize",phone_code:"501"},{name_code:"ca",name:"Canada",phone_code:"1"},{name_code:"cc",name:"Cocos (keeling) Islands",phone_code:"61"},{name_code:"cd",name:"Congo, The Democratic Republic Of The",phone_code:"243"},{name_code:"cf",name:"Central African Republic",phone_code:"236"},{name_code:"cg",name:"Congo",phone_code:"242"},{name_code:"ch",name:"Switzerland",phone_code:"41"},{name_code:"ci",name:"C\xf4te D'ivoire",phone_code:"225"},{name_code:"ck",name:"Cook Islands",phone_code:"682"},{name_code:"cl",name:"Chile",phone_code:"56"},{name_code:"cm",name:"Cameroon",phone_code:"237"},{name_code:"cn",name:"China",phone_code:"86"},{name_code:"co",name:"Colombia",phone_code:"57"},{name_code:"cr",name:"Costa Rica",phone_code:"506"},{name_code:"cu",name:"Cuba",phone_code:"53"},{name_code:"cv",name:"Cape Verde",phone_code:"238"},{name_code:"cw",name:"Cura\xe7ao",phone_code:"599"},{name_code:"cx",name:"Christmas Island",phone_code:"61"},{name_code:"cy",name:"Cyprus",phone_code:"357"},{name_code:"cz",name:"Czech Republic",phone_code:"420"},{name_code:"de",name:"Germany",phone_code:"49"},{name_code:"dj",name:"Djibouti",phone_code:"253"},{name_code:"dk",name:"Denmark",phone_code:"45"},{name_code:"dm",name:"Dominica",phone_code:"1"},{name_code:"do",name:"Dominican Republic",phone_code:"1"},{name_code:"dz",name:"Algeria",phone_code:"213"},{name_code:"ec",name:"Ecuador",phone_code:"593"},{name_code:"ee",name:"Estonia",phone_code:"372"},{name_code:"eg",name:"Egypt",phone_code:"20"},{name_code:"er",name:"Eritrea",phone_code:"291"},{name_code:"es",name:"Spain",phone_code:"34"},{name_code:"et",name:"Ethiopia",phone_code:"251"},{name_code:"fi",name:"Finland",phone_code:"358"},{name_code:"fj",name:"Fiji",phone_code:"679"},{name_code:"fk",name:"Falkland Islands (malvinas)",phone_code:"500"},{name_code:"fm",name:"Micronesia, Federated States Of",phone_code:"691"},{name_code:"fo",name:"Faroe Islands",phone_code:"298"},{name_code:"fr",name:"France",phone_code:"33"},{name_code:"ga",name:"Gabon",phone_code:"241"},{name_code:"gb",name:"United Kingdom",phone_code:"44"},{name_code:"gd",name:"Grenada",phone_code:"1"},{name_code:"ge",name:"Georgia",phone_code:"995"},{name_code:"gf",name:"French Guyana",phone_code:"594"},{name_code:"gg",name:"Guernsey",phone_code:"44"},{name_code:"gh",name:"Ghana",phone_code:"233"},{name_code:"gi",name:"Gibraltar",phone_code:"350"},{name_code:"gl",name:"Greenland",phone_code:"299"},{name_code:"gm",name:"Gambia",phone_code:"220"},{name_code:"gn",name:"Guinea",phone_code:"224"},{name_code:"gp",name:"Guadeloupe",phone_code:"590"},{name_code:"gq",name:"Equatorial Guinea",phone_code:"240"},{name_code:"gr",name:"Greece",phone_code:"30"},{name_code:"gt",name:"Guatemala",phone_code:"502"},{name_code:"gu",name:"Guam",phone_code:"1"},{name_code:"gw",name:"Guinea-bissau",phone_code:"245"},{name_code:"gy",name:"Guyana",phone_code:"592"},{name_code:"hk",name:"Hong Kong",phone_code:"852"},{name_code:"hn",name:"Honduras",phone_code:"504"},{name_code:"hr",name:"Croatia",phone_code:"385"},{name_code:"ht",name:"Haiti",phone_code:"509"},{name_code:"hu",name:"Hungary",phone_code:"36"},{name_code:"id",name:"Indonesia",phone_code:"62"},{name_code:"ie",name:"Ireland",phone_code:"353"},{name_code:"il",name:"Israel",phone_code:"972"},{name_code:"im",name:"Isle Of Man",phone_code:"44"},{name_code:"is",name:"Iceland",phone_code:"354"},{name_code:"in",name:"India",phone_code:"91"},{name_code:"io",name:"British Indian Ocean Territory",phone_code:"246"},{name_code:"iq",name:"Iraq",phone_code:"964"},{name_code:"ir",name:"Iran, Islamic Republic Of",phone_code:"98"},{name_code:"it",name:"Italy",phone_code:"39"},{name_code:"je",name:"Jersey",phone_code:"44"},{name_code:"jm",name:"Jamaica",phone_code:"1"},{name_code:"jo",name:"Jordan",phone_code:"962"},{name_code:"jp",name:"Japan",phone_code:"81"},{name_code:"ke",name:"Kenya",phone_code:"254"},{name_code:"kg",name:"Kyrgyzstan",phone_code:"996"},{name_code:"kh",name:"Cambodia",phone_code:"855"},{name_code:"ki",name:"Kiribati",phone_code:"686"},{name_code:"km",name:"Comoros",phone_code:"269"},{name_code:"kn",name:"Saint Kitts and Nevis",phone_code:"1"},{name_code:"kp",name:"North Korea",phone_code:"850"},{name_code:"kr",name:"South Korea",phone_code:"82"},{name_code:"kw",name:"Kuwait",phone_code:"965"},{name_code:"ky",name:"Cayman Islands",phone_code:"1"},{name_code:"kz",name:"Kazakhstan",phone_code:"7"},{name_code:"la",name:"Lao People's Democratic Republic",phone_code:"856"},{name_code:"lb",name:"Lebanon",phone_code:"961"},{name_code:"lc",name:"Saint Lucia",phone_code:"1"},{name_code:"li",name:"Liechtenstein",phone_code:"423"},{name_code:"lk",name:"Sri Lanka",phone_code:"94"},{name_code:"lr",name:"Liberia",phone_code:"231"},{name_code:"ls",name:"Lesotho",phone_code:"266"},{name_code:"lt",name:"Lithuania",phone_code:"370"},{name_code:"lu",name:"Luxembourg",phone_code:"352"},{name_code:"lv",name:"Latvia",phone_code:"371"},{name_code:"ly",name:"Libya",phone_code:"218"},{name_code:"ma",name:"Morocco",phone_code:"212"},{name_code:"mc",name:"Monaco",phone_code:"377"},{name_code:"md",name:"Moldova, Republic Of",phone_code:"373"},{name_code:"me",name:"Montenegro",phone_code:"382"},{name_code:"mf",name:"Saint Martin",phone_code:"590"},{name_code:"mg",name:"Madagascar",phone_code:"261"},{name_code:"mh",name:"Marshall Islands",phone_code:"692"},{name_code:"mk",name:"Macedonia (FYROM)",phone_code:"389"},{name_code:"ml",name:"Mali",phone_code:"223"},{name_code:"mm",name:"Myanmar",phone_code:"95"},{name_code:"mn",name:"Mongolia",phone_code:"976"},{name_code:"mo",name:"Macau",phone_code:"853"},{name_code:"mp",name:"Northern Mariana Islands",phone_code:"1"},{name_code:"mq",name:"Martinique",phone_code:"596"},{name_code:"mr",name:"Mauritania",phone_code:"222"},{name_code:"ms",name:"Montserrat",phone_code:"1"},{name_code:"mt",name:"Malta",phone_code:"356"},{name_code:"mu",name:"Mauritius",phone_code:"230"},{name_code:"mv",name:"Maldives",phone_code:"960"},{name_code:"mw",name:"Malawi",phone_code:"265"},{name_code:"mx",name:"Mexico",phone_code:"52"},{name_code:"my",name:"Malaysia",phone_code:"60"},{name_code:"mz",name:"Mozambique",phone_code:"258"},{name_code:"na",name:"Namibia",phone_code:"264"},{name_code:"nc",name:"New Caledonia",phone_code:"687"},{name_code:"ne",name:"Niger",phone_code:"227"},{name_code:"nf",name:"Norfolk Islands",phone_code:"672"},{name_code:"ng",name:"Nigeria",phone_code:"234"},{name_code:"ni",name:"Nicaragua",phone_code:"505"},{name_code:"nl",name:"Netherlands",phone_code:"31"},{name_code:"no",name:"Norway",phone_code:"47"},{name_code:"np",name:"Nepal",phone_code:"977"},{name_code:"nr",name:"Nauru",phone_code:"674"},{name_code:"nu",name:"Niue",phone_code:"683"},{name_code:"nz",name:"New Zealand",phone_code:"64"},{name_code:"om",name:"Oman",phone_code:"968"},{name_code:"pa",name:"Panama",phone_code:"507"},{name_code:"pe",name:"Peru",phone_code:"51"},{name_code:"pf",name:"French Polynesia",phone_code:"689"},{name_code:"pg",name:"Papua New Guinea",phone_code:"675"},{name_code:"ph",name:"Philippines",phone_code:"63"},{name_code:"pk",name:"Pakistan",phone_code:"92"},{name_code:"pl",name:"Poland",phone_code:"48"},{name_code:"pm",name:"Saint Pierre And Miquelon",phone_code:"508"},{name_code:"pn",name:"Pitcairn Islands",phone_code:"870"},{name_code:"pr",name:"Puerto Rico",phone_code:"1"},{name_code:"ps",name:"Palestine",phone_code:"970"},{name_code:"pt",name:"Portugal",phone_code:"351"},{name_code:"pw",name:"Palau",phone_code:"680"},{name_code:"py",name:"Paraguay",phone_code:"595"},{name_code:"qa",name:"Qatar",phone_code:"974"},{name_code:"re",name:"R\xe9union",phone_code:"262"},{name_code:"ro",name:"Romania",phone_code:"40"},{name_code:"rs",name:"Serbia",phone_code:"381"},{name_code:"ru",name:"Russian Federation",phone_code:"7"},{name_code:"rw",name:"Rwanda",phone_code:"250"},{name_code:"sa",name:"Saudi Arabia",phone_code:"966"},{name_code:"sb",name:"Solomon Islands",phone_code:"677"},{name_code:"sc",name:"Seychelles",phone_code:"248"},{name_code:"sd",name:"Sudan",phone_code:"249"},{name_code:"se",name:"Sweden",phone_code:"46"},{name_code:"sg",name:"Singapore",phone_code:"65"},{name_code:"sh",name:"Saint Helena, Ascension And Tristan Da Cunha",phone_code:"290"},{name_code:"si",name:"Slovenia",phone_code:"386"},{name_code:"sk",name:"Slovakia",phone_code:"421"},{name_code:"sl",name:"Sierra Leone",phone_code:"232"},{name_code:"sm",name:"San Marino",phone_code:"378"},{name_code:"sn",name:"Senegal",phone_code:"221"},{name_code:"so",name:"Somalia",phone_code:"252"},{name_code:"sr",name:"Suriname",phone_code:"597"},{name_code:"ss",name:"South Sudan",phone_code:"211"},{name_code:"st",name:"Sao Tome And Principe",phone_code:"239"},{name_code:"sv",name:"El Salvador",phone_code:"503"},{name_code:"sx",name:"Sint Maarten",phone_code:"1"},{name_code:"sy",name:"Syrian Arab Republic",phone_code:"963"},{name_code:"sz",name:"Swaziland",phone_code:"268"},{name_code:"tc",name:"Turks and Caicos Islands",phone_code:"1"},{name_code:"td",name:"Chad",phone_code:"235"},{name_code:"tg",name:"Togo",phone_code:"228"},{name_code:"th",name:"Thailand",phone_code:"66"},{name_code:"tj",name:"Tajikistan",phone_code:"992"},{name_code:"tk",name:"Tokelau",phone_code:"690"},{name_code:"tl",name:"Timor-leste",phone_code:"670"},{name_code:"tm",name:"Turkmenistan",phone_code:"993"},{name_code:"tn",name:"Tunisia",phone_code:"216"},{name_code:"to",name:"Tonga",phone_code:"676"},{name_code:"tr",name:"Turkey",phone_code:"90"},{name_code:"tt",name:"Trinidad & Tobago",phone_code:"1"},{name_code:"tv",name:"Tuvalu",phone_code:"688"},{name_code:"tw",name:"Taiwan",phone_code:"886"},{name_code:"tz",name:"Tanzania, United Republic Of",phone_code:"255"},{name_code:"ua",name:"Ukraine",phone_code:"380"},{name_code:"ug",name:"Uganda",phone_code:"256"},{name_code:"us",name:"United States",phone_code:"1"},{name_code:"uy",name:"Uruguay",phone_code:"598"},{name_code:"uz",name:"Uzbekistan",phone_code:"998"},{name_code:"va",name:"Holy See (vatican City State)",phone_code:"379"},{name_code:"vc",name:"Saint Vincent & The Grenadines",phone_code:"1"},{name_code:"ve",name:"Venezuela, Bolivarian Republic Of",phone_code:"58"},{name_code:"vg",name:"British Virgin Islands",phone_code:"1"},{name_code:"vi",name:"US Virgin Islands",phone_code:"1"},{name_code:"vn",name:"Vietnam",phone_code:"84"},{name_code:"vu",name:"Vanuatu",phone_code:"678"},{name_code:"wf",name:"Wallis And Futuna",phone_code:"681"},{name_code:"ws",name:"Samoa",phone_code:"685"},{name_code:"xk",name:"Kosovo",phone_code:"383"},{name_code:"ye",name:"Yemen",phone_code:"967"},{name_code:"yt",name:"Mayotte",phone_code:"262"},{name_code:"za",name:"South Africa",phone_code:"27"},{name_code:"zm",name:"Zambia",phone_code:"260"},{name_code:"zw",name:"Zimbabwe",phone_code:"263"}],Bn="xmui-mobile-phone-input",$o="".concat(Bn,"_separator"),Yo="".concat(Bn,"_plus"),Zo="".concat(Bn,"_country-code-container"),Qt="-",ti=function(w){function m(){var a,_=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",v=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";ee(this,m),(a=ce(this,oe(m).call(this,K.PositiveInteger,X.input_mobile_phone_number))).addClass(Bn),a.countries=Xo;var k=new ve(Qt);k.className=$o,a.prependToInputRow(k);var M=new se;M.className=Zo;var q=new r(X.input_mobile_phone_coutry_code);q.onClick(function(){if(a.onCountriesCB){var J=a.countries;if(!J)return;var Y=new Jo;Y.setCountries(J,a.currentSelectedCountryCode),Y.onSelect(function(he){var pe=J.find(function(xe){return xe.name_code===he});pe&&(a.currentSelectedCountryCode=pe.name_code,q.label=pe.phone_code)}),a.onCountriesCB(Y)}}),M.appendChild(q),a.prependToInputRow(M);var B=new ve("+");return B.className=Yo,a.prependToInputRow(B),a.countryCodeButton=q,a.addValidator(be.mobileNumber),a.value="".concat(_).concat(Qt).concat(v),a}return le(m,w),re(m,[{key:"getRequiredValidator",value:function(){return function(a){var _=a.replace(Qt,"");return be.required(_)}}},{key:"checkHasValue",value:function(){return!!this.value.replace(Qt,"").length}},{key:"onCountries",value:function(a){this.onCountriesCB=a}},{key:"isEmpty",get:function(){return!this.value.trim().replace(Qt,"").length}},{key:"value",set:function(a){var _=a.length&&a.split(Qt);_&&2===_.length&&(this.countryCodeButton.label=_[0],Ne(oe(m.prototype),"value",_[1],this,!0))},get:function(){return"".concat(this.countryCodeButton.label).concat(Qt).concat(dt(oe(m.prototype),"value",this))}},{key:"countryCode",get:function(){return this.countryCodeButton.label}},{key:"number",get:function(){return dt(oe(m.prototype),"value",this)}}]),m}(Te),oi=function(w){function m(a){var _;ee(this,m),(_=ce(this,oe(m).call(this))).addClass("xmui-dynamic-mobile-phone-input");var M=new ti(a.value&&a.value.country_code||"",a.value&&a.value.number||"");return M.name=a.id,M.message=a.hint?a.hint:"",M.required=!0===a.mandatory,M.placeholder=M.required?a.name.trim()+" *":a.name,_.appendChild(M),_.mobilePhoneInput=M,_}return le(m,w),re(m,[{key:"validateAndSetErrorMessage",value:function(){return this.mobilePhoneInput.validateAndSetErrorMessage()}},{key:"onCountriesCB",value:function(a){this.mobilePhoneInput.onCountries(a)}},{key:"name",get:function(){return this.mobilePhoneInput.name}},{key:"value",get:function(){return{country_code:this.mobilePhoneInput.countryCode,number:this.mobilePhoneInput.number}}},{key:"required",get:function(){return this.mobilePhoneInput.required}},{key:"isEmpty",get:function(){return this.mobilePhoneInput.isEmpty}}]),m}(Se),ii=function(w){function m(a,_,v,k,M){var q;return ee(this,m),(q=ce(this,oe(m).call(this,a))).actions=M,q.id=_,q.name=v,q.clientContext=k,q.buildActions(M),q}return le(m,w),re(m,[{key:"buildActions",value:function(a){var _=this;a.forEach(function(v){var k=_.createInputField(v);_.appendChild(k)})}},{key:"createInputField",value:function(a){var v,k;switch(a.type){case kn.Text:k=new Te(K.Text,X.input_text);break;case kn.Email:k=new Te(K.Email,X.input_email),v=254;break;case kn.MobileNumber:var M=new oi(a);return M.onCountriesCB(this.onCountriesCB.bind(this)),M;default:throw new Error("Unsupported form field type")}return k.name=a.id,k.message=a.hint?a.hint:"",k.required=!0===a.mandatory,k.placeholder=k.required?a.name.trim()+" *":a.name,a.value&&(k.value=a.value),null!=v&&(k.maxlength=v),k}},{key:"onCountriesCB",value:function(a){j.renderModal(a,this.clientContext)}}]),m}(Z),si=function(w){function m(a,_,v,k){var M;ee(this,m),(M=ce(this,oe(m).call(this,X.page_dynamic_form,"xmui-dynamic-form-page",a))).clientContext=_,M.formId=v,M.payload=k,M.setTitle(M.payload.title||M.formId),M.payload.subtitle&&M.setInstructions(M.payload.subtitle);var q=M.createForm();return M.setContent(q),M}return le(m,w),re(m,[{key:"onSubmit",value:function(a){this.onSubmitCB=a}},{key:"createForm",value:function(){var a=this,_=new r(X.button_continue);_.label=this.uiContext.getString("ts_authenticator_password_cta_positive"),this.addRightButton(_);var v=new ii(_,"xmui-dynamic-form","xmui-dynamic-form",this.clientContext,this.payload.actions);return v.onSubmit(function(k){a.onSubmitCB&&a.onSubmitCB({type:a.payload.type,actions:k})}),v.start(),v}}]),m}(h);!function(w){w[w.Init=0]="Init",w[w.Continue=1]="Continue",w[w.Error=2]="Error"}(wn||(wn={}));var In,ai=function(){function w(m,a){ee(this,w),this.formId=m,this.payload=a,this.state=wn.Init}return re(w,[{key:"startSession",value:function(m,a){this.clientContext=m,this.actionContext=a}},{key:"endSession",value:function(){}},{key:"onContinue",value:function(m){this.payload=m,this.state=wn.Continue}},{key:"onError",value:function(m){this.payload=m,this.state=wn.Error}},{key:"promiseFormInput",value:function(){var m=this;return new Promise(function(a,_){var v=new si(m.actionContext,m.clientContext,m.formId,m.payload),k=j.getUsernameFromClientContext(m.clientContext);k&&v.setUserName(k),v.onSubmit(function(M){a(com.ts.mobile.sdk.FormInput.createFormInputSubmissionRequest(M))}),v.onCancel(function(){a(com.ts.mobile.sdk.FormInput.createFormCancellationRequest())}),v.onEscape(function(M){a(com.ts.mobile.sdk.FormInput.createEscapeRequest(M,{}))}),j.renderPage(v,m.clientContext)})}}]),w}();!function(w){w.Button="button",w.Toggle="toggle",w.Separator="separator"}(In||(In={}));var at,so="xmui-button-user-detail",ci=function(w){function m(a){var _;ee(this,m);var v=new se;return v.className="".concat(so,"_more ").concat(fe.CircledMore),(_=ce(this,oe(m).call(this,a.title,a.value,null,v))).addClass(so),_}return le(m,w),m}(s),Un="xmui-switch",ao="".concat(Un,"--on"),ui="".concat(Un,"_bar"),li="".concat(Un,"_knob"),hi=function(w){function m(){var a,_=arguments.length>0&&void 0!==arguments[0]&&arguments[0];ee(this,m),(a=ce(this,oe(m).call(this))).className=Un,a.value=_;var v=new se;v.className=ui;var k=new se;return k.className=li,a.appendChildren(v,k),a}return le(m,w),re(m,[{key:"updateState",value:function(){this.value?this.addClass(ao):this.removeClass(ao)}},{key:"value",set:function(a){Ne(oe(m.prototype),"value",a,this,!0),this.updateState()},get:function(){return dt(oe(m.prototype),"value",this)}}]),m}(se),pi=function(w){function m(a){var _;ee(this,m);var v=new hi(a.value);return(_=ce(this,oe(m).call(this,a.title,null,null,v))).switchComp=v,_.addClass("xmui-toggle-user-detail"),_}return le(m,w),re(m,[{key:"switchState",value:function(){this.switchComp.value=!this.switchComp.value}}]),m}(s),mi=function(w){function m(a,_){var v;ee(this,m),(v=ce(this,oe(m).call(this,X.page_manage_user_details,"xmui-manage-user-details-page",!1))).actionContext=a,v.payload=_,v.uiContext=v.actionContext.getUiContext(),v.setTitle(_.title);var k=v.createContent();return v.setContent(k),_.footer_buttons.forEach(function(M){var q=new r(X.button_dynamic);q.label=M.title,q.onClick(function(){return v.onSubmitCB&&v.onSubmitCB({selected_option:M.id})}),v.addRightButton(q)}),v}return le(m,w),re(m,[{key:"createContent",value:function(){var a=this,_=new u;return this.payload.menu.items.forEach(function(v){switch(v.type){case In.Button:var k=new ci(v);_.addListItem(v.id,!1,k);break;case In.Toggle:var M=new pi(v);_.addListItem(v.id,!1,M),_.onSelectionChanged(function(q){q[0]===v.id&&M.switchState()});break;case In.Separator:_.startSection()}}),_.onSelectionChanged(function(v){a.onSubmitCB&&a.onSubmitCB({selected_option:v[0]})}),_.focus(),_}},{key:"onSubmit",value:function(a){this.onSubmitCB=a}}]),m}(Ot),_i=function(){function w(m,a){ee(this,w),this.formId=m,this.payload=a}return re(w,[{key:"startSession",value:function(m,a){this.clientContext=m,this.actionContext=a}},{key:"endSession",value:function(){}},{key:"onContinue",value:function(m){this.payload=m}},{key:"onError",value:function(m){this.payload=m}},{key:"promiseFormInput",value:function(){var m=this;return new Promise(function(a,_){var v=new mi(m.actionContext,m.payload);v.onSubmit(function(k){a(com.ts.mobile.sdk.FormInput.createFormInputSubmissionRequest(k))}),j.renderPage(v,m.clientContext)})}}]),w}(),Vn="xmui-select-question-dialog",gi="".concat(Vn,"_container"),vi="".concat(Vn,"_message"),yi=function(w){function m(a,_,v){var k;ee(this,m),(k=ce(this,oe(m).call(this))).addClass(Vn);var M=new r(X.button_cancel);M.label=a.getString("ts_gen_cancel"),M.value=!1,M.onClick(function(){k.close()}),k.addLeftButton(M),k.setTitle(a.getString("ts_authenticator_questions_reg_select_question"));var q=new se;return q.className=gi,_.forEach(function(B){var J=new ve;J.className=vi,J.setText(B.getSecurityQuestionText()),J.onClick(function(){v(B),k.close()}),q.appendChild(J)}),k.setContent(q),k}return le(m,w),m}(zn),bi=function(w){function m(){var a;return ee(this,m),(a=ce(this,oe(m).call(this,K.Text,X.input_security_question))).answered=!1,a.onChange(function(){a.updateState(a.value)}),a}return le(m,w),re(m,[{key:"checkHasValue",value:function(){return!0}},{key:"updateState",value:function(a){this.answered!==!!a&&(a&&a.length>this.minlength-1?this.addIcon(fe.Checkmark):this.removeIcon(fe.Checkmark),this.answered=!!a)}},{key:"maxlength",set:function(a){Ne(oe(m.prototype),"maxlength",a,this,!0)}},{key:"value",set:function(a){Ne(oe(m.prototype),"value",a,this,!0),this.updateState(a)},get:function(){return dt(oe(m.prototype),"value",this)}}]),m}(Te),co=function(){function w(m,a,_,v){ee(this,w),this.input=m,this.container=a,this.parent=_,this.removeButton=v}return re(w,null,[{key:"createByState",value:function(m,a,_,v,k){var M=new se;M.className=wi;var q=m.getString("ts_authenticator_questions_reg_select_question"),B=new bi;B.ariaLabel=q,B.maxlength=v.getMaxAnswerLength(),B.minlength=v.getMinAnswerLength();var J=new r(X.button_remove,l.Normal);J.addClass(ki),J.label=m.getString("ts_authenticator_questions_remove_this_question_cta"),M.appendChild(B),M.appendChild(J),_.appendChild(M);var Y=new w(B,M,_,J);switch(a.state){case at.PROVIDED_REMOVED:case at.NEW_REMOVED:throw new Error("can't start with remove");case at.PROVIDED_ANSWERED:B.placeholder=a.question.getSecurityQuestionText();var he=m.getString("ts_authenticator_questions_reg_default_answer_placeholder");B.value=he,J.onClick(function(){a.state=at.PROVIDED_REMOVED,_.removeChild(M),j.log("removed called for answered question ".concat(a.question.getSecurityQuestionText())),k(!0)});break;default:B.placeholder=q,B.disabled=!0,J.onClick(function(){a.state=at.NEW_REMOVED,j.log("remove called for new question"),_.removeChild(M),k(!0)})}return B.onFocusIn(function(){j.log("focus on "+B.placeholder),a.state==at.PROVIDED_ANSWERED&&(B.value="")}),B.onChange(function(){var pe=B.value.length;B.clearError(),pe>v.getMinAnswerLength()-1&&(a.state=a.state==at.PROVIDED_ANSWERED?at.PROVIDED_MODIFIED:at.NEW_ANSWERED,a.answer=B.value,k(!0))}),B.onFocusOut(function(){var pe=B.value.length;if(0==pe)if(a.state==at.PROVIDED_ANSWERED){var xe=m.getString("ts_authenticator_questions_reg_default_answer_placeholder");B.value=xe}else{var ht=m.getString("ts_authenticator_questions_error_answer_empty");B.setError(ht,!1)}else if(pe<v.getMinAnswerLength()){var Ye=m.formatString("ts_authenticator_questions_error_answer_range",[v.getMinAnswerLength().toString(),v.getMaxAnswerLength().toString()]);B.setError(Ye,!1),k(!1)}}),Y}}]),w}(),Si="".concat("xmui-security-questions-reg-form","_progress-indication"),Ci="".concat("xmui-security-questions-reg-form","_form-container"),ki="".concat("xmui-security-questions-reg-form","_button-remove"),wi="".concat("xmui-security-questions-reg-form","_question-container"),Gn="xmui-security-questions-reg-form";!function(w){w[w.PROVIDED_ANSWERED=0]="PROVIDED_ANSWERED",w[w.PROVIDED_REMOVED=1]="PROVIDED_REMOVED",w[w.PROVIDED_MODIFIED=2]="PROVIDED_MODIFIED",w[w.NEW_ANSWERED=3]="NEW_ANSWERED",w[w.NEW=4]="NEW",w[w.NEW_REMOVED=5]="NEW_REMOVED"}(at||(at={}));var uo=function w(m,a,_){ee(this,w),this.state=m,this.question=a,this.answer=_},Ii=function(w){function m(a,_,v){var k;ee(this,m),(k=ce(this,oe(m).call(this,X.input_security_question,"xmui-security-questions-reg-page",a))).questionsMap=new Map,k.cells=new Array,k.displayModal=v;var M=Array(),q=Array();_.getSecurityQuestions(),_.getSecurityQuestions().forEach(function(Y){Y.getAnswered()?M.push(Y):q.push(Y)}),k.selectableQuestions=q,k.answeredQuestions=M,k.currentStep=_,k.setTitle(k.getTitle()),k.setInstructions(k.getInstructions()),k.setContent(k.createForm());var B=new r(X.button_add_question);B.label=k.uiContext.getString("ts_authenticator_questions_add_question_cta"),B.type=d.Button,B.form=Gn,B.onClick(function(){k.addQuestion(),k.updateFormState()}),k.addRightButton(B),k.addQuestionButton=B;var J=new r(X.button_continue);return J.label=k.uiContext.getString("ts_authenticator_password_cta_positive"),J.type=d.Submit,J.form=Gn,J.onClick(function(){var Y=!1;k.cells.forEach(function(he){if(he.input.error)return j.log("Stopped continue click due to having a cell with an error"),void(Y=!0);if(he.input.isEmpty){var pe=k.uiContext.getString("ts_authenticator_questions_error_answer_empty");return he.input.setError(pe,!1),void(Y=!0)}}),Y||k.onSubmitCB(k.collectUserAnswers())}),k.addRightButton(J),k.continueButton=J,k.updateFormState(),k}return le(m,w),re(m,[{key:"setError",value:function(a){this.error=!0,a&&this.setInstructions(a)}},{key:"onSubmit",value:function(a){this.onSubmitCB=a}},{key:"collectUserAnswers",value:function(){var a=Array();return this.questionsMap.forEach(function(_){switch(_.state){case at.PROVIDED_REMOVED:a.push(com.ts.mobile.sdk.SecurityQuestionAndAnswer.createAnswerRemovalRequest(_.question));break;case at.NEW_ANSWERED:case at.PROVIDED_MODIFIED:a.push(com.ts.mobile.sdk.SecurityQuestionAndAnswer.createAnswerToQuestion(_.question,com.ts.mobile.sdk.SecurityQuestionAnswer.createWithText(_.answer)));break;default:j.log("question not used: "+_)}}),a}},{key:"updateFormState",value:function(){var a=this.countAnsweredQuestions();this.updateUserProgress(a),this.continueButton.disabled=!this.canSendForm(a),this.addQuestionButton.disabled=this.cells.length+1>this.selectableQuestions.length+this.answeredQuestions.length}},{key:"canSendForm",value:function(a){return!(a<this.currentStep.getMinAnswersNeeded()||(this.cells.forEach(function(_){if(_.input.error)return j.log("Stopped continue click due to having a cell with an error"),!1}),0))}},{key:"countAnsweredQuestions",value:function(){var a=this.answeredQuestions.length;return this.questionsMap.forEach(function(_){switch(_.state){case at.NEW_ANSWERED:a++;break;case at.PROVIDED_REMOVED:a--}}),a}},{key:"updateUserProgress",value:function(a){var _=this.uiContext.formatString("ts_authenticator_questions_left",[a.toString(),(this.selectableQuestions.length+this.answeredQuestions.length).toString()]);this.progressIndication.setText(_)}},{key:"getTitle",value:function(){return this.uiContext.getString("ts_authenticator_questions_title_reg")}},{key:"getInstructions",value:function(){return this.uiContext.formatString("ts_authenticator_questions_intro_reg",[this.currentStep.getMinAnswersNeeded().toString(),(this.selectableQuestions.length+this.answeredQuestions.length).toString()])}},{key:"createForm",value:function(){var a=this,_=new Z;_.addClass("xmui-security-questions-reg-form"),_.id=Gn;var v=new se;v.className=Ci,this.questionsInputContainer=v,this.answeredQuestions.forEach(function(q){var J=new uo(at.PROVIDED_ANSWERED,q),Y=co.createByState(a.uiContext,J,a.questionsInputContainer,a.currentStep,function(he){a.onCellUpdated(J,he)});a.cells.push(Y),a.questionsMap.set(q.getSecurityQuestionId(),J)});for(var k=this.currentStep.getMinAnswersNeeded()-this.answeredQuestions.length,M=0;M<k;M++)this.addQuestion();return this.progressIndication=new ve,this.progressIndication.className=Si,_.appendChildren(v,this.progressIndication),_}},{key:"addQuestion",value:function(){var a=this,v=new uo(at.NEW,null),k=co.createByState(this.uiContext,v,this.questionsInputContainer,this.currentStep,function(M){a.onCellUpdated(v,M)});k.input.addRightButton(this.uiContext.getString("ts_authenticator_questions_reg_select_question_cta"),function(){var M=new Array;a.selectableQuestions.forEach(function(B){var J=a.questionsMap.get(B.getSecurityQuestionId());(!J||J.state&&J.state!=at.NEW_ANSWERED)&&M.push(B)});var q=new yi(a.uiContext,M,function(B){var J=a.selectableQuestions.indexOf(B);a.selectableQuestions.splice(J,1),v.question=B,k.input.disabled=!1,k.input.focus(),k.input.placeholder=B.getSecurityQuestionText(),k.input.value=null});a.displayModal(q)}),k.removeButton.onClick(this.updateFormState.bind(this)),this.cells.push(k)}},{key:"onCellUpdated",value:function(a,_){if(j.log("new state ('".concat(a.state,"') with answer: ").concat(a.answer)),!_&&a.question&&a.question.getSecurityQuestionId())this.questionsMap.delete(a.question.getSecurityQuestionId()),this.updateFormState();else{switch(a.state){case at.PROVIDED_REMOVED:a.question&&a.question.getSecurityQuestionId()&&this.questionsMap.set(a.question.getSecurityQuestionId(),a),this.selectableQuestions.push(a.question);break;case at.NEW_REMOVED:a.question&&a.question.getSecurityQuestionId()&&(this.questionsMap.delete(a.question.getSecurityQuestionId()),this.selectableQuestions.push(a.question));break;default:this.questionsMap.set(a.question.getSecurityQuestionId(),a)}this.updateFormState()}}}]),m}(Ae),Qn="xmui-answered-security-question",Ei=function(w){function m(a,_){var v;ee(this,m),(v=ce(this,oe(m).call(this))).className=Qn;var k=new ve,M=new ve;return k.className="".concat(Qn,"_question"),M.className="".concat(Qn,"_answer"),k.setText(a),M.setText(_),v.appendChildren(k,M),v}return le(m,w),m}(se),lo="xmui-security-questions-auth-form",Pi=function(w){function m(a,_,v){var k;ee(this,m),(k=ce(this,oe(m).call(this,X.page_security_questions_auth,"xmui-security-questions-auth-page",a))).nextQuestion=_,k.prevAnsweredQuestions=v,k.setTitle(k.getTitle()),k.setInstructions(k.getInstructions()),k.content=k.createForm(),k.setContent(k.content);var M=new r(X.button_continue);return M.label=k.uiContext.getString("ts_authenticator_password_cta_positive"),M.type=d.Submit,M.form=lo,M.onClick(function(){return k.onSubmitCB(k.collectUserAnswer())}),k.addRightButton(M),k.continueButton=M,k.updateFormState(),k}return le(m,w),re(m,[{key:"setError",value:function(a){this.error=!0,a&&this.setInstructions(a)}},{key:"onSubmit",value:function(a){this.onSubmitCB=a}},{key:"updateFormState",value:function(){this.updateSubmitButton()}},{key:"updateSubmitButton",value:function(){this.continueButton.disabled=!this.nextQuestionInput.value.trim()}},{key:"collectUserAnswer",value:function(){return com.ts.mobile.sdk.SecurityQuestionAndAnswer.createAnswerToQuestion(this.nextQuestion,com.ts.mobile.sdk.SecurityQuestionAnswer.createWithText(this.nextQuestionInput.value))}},{key:"getTitle",value:function(){return this.uiContext.getString("ts_authenticator_questions_title_auth")}},{key:"getInstructions",value:function(){return this.uiContext.getString("ts_authenticator_questions_intro_auth")}},{key:"createForm",value:function(){var a=new Z;a.addClass("xmui-security-questions-auth-form"),a.id=lo,this.prevAnsweredQuestions.forEach(function(k){var M=k.getQuestion().getSecurityQuestionText(),q=k.getAnswer().getAnswerText(),B=new Ei(M,q);a.appendChild(B)});var _=new Te(K.Text,X.input_security_question),v=this.nextQuestion.getSecurityQuestionText();return _.placeholder=v,_.ariaLabel=v,_.focus(),_.scrollIntoView(),this.nextQuestionInput=_,a.appendChild(_),a.onUserInput(this.updateFormState.bind(this)),a}}]),m}(Ae),Di=function(w){function m(a,_){var v;return ee(this,m),(v=ce(this,oe(m).call(this,a,_))).prevAnsweredQuestions=[],v.supportsInlineError=!0,v}return le(m,w),re(m,[{key:"showAuthUi",value:function(){this.showSecurityQuestionsAuthPage()}},{key:"showRegUi",value:function(){this.showSecurityQuestionsRegPage()}},{key:"setInputStep",value:function(a,_,v){this.currentStep=v}},{key:"showSecurityQuestionsRegPage",value:function(){var a=this,_=new Ii(this.actionContext,this.currentStep,function(v){j.renderModal(v,a.clientContext)});this.authError&&_.setError(this.authErrorMessage),_.onSubmit(function(v){_.blockInteraction();var k=com.ts.mobile.sdk.SecurityQuestionInputResponse.createSecurityQuestionAnswersInputResponse(v);a.resolveInputPromise(com.ts.mobile.sdk.InputOrControlResponse.createInputResponse(k))}),this.showAuthenticatorPage(_)}},{key:"promiseCancelAction",value:function(a){return this.prevAnsweredQuestions=[],dt(oe(m.prototype),"promiseCancelAction",this).call(this,a)}},{key:"promiseRecoveryForError",value:function(a,_,v){return dt(oe(m.prototype),"promiseRecoveryForError",this).call(this,a,_,v)}},{key:"showSecurityQuestionsAuthPage",value:function(){var a=this;this.authError&&(this.prevAnsweredQuestions=[]);var _=new Pi(this.actionContext,this.currentStep.getSecurityQuestions()[0],this.prevAnsweredQuestions);this.authError&&_.setError(this.authErrorMessage),_.onSubmit(function(v){_.blockInteraction();var k=com.ts.mobile.sdk.SecurityQuestionInputResponse.createSecurityQuestionAnswersInputResponse([v]);a.resolveInputPromise(com.ts.mobile.sdk.InputOrControlResponse.createInputResponse(k)),a.prevAnsweredQuestions.push(v)}),this.showAuthenticatorPage(_)}}]),m}(F),Ti=function(){function w(){ee(this,w),N.init()}return re(w,[{key:"startActivityIndicator",value:function(m,a){j.activityStarted(a)}},{key:"endActivityIndicator",value:function(m,a){j.activityEnded(a)}},{key:"controlFlowCancelled",value:function(m){j.log("Control flow cancelled"),j.clearContainer(m)}},{key:"controlFlowStarting",value:function(m){j.log("Control flow started")}},{key:"controlFlowEnded",value:function(m,a){var _=m?"Session rejected by server."==m._message?"":" with error: ".concat(m):"";j.log("Control flow ended"+_)}},{key:"controlFlowActionStarting",value:function(m,a){j.log("Control flow action starting")}},{key:"controlFlowActionEnded",value:function(m,a,_){j.log("Control flow action starting")}},{key:"handleAuthenticatorUnregistration",value:function(m,a,_,v){return Promise.resolve(com.ts.mobile.sdk.UnregistrationInput.create(0))}},{key:"selectAuthenticator",value:function(m,a,_){return x.promiseAuthenticator(m,a,_)}},{key:"selectAuthenticatorFallbackAction",value:function(m,a,_,v,k){var M=j.getUsernameFromClientContext(k);return x.promiseAuthenticatorFallbackAction(M,m,a,_,v,k)}},{key:"controlOptionForCancellationRequestInSession",value:function(m,a){return a instanceof F?a.promiseCancelAction(m):x.promiseCancelActionForNonBaseAuthenticatorSession(m)}},{key:"createPasswordAuthSession",value:function(m,a){return new ke(m,a)}},{key:"createPinAuthSession",value:function(m,a,_){return new He(m,a,_)}},{key:"createPatternAuthSession",value:function(m,a,_,v){return new On(m,a,_,v)}},{key:"createOtpAuthSession",value:function(m,a,_,v){return new An(m,a,_,v)}},{key:"createVoiceAuthSession",value:function(m,a){throw new Error("Method not implemented.")}},{key:"createSecurityQuestionAuthSession",value:function(m,a){return new Di(m,a)}},{key:"createPlaceholderAuthSession",value:function(m,a,_,v,k,M){throw new Error("Method not implemented by demo application.")}},{key:"createFido2AuthSession",value:function(m,a){return new go(m,a)}},{key:"getConfirmationInput",value:function(m,a,_,v,k,M){var q=j.getUsernameFromClientContext(M);return x.promiseConfirmationActionInput(q,fe.Confirmation,m,a,_,v,k,M)}},{key:"getInformationResponse",value:function(m,a,_,v,k){var M=j.getUsernameFromClientContext(k);return x.promiseInformationActionInput(M,fe.Information,m,a,_,v,k)}},{key:"createMobileApproveAuthSession",value:function(m,a,_){return new je(m,a,_)}},{key:"createTicketWaitSession",value:function(m,a){return new Ao}},{key:"createTotpAuthSession",value:function(m,a){return new po(m,a)}},{key:"createFormSession",value:function(m,a){if(a&&"dynamic_form"===a.type)return new ai(m,a);if(a&&"xm.qs.MenuList"===a.type)return new _i(m,a);throw new Error("Method not implemented by demo application.")}},{key:"createAuthenticationConfigurationSession",value:function(m){return new Po(m)}},{key:"createRegistrationPromotionSession",value:function(m,a){return new xo(m,a)}},{key:"processJsonData",value:function(m,a,_){throw new Error("Method not implemented by demo application.")}},{key:"handlePolicyRejection",value:function(m,a,_,v,k,M){return x.promisePolicyRejectionInput(m,a,_,v,k,M)}},{key:"handlePolicyRedirect",value:function(m,a,_,v,k){return j.log("Policy redirection requested. redirecting to policy: [".concat(a,"] with additionalParameters: [").concat(v,"]")),Promise.resolve(com.ts.mobile.sdk.RedirectInput.create(com.ts.mobile.sdk.RedirectResponseType.RedirectToPolicy))}},{key:"shouldIncludeDisabledAuthenticatorsInMenu",value:function(m,a){return!1}},{key:"createScanQrSession",value:function(m,a){throw new Error("Method not implemented.")}},{key:"createFingerprintAuthSession",value:function(m,a){throw new Error("Method not implemented.")}},{key:"createApprovalsSession",value:function(m){throw new Error("Method not implemented.")}},{key:"createTotpGenerationSession",value:function(m,a){throw new Error("Method not implemented.")}},{key:"createDeviceManagementSession",value:function(m){return j.log("Starting device management session"),new zo(m)}},{key:"createNativeFaceAuthSession",value:function(m,a){throw new Error("Method not implemented.")}},{key:"createFaceAuthSession",value:function(m,a){throw new Error("Method not implemented.")}},{key:"createDeviceBiometricsAuthSession",value:function(m,a){throw new Error("Method not implemented.")}},{key:"localAuthenticatorInvalidated",value:function(m){throw new Error("Method not implemented.")}},{key:"setLogEnabled",value:function(m){j.setLogEnabled(m)}}],[{key:"presentUI",value:function(m,a){j.presentUI(m,a)}}]),w}();Ct.XmUIHandler=Ti,Object.defineProperty(Ct,"__esModule",{value:!0})});